"use strict";(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[86],{227:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},379:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},529:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z"}),"Chat")},598:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5m-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11m3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5"}),"InsertEmoticon")},760:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},1673:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")},1770:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block")},3086:(e,r,o)=>{o.r(r),o.d(r,{default:()=>he});var n=o(9379),t=o(45),s=o(9950),i=o(8429),a=o(6491),l=o(6639),c=o(9808),d=o(2235),m=o(5333),u=o(2053),h=o(2236),x=o(4142),p=o(6699),A=o(249),v=o(6050),j=o(8614),g=o(1413),f=o(5277),b=o(8145),y=o(226),C=o(7591),k=o(3266),w=o(4195),S=o(4447),R=o(6583),P=o(33),z=o(8170),E=o(6493),I=o(3563),M=o(9739),H=o(2362),B=o(4862),N=o(3174),q=o(4801),F=o(6281),L=o(529),U=o(3235),W=o(4414);const V=(0,U.A)((0,W.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-7 9h-2V5h2zm0 4h-2v-2h2z"}),"Announcement"),D=(0,U.A)((0,W.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Poll"),O=(0,U.A)((0,W.jsx)("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6z"}),"AttachFile");var T=o(598),_=o(1673),G=o(227),J=o(3248),Z=o(2092),Y=o(760),Q=o(7565),K=o(7319);const X=(0,U.A)((0,W.jsx)("path",{d:"M13 8c0-2.21-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4 4-1.79 4-4m-2 0c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2M1 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4m2 0c.2-.71 3.3-2 6-2 2.69 0 5.78 1.28 6 2zm17-3v-3h3v-2h-3V7h-2v3h-3v2h3v3z"}),"PersonAddAlt"),$=(0,U.A)((0,W.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");var ee=o(379),re=o(1770),oe=o(1367),ne=o(6220),te=o(330),se=o(5887),ie=o(9751),ae=o(4857),le=o(6589),ce=o(4567);const de=["children","value","index"];function me(e){const{children:r,value:o,index:s}=e,i=(0,t.A)(e,de);return(0,W.jsx)("div",(0,n.A)((0,n.A)({role:"tabpanel",hidden:o!==s,id:"room-tabpanel-".concat(s),"aria-labelledby":"room-tab-".concat(s)},i),{},{children:o===s&&(0,W.jsx)(a.A,{sx:{p:2},children:r})}))}const ue=(0,ce.A)("input")({display:"none"}),he=()=>{var e,r;const{roomId:o}=(0,i.g)(),{currentUser:t}=(0,oe.As)(),U=(0,i.Zp)(),[ce,de]=(0,s.useState)(null),[he,xe]=(0,s.useState)(!0),[pe,Ae]=(0,s.useState)(!1),[ve,je]=(0,s.useState)(0),[ge,fe]=(0,s.useState)(null),[be,ye]=(0,s.useState)(""),[Ce,ke]=(0,s.useState)(""),[we,Se]=(0,s.useState)([]),[Re,Pe]=(0,s.useState)([]),[ze,Ee]=(0,s.useState)([]),[Ie,Me]=(0,s.useState)(!1),[He,Be]=(0,s.useState)(!1),[Ne,qe]=(0,s.useState)(!1),[Fe,Le]=(0,s.useState)(""),[Ue,We]=(0,s.useState)([{text:""},{text:""}]),[Ve,De]=(0,s.useState)(""),[Oe,Te]=(0,s.useState)([]),[_e,Ge]=(0,s.useState)(!1),[Je,Ze]=(0,s.useState)(""),[Ye,Qe]=(0,s.useState)("success"),Ke=(0,s.useRef)(null),[Xe,$e]=(0,s.useState)({}),[er,rr]=(0,s.useState)(null),[or,nr]=(0,s.useState)(!1),[tr,sr]=(0,s.useState)(null),[ir,ar]=(0,s.useState)(null),[lr,cr]=(0,s.useState)(!1),dr=(0,s.useRef)(null),[mr,ur]=(0,s.useState)(!1),[hr,xr]=(0,s.useState)(null),[pr,Ar]=(0,s.useState)(null),[vr,jr]=(0,s.useState)(!1),[gr,fr]=(0,s.useState)(!1),[br,yr]=(0,s.useState)(""),[Cr,kr]=(0,s.useState)(null),[wr,Sr]=(0,s.useState)(null),[Rr,Pr]=(0,s.useState)(!1),[zr,Er]=(0,s.useState)(!1),[Ir,Mr]=(0,s.useState)([]),[Hr,Br]=(0,s.useState)(!1),[Nr,qr]=(0,s.useState)([]),[Fr,Lr]=(0,s.useState)(null),[Ur,Wr]=(0,s.useState)(null),[Vr,Dr]=(0,s.useState)(!1),[Or,Tr]=(0,s.useState)(null),[_r,Gr]=(0,s.useState)([]),[Jr,Zr]=(0,s.useState)(!1),[Yr,Qr]=(0,s.useState)(null),[Kr,Xr]=(0,s.useState)({anchorEl:null,message:null}),[$r,eo]=(0,s.useState)({anchorEl:null,message:null,emoji:null}),ro=(0,ae.A)(),oo=((0,le.A)(ro.breakpoints.up("md")),()=>{fe(null)}),no=()=>{var e;null===(e=Ke.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)((()=>{no()}),[we,Re]),(0,s.useEffect)((()=>{if(!o||!t)return void U("/messages");(async()=>{try{const e=(0,ne.H9)(te.db,"rooms",o),r=await(0,ne.x7)(e);if(!r.exists())return se.oR.error("Room not found"),void U("/messages");const s=(0,n.A)({id:r.id},r.data());if(de(s),Ae(s.createdBy===t.uid),!s.members.includes(t.uid)){if(s.locked&&s.createdBy!==t.uid){if(s.pendingRequests&&s.pendingRequests.includes(t.uid))se.oR.success("Your request to join this room is pending approval");else{const r=s.pendingRequests||[];await(0,ne.mZ)(e,{pendingRequests:[...r,t.uid]});const n=(0,ne.rJ)(te.db,"notifications");await(0,ne.gS)(n,{type:"room_join_request",senderId:t.uid,senderName:t.displayName||"User",senderAvatar:t.photoURL||"",recipientId:s.createdBy,content:"".concat(t.displayName||"A user",' wants to join your room "').concat(s.name,'"'),roomId:o,roomName:s.name,isRead:!1,createdAt:(0,ne.O5)()}),se.oR.success("Your request to join this room has been sent to the owner")}return void U("/messages")}await(0,ne.mZ)(e,{members:[...s.members,t.uid]})}xe(!1)}catch(e){console.error("Error fetching room:",e),se.oR.error("Failed to load room"),U("/messages")}})();const e=(0,ne.rJ)(te.db,"rooms",o,"messages"),r=(0,ne.P)(e,(0,ne._M)("type","==","chat"),(0,ne.My)("timestamp","asc"),(0,ne.AB)(100)),s=(0,ne.aQ)(r,(e=>{const r=e.docs.map((e=>(0,n.A)({id:e.id},e.data())));Se(r)})),i=(0,ne.P)(e,(0,ne._M)("type","==","announcement"),(0,ne.My)("timestamp","desc"),(0,ne.AB)(20)),a=(0,ne.aQ)(i,(e=>{const r=e.docs.map((e=>(0,n.A)({id:e.id},e.data())));Pe(r)})),l=(0,ne.P)(e,(0,ne._M)("type","==","poll"),(0,ne.My)("timestamp","desc"),(0,ne.AB)(10)),c=(0,ne.aQ)(l,(e=>{const r=e.docs.map((e=>(0,n.A)({id:e.id},e.data())));Ee(r)}));return()=>{s(),a(),c()}}),[o,t,U,te.db]),(0,s.useEffect)((()=>{if(!t)return;(async()=>{try{const e=(0,ne.H9)(te.db,"users",t.uid),r=await(0,ne.x7)(e);if(r.exists()){const e=r.data();$e({username:e.username,name:e.name,profilePic:e.profilePic||e.photoURL})}}catch(e){console.error("Error fetching user data:",e)}})()}),[t,te.db]);const to=async()=>{if(be.trim()||lr)try{if(lr)return void await co();await(0,ne.gS)((0,ne.rJ)(te.db,"rooms",o,"messages"),{text:be.trim(),sender:null===t||void 0===t?void 0:t.uid,senderName:Xe.name||Xe.username||(null===t||void 0===t?void 0:t.displayName)||"Anonymous",senderPhoto:Xe.profilePic||(null===t||void 0===t?void 0:t.photoURL)||null,timestamp:(0,ne.O5)(),type:"chat",reactions:[]}),ye(""),no()}catch(e){console.error("Error sending message:",e),Ze("Failed to send message"),Qe("error"),Ge(!0)}},so=async()=>{if(Ve.trim())try{Te([]);const r=Ve.trim().toLowerCase(),o=(0,ne.rJ)(te.db,"users");let s=[];try{const e=(0,ne.P)(o,(0,ne.My)("username_lower"),(0,ne.EO)(r),(0,ne.FD)(r+"\uf8ff"),(0,ne.AB)(20)),t=await(0,ne.GG)(e);s=t.docs.map((e=>(0,n.A)({id:e.id},e.data()))),console.log("Found ".concat(s.length," users by username_lower"))}catch(e){console.error("Error searching by username_lower:",e)}if(s.length<10)try{const e=(0,ne.P)(o,(0,ne.My)("name_lower"),(0,ne.EO)(r),(0,ne.FD)(r+"\uf8ff"),(0,ne.AB)(20)),t=(await(0,ne.GG)(e)).docs.map((e=>(0,n.A)({id:e.id},e.data()))).filter((e=>!s.some((r=>r.id===e.id))));s=[...s,...t],console.log("Added ".concat(t.length," users by name_lower, total: ").concat(s.length))}catch(e){console.error("Error searching by name_lower:",e)}if(0===s.length)try{const e=(0,ne.P)(o,(0,ne._M)("username",">=",r),(0,ne._M)("username","<=",r+"\uf8ff"),(0,ne.AB)(20)),t=(0,ne.P)(o,(0,ne._M)("name",">=",r),(0,ne._M)("name","<=",r+"\uf8ff"),(0,ne.AB)(20)),[i,a]=await Promise.all([(0,ne.GG)(e),(0,ne.GG)(t)]),l=new Map;i.docs.forEach((e=>{l.set(e.id,(0,n.A)({id:e.id},e.data()))})),a.docs.forEach((e=>{l.set(e.id,(0,n.A)({id:e.id},e.data()))})),s=Array.from(l.values()),console.log("Found ".concat(s.length," users using standard fields"))}catch(e){console.error("Error with fallback search:",e)}if(0===s.length)try{console.log("Using last resort search method");const e=(0,ne.P)(o,(0,ne.AB)(50)),t=await(0,ne.GG)(e);s=t.docs.map((e=>{const r=e.data();return(0,n.A)({id:e.id,username:r.username,name:r.name,profilePic:r.profilePic},r)})).filter((e=>e.username&&e.username.toLowerCase().includes(r)||e.name&&e.name.toLowerCase().includes(r))),console.log("Found ".concat(s.length," users with client-side filtering"))}catch(e){console.error("Error with last resort search:",e)}const i=s.filter((e=>e.id!==(null===t||void 0===t?void 0:t.uid)&&!(null!==ce&&void 0!==ce&&ce.members.includes(e.id))));console.log("Returning ".concat(i.length," users after filtering")),Te(i),0===i.length&&(Ze("No matching users found"),Qe("info"),Ge(!0))}catch(e){console.error("Error searching users:",e),Ze("Failed to search users"),Qe("error"),Ge(!0)}},io=e=>{if(!e)return"";return e.toDate().toLocaleString()},ao=()=>{tr&&(clearTimeout(tr),sr(null))},lo=()=>{tr&&(clearTimeout(tr),sr(null))},co=async e=>{var r,n,s;const i=e?null===(r=e.target.files)||void 0===r?void 0:r[0]:null===(n=dr.current)||void 0===n||null===(s=n.files)||void 0===s?void 0:s[0];if(!i||!t||!o)return;if(i.size>10485760)return void se.oR.error("File too large. Maximum size is 10MB.");const a=i.type.split("/")[0];if("image"===a||"video"===a){try{cr(!0),ar(0);const e=(0,ie.KR)(te.IG,"chat-media/rooms/".concat(o,"/").concat(Date.now(),"_").concat(i.name)),r=(0,ie.bp)(e,i);r.on("state_changed",(e=>{const r=e.bytesTransferred/e.totalBytes*100;ar(r)}),(e=>{console.error("Error uploading file:",e),se.oR.error("Upload failed: "+e.message),cr(!1),ar(null)}),(async()=>{try{const e=await(0,ie.qk)(r.snapshot.ref);await mo(e,a),cr(!1),ar(null)}catch(e){console.error("Error getting download URL:",e),se.oR.error("Failed to process uploaded file"),cr(!1),ar(null)}}))}catch(l){console.error("Error handling file upload:",l),se.oR.error("Failed to upload file"),cr(!1),ar(null)}dr.current&&(dr.current.value="")}else se.oR.error("Only image and video files are supported.")},mo=async(e,r)=>{if(t)try{const n=(0,ne.rJ)(te.db,"rooms",o,"messages"),s="image"===r?"Sent an image":"Sent a video";await(0,ne.gS)(n,{text:s,sender:t.uid,senderName:Xe.name||Xe.username||t.displayName||"User",senderPhoto:Xe.profilePic||t.photoURL||"",timestamp:(0,ne.O5)(),type:"chat",mediaUrl:e,mediaType:r}),no()}catch(n){console.error("Error sending media message:",n),se.oR.error("Failed to send media")}},uo=()=>{Ar(null)},ho=()=>{kr(null)},xo=()=>{Xr({anchorEl:null,message:null})},po=()=>{eo({anchorEl:null,message:null,emoji:null})},Ao=()=>{Lr(null),Wr(null)};(0,s.useEffect)((()=>{t&&(async()=>{if(t)try{const e=(0,ne.H9)(te.db,"users",t.uid),r=await(0,ne.x7)(e);if(r.exists()){const e=r.data();Gr(e.blockedUsers||[])}}catch(e){console.error("Error fetching blocked users:",e)}})()}),[t]),(0,s.useEffect)((()=>{Nr.length>0&&(()=>{if(!ce||!_r.length)return;const e=Nr.find((e=>_r.includes(e.id)));e&&(Qr(e),Zr(!0))})()}),[Nr,_r]);const vo=e=>{const r=/(https?:\/\/[^\s]+\/side-room\/[^\s]+)/g;return e.split(r).map(((e,o)=>{if(e.match(r)){const r=new URL(e).pathname.split("/"),n=r[r.length-1];return(0,W.jsx)(a.A,{component:"button",onClick:e=>{e.stopPropagation(),(e=>{U("/side-room/".concat(e))})(n)},sx:{color:"inherit",textDecoration:"underline",background:"none",border:"none",padding:0,font:"inherit",cursor:"pointer","&:hover":{opacity:.8}},children:e},o)}return(0,W.jsx)("span",{children:e},o)}))};return he?(0,W.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,W.jsx)(l.A,{})}):(0,W.jsxs)(c.A,{maxWidth:"md",sx:{mt:2,mb:8,height:"100%"},children:[(0,W.jsxs)(d.A,{elevation:0,sx:{p:2},children:[(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center"},children:[(0,W.jsx)(m.A,{onClick:()=>U("/messages"),sx:{mr:1},children:(0,W.jsx)(q.A,{})}),(0,W.jsx)(u.A,{variant:"h6",fontWeight:"bold",children:null===ce||void 0===ce?void 0:ce.name})]}),(0,W.jsx)(m.A,{onClick:e=>{fe(e.currentTarget)},children:(0,W.jsx)(F.A,{})})]}),(null===ce||void 0===ce?void 0:ce.description)&&(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:ce.description}),(0,W.jsx)(a.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,W.jsxs)(h.A,{value:ve,onChange:(e,r)=>{je(r)},"aria-label":"room tabs",variant:"fullWidth",children:[(0,W.jsx)(x.A,{label:"General Chat",icon:(0,W.jsx)(L.A,{}),iconPosition:"start",id:"room-tab-0","aria-controls":"room-tabpanel-0"}),(0,W.jsx)(x.A,{label:"Announcements",icon:(0,W.jsx)(V,{}),iconPosition:"start",id:"room-tab-1","aria-controls":"room-tabpanel-1"}),(0,W.jsx)(x.A,{label:"Polls",icon:(0,W.jsx)(D,{}),iconPosition:"start",id:"room-tab-2","aria-controls":"room-tabpanel-2"})]})})]}),lr&&(0,W.jsxs)(a.A,{sx:{width:"100%",px:2,py:1,bgcolor:"background.paper"},children:[(0,W.jsxs)(u.A,{variant:"caption",gutterBottom:!0,children:["Uploading media... ",ir?Math.round(ir):0,"%"]}),(0,W.jsx)(p.A,{variant:"determinate",value:ir||0,sx:{height:6,borderRadius:3}})]}),(0,W.jsxs)(d.A,{elevation:0,sx:{height:"calc(100vh - 250px)",mt:2},children:[(0,W.jsxs)(me,{value:ve,index:0,children:[(0,W.jsx)(a.A,{sx:{height:"calc(100vh - 350px)",overflowY:"auto",mb:2},children:0===we.length?(0,W.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"No messages yet. Start the conversation!"})}):(0,W.jsxs)(A.A,{children:[we.map((e=>{var r,o;const n=e.sender===(null===t||void 0===t?void 0:t.uid);return(0,W.jsxs)(v.Ay,{alignItems:"flex-start",sx:{flexDirection:n?"row-reverse":"row",px:1},children:[(0,W.jsx)(j.A,{sx:{minWidth:n?"40px":"56px",ml:n?1:0},children:(0,W.jsx)(g.A,{alt:e.senderName,src:e.senderPhoto,sx:{width:40,height:40,bgcolor:e.senderPhoto?void 0:n?"primary.main":"secondary.main",cursor:"pointer","&:hover":{opacity:.8}},onClick:()=>U("/profile/".concat(e.sender)),children:!e.senderPhoto&&(null===(r=e.senderName)||void 0===r||null===(o=r.charAt(0))||void 0===o?void 0:o.toUpperCase())})}),(0,W.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",alignItems:n?"flex-end":"flex-start",maxWidth:"75%"},children:[(0,W.jsx)(u.A,{variant:"caption",color:"text.secondary",sx:{mb:.5,cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>U("/profile/".concat(e.sender)),children:n?"You":e.senderName}),(0,W.jsxs)(d.A,{elevation:0,sx:{p:1.5,borderRadius:2,bgcolor:n?"primary.light":"background.paper",color:n?"primary.contrastText":"text.primary",cursor:"pointer",position:"relative","&:hover":{opacity:.9}},onClick:r=>((e,r)=>{Xr({anchorEl:e.currentTarget,message:r})})(r,e),onMouseDown:()=>n&&(e=>{if(e.sender!==(null===t||void 0===t?void 0:t.uid))return;const r=setTimeout((()=>{rr(e),nr(!0)}),500);sr(r)})(e),onMouseUp:ao,onTouchStart:()=>n&&(e=>{if(e.sender!==(null===t||void 0===t?void 0:t.uid))return;const r=setTimeout((()=>{rr(e),nr(!0)}),500);sr(r)})(e),onTouchEnd:lo,children:[e.mediaUrl&&"image"===e.mediaType&&(0,W.jsx)(a.A,{sx:{mb:1},children:(0,W.jsx)("img",{src:e.mediaUrl,alt:"Shared image",style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"8px",display:"block"}})}),e.mediaUrl&&"video"===e.mediaType&&(0,W.jsx)(a.A,{sx:{mb:1},children:(0,W.jsx)("video",{src:e.mediaUrl,controls:!0,style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"8px",display:"block"}})}),(0,W.jsx)(u.A,{variant:"body1",children:vo(e.text)}),(0,W.jsx)(u.A,{variant:"caption",color:n?"primary.contrastText":"text.secondary",sx:{display:"block",opacity:.8,mt:.5,textAlign:"right"},children:io(e.timestamp)})]}),e.reactions&&e.reactions.length>0&&(0,W.jsx)(a.A,{sx:{display:"flex",flexDirection:n?"row-reverse":"row",flexWrap:"wrap",gap:.5,mt:.5,maxWidth:"100%"},children:Object.entries(e.reactions.reduce(((e,r)=>(e[r.emoji]=(e[r.emoji]||0)+1,e)),{})).map((r=>{var o;let[n,s]=r;const i=null===(o=e.reactions)||void 0===o?void 0:o.some((e=>e.emoji===n&&e.userId===(null===t||void 0===t?void 0:t.uid)));return(0,W.jsx)(f.A,{label:"".concat(n," ").concat(s),size:"small",variant:"outlined",onClick:r=>((e,r,o)=>{e.stopPropagation(),eo({anchorEl:e.currentTarget,message:r,emoji:o})})(r,e,n),sx:{borderRadius:"12px",height:"24px",fontSize:"0.75rem",cursor:"pointer",backgroundColor:e=>i?"dark"===e.palette.mode?"rgba(25, 118, 210, 0.2)":"rgba(25, 118, 210, 0.1)":"dark"===e.palette.mode?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",border:e=>i?"1px solid ".concat(e.palette.primary.main):void 0,"&:hover":{backgroundColor:e=>i?"dark"===e.palette.mode?"rgba(25, 118, 210, 0.3)":"rgba(25, 118, 210, 0.2)":"dark"===e.palette.mode?"rgba(255,255,255,0.15)":"rgba(0,0,0,0.1)"}}},n)}))})]})]},e.id)})),(0,W.jsx)("div",{ref:Ke})]})}),(0,W.jsxs)(a.A,{sx:{display:"flex",p:1},children:[(0,W.jsx)(ue,{ref:dr,accept:"image/*,video/*",id:"file-upload-input",type:"file",onChange:co}),(0,W.jsx)(m.A,{onClick:()=>{var e;null===(e=dr.current)||void 0===e||e.click()},color:"primary",sx:{mr:1},"aria-label":"attach file",children:(0,W.jsx)(O,{})}),(0,W.jsx)(m.A,{onClick:()=>{ur(!mr)},color:"primary",sx:{mr:1},"aria-label":"add emoji",children:(0,W.jsx)(T.A,{})}),(0,W.jsx)(b.A,{fullWidth:!0,placeholder:"Type a message...",variant:"outlined",value:be,onChange:e=>ye(e.target.value),onKeyPress:e=>"Enter"===e.key&&to(),sx:{mr:1}}),(0,W.jsx)(y.A,{variant:"contained",endIcon:(0,W.jsx)(_.A,{}),onClick:to,disabled:!be.trim()&&!lr,children:"Send"})]})]}),(0,W.jsxs)(me,{value:ve,index:1,children:[pe&&(0,W.jsxs)(a.A,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1},children:[(0,W.jsx)(u.A,{variant:"subtitle1",gutterBottom:!0,children:"Create Announcement"}),(0,W.jsx)(b.A,{fullWidth:!0,placeholder:"Post an announcement to all members...",variant:"outlined",multiline:!0,rows:3,value:Ce,onChange:e=>ke(e.target.value),sx:{mb:1}}),(0,W.jsx)(y.A,{variant:"contained",endIcon:(0,W.jsx)(V,{}),onClick:async()=>{if(Ce.trim()&&t&&pe)try{const e=(0,ne.rJ)(te.db,"rooms",o,"messages");await(0,ne.gS)(e,{text:Ce.trim(),sender:t.uid,senderName:Xe.name||Xe.username||t.displayName||"User",senderPhoto:Xe.profilePic||t.photoURL||"",timestamp:(0,ne.O5)(),type:"announcement",reactions:[]}),ke(""),Ze("Announcement posted"),Qe("success"),Ge(!0)}catch(e){console.error("Error posting announcement:",e),se.oR.error("Failed to post announcement")}},disabled:!Ce.trim(),children:"Post Announcement"})]}),(0,W.jsx)(a.A,{children:0===Re.length?(0,W.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:4},children:(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"No announcements yet."})}):(0,W.jsx)(A.A,{children:Re.map((e=>(0,W.jsxs)(d.A,{elevation:0,sx:{mb:2,p:2,bgcolor:"background.default"},children:[(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,W.jsx)(g.A,{alt:e.senderName,src:e.senderPhoto,sx:{mr:1}}),(0,W.jsxs)(a.A,{sx:{flexGrow:1},children:[(0,W.jsx)(u.A,{variant:"subtitle2",children:e.senderName}),(0,W.jsx)(u.A,{variant:"caption",color:"text.secondary",children:io(e.timestamp)})]}),pe&&(0,W.jsx)(m.A,{size:"small",onClick:r=>((e,r)=>{e.stopPropagation(),Ar(e.currentTarget),xr(r)})(r,e),sx:{ml:1},children:(0,W.jsx)(F.A,{fontSize:"small"})})]}),(0,W.jsx)(u.A,{variant:"body1",children:e.text})]},e.id)))})})]}),(0,W.jsxs)(me,{value:ve,index:2,children:[pe&&(0,W.jsxs)(a.A,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1},children:[(0,W.jsx)(u.A,{variant:"subtitle1",gutterBottom:!0,children:"Create Poll"}),(0,W.jsx)(y.A,{variant:"contained",startIcon:(0,W.jsx)(D,{}),onClick:()=>qe(!0),fullWidth:!0,children:"Create New Poll"})]}),(0,W.jsx)(a.A,{children:0===ze.length?(0,W.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:4},children:(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",children:"No polls have been created yet."})}):(0,W.jsx)(A.A,{children:ze.map((e=>{var r;return(0,W.jsxs)(d.A,{elevation:0,sx:{mb:3,p:2,bgcolor:"background.default"},children:[(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,W.jsx)(g.A,{alt:e.senderName,src:e.senderPhoto,sx:{mr:1}}),(0,W.jsxs)(a.A,{sx:{flexGrow:1},children:[(0,W.jsx)(u.A,{variant:"subtitle2",children:e.senderName}),(0,W.jsx)(u.A,{variant:"caption",color:"text.secondary",children:io(e.timestamp)})]}),pe&&e.sender===(null===t||void 0===t?void 0:t.uid)&&(0,W.jsx)(m.A,{size:"small",onClick:r=>((e,r)=>{e.stopPropagation(),kr(e.currentTarget),Sr(r)})(r,e),sx:{ml:1},children:(0,W.jsx)(F.A,{fontSize:"small"})})]}),(0,W.jsx)(u.A,{variant:"h6",gutterBottom:!0,children:e.text}),null===(r=e.pollOptions)||void 0===r?void 0:r.map(((r,n)=>{var s;const i=(null===(s=e.pollVotes)||void 0===s?void 0:s[n.toString()])||[],l=i.length,c=Object.values(e.pollVotes||{}).reduce(((e,r)=>e+((null===r||void 0===r?void 0:r.length)||0)),0),d=c>0?Math.round(l/c*100):0,m=i.includes((null===t||void 0===t?void 0:t.uid)||"");return(0,W.jsxs)(a.A,{sx:{mb:1,p:1.5,borderRadius:1,bgcolor:m?"primary.light":"background.paper",position:"relative",overflow:"hidden",cursor:"pointer","&:hover":{bgcolor:m?"primary.light":"action.hover"}},onClick:()=>(async(e,r)=>{if(t)try{const n=(0,ne.H9)(te.db,"rooms",o,"messages",e),s=await(0,ne.x7)(n);if(!s.exists())return;const i=s.data().pollVotes||{};Object.keys(i).forEach((e=>{var r;null!==(r=i[e])&&void 0!==r&&r.includes(t.uid)&&(i[e]=i[e].filter((e=>e!==t.uid)))}));const a=r.toString();i[a]||(i[a]=[]),i[a]=[...i[a],t.uid],await(0,ne.mZ)(n,{pollVotes:i})}catch(n){console.error("Error voting on poll:",n),se.oR.error("Failed to submit vote")}})(e.id,n),children:[(0,W.jsx)(a.A,{sx:{position:"absolute",left:0,top:0,height:"100%",width:"".concat(d,"%"),bgcolor:"primary.main",opacity:.2,zIndex:0}}),(0,W.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",position:"relative",zIndex:1},children:[(0,W.jsx)(u.A,{variant:"body1",children:r}),(0,W.jsxs)(u.A,{variant:"body2",children:[l," ",1===l?"vote":"votes"," (",d,"%)"]})]})]},n)}))]},e.id)}))})})]})]}),(0,W.jsx)(C.A,{anchorEl:ge,open:Boolean(ge),onClose:oo,children:pe?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(k.A,{onClick:()=>{Me(!0),oo()},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(G.A,{fontSize:"small"})}),"Invite People"]}),(0,W.jsxs)(k.A,{onClick:()=>{Br(!0),(async()=>{if(ce&&ce.members)try{const e=await Promise.all(ce.members.map((async e=>{const r=(0,ne.H9)(te.db,"users",e),o=await(0,ne.x7)(r);if(o.exists()){const r=o.data();return{id:e,username:r.username||"Unknown user",name:r.name,profilePic:r.profilePic}}return null})));qr(e.filter(Boolean))}catch(e){console.error("Error fetching room members:",e),Ze("Failed to load room members"),Qe("error"),Ge(!0)}})(),oo()},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(G.A,{fontSize:"small"})}),"Members"]}),(0,W.jsxs)(k.A,{onClick:async()=>{if(ce&&pe)try{const e=!ce.locked,r=(0,ne.H9)(te.db,"rooms",o);await(0,ne.mZ)(r,{locked:e}),de((0,n.A)((0,n.A)({},ce),{},{locked:e})),Ze("Room ".concat(e?"locked":"unlocked")),Qe("success"),Ge(!0),oo()}catch(e){console.error("Error toggling room lock:",e),Ze("Failed to update room settings"),Qe("error"),Ge(!0)}},children:[(0,W.jsx)(w.A,{children:null!==ce&&void 0!==ce&&ce.locked?(0,W.jsx)(J.A,{fontSize:"small"}):(0,W.jsx)(Z.A,{fontSize:"small"})}),null!==ce&&void 0!==ce&&ce.locked?"Unlock Room":"Lock Room"]}),(null===ce||void 0===ce?void 0:ce.locked)&&(null===ce||void 0===ce?void 0:ce.pendingRequests)&&ce.pendingRequests.length>0&&(0,W.jsxs)(k.A,{onClick:async()=>{if(ce&&pe)try{if(ce.pendingRequests&&ce.pendingRequests.length>0){const e=await Promise.all(ce.pendingRequests.map((async e=>{const r=(0,ne.H9)(te.db,"users",e),o=await(0,ne.x7)(r);if(o.exists()){const r=o.data();return{id:e,username:r.username||"Unknown user",profilePic:r.profilePic}}return null})));Mr(e.filter(Boolean))}else Mr([]);Er(!0)}catch(e){console.error("Error fetching pending requests:",e),Ze("Failed to load join requests"),Qe("error"),Ge(!0)}},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(G.A,{fontSize:"small"})}),"View Join Requests",(0,W.jsx)(S.A,{color:"primary",badgeContent:ce.pendingRequests.length,sx:{ml:1}})]}),(0,W.jsxs)(k.A,{onClick:()=>{Be(!0),oo()},sx:{color:"error.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Y.A,{fontSize:"small",color:"error"})}),"Delete Room"]})]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(k.A,{onClick:()=>{Ze("Room reported to moderators"),Qe("info"),Ge(!0),oo()},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Q.A,{fontSize:"small"})}),"Report Room"]}),(0,W.jsxs)(k.A,{onClick:async()=>{if(ce&&t)try{const e=(0,ne.H9)(te.db,"rooms",o);await(0,ne.mZ)(e,{members:ce.members.filter((e=>e!==t.uid))}),U("/messages"),se.oR.success("You left the room")}catch(e){console.error("Error leaving room:",e),se.oR.error("Failed to leave room")}},sx:{color:"error.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(K.A,{fontSize:"small",color:"error"})}),"Leave Room"]})]})}),(0,W.jsxs)(R.A,{open:Ie,onClose:()=>Me(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(P.A,{children:"Invite People to Room"}),(0,W.jsxs)(z.A,{children:[(0,W.jsx)(E.A,{sx:{mb:2},children:"Search for users to add to this room."}),(0,W.jsxs)(a.A,{sx:{display:"flex",mb:2},children:[(0,W.jsx)(b.A,{fullWidth:!0,label:"Search by username",variant:"outlined",value:Ve,onChange:e=>De(e.target.value),onKeyPress:e=>"Enter"===e.key&&so(),sx:{mr:1}}),(0,W.jsx)(y.A,{variant:"contained",onClick:so,children:"Search"})]}),Oe.length>0?(0,W.jsx)(A.A,{children:Oe.map((e=>(0,W.jsxs)(v.Ay,{secondaryAction:(0,W.jsx)(y.A,{variant:"outlined",size:"small",startIcon:(0,W.jsx)(X,{}),onClick:()=>(async e=>{if(ce&&t)try{const r=(0,ne.H9)(te.db,"rooms",o);await(0,ne.mZ)(r,{members:[...ce.members,e]});const n=(0,ne.rJ)(te.db,"notifications");await(0,ne.gS)(n,{type:"room_invite",from:t.uid,to:e,roomId:o,roomName:ce.name,read:!1,timestamp:(0,ne.O5)()}),Te((r=>r.filter((r=>r.id!==e)))),Ze("User invited to room"),Qe("success"),Ge(!0)}catch(r){console.error("Error inviting user:",r),se.oR.error("Failed to invite user")}})(e.id),children:"Invite"}),children:[(0,W.jsx)(j.A,{children:(0,W.jsx)(g.A,{alt:e.username,src:e.profilePic})}),(0,W.jsx)(I.A,{primary:e.name||e.username,secondary:"@".concat(e.username)})]},e.id)))}):Ve?(0,W.jsxs)(u.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:['No users found matching "',Ve,'"']}):null]}),(0,W.jsx)(M.A,{children:(0,W.jsx)(y.A,{onClick:()=>Me(!1),children:"Close"})})]}),(0,W.jsxs)(R.A,{open:He,onClose:()=>Be(!1),children:[(0,W.jsx)(P.A,{children:"Delete Room?"}),(0,W.jsx)(z.A,{children:(0,W.jsx)(E.A,{children:"Are you sure you want to delete this room? This action cannot be undone and all messages will be permanently deleted."})}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>Be(!1),children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(pe&&o)try{xe(!0);const e=(0,ne.rJ)(te.db,"rooms",o,"messages"),r=(await(0,ne.GG)(e)).docs.map((e=>(0,ne.kd)(e.ref)));await Promise.all(r),await(0,ne.kd)((0,ne.H9)(te.db,"rooms",o)),U("/messages"),se.oR.success("Room deleted")}catch(e){console.error("Error deleting room:",e),se.oR.error("Failed to delete room"),xe(!1)}},color:"error",variant:"contained",children:"Delete"})]})]}),(0,W.jsxs)(R.A,{open:Ne,onClose:()=>qe(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(P.A,{children:"Create Poll"}),(0,W.jsxs)(z.A,{children:[(0,W.jsx)(b.A,{autoFocus:!0,margin:"dense",label:"Poll Question",fullWidth:!0,variant:"outlined",value:Fe,onChange:e=>Le(e.target.value),sx:{mb:3}}),(0,W.jsx)(u.A,{variant:"subtitle2",gutterBottom:!0,children:"Options"}),Ue.map(((e,r)=>(0,W.jsx)(b.A,{margin:"dense",label:"Option ".concat(r+1),fullWidth:!0,variant:"outlined",value:e.text,onChange:e=>((e,r)=>{const o=[...Ue];o[e].text=r,We(o)})(r,e.target.value),sx:{mb:1}},r))),(0,W.jsx)(y.A,{variant:"outlined",startIcon:(0,W.jsx)(X,{}),onClick:()=>{We([...Ue,{text:""}])},sx:{mt:1},children:"Add Option"})]}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>qe(!1),children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(!Fe.trim()||!t||!pe)return;const e=Ue.map((e=>e.text.trim())).filter(Boolean);if(e.length<2)return Ze("A poll needs at least 2 options"),Qe("error"),void Ge(!0);try{const r=(0,ne.rJ)(te.db,"rooms",o,"messages");await(0,ne.gS)(r,{text:Fe.trim(),sender:t.uid,senderName:Xe.name||Xe.username||t.displayName||"User",senderPhoto:Xe.profilePic||t.photoURL||"",timestamp:(0,ne.O5)(),type:"poll",pollOptions:e,pollVotes:{}}),Le(""),We([{text:""},{text:""}]),qe(!1),Ze("Poll created"),Qe("success"),Ge(!0)}catch(r){console.error("Error creating poll:",r),se.oR.error("Failed to create poll")}},variant:"contained",disabled:!Fe.trim()||Ue.filter((e=>e.text.trim())).length<2,children:"Create Poll"})]})]}),(0,W.jsxs)(R.A,{open:or,onClose:()=>{nr(!1),rr(null)},children:[(0,W.jsx)(P.A,{children:"Delete Message?"}),(0,W.jsxs)(z.A,{children:[(0,W.jsx)(E.A,{children:"Are you sure you want to delete this message? This action cannot be undone."}),er&&(0,W.jsx)(d.A,{elevation:0,sx:{p:2,mt:2,bgcolor:"background.default"},children:(0,W.jsx)(u.A,{variant:"body1",children:er.text})})]}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>{nr(!1),rr(null)},children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(!er||!t||er.sender!==t.uid)return nr(!1),void rr(null);try{const e=(0,ne.H9)(te.db,"rooms",o,"messages",er.id);await(0,ne.kd)(e),Ze("Message deleted"),Qe("success"),Ge(!0)}catch(e){console.error("Error deleting message:",e),Ze("Failed to delete message"),Qe("error"),Ge(!0)}finally{nr(!1),rr(null)}},color:"error",startIcon:(0,W.jsx)($,{}),children:"Delete"})]})]}),(0,W.jsx)(H.Ay,{open:mr,onClose:()=>ur(!1),anchorReference:"anchorPosition",anchorPosition:{top:window.innerHeight-300,left:window.innerWidth/2},transformOrigin:{vertical:"bottom",horizontal:"center"},children:(0,W.jsx)(a.A,{sx:{p:1,width:"300px",maxWidth:"90vw",height:"200px",overflow:"auto",display:"flex",flexWrap:"wrap",justifyContent:"center"},children:["\ud83d\ude00","\ud83d\ude01","\ud83d\ude02","\ud83e\udd23","\ud83d\ude03","\ud83d\ude04","\ud83d\ude05","\ud83d\ude06","\ud83d\ude09","\ud83d\ude0a","\ud83d\ude0b","\ud83d\ude0e","\ud83d\ude0d","\ud83e\udd70","\ud83d\ude18","\ud83d\ude17","\ud83d\ude19","\ud83d\ude1a","\ud83d\ude42","\ud83e\udd17","\ud83e\udd14","\ud83e\udd28","\ud83d\ude10","\ud83d\ude11","\ud83d\ude36","\ud83d\ude44","\ud83d\ude0f","\ud83d\ude23","\ud83d\ude25","\ud83d\ude2e","\ud83d\udc4d","\ud83d\udc4e","\ud83d\udc4c","\u270c\ufe0f","\ud83e\udd1e","\ud83e\udd1f","\ud83e\udd18","\ud83d\udc4a","\ud83d\udc4b","\ud83d\ude4c","\u2764\ufe0f","\ud83d\udc94","\ud83d\udc96","\ud83d\udc99","\ud83d\ude22","\ud83d\ude2d","\ud83d\ude24","\ud83d\ude20","\ud83d\ude21","\ud83e\udd2c"].map((e=>(0,W.jsx)(a.A,{component:"button",onClick:()=>{(e=>{ye((r=>r+e))})(e),ur(!1)},sx:{border:"none",background:"none",cursor:"pointer",fontSize:"1.8rem",m:.5,p:.5,borderRadius:"4px",minWidth:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{background:e=>"dark"===e.palette.mode?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"}},children:e},e)))})}),(0,W.jsx)(B.A,{open:_e,autoHideDuration:4e3,onClose:()=>Ge(!1),children:(0,W.jsx)(N.A,{onClose:()=>Ge(!1),severity:Ye,sx:{width:"100%"},children:Je})}),(0,W.jsxs)(C.A,{anchorEl:pr,open:Boolean(pr),onClose:uo,children:[(0,W.jsxs)(k.A,{onClick:()=>{hr&&(yr(hr.text),jr(!0)),uo()},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(ee.A,{fontSize:"small"})}),"Edit Announcement"]}),(0,W.jsxs)(k.A,{onClick:()=>{fr(!0),uo()},sx:{color:"error.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Y.A,{fontSize:"small",color:"error"})}),"Delete Announcement"]})]}),(0,W.jsxs)(R.A,{open:vr,onClose:()=>jr(!1),fullWidth:!0,maxWidth:"sm",children:[(0,W.jsx)(P.A,{children:"Edit Announcement"}),(0,W.jsx)(z.A,{children:(0,W.jsx)(b.A,{autoFocus:!0,fullWidth:!0,multiline:!0,rows:4,value:br,onChange:e=>yr(e.target.value),margin:"dense",variant:"outlined"})}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>jr(!1),children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(hr&&t&&pe&&br.trim())try{const e=(0,ne.H9)(te.db,"rooms",o,"messages",hr.id);await(0,ne.mZ)(e,{text:br.trim()}),Ze("Announcement updated"),Qe("success"),Ge(!0),jr(!1)}catch(e){console.error("Error updating announcement:",e),Ze("Failed to update announcement"),Qe("error"),Ge(!0)}},variant:"contained",color:"primary",disabled:!br.trim(),children:"Save Changes"})]})]}),(0,W.jsxs)(R.A,{open:gr,onClose:()=>fr(!1),children:[(0,W.jsx)(P.A,{children:"Delete Announcement?"}),(0,W.jsx)(z.A,{children:(0,W.jsx)(E.A,{children:"Are you sure you want to delete this announcement? This action cannot be undone."})}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>fr(!1),children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(hr&&t&&pe)try{const e=(0,ne.H9)(te.db,"rooms",o,"messages",hr.id);await(0,ne.kd)(e),Ze("Announcement deleted"),Qe("success"),Ge(!0),fr(!1),xr(null)}catch(e){console.error("Error deleting announcement:",e),Ze("Failed to delete announcement"),Qe("error"),Ge(!0)}},color:"error",variant:"contained",children:"Delete"})]})]}),(0,W.jsxs)(R.A,{open:Rr,onClose:()=>Pr(!1),children:[(0,W.jsx)(P.A,{children:"Delete Poll?"}),(0,W.jsx)(z.A,{children:(0,W.jsx)(E.A,{children:"Are you sure you want to delete this poll? This action cannot be undone."})}),(0,W.jsxs)(M.A,{children:[(0,W.jsx)(y.A,{onClick:()=>Pr(!1),children:"Cancel"}),(0,W.jsx)(y.A,{onClick:async()=>{if(wr&&t&&pe)try{const e=(0,ne.H9)(te.db,"rooms",o,"messages",wr.id);await(0,ne.kd)(e),Ze("Poll deleted"),Qe("success"),Ge(!0),Pr(!1),Sr(null)}catch(e){console.error("Error deleting poll:",e),Ze("Failed to delete poll"),Qe("error"),Ge(!0)}},color:"error",variant:"contained",children:"Delete"})]})]}),(0,W.jsx)(C.A,{anchorEl:Cr,open:Boolean(Cr),onClose:ho,children:(0,W.jsxs)(k.A,{onClick:()=>{Pr(!0),ho()},sx:{color:"error.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Y.A,{fontSize:"small",color:"error"})}),"Delete Poll"]})}),(0,W.jsx)(H.Ay,{open:Boolean(Kr.anchorEl),anchorEl:Kr.anchorEl,onClose:xo,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:(0,W.jsx)(a.A,{sx:{p:1,display:"flex",flexWrap:"wrap",maxWidth:"300px"},children:[{emoji:"\ud83d\udc4d",label:"Like"},{emoji:"\u2764\ufe0f",label:"Love"},{emoji:"\ud83d\ude00",label:"Happy"},{emoji:"\ud83d\ude14",label:"Sad"},{emoji:"\ud83d\udc40",label:"Eyes"},{emoji:"\ud83d\udd25",label:"Fire"},{emoji:"\ud83c\udf89",label:"Celebration"},{emoji:"\ud83e\udd14",label:"Thinking"}].map((e=>(0,W.jsx)(m.A,{onClick:()=>(async e=>{if(Kr.message&&null!==t&&void 0!==t&&t.uid&&o)try{const r=Kr.message.id,s=(0,ne.H9)(te.db,"rooms",o,"messages",r),i=Kr.message.reactions||[],a=i.findIndex((r=>r.userId===t.uid&&r.emoji===e));if(-1!==a){const e=[...i];e.splice(a,1),await(0,ne.mZ)(s,{reactions:e}),"chat"===Kr.message.type?Se((o=>o.map((o=>o.id===r?(0,n.A)((0,n.A)({},o),{},{reactions:e}):o)))):"announcement"===Kr.message.type&&Pe((o=>o.map((o=>o.id===r?(0,n.A)((0,n.A)({},o),{},{reactions:e}):o))))}else{const o={emoji:e,userId:t.uid,username:t.displayName||""},a=[...i,o];await(0,ne.mZ)(s,{reactions:a}),"chat"===Kr.message.type?Se((e=>e.map((e=>e.id===r?(0,n.A)((0,n.A)({},e),{},{reactions:a}):e)))):"announcement"===Kr.message.type&&Pe((e=>e.map((e=>e.id===r?(0,n.A)((0,n.A)({},e),{},{reactions:a}):e))))}xo()}catch(r){console.error("Error adding reaction:",r),Ze("Failed to add reaction"),Qe("error"),Ge(!0),xo()}})(e.emoji),sx:{m:.5,"&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},"aria-label":e.label,children:(0,W.jsx)(u.A,{variant:"body1",sx:{fontSize:"1.4rem"},children:e.emoji})},e.emoji)))})}),(0,W.jsx)(H.Ay,{open:Boolean($r.anchorEl),anchorEl:$r.anchorEl,onClose:po,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:(0,W.jsxs)(a.A,{sx:{p:2,maxWidth:"250px"},children:[(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5,pb:1,borderBottom:1,borderColor:"divider"},children:[(0,W.jsxs)(u.A,{variant:"h6",sx:{display:"flex",alignItems:"center"},children:[(0,W.jsx)(a.A,{component:"span",sx:{fontSize:"1.6rem",mr:1},children:$r.emoji}),"Reactions"]}),$r.message&&$r.emoji&&(null===(e=$r.message.reactions)||void 0===e?void 0:e.some((e=>e.emoji===$r.emoji&&e.userId===(null===t||void 0===t?void 0:t.uid))))&&(0,W.jsx)(y.A,{variant:"outlined",color:"error",size:"small",onClick:()=>{var e;return(async(e,r)=>{if(null!==t&&void 0!==t&&t.uid&&o)try{const s=(0,ne.H9)(te.db,"rooms",o,"messages",e),i=await(0,ne.x7)(s);if(!i.exists())return Ze("Message not found"),Qe("error"),void Ge(!0);const a=i.data(),l=(a.reactions||[]).filter((e=>!(e.userId===t.uid&&e.emoji===r)));await(0,ne.mZ)(s,{reactions:l}),"chat"===a.type?Se((r=>r.map((r=>r.id===e?(0,n.A)((0,n.A)({},r),{},{reactions:l}):r)))):"announcement"===a.type&&Pe((r=>r.map((r=>r.id===e?(0,n.A)((0,n.A)({},r),{},{reactions:l}):r)))),po()}catch(s){console.error("Error removing reaction:",s),Ze("Failed to remove reaction"),Qe("error"),Ge(!0)}})((null===(e=$r.message)||void 0===e?void 0:e.id)||"",$r.emoji||"")},children:"Remove"})]}),(0,W.jsx)(A.A,{sx:{py:0},children:$r.message&&$r.emoji&&(null===(r=$r.message.reactions)||void 0===r?void 0:r.filter((e=>e.emoji===$r.emoji)).map(((e,r)=>(0,W.jsx)(v.Ay,{sx:{py:.5,px:1,borderRadius:1,my:.3,bgcolor:e.userId===(null===t||void 0===t?void 0:t.uid)?"rgba(25, 118, 210, 0.15)":"transparent"},children:(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",width:"100%",justifyContent:"space-between"},children:[(0,W.jsxs)(u.A,{children:[e.username||"User",e.userId===(null===t||void 0===t?void 0:t.uid)&&(0,W.jsx)(u.A,{component:"span",color:"text.secondary",sx:{ml:.5,fontSize:"0.8rem"},children:"(you)"})]}),(0,W.jsx)(u.A,{fontSize:"1.2rem",children:e.emoji})]})},"".concat(e.userId,"-").concat(r)))))})]})}),(0,W.jsxs)(R.A,{open:zr,onClose:()=>Er(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(P.A,{children:"Join Requests"}),(0,W.jsx)(z.A,{children:0===Ir.length?(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No pending join requests"}):(0,W.jsx)(A.A,{children:Ir.map((e=>(0,W.jsxs)(v.Ay,{secondaryAction:(0,W.jsxs)(a.A,{children:[(0,W.jsx)(y.A,{variant:"outlined",color:"primary",size:"small",onClick:()=>(async e=>{if(ce&&pe)try{const r=(0,ne.H9)(te.db,"rooms",o),s=(ce.pendingRequests||[]).filter((r=>r!==e)),i=[...ce.members,e];await(0,ne.mZ)(r,{pendingRequests:s,members:i}),de((0,n.A)((0,n.A)({},ce),{},{pendingRequests:s,members:i})),Mr((r=>r.filter((r=>r.id!==e))));const a=(0,ne.rJ)(te.db,"notifications");await(0,ne.gS)(a,{type:"room_join_approved",senderId:null===t||void 0===t?void 0:t.uid,senderName:Xe.name||Xe.username||(null===t||void 0===t?void 0:t.displayName)||"Room owner",senderAvatar:Xe.profilePic||(null===t||void 0===t?void 0:t.photoURL)||"",recipientId:e,content:'Your request to join "'.concat(ce.name,'" has been approved'),roomId:o,roomName:ce.name,isRead:!1,createdAt:(0,ne.O5)()}),Ze("Join request approved"),Qe("success"),Ge(!0)}catch(r){console.error("Error approving join request:",r),Ze("Failed to approve join request"),Qe("error"),Ge(!0)}})(e.id),sx:{mr:1},children:"Approve"}),(0,W.jsx)(y.A,{variant:"outlined",color:"error",size:"small",onClick:()=>(async e=>{if(ce&&pe)try{const r=(0,ne.H9)(te.db,"rooms",o),s=(ce.pendingRequests||[]).filter((r=>r!==e));await(0,ne.mZ)(r,{pendingRequests:s}),de((0,n.A)((0,n.A)({},ce),{},{pendingRequests:s})),Mr((r=>r.filter((r=>r.id!==e))));const i=(0,ne.rJ)(te.db,"notifications");await(0,ne.gS)(i,{type:"room_join_rejected",senderId:null===t||void 0===t?void 0:t.uid,senderName:Xe.name||Xe.username||(null===t||void 0===t?void 0:t.displayName)||"Room owner",senderAvatar:Xe.profilePic||(null===t||void 0===t?void 0:t.photoURL)||"",recipientId:e,content:'Your request to join "'.concat(ce.name,'" has been declined'),roomId:o,roomName:ce.name,isRead:!1,createdAt:(0,ne.O5)()}),Ze("Join request declined"),Qe("info"),Ge(!0)}catch(r){console.error("Error rejecting join request:",r),Ze("Failed to decline join request"),Qe("error"),Ge(!0)}})(e.id),children:"Decline"})]}),children:[(0,W.jsx)(j.A,{children:(0,W.jsx)(g.A,{alt:e.username,src:e.profilePic})}),(0,W.jsx)(I.A,{primary:e.username,secondary:"Wants to join this room"})]},e.id)))})}),(0,W.jsx)(M.A,{children:(0,W.jsx)(y.A,{onClick:()=>Er(!1),children:"Close"})})]}),(0,W.jsxs)(R.A,{open:Hr,onClose:()=>Br(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(P.A,{children:"Room Members"}),(0,W.jsx)(z.A,{children:0===Nr.length?(0,W.jsx)(u.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center",py:2},children:"No members found"}):(0,W.jsx)(A.A,{children:Nr.map((e=>(0,W.jsxs)(v.Ay,{secondaryAction:e.id!==(null===t||void 0===t?void 0:t.uid)&&(0,W.jsx)(m.A,{edge:"end",onClick:r=>((e,r)=>{e.stopPropagation(),Lr(e.currentTarget),Wr(r)})(r,e),children:(0,W.jsx)(F.A,{})}),sx:{cursor:"pointer",opacity:_r.includes(e.id)?.5:1,"&:hover":{backgroundColor:"action.hover"}},onClick:()=>(e=>{U("/profile/".concat(e.id))})(e),children:[(0,W.jsx)(j.A,{children:(0,W.jsx)(g.A,{alt:e.username,src:e.profilePic})}),(0,W.jsx)(I.A,{primary:(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.name||e.username,_r.includes(e.id)&&(0,W.jsx)(f.A,{label:"Blocked",size:"small",color:"error",variant:"outlined",sx:{height:20,fontSize:"0.7rem"}})]}),secondary:"@".concat(e.username)})]},e.id)))})}),(0,W.jsx)(M.A,{children:(0,W.jsx)(y.A,{onClick:()=>Br(!1),children:"Close"})})]}),(0,W.jsxs)(C.A,{anchorEl:Fr,open:Boolean(Fr),onClose:Ao,children:[pe&&Ur&&Ur.id!==(null===t||void 0===t?void 0:t.uid)&&(0,W.jsxs)(k.A,{onClick:async()=>{if(Ur&&ce&&pe)try{const e=(0,ne.H9)(te.db,"rooms",o),r=ce.members.filter((e=>e!==Ur.id));await(0,ne.mZ)(e,{members:r}),de((0,n.A)((0,n.A)({},ce),{},{members:r})),qr((e=>e.filter((e=>e.id!==Ur.id))));const s=(0,ne.rJ)(te.db,"notifications");await(0,ne.gS)(s,{type:"room_removed",senderId:null===t||void 0===t?void 0:t.uid,senderName:Xe.name||Xe.username||(null===t||void 0===t?void 0:t.displayName)||"Room owner",senderAvatar:Xe.profilePic||(null===t||void 0===t?void 0:t.photoURL)||"",recipientId:Ur.id,content:'You have been removed from "'.concat(ce.name,'"'),roomId:o,roomName:ce.name,isRead:!1,createdAt:(0,ne.O5)()}),Ze("Member removed from room"),Qe("success"),Ge(!0),Ao()}catch(e){console.error("Error removing member:",e),Ze("Failed to remove member"),Qe("error"),Ge(!0)}},sx:{color:"error.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Y.A,{fontSize:"small",color:"error"})}),"Remove from Room"]}),Ur&&Ur.id!==(null===t||void 0===t?void 0:t.uid)&&(0,W.jsxs)(k.A,{onClick:()=>{Ur&&(Ze("Reported ".concat(Ur.username)),Qe("info"),Ge(!0),Ao())},sx:{color:"warning.main"},children:[(0,W.jsx)(w.A,{children:(0,W.jsx)(Q.A,{fontSize:"small",color:"warning"})}),"Report User"]})]}),(0,W.jsxs)(R.A,{open:Vr,onClose:()=>Dr(!1),maxWidth:"sm",fullWidth:!0,children:[(0,W.jsx)(P.A,{children:(0,W.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,W.jsx)(g.A,{src:null===Or||void 0===Or?void 0:Or.profilePic,alt:null===Or||void 0===Or?void 0:Or.username,sx:{width:64,height:64}}),(0,W.jsxs)(a.A,{children:[(0,W.jsx)(u.A,{variant:"h6",children:(null===Or||void 0===Or?void 0:Or.name)||(null===Or||void 0===Or?void 0:Or.username)}),(0,W.jsxs)(u.A,{variant:"subtitle2",color:"text.secondary",children:["@",null===Or||void 0===Or?void 0:Or.username]})]})]})}),(0,W.jsx)(z.A,{children:(0,W.jsx)(a.A,{sx:{mt:2},children:Or&&_r.includes(Or.id)?(0,W.jsx)(y.A,{variant:"outlined",color:"primary",fullWidth:!0,onClick:async()=>{if(t&&Or)try{const e=(0,ne.H9)(te.db,"users",t.uid),r=_r.filter((e=>e!==Or.id));await(0,ne.mZ)(e,{blockedUsers:r}),Gr(r),Ze("Unblocked ".concat(Or.username)),Qe("success"),Ge(!0),Dr(!1)}catch(e){console.error("Error unblocking user:",e),Ze("Failed to unblock user"),Qe("error"),Ge(!0)}},startIcon:(0,W.jsx)(G.A,{}),children:"Unblock User"}):(0,W.jsx)(y.A,{variant:"outlined",color:"error",fullWidth:!0,onClick:async()=>{if(t&&Or)try{const e=(0,ne.H9)(te.db,"users",t.uid),r=[..._r,Or.id];await(0,ne.mZ)(e,{blockedUsers:r}),Gr(r),Ze("Blocked ".concat(Or.username)),Qe("success"),Ge(!0),Dr(!1),null!==ce&&void 0!==ce&&ce.members.includes(Or.id)&&(Qr(Or),Zr(!0))}catch(e){console.error("Error blocking user:",e),Ze("Failed to block user"),Qe("error"),Ge(!0)}},startIcon:(0,W.jsx)(re.A,{}),children:"Block User"})})}),(0,W.jsx)(M.A,{children:(0,W.jsx)(y.A,{onClick:()=>Dr(!1),children:"Close"})})]}),(0,W.jsx)(B.A,{open:Jr,autoHideDuration:6e3,onClose:()=>Zr(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,W.jsx)(N.A,{onClose:()=>Zr(!1),severity:"warning",sx:{width:"100%"},children:Yr&&(0,W.jsxs)(W.Fragment,{children:["You have blocked ",Yr.username,". You can unblock them from their profile."]})})})]})}},3248:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen")},4801:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},6281:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"MoreVert")},6699:(e,r,o)=>{o.d(r,{A:()=>W});var n=o(7528),t=o(8587),s=o(8168),i=o(9950),a=o(2004),l=o(8465),c=o(8283),d=o(9269),m=o(4730),u=o(1676),h=o(9254),x=o(8463),p=o(1763),A=o(423);function v(e){return(0,A.Ay)("MuiLinearProgress",e)}(0,p.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var j,g,f,b,y,C,k=o(4414);const w=["className","color","value","valueBuffer","variant"];let S,R,P,z,E,I;const M=(0,c.i7)(S||(S=j||(j=(0,n.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"])))),H=(0,c.i7)(R||(R=g||(g=(0,n.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"])))),B=(0,c.i7)(P||(P=f||(f=(0,n.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"])))),N=(e,r)=>"inherit"===r?"currentColor":e.vars?e.vars.palette.LinearProgress["".concat(r,"Bg")]:"light"===e.palette.mode?(0,d.a)(e.palette[r].main,.62):(0,d.e$)(e.palette[r].main,.5),q=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.root,r["color".concat((0,u.A)(o.color))],r[o.variant]]}})((e=>{let{ownerState:r,theme:o}=e;return(0,s.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:N(o,r.color)},"inherit"===r.color&&"buffer"!==r.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===r.variant&&{backgroundColor:"transparent"},"query"===r.variant&&{transform:"rotate(180deg)"})})),F=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.dashed,r["dashedColor".concat((0,u.A)(o.color))]]}})((e=>{let{ownerState:r,theme:o}=e;const n=N(o,r.color);return(0,s.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===r.color&&{opacity:.3},{backgroundImage:"radial-gradient(".concat(n," 0%, ").concat(n," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,c.AH)(z||(z=b||(b=(0,n.A)(["\n    animation: "," 3s infinite linear;\n  "]))),B)),L=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r["barColor".concat((0,u.A)(o.color))],("indeterminate"===o.variant||"query"===o.variant)&&r.bar1Indeterminate,"determinate"===o.variant&&r.bar1Determinate,"buffer"===o.variant&&r.bar1Buffer]}})((e=>{let{ownerState:r,theme:o}=e;return(0,s.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===r.color?"currentColor":(o.vars||o).palette[r.color].main},"determinate"===r.variant&&{transition:"transform .".concat(4,"s linear")},"buffer"===r.variant&&{zIndex:1,transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:r}=e;return("indeterminate"===r.variant||"query"===r.variant)&&(0,c.AH)(E||(E=y||(y=(0,n.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    "]))),M)})),U=(0,h.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:o}=e;return[r.bar,r["barColor".concat((0,u.A)(o.color))],("indeterminate"===o.variant||"query"===o.variant)&&r.bar2Indeterminate,"buffer"===o.variant&&r.bar2Buffer]}})((e=>{let{ownerState:r,theme:o}=e;return(0,s.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==r.variant&&{backgroundColor:"inherit"===r.color?"currentColor":(o.vars||o).palette[r.color].main},"inherit"===r.color&&{opacity:.3},"buffer"===r.variant&&{backgroundColor:N(o,r.color),transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:r}=e;return("indeterminate"===r.variant||"query"===r.variant)&&(0,c.AH)(I||(I=C||(C=(0,n.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    "]))),H)})),W=i.forwardRef((function(e,r){const o=(0,x.b)({props:e,name:"MuiLinearProgress"}),{className:n,color:i="primary",value:c,valueBuffer:d,variant:h="indeterminate"}=o,p=(0,t.A)(o,w),A=(0,s.A)({},o,{color:i,variant:h}),j=(e=>{const{classes:r,variant:o,color:n}=e,t={root:["root","color".concat((0,u.A)(n)),o],dashed:["dashed","dashedColor".concat((0,u.A)(n))],bar1:["bar","barColor".concat((0,u.A)(n)),("indeterminate"===o||"query"===o)&&"bar1Indeterminate","determinate"===o&&"bar1Determinate","buffer"===o&&"bar1Buffer"],bar2:["bar","buffer"!==o&&"barColor".concat((0,u.A)(n)),"buffer"===o&&"color".concat((0,u.A)(n)),("indeterminate"===o||"query"===o)&&"bar2Indeterminate","buffer"===o&&"bar2Buffer"]};return(0,l.A)(t,v,r)})(A),g=(0,m.I)(),f={},b={bar1:{},bar2:{}};if("determinate"===h||"buffer"===h)if(void 0!==c){f["aria-valuenow"]=Math.round(c),f["aria-valuemin"]=0,f["aria-valuemax"]=100;let e=c-100;g&&(e=-e),b.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===h)if(void 0!==d){let e=(d||0)-100;g&&(e=-e),b.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,k.jsxs)(q,(0,s.A)({className:(0,a.A)(j.root,n),ownerState:A,role:"progressbar"},f,{ref:r},p,{children:["buffer"===h?(0,k.jsx)(F,{className:j.dashed,ownerState:A}):null,(0,k.jsx)(L,{className:j.bar1,ownerState:A,style:b.bar1}),"determinate"===h?null:(0,k.jsx)(U,{className:j.bar2,ownerState:A,style:b.bar2})]}))}))},7319:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M10.09 15.59 11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"ExitToApp")},7565:(e,r,o)=>{o.d(r,{A:()=>s});var n=o(3235),t=o(4414);const s=(0,n.A)((0,t.jsx)("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"}),"Report")}}]);