"use strict";(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[150],{675:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16"}),"MonetizationOn")},2150:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var a=s(9379),n=s(9950),i=s(8429),r=s(4857),o=s(9808),l=s(6491),c=s(6639),d=s(2053),h=s(899),x=s(470),u=s(704),m=s(7497),A=s(226),j=s(5277),p=s(3174),b=s(2235),g=s(249),f=s(6050),y=s(4195),v=s(3563),C=s(6583),w=s(33),S=s(8170),k=s(8145),W=s(4745),z=s(5979),N=s(3788),D=s(6101),F=s(3266),M=s(9739),R=s(7443),B=s(3235),E=s(4414);const L=(0,B.A)((0,E.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");var H=s(6117),I=s(3531),G=s(2289),P=s(3331),V=s(3182),X=s(6299),U=s(675);const q=(0,B.A)([(0,E.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,E.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"Schedule");var J=s(5699),Y=s(1367),_=s(330),Q=s(6220),T=s(3380),O=s(2856),Z=s(5887);const $=()=>{const{currentUser:e}=(0,Y.As)(),t=(0,r.A)(),s=(0,i.Zp)(),[B,$]=(0,n.useState)(0),[K,ee]=(0,n.useState)(!0),[te,se]=(0,n.useState)({totalGiftsSent:0,totalGiftsReceived:0,totalCoinsEarned:0,totalCoinsSpent:0}),[ae,ne]=(0,n.useState)(!1),[ie,re]=(0,n.useState)(!1),[oe,le]=(0,n.useState)(""),[ce,de]=(0,n.useState)({accountName:"",accountNumber:"",sortCode:"",bankName:""}),[he,xe]=(0,n.useState)([]),[ue,me]=(0,n.useState)(""),[Ae,je]=(0,n.useState)(!1),[pe,be]=(0,n.useState)([]),[ge,fe]=(0,n.useState)(!0),[ye,ve]=(0,n.useState)(null),[Ce,we]=(0,n.useState)(!1),[Se,ke]=(0,n.useState)(!1),We=1e3,ze=e=>e.toFixed(2),Ne=e=>Math.round(100*e),De=e=>.005*e,Fe=e=>{const t=De(e),s=.1*t;return{grossAmount:t,platformFee:s,netAmount:t-s}},Me=[{icon:(0,E.jsx)(R.A,{color:"error"}),title:"Receive Gifts & Earn Money",description:"Host live rooms and earn SideCoins from gifts - withdraw as real money monthly!",coins:"\xa30.005 per SC"},{icon:(0,E.jsx)(L,{color:"warning"}),title:"Monthly Withdrawals",description:"Convert your SideCoins to real money once per month (10% platform fee)",coins:"90% to you"},{icon:(0,E.jsx)(H.A,{color:"primary"}),title:"Host Live Rooms",description:"Create engaging content to attract gift-giving viewers and earn withdrawable income",coins:"Varies"}];(0,n.useEffect)((()=>{if(null===e||void 0===e||!e.uid)return void ee(!1);console.log("[Wallet] Setting up real-time listeners for user:",e.uid);const t=(0,Q.H9)(_.db,"users",e.uid),s=(0,Q.aQ)(t,(e=>{if(e.exists()){const t=e.data();$(t.sideCoins||0),console.log("[Wallet] Balance updated:",t.sideCoins||0)}})),n=(0,Q.P)((0,Q.rJ)(_.db,"withdrawalRequests"),(0,Q._M)("userId","==",e.uid),(0,Q.My)("requestDate","desc")),i=(0,Q.aQ)(n,(e=>{const t=[];e.forEach((e=>{t.push((0,a.A)({id:e.id},e.data()))})),be(t)}));let r;(async()=>{if(null!==e&&void 0!==e&&e.uid){we(!0);try{const t=(0,Q.P)((0,Q.rJ)(_.db,"users",e.uid,"bankDetails"),(0,Q.My)("createdAt","desc"));return(0,Q.aQ)(t,(e=>{const t=[];e.forEach((e=>{const s=e.data();t.push({id:e.id,accountName:s.accountName,accountNumber:s.accountNumber,sortCode:s.sortCode,bankName:s.bankName,isDefault:s.isDefault||!1,createdAt:s.createdAt,lastUsed:s.lastUsed})})),xe(t);const s=t.find((e=>e.isDefault));s&&!ue&&me(s.id)}))}catch(t){console.error("Error loading bank details:",t),Z.oR.error("Failed to load saved bank details")}finally{we(!1)}}})().then((e=>{r=e}));return(async()=>{try{console.log("[Wallet] Loading user stats for:",e.uid);const t=await(0,Q.GG)((0,Q.rJ)(_.db,"sideRooms"));let s=0,a=0,n=0,i=0;for(const r of t.docs){const t=r.id,o=(0,Q.P)((0,Q.rJ)(_.db,"sideRooms",t,"gifts"),(0,Q._M)("senderId","==",e.uid)),l=await(0,Q.GG)(o),c=(0,Q.P)((0,Q.rJ)(_.db,"sideRooms",t,"gifts"),(0,Q._M)("receiverId","==",e.uid)),d=await(0,Q.GG)(c);n+=l.size,l.forEach((e=>{const t=e.data();t.value&&(a+=t.value)})),i+=d.size,d.forEach((e=>{const t=e.data();if(t.value){const e=.8*t.value/.005;s+=e}}))}console.log("[Wallet] Stats calculated:",{totalGiftsSent:n,totalGiftsReceived:i,totalCoinsEarned:s,totalCoinsSpent:a}),se({totalGiftsSent:n,totalGiftsReceived:i,totalCoinsEarned:s,totalCoinsSpent:a})}catch(t){console.error("[Wallet] Error loading user stats:",t)}finally{ee(!1)}})(),()=>{s(),i(),r&&r()}}),[null===e||void 0===e?void 0:e.uid]),(0,n.useEffect)((()=>{(()=>{const e=new Date,t=e.getMonth(),s=e.getFullYear(),a=pe.filter((e=>"completed"===e.status||"approved"===e.status)).sort(((e,t)=>t.requestDate.toDate().getTime()-e.requestDate.toDate().getTime()))[0];if(a){const e=a.requestDate.toDate(),n=e.getMonth(),i=e.getFullYear(),r=n===t&&i===s;if(fe(!r),r){const e=new Date(s,t+1,1);ve(e)}else ve(null)}else fe(!0),ve(null)})()}),[pe]);I.A,G.A,R.A;return K?(0,E.jsx)(o.A,{maxWidth:"lg",sx:{py:4},children:(0,E.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,E.jsx)(c.A,{})})}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(O.mg,{children:[(0,E.jsx)("title",{children:"Wallet - SideEye"}),(0,E.jsx)("meta",{name:"description",content:"Manage your SideCoins balance and withdraw real money"})]}),(0,E.jsxs)(o.A,{maxWidth:"lg",sx:{py:4},children:[(0,E.jsxs)(d.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:2,mb:4},children:[(0,E.jsx)(P.A,{fontSize:"large",color:"primary"}),"My Wallet"]}),(0,E.jsxs)(h.Ay,{container:!0,spacing:3,children:[(0,E.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,E.jsx)(x.A,{sx:{background:"linear-gradient(135deg, ".concat(t.palette.primary.main,", ").concat(t.palette.primary.dark,")"),color:"white",position:"relative",overflow:"hidden"},children:(0,E.jsxs)(u.A,{sx:{p:3},children:[(0,E.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,E.jsx)(d.A,{variant:"h6",children:"Current Balance"}),(0,E.jsx)(T.A,{size:"large"})]}),(0,E.jsxs)(l.A,{sx:{mb:2},children:[(0,E.jsxs)(d.A,{variant:"h3",component:"div",fontWeight:"bold",children:[ze(B)," SC"]}),(0,E.jsxs)(d.A,{variant:"h6",sx:{opacity:.8},children:[Ne(B)," LC"]})]}),(0,E.jsxs)(l.A,{sx:{mb:2,p:2,bgcolor:(0,m.X4)("#fff",.1),borderRadius:1},children:[(0,E.jsxs)(d.A,{variant:"h4",component:"div",fontWeight:"bold",sx:{color:"#FFD700"},children:["\xa3",De(B).toFixed(2)]}),(0,E.jsx)(d.A,{variant:"body2",sx:{opacity:.9},children:"Current Money Value"}),(0,E.jsxs)(d.A,{variant:"caption",sx:{opacity:.8},children:["After 10% platform fee: \xa3",Fe(B).netAmount.toFixed(2)]})]}),(0,E.jsx)(A.A,{variant:"contained",fullWidth:!0,onClick:()=>ne(!0),disabled:!1,startIcon:(0,E.jsx)(V.A,{}),sx:{bgcolor:"#FFD700",color:"#000",fontWeight:"bold","&:hover":{bgcolor:"#FFC107"}},children:"Withdraw Money (Coming Soon)"}),(0,E.jsx)(l.A,{sx:{mt:2},children:ye&&(0,E.jsx)(j.A,{label:"Next Withdrawal: ".concat(ye.toLocaleDateString()),color:"info",size:"small"})}),(0,E.jsx)(l.A,{sx:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:(0,m.X4)("#fff",.1),zIndex:0}})]})})}),(0,E.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,E.jsx)(x.A,{sx:{height:"100%"},children:(0,E.jsxs)(u.A,{sx:{p:3},children:[(0,E.jsxs)(d.A,{variant:"h6",gutterBottom:!0,children:[(0,E.jsx)(X.A,{sx:{mr:1,verticalAlign:"middle"}}),"Your Activity"]}),Math.abs(B-te.totalCoinsEarned)>.01&&(0,E.jsx)(p.A,{severity:"warning",sx:{mb:2},action:(0,E.jsx)(A.A,{color:"inherit",size:"small",onClick:async()=>{if(null!==e&&void 0!==e&&e.uid&&_.db){if(window.confirm("This will set your balance to match your calculated earnings (".concat(ze(te.totalCoinsEarned)," SC). Continue?")))try{const t=(0,Q.H9)(_.db,"users",e.uid);await(0,Q.mZ)(t,{sideCoins:te.totalCoinsEarned}),Z.oR.success("Balance corrected to ".concat(ze(te.totalCoinsEarned)," SC!")),console.log("[Balance Correction] Updated balance from ".concat(B," to ").concat(te.totalCoinsEarned))}catch(t){console.error("[Balance Correction] Error:",t),Z.oR.error("Failed to correct balance")}}else Z.oR.error("Cannot correct balance: User not authenticated")},variant:"outlined",children:"Fix Balance"}),children:(0,E.jsxs)(d.A,{variant:"body2",children:["Balance mismatch detected! You should have ",ze(te.totalCoinsEarned)," SC but have ",ze(B)," SC."]})}),(0,E.jsxs)(h.Ay,{container:!0,spacing:2,children:[(0,E.jsx)(h.Ay,{item:!0,xs:6,children:(0,E.jsxs)(l.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(d.A,{variant:"h4",color:"primary",fontWeight:"bold",children:te.totalGiftsSent}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"Gifts Sent"})]})}),(0,E.jsx)(h.Ay,{item:!0,xs:6,children:(0,E.jsxs)(l.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(d.A,{variant:"h4",color:"secondary",fontWeight:"bold",children:te.totalGiftsReceived}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"Gifts Received"})]})}),(0,E.jsxs)(h.Ay,{item:!0,xs:6,children:[(0,E.jsxs)(l.A,{sx:{textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[(0,E.jsx)(T.A,{size:"small"}),(0,E.jsx)(d.A,{variant:"h4",color:"success.main",fontWeight:"bold",children:ze(te.totalCoinsEarned)})]}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"SC Earned"}),(0,E.jsxs)(d.A,{variant:"caption",color:"success.main",fontWeight:"bold",children:["\xa3",De(te.totalCoinsEarned).toFixed(2)," value"]})]}),(0,E.jsxs)(h.Ay,{item:!0,xs:6,children:[(0,E.jsxs)(l.A,{sx:{textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[(0,E.jsx)(T.A,{size:"small"}),(0,E.jsx)(d.A,{variant:"h4",color:"error",fontWeight:"bold",children:ze(te.totalCoinsSpent)})]}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"SC Spent"}),(0,E.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:["(",Ne(te.totalCoinsSpent)," LC)"]})]})]})]})})}),(0,E.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,E.jsxs)(b.A,{sx:{p:3,height:"100%"},children:[(0,E.jsx)(d.A,{variant:"h6",gutterBottom:!0,color:"primary",children:"\ud83d\udcb0 Withdrawal Information"}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Convert your SideCoins to real money with monthly withdrawals."}),(0,E.jsxs)(g.A,{dense:!0,children:[(0,E.jsxs)(f.Ay,{sx:{px:0},children:[(0,E.jsx)(y.A,{sx:{minWidth:40},children:(0,E.jsx)(U.A,{color:"success"})}),(0,E.jsx)(v.A,{primary:"Conversion Rate",secondary:"1 SC = \xa30.005 (0.5p) \u2022 1000 SC = \xa35"})]}),(0,E.jsxs)(f.Ay,{sx:{px:0},children:[(0,E.jsx)(y.A,{sx:{minWidth:40},children:(0,E.jsx)(q,{color:"info"})}),(0,E.jsx)(v.A,{primary:"Monthly Withdrawals",secondary:"Withdraw once per month, processed within 5-7 business days"})]}),(0,E.jsxs)(f.Ay,{sx:{px:0},children:[(0,E.jsx)(y.A,{sx:{minWidth:40},children:(0,E.jsx)(J.A,{color:"warning"})}),(0,E.jsx)(v.A,{primary:"Platform Fee",secondary:"10% fee applies to all withdrawals (you keep 90%)"})]})]}),(0,E.jsx)(p.A,{severity:"info",sx:{mt:2},children:(0,E.jsxs)(d.A,{variant:"body2",children:[(0,E.jsx)("strong",{children:"Next withdrawal available:"})," ",ge?"Now":"Next month"]})})]})}),(0,E.jsx)(h.Ay,{item:!0,xs:12,md:6,children:(0,E.jsxs)(b.A,{sx:{p:3,height:"100%"},children:[(0,E.jsx)(d.A,{variant:"h6",gutterBottom:!0,color:"primary",children:"\ud83d\udcc8 How to Earn More"}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Maximize your earnings by hosting engaging live streams."}),(0,E.jsx)(g.A,{dense:!0,children:Me.map(((e,t)=>(0,E.jsxs)(f.Ay,{sx:{px:0},children:[(0,E.jsx)(y.A,{sx:{minWidth:40},children:e.icon}),(0,E.jsx)(v.A,{primary:e.title,secondary:e.description}),(0,E.jsx)(d.A,{variant:"body2",fontWeight:"bold",color:"primary",children:e.coins})]},t)))})]})}),pe.length>0&&(0,E.jsx)(h.Ay,{item:!0,xs:12,children:(0,E.jsxs)(b.A,{sx:{p:3},children:[(0,E.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:"Withdrawal History"}),(0,E.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:pe.slice(0,5).map((e=>(0,E.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,border:"1px solid",borderColor:"divider",borderRadius:1},children:[(0,E.jsxs)(l.A,{children:[(0,E.jsxs)(d.A,{variant:"body1",fontWeight:"medium",children:[e.amount," SC \u2192 \xa3",e.moneyAmount.toFixed(2)]}),(0,E.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:[e.requestDate.toDate().toLocaleDateString()," \u2022 Fee: \xa3",e.platformFee.toFixed(2)]})]}),(0,E.jsx)(j.A,{label:e.status.toUpperCase(),color:"completed"===e.status?"success":"approved"===e.status?"info":"rejected"===e.status?"error":"default",size:"small"})]},e.id)))})]})}),(0,E.jsx)(h.Ay,{item:!0,xs:12,children:(0,E.jsxs)(b.A,{sx:{p:4,textAlign:"center",background:"linear-gradient(135deg, ".concat((0,m.X4)(t.palette.primary.main,.1),", ").concat((0,m.X4)(t.palette.secondary.main,.1),")")},children:[(0,E.jsx)(d.A,{variant:"h5",gutterBottom:!0,children:"Ready to Start Earning Real Money?"}),(0,E.jsx)(d.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Host live streams and receive gifts that convert to withdrawable cash!"}),(0,E.jsx)(A.A,{variant:"contained",size:"large",onClick:()=>s("/discover"),sx:{mr:2},children:"Discover Live Rooms"}),(0,E.jsx)(A.A,{variant:"outlined",size:"large",onClick:()=>s("/profile"),children:"View My Profile"})]})})]}),(0,E.jsxs)(C.A,{open:ae,onClose:()=>ne(!1),maxWidth:"sm",fullWidth:!0,children:[(0,E.jsx)(w.A,{children:(0,E.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,E.jsx)(V.A,{}),(0,E.jsx)(d.A,{variant:"h6",children:"Withdraw Money"})]})}),(0,E.jsxs)(S.A,{children:[(0,E.jsx)(p.A,{severity:"info",sx:{mb:3},children:(0,E.jsxs)(d.A,{variant:"body2",children:[(0,E.jsx)("strong",{children:"Available:"})," ",ze(B)," SC (\xa3",De(B).toFixed(2),")",(0,E.jsx)("br",{}),(0,E.jsx)("strong",{children:"Platform Fee:"})," 10% \u2022 ",(0,E.jsx)("strong",{children:"Minimum:"})," ",We," SC",!ge&&ye&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("br",{}),(0,E.jsx)("strong",{children:"Next Withdrawal:"})," ",ye.toLocaleDateString()]})]})}),(0,E.jsx)(k.A,{fullWidth:!0,label:"Amount to Withdraw (SC)",type:"number",value:oe,onChange:e=>le(e.target.value),sx:{mb:2},inputProps:{min:We,max:B},disabled:!ge}),oe&&parseFloat(oe)>=We&&(0,E.jsxs)(l.A,{sx:{mb:3,p:2,bgcolor:(0,m.X4)(t.palette.success.main,.1),borderRadius:1},children:[(0,E.jsx)(d.A,{variant:"body2",gutterBottom:!0,children:(0,E.jsx)("strong",{children:"Withdrawal Breakdown:"})}),(0,E.jsxs)(d.A,{variant:"body2",children:["Gross Amount: \xa3",Fe(parseFloat(oe)).grossAmount.toFixed(2)]}),(0,E.jsxs)(d.A,{variant:"body2",children:["Platform Fee (10%): -\xa3",Fe(parseFloat(oe)).platformFee.toFixed(2)]}),(0,E.jsxs)(d.A,{variant:"body1",fontWeight:"bold",color:"success.main",children:["You'll Receive: \xa3",Fe(parseFloat(oe)).netAmount.toFixed(2)]})]}),(0,E.jsx)(W.A,{sx:{my:2}}),(0,E.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,E.jsx)(d.A,{variant:"h6",children:"Bank Details"}),(0,E.jsx)(A.A,{variant:"outlined",size:"small",onClick:()=>re(!0),startIcon:(0,E.jsx)(V.A,{}),children:"Add New"})]}),Ce?(0,E.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",py:2},children:(0,E.jsx)(c.A,{size:24})}):0===he.length?(0,E.jsx)(p.A,{severity:"warning",sx:{mb:2},children:(0,E.jsx)(d.A,{variant:"body2",children:"No saved bank details found. Please add your bank details to proceed with withdrawal."})}):(0,E.jsxs)(z.A,{fullWidth:!0,sx:{mb:2},children:[(0,E.jsx)(N.A,{children:"Select Bank Account"}),(0,E.jsx)(D.A,{value:ue,onChange:e=>me(e.target.value),label:"Select Bank Account",children:he.map((e=>(0,E.jsx)(F.A,{value:e.id,children:(0,E.jsx)(l.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:(0,E.jsxs)(l.A,{children:[(0,E.jsx)(d.A,{variant:"body2",fontWeight:"bold",children:e.accountName}),(0,E.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:[e.bankName," \u2022 ****",e.accountNumber.slice(-4),e.isDefault&&" (Default)"]})]})})},e.id)))})]}),(0,E.jsx)(p.A,{severity:"warning",sx:{mt:2},children:(0,E.jsx)(d.A,{variant:"body2",children:"Withdrawals are processed once per month. Please ensure your bank details are correct as changes cannot be made after submission."})})]}),(0,E.jsxs)(M.A,{children:[(0,E.jsx)(A.A,{onClick:()=>ne(!1),children:"Cancel"}),(0,E.jsx)(A.A,{variant:"contained",onClick:async()=>{console.log("\ud83d\ude80 Withdrawal feature coming soon!"),Z.oR.success("Withdrawal feature coming soon! \ud83d\ude80",{duration:3e3,position:"top-center"}),ne(!1)},disabled:!oe||parseFloat(oe)<We||parseFloat(oe)>B||!ue||!ge||Ae,startIcon:Ae?(0,E.jsx)(c.A,{size:20}):(0,E.jsx)(V.A,{}),children:Ae?"Processing...":"Submit Withdrawal Request"})]})]}),(0,E.jsxs)(C.A,{open:ie,onClose:()=>re(!1),maxWidth:"sm",fullWidth:!0,children:[(0,E.jsx)(w.A,{children:(0,E.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,E.jsx)(V.A,{}),(0,E.jsx)(d.A,{variant:"h6",children:"Bank Details"})]})}),(0,E.jsxs)(S.A,{children:[(0,E.jsx)(p.A,{severity:"info",sx:{mb:3},children:(0,E.jsx)(d.A,{variant:"body2",children:"Your bank details are encrypted and stored securely. We only use this information for processing withdrawals."})}),(0,E.jsxs)(l.A,{sx:{mb:3},children:[(0,E.jsx)(d.A,{variant:"subtitle1",gutterBottom:!0,children:"Add New Bank Account"}),(0,E.jsx)(k.A,{fullWidth:!0,label:"Account Holder Name",value:ce.accountName,onChange:e=>de((t=>(0,a.A)((0,a.A)({},t),{},{accountName:e.target.value}))),sx:{mb:2},placeholder:"John Smith"}),(0,E.jsx)(k.A,{fullWidth:!0,label:"Account Number",value:ce.accountNumber,onChange:e=>de((t=>(0,a.A)((0,a.A)({},t),{},{accountNumber:e.target.value.replace(/\D/g,"")}))),sx:{mb:2},placeholder:"12345678",inputProps:{maxLength:8}}),(0,E.jsx)(k.A,{fullWidth:!0,label:"Sort Code",value:ce.sortCode,onChange:e=>{let t=e.target.value.replace(/\D/g,"");t.length>2&&t.length<=4?t=t.slice(0,2)+"-"+t.slice(2):t.length>4&&(t=t.slice(0,2)+"-"+t.slice(2,4)+"-"+t.slice(4,6)),de((e=>(0,a.A)((0,a.A)({},e),{},{sortCode:t})))},sx:{mb:2},placeholder:"12-34-56",inputProps:{maxLength:8}}),(0,E.jsx)(k.A,{fullWidth:!0,label:"Bank Name",value:ce.bankName,onChange:e=>de((t=>(0,a.A)((0,a.A)({},t),{},{bankName:e.target.value}))),sx:{mb:2},placeholder:"Barclays Bank"}),(0,E.jsx)(A.A,{variant:"contained",onClick:async()=>{if(null!==e&&void 0!==e&&e.uid&&ce.accountName&&ce.accountNumber&&ce.sortCode&&ce.bankName){ke(!0);try{if(!/^\d{6}$/.test(ce.sortCode.replace(/[-\s]/g,"")))return void Z.oR.error("Sort code must be 6 digits (e.g., 123456 or 12-34-56)");if(!/^\d{8}$/.test(ce.accountNumber))return void Z.oR.error("Account number must be 8 digits");const t=0===he.length,s=(0,Q.rJ)(_.db,"users",e.uid,"bankDetails"),a=await(0,Q.gS)(s,{accountName:ce.accountName,accountNumber:ce.accountNumber,sortCode:ce.sortCode.replace(/[-\s]/g,""),bankName:ce.bankName,isDefault:t,createdAt:(0,Q.O5)(),encryptionVersion:1});de({accountName:"",accountNumber:"",sortCode:"",bankName:""}),me(a.id),re(!1),Z.oR.success("Bank details saved securely")}catch(t){console.error("Error saving bank details:",t),Z.oR.error("Failed to save bank details")}finally{ke(!1)}}else Z.oR.error("Please fill in all bank details")},disabled:Se||!ce.accountName||!ce.accountNumber||!ce.sortCode||!ce.bankName,startIcon:Se?(0,E.jsx)(c.A,{size:20}):(0,E.jsx)(V.A,{}),fullWidth:!0,children:Se?"Saving...":"Save Bank Details"})]}),he.length>0&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(W.A,{sx:{my:2}}),(0,E.jsx)(d.A,{variant:"subtitle1",gutterBottom:!0,children:"Saved Bank Accounts"}),he.map((t=>(0,E.jsx)(b.A,{elevation:1,sx:{p:2,mb:2},children:(0,E.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,E.jsxs)(l.A,{sx:{flex:1},children:[(0,E.jsxs)(d.A,{variant:"body1",fontWeight:"bold",children:[t.accountName,t.isDefault&&(0,E.jsx)(j.A,{label:"Default",size:"small",color:"primary",sx:{ml:1}})]}),(0,E.jsx)(d.A,{variant:"body2",color:"text.secondary",children:t.bankName}),(0,E.jsxs)(d.A,{variant:"body2",color:"text.secondary",children:["Account: ****",t.accountNumber.slice(-4)," \u2022 Sort: ",t.sortCode]}),t.lastUsed&&(0,E.jsxs)(d.A,{variant:"caption",color:"text.secondary",children:["Last used: ",t.lastUsed.toDate().toLocaleDateString()]})]}),(0,E.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[!t.isDefault&&(0,E.jsx)(A.A,{size:"small",variant:"outlined",onClick:()=>(async t=>{if(null!==e&&void 0!==e&&e.uid)try{const s=(0,Q.wP)(_.db);he.forEach((a=>{if(a.id!==t){const t=(0,Q.H9)(_.db,"users",e.uid,"bankDetails",a.id);s.update(t,{isDefault:!1})}}));const a=(0,Q.H9)(_.db,"users",e.uid,"bankDetails",t);s.update(a,{isDefault:!0}),await s.commit(),Z.oR.success("Default bank details updated")}catch(s){console.error("Error setting default bank details:",s),Z.oR.error("Failed to update default bank details")}})(t.id),children:"Set Default"}),(0,E.jsx)(A.A,{size:"small",variant:"outlined",color:"error",onClick:()=>(async t=>{if(null!==e&&void 0!==e&&e.uid&&window.confirm("Are you sure you want to delete these bank details?"))try{await(0,Q.kd)((0,Q.H9)(_.db,"users",e.uid,"bankDetails",t)),Z.oR.success("Bank details deleted"),ue===t&&me("")}catch(s){console.error("Error deleting bank details:",s),Z.oR.error("Failed to delete bank details")}})(t.id),children:"Delete"})]})]})},t.id)))]})]}),(0,E.jsx)(M.A,{children:(0,E.jsx)(A.A,{onClick:()=>re(!1),children:"Close"})})]})]})]})}},2289:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M9.68 13.69 12 11.93l2.31 1.76-.88-2.85L15.75 9h-2.84L12 6.19 11.09 9H8.25l2.31 1.84zM20 10c0-4.42-3.58-8-8-8s-8 3.58-8 8c0 2.03.76 3.87 2 5.28V23l6-2 6 2v-7.72c1.24-1.41 2-3.25 2-5.28m-8-6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6 2.69-6 6-6"}),"WorkspacePremium")},3182:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"}),"AccountBalance")},3380:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(9379),n=(s(9950),s(6491)),i=s(2053),r=s(7497),o=s(4414);const l=e=>{let{size:t="medium",color:s="#FFD700",value:l,showValue:c=!0,sx:d={}}=e;const{width:h,height:x,fontSize:u,valueSize:m}=(()=>{switch(t){case"small":return{width:20,height:20,fontSize:"0.6rem",valueSize:"0.75rem"};case"large":return{width:32,height:32,fontSize:"0.8rem",valueSize:"1rem"};default:return{width:24,height:24,fontSize:"0.7rem",valueSize:"0.875rem"}}})(),A=(0,o.jsx)(n.A,{sx:{width:h,height:x,borderRadius:"50%",background:"linear-gradient(145deg, ".concat(s,", ").concat((0,r.X4)(s,.7),")"),border:"2px solid ".concat((0,r.X4)(s,.8)),display:"flex",alignItems:"center",justifyContent:"center",position:"relative",boxShadow:"\n                    inset 0 2px 4px ".concat((0,r.X4)("#fff",.3),",\n                    inset 0 -2px 4px ").concat((0,r.X4)("#000",.2),",\n                    0 2px 8px ").concat((0,r.X4)(s,.3),"\n                "),"&::before":{content:'""',position:"absolute",top:"15%",left:"15%",right:"15%",bottom:"15%",borderRadius:"50%",border:"1px solid ".concat((0,r.X4)(s,.6)),background:"linear-gradient(145deg, ".concat((0,r.X4)("#fff",.1),", transparent)")}},children:(0,o.jsx)(i.A,{variant:"caption",sx:{fontSize:u,fontWeight:"bold",color:"#000",textShadow:"0 1px 2px ".concat((0,r.X4)("#fff",.8)),zIndex:1,lineHeight:1},children:"SC"})});return void 0!==l&&c?(0,o.jsxs)(n.A,{sx:(0,a.A)({display:"flex",alignItems:"center",gap:.5},d),children:[A,(0,o.jsx)(i.A,{variant:"caption",sx:{fontSize:m,fontWeight:"medium",color:"text.primary"},children:l})]}):(0,o.jsx)(n.A,{sx:d,children:A})}},3531:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M12.16 3h-.32L9.21 8.25h5.58zm4.3 5.25h5.16L19 3h-5.16zm4.92 1.5h-8.63V20.1zM11.25 20.1V9.75H2.62zM7.54 8.25 10.16 3H5L2.38 8.25z"}),"Diamond")},5699:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning")},6117:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1M9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m11 15H4v-2h16zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20z"}),"CardGiftcard")},7443:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(3235),n=s(4414);const i=(0,a.A)((0,n.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"}),"Favorite")}}]);