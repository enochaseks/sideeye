"use strict";(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[355],{227:(e,i,t)=>{t.d(i,{A:()=>s});var a=t(3235),r=t(4414);const s=(0,a.A)((0,r.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},3355:(e,i,t)=>{t.r(i),t.d(i,{default:()=>ie});var a=t(9379),r=t(9950),s=t(4857),o=t(6589),n=t(6491),l=t(6639),d=t(9808),c=t(2053),u=t(8145),m=t(2046),h=t(2235),x=t(249),p=t(6050),v=t(8614),A=t(1413),f=t(3563),b=t(5333),g=t(4745),y=t(2236),j=t(4142),w=t(1378),P=t(899),C=t(470),S=t(3569),k=t(5277),M=t(704),D=t(226),U=t(6583),z=t(33),I=t(8170),E=t(9739),L=t(9715),R=t(6164),G=t(7092),W=t(227),B=t(4066),H=t(3235),V=t(4414);const O=(0,H.A)((0,V.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People"),N=(0,H.A)((0,V.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents"),F=(0,H.A)((0,V.jsx)("path",{d:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67M11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8"}),"Whatshot"),_=(0,H.A)((0,V.jsx)("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined");var J=t(8429),T=t(6220),X=t(330),q=t(1367),Y=t(5887),K=t(7081);const Q=e=>{try{return(0,K.A)(e)}catch(i){return e instanceof Date?e.toLocaleString():new Date(e).toLocaleString()}},Z=e=>{if(!e)return"";try{return e.toDate?Q(e.toDate()):e instanceof Date?Q(e):Q(new Date(e))}catch(i){return console.error("Error formatting timestamp:",i),""}};var $=t(9325),ee=t(1849);const ie=()=>{var e;const[i,t]=(0,r.useState)(0),[H,K]=(0,r.useState)(""),[Q,ie]=(0,r.useState)([]),[te,ae]=(0,r.useState)([]),[re,se]=(0,r.useState)(!0),[oe,ne]=(0,r.useState)(new Set),[le,de]=(0,r.useState)(new Set),ce=(0,J.Zp)(),{currentUser:ue}=(0,q.As)(),[me,he]=(0,r.useState)(null),xe=(0,s.A)(),pe=(0,o.A)(xe.breakpoints.down("sm")),[ve,Ae]=(0,r.useState)(!1),[fe,be]=(0,r.useState)([]),[ge,ye]=(0,r.useState)(!1),je=r.useRef(null),[we,Pe]=(0,r.useState)("All"),[Ce,Se]=(0,r.useState)(!1),[ke,Me]=(0,r.useState)(!1),[De,Ue]=(0,r.useState)(null),[ze,Ie]=(0,r.useState)(null),[Ee,Le]=(0,r.useState)([]),[Re,Ge]=(0,r.useState)([]),[We,Be]=(0,r.useState)(""),[He,Ve]=(0,r.useState)("All"),[Oe,Ne]=(0,r.useState)(!1),[Fe,_e]=(0,r.useState)([]),[Je,Te]=(0,r.useState)([]),[Xe,qe]=(0,r.useState)(""),[Ye,Ke]=(0,r.useState)("All"),[Qe,Ze]=(0,r.useState)(!1),$e=["ASMR","Just Chatting","Music","Gossip","Podcasts","Shows","Social","Other"],ei=async()=>{try{const e=(0,T.rJ)(X.db,"users"),i=(0,T.P)(e,(0,T.My)("createdAt","desc"),(0,T.AB)(20)),t=(await(0,T.GG)(i)).docs.filter((e=>"sideeye"!==e.id&&"contact-team"!==e.id)).map((e=>({id:e.id,username:e.data().username||"",name:e.data().name||"",profilePic:e.data().profilePic,bio:e.data().bio,coverPhoto:e.data().coverPhoto,isPublic:e.data().isPublic,isAuthenticated:e.data().isAuthenticated,createdAt:e.data().createdAt,isActive:e.data().isActive,isVerified:!0,email:e.data().email})));ae(t)}catch(me){console.error("Error fetching users:",me)}finally{se(!1)}},ii=async()=>{try{if(se(!0),!X.db)return;const e=await(async()=>{if(!ue||!X.db)return[];try{const e=(0,T.rJ)(X.db,"users"),i=await(0,T.GG)(e),t=[];return i.forEach((e=>{const i=e.data();i.blockedUsers&&Array.isArray(i.blockedUsers)&&i.blockedUsers.includes(ue.uid)&&t.push(e.id)})),[...ue.blockedUsers||[],...t]}catch(me){return console.error("Error fetching blocked users:",me),[]}})(),i=(0,T.rJ)(X.db,"sideRooms"),t=(0,T.P)(i,(0,T._M)("deleted","!=",!0)),r=await(0,T.GG)(t),s=r.docs.map((e=>{const i=e.data();return(0,a.A)({id:e.id},i)})).filter((i=>!e.includes(i.ownerId))),o=await Promise.all(s.map((async e=>{try{var i,t;const a=await(0,T.x7)((0,T.H9)(X.db,"users",e.ownerId)),r=a.exists()?a.data():null;return{id:e.id,name:e.name||"",description:e.description||"",memberCount:e.memberCount||0,shareCount:0,isPrivate:e.isPrivate||!1,createdAt:(null===(i=e.createdAt)||void 0===i?void 0:i.toDate())||new Date,creatorName:(null===r||void 0===r?void 0:r.username)||"Unknown",creatorId:e.ownerId,creatorAvatar:(null===r||void 0===r?void 0:r.profilePic)||"",tags:e.tags||[],lastActive:(null===(t=e.lastActive)||void 0===t?void 0:t.toDate())||new Date,maxMembers:e.maxMembers||100,activeUsers:e.activeUsers||0,isLive:e.isLive||!1,thumbnailUrl:e.thumbnailUrl||"",isPopular:(e.activeUsers||0)>=200}}catch(me){return console.error("Error fetching owner data for room ".concat(e.id,":"),me),null}}))),n=o.filter((e=>null!==e)).sort(((e,i)=>e.isPopular&&!i.isPopular?-1:!e.isPopular&&i.isPopular?1:(i.activeUsers||0)-(e.activeUsers||0)));ie(n)}catch(me){console.error("Error fetching rooms:",me)}finally{se(!1)}};(0,r.useEffect)((()=>{ei(),ii(),(async()=>{try{const e=(0,T.rJ)(X.db,"sideRooms"),i=await(0,T.GG)(e),t=new Map;i.docs.forEach((e=>{const i=e.data(),a=i.ownerId,r=i.activeUsers||0;if(t.has(a)){const e=t.get(a);e.totalViews+=r,e.activeRooms+=1}else t.set(a,{totalViews:r,activeRooms:1})}));const a=Array.from(t.entries()).filter((e=>{let[i,t]=e;return t.totalViews>=200})).map((e=>{let[i]=e;return i})),r=await Promise.all(a.map((async e=>{const i=(0,T.H9)(X.db,"users",e),a=await(0,T.x7)(i);if(a.exists()){var r;const i=a.data(),s=t.get(e);return{id:e,username:i.username||"",name:i.name||"",profilePic:i.profilePic,bio:i.bio,isPublic:null===(r=i.isPublic)||void 0===r||r,isAuthenticated:i.isAuthenticated,createdAt:i.createdAt,isActive:i.isActive,isVerified:!0,isTopHost:!0,totalViews:s.totalViews,activeRooms:s.activeRooms}}return null})));Le(r.filter(Boolean))}catch(me){console.error("Error fetching top hosts:",me)}})(),(async()=>{try{const e=(0,T.rJ)(X.db,"sideRooms"),i=(0,T.P)(e,(0,T._M)("deleted","!=",!0)),t=(await(0,T.GG)(i)).docs.map((e=>{const i=e.data();return(0,a.A)({id:e.id},i)})).filter((e=>(e.activeUsers||0)>=200)),r=await Promise.all(t.map((async e=>{try{var i,t;const a=await(0,T.x7)((0,T.H9)(X.db,"users",e.ownerId)),r=a.exists()?a.data():null;return{id:e.id,name:e.name||"",description:e.description||"",memberCount:e.memberCount||0,shareCount:0,isPrivate:e.isPrivate||!1,createdAt:(null===(i=e.createdAt)||void 0===i?void 0:i.toDate())||new Date,creatorName:(null===r||void 0===r?void 0:r.username)||"Unknown",creatorId:e.ownerId,creatorAvatar:(null===r||void 0===r?void 0:r.profilePic)||"",tags:e.tags||[],lastActive:(null===(t=e.lastActive)||void 0===t?void 0:t.toDate())||new Date,maxMembers:e.maxMembers||100,activeUsers:e.activeUsers||0,isLive:e.isLive||!1,thumbnailUrl:e.thumbnailUrl||"",isPopular:!0}}catch(me){return console.error("Error fetching owner data for room ".concat(e.id,":"),me),null}}))),s=r.filter((e=>null!==e));_e(s),Te(s)}catch(me){console.error("Error fetching popular rooms:",me)}})();const e=async()=>{ue&&(await ti(),await ai())};e();const i=()=>{e()};return window.addEventListener("focus",i),()=>{window.removeEventListener("focus",i)}}),[ue]),(0,r.useEffect)((()=>{ue&&oe.size>0&&ai()}),[oe]);const ti=async()=>{if(ue&&X.db)try{const e=(0,T.P)((0,T.rJ)(X.db,"users/".concat(ue.uid,"/following"))),i=await(0,T.GG)(e),t=new Set(i.docs.map((e=>e.id))),a=(0,T.P)((0,T.rJ)(X.db,"users")),r=await(0,T.GG)(a);await Promise.all(r.docs.map((async e=>{if(t.has(e.id))return;const i=(0,T.H9)(X.db,"users/".concat(e.id,"/followers/").concat(ue.uid));if((await(0,T.x7)(i)).exists()){t.add(e.id);const i=(0,T.H9)(X.db,"users/".concat(ue.uid,"/following/").concat(e.id));(await(0,T.x7)(i)).exists()||(await(0,T.BN)(i,{timestamp:(0,T.O5)()}),console.log("Fixed inconsistent follow status for user ".concat(e.id)))}}))),ne(t)}catch(me){console.error("Error fetching following:",me)}},ai=async()=>{if(ue&&X.db)try{const e=new Set,i=(0,T.P)((0,T.rJ)(X.db,"users"),(0,T._M)("isPrivate","==",!0)),t=await(0,T.GG)(i);await Promise.all(t.docs.map((async i=>{if(oe.has(i.id))return;const t=(0,T.H9)(X.db,"users/".concat(i.id,"/followRequests/").concat(ue.uid));(await(0,T.x7)(t)).exists()&&e.add(i.id)})));const a=(0,T.P)((0,T.rJ)(X.db,"users"),(0,T._M)("isPublic","==",!1)),r=await(0,T.GG)(a);await Promise.all(r.docs.map((async i=>{if(oe.has(i.id)||e.has(i.id))return;const t=(0,T.H9)(X.db,"users/".concat(i.id,"/followRequests/").concat(ue.uid));(await(0,T.x7)(t)).exists()&&e.add(i.id)}))),de(e)}catch(me){console.error("Error fetching pending requests:",me)}},ri=async e=>{if(!X.db||!e)return null;try{const i=(0,T.rJ)(X.db,"rooms"),t=(0,T.P)(i,(0,T._M)("createdBy","==",e),(0,T._M)("type","==","public")),a=await(0,T.GG)(t);if(!a.empty){const i=a.docs[0],t=(0,T.H9)(X.db,"users",e),r=await(0,T.x7)(t);return r.exists()&&Ie({username:r.data().username||r.data().name}),{id:i.id,name:i.data().name||"Chat Room"}}return null}catch(me){return console.error("[Discover] Error checking for server chat room:",me),null}},si=()=>{Me(!1)},oi=async e=>{if(ue&&e!==ue.uid)try{const r=(0,T.H9)(X.db,"users/".concat(ue.uid,"/following"),e),s=(0,T.H9)(X.db,"users/".concat(e,"/followers"),ue.uid);if(oe.has(e))await(0,T.kd)(r),await(0,T.kd)(s),ne((i=>{const t=new Set(i);return t.delete(e),t})),Y.oR.success("Unfollowed user");else{const o=await(async e=>{if(!X.db)return!1;try{const i=(0,T.H9)(X.db,"users",e),t=await(0,T.x7)(i);if(t.exists()){const e=t.data();return!0===e.isPrivate||!1===e.isPublic}return!1}catch(me){return console.error("Error checking if account is private:",me),!1}})(e);if(o){var i;const t=(0,T.H9)(X.db,"users",e,"followRequests",ue.uid);await(0,T.BN)(t,{userId:ue.uid,username:ue.displayName||(null===(i=ue.email)||void 0===i?void 0:i.split("@")[0])||"User_".concat(ue.uid.substring(0,5)),timestamp:(0,T.O5)()}),de((i=>new Set(i).add(e))),Y.oR.success("Follow request sent")}else{var t,a;await(0,T.BN)(r,{timestamp:(0,T.O5)()}),await(0,T.BN)(s,{timestamp:(0,T.O5)()}),ne((i=>new Set(i).add(e)));const i={type:"follow",senderId:ue.uid,senderName:ue.displayName||(null===(t=ue.email)||void 0===t?void 0:t.split("@")[0])||"Someone",senderAvatar:ue.photoURL||"",recipientId:e,content:"".concat(ue.displayName||(null===(a=ue.email)||void 0===a?void 0:a.split("@")[0])||"Someone"," started following you"),createdAt:(0,T.O5)(),isRead:!1};await(0,T.gS)((0,T.rJ)(X.db,"notifications"),i);const o=await ri(e);o&&(Ue(o),Me(!0)),Y.oR.success("Followed user")}}}catch(me){console.error("Error toggling follow:",me),Y.oR.error("Failed to update follow status")}},ni=e=>{ce("/side-room/".concat(e))},li=async function(e){if(K(e),""===e.trim())return ae([]),ie([]),void Ae(!1);try{se(!0),Ae(!0);const i=(null===ue||void 0===ue?void 0:ue.blockedUsers)||[],t=[];if(ue&&X.db){(await(0,T.GG)((0,T.rJ)(X.db,"users"))).forEach((e=>{const i=e.data();i.blockedUsers&&Array.isArray(i.blockedUsers)&&i.blockedUsers.includes(ue.uid)&&t.push(e.id)}))}const r=[...i,...t];let s=[];const o=(0,T.rJ)(X.db,"users"),n=e.toLowerCase();try{const e=(0,T.P)(o,(0,T.My)("username_lower"),(0,T.EO)(n),(0,T.FD)(n+"\uf8ff"),(0,T.AB)(20)),i=await(0,T.GG)(e);s=i.docs.map((e=>{var i;return{id:e.id,username:e.data().username||"",name:e.data().name||"",bio:e.data().bio||"",profilePic:e.data().profilePic||"",isPublic:null===(i=e.data().isPublic)||void 0===i||i,isAuthenticated:e.data().isAuthenticated,createdAt:e.data().createdAt,isActive:e.data().isActive,isVerified:!0,email:e.data().email}})).filter((e=>!r.includes(e.id)&&"sideeye"!==e.id&&"contact-team"!==e.id))}catch(me){console.error("Error searching by username_lower:",me)}if(s.length<10)try{const e=(0,T.P)(o,(0,T.My)("name_lower"),(0,T.EO)(n),(0,T.FD)(n+"\uf8ff"),(0,T.AB)(20)),i=(await(0,T.GG)(e)).docs.map((e=>{var i;return{id:e.id,username:e.data().username||"",name:e.data().name||"",bio:e.data().bio||"",profilePic:e.data().profilePic||"",isPublic:null===(i=e.data().isPublic)||void 0===i||i,isAuthenticated:e.data().isAuthenticated,createdAt:e.data().createdAt,isActive:e.data().isActive,isVerified:!0,email:e.data().email}})).filter((e=>!r.includes(e.id)&&"sideeye"!==e.id&&"contact-team"!==e.id&&!s.some((i=>i.id===e.id))));s=[...s,...i]}catch(me){console.error("Error searching by name_lower:",me)}if(0===s.length){console.log("Falling back to simple search approach");const e=(0,T.P)(o,(0,T.AB)(50)),i=await(0,T.GG)(e);s=i.docs.map((e=>{var i;return{id:e.id,username:e.data().username||"",name:e.data().name||"",bio:e.data().bio||"",profilePic:e.data().profilePic||"",isPublic:null===(i=e.data().isPublic)||void 0===i||i,isAuthenticated:e.data().isAuthenticated,createdAt:e.data().createdAt,isActive:e.data().isActive,isVerified:!0,email:e.data().email}})).filter((e=>!r.includes(e.id)&&"sideeye"!==e.id&&"contact-team"!==e.id&&(e.username.toLowerCase().includes(n)||e.name.toLowerCase().includes(n))))}const l=(0,T.rJ)(X.db,"sideRooms");let d=[];try{const i=(0,T.P)(l,(0,T._M)("name",">=",e),(0,T._M)("name","<=",e+"\uf8ff"),(0,T.AB)(20)),t=await(0,T.GG)(i);if(d=t.docs.map((e=>(0,a.A)({id:e.id},e.data()))),d.length<5){const e=(0,T.P)(l,(0,T._M)("deleted","!=",!0),(0,T.AB)(50)),i=(await(0,T.GG)(e)).docs.map((e=>(0,a.A)({id:e.id},e.data()))).filter((e=>!d.some((i=>i.id===e.id))&&(e.name.toLowerCase().includes(n)||e.description&&e.description.toLowerCase().includes(n)||e.tags&&e.tags.some((e=>e.toLowerCase().includes(n))))));d=[...d,...i]}}catch(me){console.error("Error searching rooms:",me)}d=d.filter((e=>e.ownerId&&!r.includes(e.ownerId)));const c=await Promise.all(d.map((async e=>{try{var i,t;const a=await(0,T.x7)((0,T.H9)(X.db,"users",e.ownerId)),r=a.exists()?a.data():null;return{id:e.id,name:e.name,description:e.description,memberCount:e.memberCount||0,shareCount:0,isPrivate:e.isPrivate||!1,createdAt:(null===(i=e.createdAt)||void 0===i?void 0:i.toDate())||new Date,creatorName:(null===r||void 0===r?void 0:r.username)||"Unknown",creatorId:e.ownerId,creatorAvatar:(null===r||void 0===r?void 0:r.profilePic)||"",tags:e.tags||[],lastActive:(null===(t=e.lastActive)||void 0===t?void 0:t.toDate())||new Date,maxMembers:e.maxMembers||100,activeUsers:e.activeUsers||0,isLive:e.isLive||!1,thumbnailUrl:e.thumbnailUrl||""}}catch(me){var a,r;return console.error("Error fetching owner data for room ".concat(e.id,":"),me),{id:e.id,name:e.name,description:e.description,memberCount:e.memberCount||0,shareCount:0,isPrivate:e.isPrivate||!1,createdAt:(null===(a=e.createdAt)||void 0===a?void 0:a.toDate())||new Date,creatorName:"Unknown",creatorId:e.ownerId,creatorAvatar:"",tags:e.tags||[],lastActive:(null===(r=e.lastActive)||void 0===r?void 0:r.toDate())||new Date,maxMembers:e.maxMembers||100,activeUsers:e.activeUsers||0,isLive:e.isLive||!1,thumbnailUrl:e.thumbnailUrl||""}}})));ae(s),ie(c)}catch(me){console.error("Error searching:",me)}finally{se(!1)}};(0,r.useEffect)((()=>{if(null===ue||void 0===ue||!ue.uid||!X.db)return;const e=(0,T.rJ)(X.db,"users",ue.uid,"following"),i=(0,T.aQ)(e,(async e=>{e.docChanges().forEach((async e=>{if("added"===e.type){const i=e.doc.id;if(le.has(i)){const e=await ri(i);e&&(Ue(e),Me(!0),de((e=>{const t=new Set(e);return t.delete(i),t})))}}}))}));return()=>i()}),[null===ue||void 0===ue?void 0:ue.uid,X.db,le]);(0,r.useEffect)((()=>{Ge(Ee)}),[Ee]);return re&&!ve?(0,V.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh",children:(0,V.jsx)(l.A,{})}):(0,V.jsxs)(n.A,{sx:{position:"relative",backgroundColor:xe.palette.background.default},children:[(0,V.jsx)(n.A,{sx:{position:"sticky",top:0,backgroundColor:xe.palette.background.default,zIndex:1e3,pt:2,pb:2,borderBottom:1,borderColor:"divider"},children:(0,V.jsxs)(d.A,{maxWidth:!1,sx:{maxWidth:"1440px"},children:[(0,V.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,V.jsx)(n.A,{sx:{display:"flex",alignItems:"center",gap:2},children:(0,V.jsx)(c.A,{variant:pe?"h5":"h4",component:"h1",sx:{fontWeight:600},children:ve?"Search Results":"Discover"})}),(0,V.jsx)($.x,{onClickAway:()=>{ye(!1)},children:(0,V.jsx)(n.A,{sx:{display:"flex",alignItems:"center",gap:1,position:"relative"},children:(0,V.jsxs)(n.A,{ref:je,children:[(0,V.jsx)(u.A,{size:"small",placeholder:"Search rooms and users...",value:H,onChange:e=>{(async e=>{if(K(e),e.length<1)return be([]),void ye(!1);try{const i=e.toLowerCase(),t=(0,T.rJ)(X.db,"users"),a=e=>{var i,t,a,r,s,o,n,l,d,c;return{id:e.id,username:(null===(i=e.data())||void 0===i?void 0:i.username)||"",name:(null===(t=e.data())||void 0===t?void 0:t.name)||"",bio:null===(a=e.data())||void 0===a?void 0:a.bio,profilePic:null===(r=e.data())||void 0===r?void 0:r.profilePic,isPublic:null===(s=null===(o=e.data())||void 0===o?void 0:o.isPublic)||void 0===s||s,isAuthenticated:null===(n=e.data())||void 0===n?void 0:n.isAuthenticated,createdAt:null===(l=e.data())||void 0===l?void 0:l.createdAt,isActive:null===(d=e.data())||void 0===d?void 0:d.isActive,isVerified:!0,email:null===(c=e.data())||void 0===c?void 0:c.email}};let r=[];try{const e=(0,T.P)(t,(0,T.My)("username_lower"),(0,T.EO)(i),(0,T.FD)(i+"\uf8ff"),(0,T.AB)(10)),s=await(0,T.GG)(e);r=s.docs.filter((e=>"sideeye"!==e.id&&"contact-team"!==e.id)).map(a)}catch(me){console.log("Error searching by username_lower:",me)}if(r.length<5)try{const e=(0,T.P)(t,(0,T.My)("name_lower"),(0,T.EO)(i),(0,T.FD)(i+"\uf8ff"),(0,T.AB)(10)),s=(await(0,T.GG)(e)).docs.filter((e=>"sideeye"!==e.id&&"contact-team"!==e.id&&!r.some((i=>i.id===e.id)))).map(a);r=[...r,...s]}catch(me){console.log("Error searching by name_lower:",me)}if(r.length<3){const e=(0,T.P)(t,(0,T.AB)(25));try{const t=(await(0,T.GG)(e)).docs.filter((e=>{var t,a;return"sideeye"!==e.id&&"contact-team"!==e.id&&!r.some((i=>i.id===e.id))&&(((null===(t=e.data())||void 0===t?void 0:t.username)||"").toLowerCase().includes(i)||((null===(a=e.data())||void 0===a?void 0:a.name)||"").toLowerCase().includes(i))})).map(a);r=[...r,...t]}catch(me){console.log("Error with fallback search:",me)}}null!==ue&&void 0!==ue&&ue.blockedUsers&&(r=r.filter((e=>{var i;return!(null!==(i=ue.blockedUsers)&&void 0!==i&&i.includes(e.id))}))),be(r.slice(0,5)),ye(r.length>0)}catch(me){console.error("Instant search error:",me)}})(e.target.value),li(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(li(H,!0),ye(!1))},InputProps:{startAdornment:(0,V.jsx)(m.A,{position:"start",children:(0,V.jsx)(L.A,{})})},sx:{backgroundColor:"background.paper",borderRadius:1,width:pe?"230px":"300px","& .MuiOutlinedInput-root":{borderRadius:1}}}),(0,V.jsx)(ee.A,{open:ge&&fe.length>0,anchorEl:je.current,placement:"bottom-start",style:{width:null===(e=je.current)||void 0===e?void 0:e.offsetWidth,zIndex:1400},children:(0,V.jsx)(h.A,{elevation:3,sx:{mt:1,maxHeight:"300px",overflowY:"auto",borderRadius:1},children:(0,V.jsx)(x.A,{sx:{p:0},children:fe.map(((e,i)=>{var t,a;return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsxs)(p.Ay,{button:!0,onClick:()=>{ce("/profile/".concat(e.id)),ye(!1)},sx:{py:1,px:2,"&:hover":{backgroundColor:"action.hover"}},children:[(0,V.jsx)(v.A,{children:(0,V.jsx)(A.A,{src:!1===e.isActive?void 0:e.profilePic,alt:e.name,sx:{width:32,height:32},children:!1===e.isActive||e.profilePic?null:null===(t=e.name)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.toUpperCase()})}),(0,V.jsx)(f.A,{primary:(0,V.jsxs)(c.A,{variant:"body1",component:"div",children:[e.name,e.isVerified&&(0,V.jsx)(R.A,{sx:{ml:.5,color:"primary.main",fontSize:"0.9rem",verticalAlign:"middle"}})]}),secondary:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(c.A,{variant:"body2",component:"span",color:"text.secondary",children:["@",e.username]}),e.bio&&(0,V.jsx)(c.A,{variant:"body2",component:"span",color:"text.secondary",sx:{mt:.5,display:"block",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.bio})]}),sx:{my:0}}),ue&&e.id!==ue.uid&&(0,V.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,V.jsx)(b.A,{size:"small",onClick:i=>{i.stopPropagation(),ce("/messages/".concat(e.id))},children:(0,V.jsx)(G.A,{fontSize:"small"})}),(0,V.jsx)(b.A,{size:"small",onClick:i=>{i.stopPropagation(),le.has(e.id)||oi(e.id)},color:oe.has(e.id)?"primary":le.has(e.id)?"secondary":"default",disabled:le.has(e.id),children:(0,V.jsx)(W.A,{fontSize:"small"})})]})]}),i<fe.length-1&&(0,V.jsx)(g.A,{})]},e.id)}))})})})]})})})]}),!ve&&(0,V.jsxs)(y.A,{value:i,onChange:(e,i)=>{t(i),1===i&&0===te.length&&ei()},variant:pe?"scrollable":"standard",scrollButtons:!!pe&&"auto",sx:{mb:2,"& .MuiTabs-indicator":{height:3}},children:[(0,V.jsx)(j.A,{icon:(0,V.jsx)(B.A,{}),label:"ROOMS",iconPosition:"start"}),(0,V.jsx)(j.A,{icon:(0,V.jsx)(O,{}),label:"PEOPLE",iconPosition:"start"}),(0,V.jsx)(j.A,{icon:(0,V.jsx)(N,{}),label:"TOP HOSTS",iconPosition:"start"}),(0,V.jsx)(j.A,{icon:(0,V.jsx)(F,{}),label:"POPULAR",iconPosition:"start"})]}),!ve&&0===i&&(0,V.jsxs)(y.A,{value:we,onChange:(e,i)=>{Pe(i),ve&&Ae(!1)},variant:"scrollable",scrollButtons:"auto","aria-label":"room categories",sx:{mb:3,borderBottom:1,borderColor:"divider"},children:[(0,V.jsx)(j.A,{label:"All",value:"All"}),$e.map((e=>(0,V.jsx)(j.A,{label:e,value:e},e)))]})]})}),(0,V.jsx)(d.A,{maxWidth:!1,sx:{pt:3,pb:4,px:pe?2:3,maxWidth:"1440px"},children:ve?(0,V.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:4},children:[te.length>0&&(0,V.jsxs)(n.A,{children:[(0,V.jsx)(c.A,{variant:"h6",sx:{mb:2},children:"Users"}),(0,V.jsx)(x.A,{children:te.map(((e,i)=>{var t,a;return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsxs)(p.Ay,{sx:{py:2,cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>ce("/profile/".concat(e.id)),children:[(0,V.jsx)(v.A,{children:(0,V.jsx)(A.A,{src:!1===e.isActive?void 0:e.profilePic,alt:e.name,sx:{width:50,height:50},children:!1===e.isActive||e.profilePic?null:null===(t=e.name)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.toUpperCase()})}),(0,V.jsx)(f.A,{primary:(0,V.jsxs)(c.A,{variant:"subtitle1",component:"div",sx:{fontWeight:600},children:[e.name,e.isVerified&&(0,V.jsx)(R.A,{sx:{ml:.5,color:"primary.main",fontSize:"1rem",verticalAlign:"middle"}})]}),secondary:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(c.A,{variant:"body2",component:"span",color:"text.secondary",children:["@",e.username]}),e.bio&&(0,V.jsx)(c.A,{variant:"body2",component:"span",color:"text.secondary",sx:{mt:.5,display:"block",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.bio})]})}),ue&&e.id!==ue.uid&&(0,V.jsx)(w.A,{children:(0,V.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,V.jsx)(b.A,{onClick:i=>{i.stopPropagation(),ce("/chat/".concat(e.id))},size:"small",children:(0,V.jsx)(G.A,{})}),(0,V.jsx)(b.A,{onClick:i=>{i.stopPropagation(),le.has(e.id)||oi(e.id)},size:"small",color:oe.has(e.id)?"primary":le.has(e.id)?"secondary":"default",disabled:le.has(e.id),children:(0,V.jsx)(W.A,{})})]})})]}),i<te.length-1&&(0,V.jsx)(g.A,{})]},e.id)}))})]}),Q.length>0&&(0,V.jsxs)(n.A,{children:[(0,V.jsx)(c.A,{variant:"h6",sx:{mb:2},children:"Rooms"}),(0,V.jsx)(P.Ay,{container:!0,spacing:3,children:Q.filter((e=>"All"===we||e.tags&&e.tags.includes(we))).map((e=>(0,V.jsx)(P.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,V.jsxs)(C.A,{sx:{display:"flex",flexDirection:"column",cursor:"pointer",borderRadius:2,overflow:"hidden",boxShadow:xe.shadows[3],"&:hover":{transform:"translateY(-4px)",transition:"transform 0.2s ease-in-out",boxShadow:xe.shadows[6]}},onClick:()=>ni(e.id),children:[(0,V.jsxs)(n.A,{sx:{position:"relative"},children:[(0,V.jsx)(S.A,{component:"img",height:pe?"220":"280",image:e.thumbnailUrl||e.creatorAvatar||"https://placehold.co/600x400/333/666?text=Room",alt:e.name,sx:{objectFit:"cover",width:"100%"}}),(0,V.jsxs)(n.A,{sx:{position:"absolute",top:12,right:12,display:"flex",gap:1},children:[e.isPopular&&(0,V.jsx)(k.A,{label:"Popular",color:"warning",size:"small",icon:(0,V.jsx)(F,{}),sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}}),e.isLive&&(0,V.jsx)(k.A,{label:"LIVE",color:"error",size:"small",sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}})]})]}),(0,V.jsxs)(M.A,{sx:{flexGrow:1,p:3,"&:last-child":{pb:3}},children:[(0,V.jsxs)(n.A,{sx:{mb:2},children:[(0,V.jsx)(c.A,{gutterBottom:!0,variant:pe?"h6":"h5",component:"h2",noWrap:!0,sx:{fontWeight:600,mb:1},children:e.name}),(0,V.jsx)(c.A,{variant:"body1",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",mb:2,lineHeight:1.5},children:e.description})]}),(0,V.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2,flexWrap:"wrap"},children:[(0,V.jsx)(k.A,{icon:(0,V.jsx)(_,{sx:{fontSize:pe?"1.1rem":"1.25rem"}}),label:"".concat(e.activeUsers||0," viewing"),color:"primary",variant:"outlined",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"0 4px",fontSize:pe?"0.875rem":"1rem"}}}),e.isPrivate&&(0,V.jsx)(k.A,{label:"Private",color:"secondary",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"0 4px",fontSize:pe?"0.875rem":"1rem"}}})]}),(0,V.jsxs)(c.A,{variant:"body2",color:"text.secondary",sx:{fontSize:pe?"0.75rem":"0.875rem",display:"flex",alignItems:"center",gap:.5},children:["Created by ",e.creatorName||"Anonymous"," \u2022 ",Z(e.lastActive)]})]})]})},e.id)))})]}),0===te.length&&0===Q.length&&!re&&(0,V.jsxs)(n.A,{sx:{textAlign:"center",py:4},children:[(0,V.jsx)(c.A,{variant:"h6",color:"text.secondary",children:"No results found"}),(0,V.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Try different keywords or check your spelling"})]})]}):0===i?(0,V.jsx)(P.Ay,{container:!0,spacing:3,children:Q.filter((e=>"All"===we||e.tags&&e.tags.includes(we))).map((e=>(0,V.jsx)(P.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,V.jsxs)(C.A,{sx:{display:"flex",flexDirection:"column",cursor:"pointer",borderRadius:2,overflow:"hidden",boxShadow:xe.shadows[3],"&:hover":{transform:"translateY(-4px)",transition:"transform 0.2s ease-in-out",boxShadow:xe.shadows[6]}},onClick:()=>ni(e.id),children:[(0,V.jsxs)(n.A,{sx:{position:"relative"},children:[(0,V.jsx)(S.A,{component:"img",height:pe?"220":"280",image:e.thumbnailUrl||e.creatorAvatar||"https://placehold.co/600x400/333/666?text=Room",alt:e.name,sx:{objectFit:"cover",width:"100%"}}),(0,V.jsxs)(n.A,{sx:{position:"absolute",top:12,right:12,display:"flex",gap:1},children:[e.isPopular&&(0,V.jsx)(k.A,{label:"Popular",color:"warning",size:"small",icon:(0,V.jsx)(F,{}),sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}}),e.isLive&&(0,V.jsx)(k.A,{label:"LIVE",color:"error",size:"small",sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}})]})]}),(0,V.jsxs)(M.A,{sx:{flexGrow:1,p:3,"&:last-child":{pb:3}},children:[(0,V.jsxs)(n.A,{sx:{mb:2},children:[(0,V.jsx)(c.A,{gutterBottom:!0,variant:pe?"h6":"h5",component:"h2",noWrap:!0,sx:{fontWeight:600,mb:1},children:e.name}),(0,V.jsx)(c.A,{variant:"body1",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",mb:2,lineHeight:1.5},children:e.description})]}),(0,V.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2,flexWrap:"wrap"},children:[(0,V.jsx)(k.A,{icon:(0,V.jsx)(_,{sx:{fontSize:pe?"1.1rem":"1.25rem"}}),label:"".concat(e.activeUsers||0," viewing"),color:"primary",variant:"outlined",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"1 4px",fontSize:pe?"0.875rem":"1rem"}}}),e.isPrivate&&(0,V.jsx)(k.A,{label:"Private",color:"secondary",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"0 4px",fontSize:pe?"0.875rem":"1rem"}}})]}),(0,V.jsxs)(c.A,{variant:"body2",color:"text.secondary",sx:{fontSize:pe?"0.75rem":"0.875rem",display:"flex",alignItems:"center",gap:.5},children:["Created by ",e.creatorName||"Anonymous"," \u2022 ",Z(e.lastActive)]})]})]})},e.id)))}):1===i?(0,V.jsx)(n.A,{sx:{mt:2},children:re?(0,V.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:(0,V.jsx)(l.A,{})}):te.length>0?(0,V.jsx)(x.A,{children:te.map(((e,i)=>{var t,a;return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsxs)(p.Ay,{sx:{py:3,px:2,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},borderRadius:1,mb:1},onClick:()=>ce("/profile/".concat(e.id)),children:[(0,V.jsx)(v.A,{children:(0,V.jsx)(A.A,{src:!1===e.isActive?void 0:e.profilePic,alt:e.name,sx:{width:60,height:60,mr:2},children:!1===e.isActive||e.profilePic?null:null===(t=e.name)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.toUpperCase()})}),(0,V.jsx)(f.A,{primary:(0,V.jsxs)(c.A,{variant:"subtitle1",component:"div",sx:{fontWeight:600},children:[e.name,e.isVerified&&(0,V.jsx)(R.A,{sx:{ml:.5,color:"primary.main",fontSize:"1rem",verticalAlign:"middle"}})]}),secondary:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(c.A,{variant:"body2",component:"span",color:"text.secondary",children:["@",e.username]}),e.bio&&(0,V.jsx)(c.A,{variant:"body2",component:"span",color:"text.secondary",sx:{mt:.5,display:"block",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.bio})]}),sx:{ml:2}}),ue&&e.id!==ue.uid&&(0,V.jsx)(w.A,{sx:{right:16},children:(0,V.jsxs)(n.A,{sx:{display:"flex",gap:1,flexWrap:{xs:"wrap",sm:"nowrap"}},children:[(0,V.jsx)(b.A,{color:"primary",size:"small",onClick:i=>{i.stopPropagation(),ce("/chat/user/".concat(e.id))},sx:{border:"1px solid",borderColor:"primary.main",p:1},children:(0,V.jsx)(G.A,{fontSize:"small"})}),(0,V.jsx)(D.A,{variant:oe.has(e.id)||le.has(e.id)?"contained":"outlined",size:"small",startIcon:oe.has(e.id)||le.has(e.id)?null:(0,V.jsx)(W.A,{}),onClick:i=>{i.stopPropagation(),le.has(e.id)||oi(e.id)},color:le.has(e.id)?"secondary":"primary",disabled:le.has(e.id),children:oe.has(e.id)?"Following":le.has(e.id)?"Requested":"Follow"})]})})]}),i<te.length-1&&(0,V.jsx)(g.A,{sx:{my:1}})]},e.id)}))}):(0,V.jsx)(n.A,{sx:{textAlign:"center",py:4},children:(0,V.jsx)(c.A,{variant:"h6",color:"text.secondary",children:"No users found"})})}):2===i?(0,V.jsxs)(n.A,{sx:{mt:2},children:[(0,V.jsx)(n.A,{sx:{mb:3},children:(0,V.jsxs)(P.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,V.jsx)(P.Ay,{item:!0,xs:12,md:6,children:(0,V.jsx)(u.A,{fullWidth:!0,size:"small",placeholder:"Search top hosts...",value:We,onChange:e=>{Be(e.target.value),(async e=>{if(e.trim()){Ne(!0);try{const i=e.toLowerCase(),t=(0,T.rJ)(X.db,"users"),r=(0,T.P)(t,(0,T._M)("username_lower",">=",i),(0,T._M)("username_lower","<=",i+"\uf8ff"),(0,T.AB)(20)),s=(await(0,T.GG)(r)).docs.map((e=>(0,a.A)({id:e.id},e.data()))).filter((e=>Ee.some((i=>i.id===e.id))));Ge(s)}catch(me){console.error("Error searching top hosts:",me),Ge([])}finally{Ne(!1)}}else Ge(Ee)})(e.target.value)},InputProps:{startAdornment:(0,V.jsx)(m.A,{position:"start",children:(0,V.jsx)(L.A,{})})},sx:{backgroundColor:"background.paper",borderRadius:1,"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,V.jsx)(P.Ay,{item:!0,xs:12,md:6,children:(0,V.jsxs)(y.A,{value:He,onChange:(e,i)=>(e=>{if(Ve(e),"All"===e)return void Ge(Ee);const i=Ee.filter((i=>Q.filter((e=>e.creatorId===i.id)).some((i=>{var t;return null===(t=i.tags)||void 0===t?void 0:t.includes(e)}))));Ge(i)})(i),variant:"scrollable",scrollButtons:"auto","aria-label":"top host categories",sx:{borderBottom:1,borderColor:"divider"},children:[(0,V.jsx)(j.A,{label:"All",value:"All"}),$e.map((e=>(0,V.jsx)(j.A,{label:e,value:e},e)))]})})]})}),re||Oe?(0,V.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:(0,V.jsx)(l.A,{})}):Re.length>0?(0,V.jsx)(x.A,{children:Re.map(((e,i)=>{var t,a,s;return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsxs)(p.Ay,{sx:{py:3,px:2,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},borderRadius:1,mb:1,position:"relative"},children:[(0,V.jsx)(v.A,{children:(0,V.jsx)(A.A,{src:!1===e.isActive?void 0:e.profilePic,alt:e.name,sx:{width:60,height:60,mr:2,cursor:"pointer","&:hover":{opacity:.8}},onClick:()=>ce("/profile/".concat(e.id)),children:!1===e.isActive||e.profilePic?null:null===(t=e.name)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.toUpperCase()})}),(0,V.jsx)(f.A,{primary:(0,V.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,V.jsxs)(c.A,{variant:"subtitle1",component:"div",sx:{fontWeight:600},children:[e.name,e.isVerified&&(0,V.jsx)(R.A,{sx:{ml:.5,color:"primary.main",fontSize:"1rem",verticalAlign:"middle"}})]}),(0,V.jsx)(k.A,{label:"Top Host",color:"warning",size:"small",icon:(0,V.jsx)(N,{}),sx:{height:"auto","& .MuiChip-label":{px:1}}})]}),secondary:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(c.A,{variant:"body2",component:"span",color:"text.secondary",children:["@",e.username]}),(0,V.jsxs)(n.A,{sx:{mt:1,display:"flex",gap:2},children:[(0,V.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:[null===(s=e.totalViews)||void 0===s?void 0:s.toLocaleString()," total views"]}),(0,V.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:[e.activeRooms," active rooms"]})]}),e.bio&&(0,V.jsx)(c.A,{variant:"body2",component:"span",color:"text.secondary",sx:{mt:.5,display:"block",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.bio})]}),sx:{ml:2}}),ue&&e.id!==ue.uid&&(0,V.jsx)(w.A,{sx:{right:16},children:(0,V.jsx)(D.A,{variant:oe.has(e.id)||le.has(e.id)?"contained":"outlined",size:"small",startIcon:oe.has(e.id)||le.has(e.id)?null:(0,V.jsx)(W.A,{}),onClick:i=>{i.stopPropagation(),le.has(e.id)||oi(e.id)},color:le.has(e.id)?"secondary":"primary",disabled:le.has(e.id),children:oe.has(e.id)?"Following":le.has(e.id)?"Requested":"Follow"})})]}),i<Re.length-1&&(0,V.jsx)(g.A,{sx:{my:1}})]},e.id)}))}):(0,V.jsxs)(n.A,{sx:{textAlign:"center",py:4},children:[(0,V.jsx)(c.A,{variant:"h6",color:"text.secondary",children:We?"No matching top hosts found":"No top hosts found"}),We&&(0,V.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Try different keywords or check your spelling"})]})]}):(0,V.jsxs)(n.A,{sx:{mt:2},children:[(0,V.jsx)(n.A,{sx:{mb:3},children:(0,V.jsxs)(P.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,V.jsx)(P.Ay,{item:!0,xs:12,md:6,children:(0,V.jsx)(u.A,{fullWidth:!0,size:"small",placeholder:"Search popular rooms...",value:Xe,onChange:e=>{qe(e.target.value),(async e=>{if(e.trim()){Ze(!0);try{const i=e.toLowerCase(),t=Fe.filter((e=>e.name.toLowerCase().includes(i)||e.description.toLowerCase().includes(i)||e.creatorName.toLowerCase().includes(i)));Te(t)}catch(me){console.error("Error searching popular rooms:",me),Te([])}finally{Ze(!1)}}else Te(Fe)})(e.target.value)},InputProps:{startAdornment:(0,V.jsx)(m.A,{position:"start",children:(0,V.jsx)(L.A,{})})},sx:{backgroundColor:"background.paper",borderRadius:1,"& .MuiOutlinedInput-root":{borderRadius:1}}})}),(0,V.jsx)(P.Ay,{item:!0,xs:12,md:6,children:(0,V.jsxs)(y.A,{value:Ye,onChange:(e,i)=>(e=>{if(Ke(e),"All"===e)return void Te(Fe);const i=Fe.filter((i=>{var t;return null===(t=i.tags)||void 0===t?void 0:t.includes(e)}));Te(i)})(i),variant:"scrollable",scrollButtons:"auto","aria-label":"popular room categories",sx:{borderBottom:1,borderColor:"divider"},children:[(0,V.jsx)(j.A,{label:"All",value:"All"}),$e.map((e=>(0,V.jsx)(j.A,{label:e,value:e},e)))]})})]})}),re||Qe?(0,V.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:(0,V.jsx)(l.A,{})}):Je.length>0?(0,V.jsx)(P.Ay,{container:!0,spacing:3,children:Je.map((e=>(0,V.jsx)(P.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,V.jsxs)(C.A,{sx:{display:"flex",flexDirection:"column",cursor:"pointer",borderRadius:2,overflow:"hidden",boxShadow:xe.shadows[3],"&:hover":{transform:"translateY(-4px)",transition:"transform 0.2s ease-in-out",boxShadow:xe.shadows[6]}},onClick:()=>ni(e.id),children:[(0,V.jsxs)(n.A,{sx:{position:"relative"},children:[(0,V.jsx)(S.A,{component:"img",height:pe?"220":"280",image:e.thumbnailUrl||e.creatorAvatar||"https://placehold.co/600x400/333/666?text=Room",alt:e.name,sx:{objectFit:"cover",width:"100%"}}),(0,V.jsxs)(n.A,{sx:{position:"absolute",top:12,right:12,display:"flex",gap:1},children:[(0,V.jsx)(k.A,{label:"Popular",color:"warning",size:"small",icon:(0,V.jsx)(F,{}),sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}}),e.isLive&&(0,V.jsx)(k.A,{label:"LIVE",color:"error",size:"small",sx:{fontWeight:"bold",fontSize:pe?"0.75rem":"0.875rem",height:"auto",padding:"6px 12px"}})]})]}),(0,V.jsxs)(M.A,{sx:{flexGrow:1,p:3,"&:last-child":{pb:3}},children:[(0,V.jsxs)(n.A,{sx:{mb:2},children:[(0,V.jsx)(c.A,{gutterBottom:!0,variant:pe?"h6":"h5",component:"h2",noWrap:!0,sx:{fontWeight:600,mb:1},children:e.name}),(0,V.jsx)(c.A,{variant:"body1",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",mb:2,lineHeight:1.5},children:e.description})]}),(0,V.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:2,flexWrap:"wrap"},children:[(0,V.jsx)(k.A,{icon:(0,V.jsx)(O,{sx:{fontSize:pe?"1.1rem":"1.25rem"}}),label:"".concat(e.activeUsers||0," viewing"),color:"primary",variant:"outlined",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"0 4px",fontSize:pe?"0.875rem":"1rem"}}}),e.isPrivate&&(0,V.jsx)(k.A,{label:"Private",color:"secondary",sx:{height:"auto",padding:"8px 12px","& .MuiChip-label":{padding:"0 4px",fontSize:pe?"0.875rem":"1rem"}}})]}),(0,V.jsxs)(c.A,{variant:"body2",color:"text.secondary",sx:{fontSize:pe?"0.75rem":"0.875rem",display:"flex",alignItems:"center",gap:.5},children:["Created by ",e.creatorName||"Anonymous"," \u2022 ",Z(e.lastActive)]})]})]})},e.id)))}):(0,V.jsxs)(n.A,{sx:{textAlign:"center",py:4},children:[(0,V.jsx)(c.A,{variant:"h6",color:"text.secondary",children:Xe?"No matching popular rooms found":"No popular rooms found"}),Xe&&(0,V.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Try different keywords or check your spelling"})]})]})}),(0,V.jsxs)(U.A,{open:ke,onClose:si,"aria-labelledby":"join-room-chat-dialog-title",children:[(0,V.jsx)(z.A,{id:"join-room-chat-dialog-title",children:"Join Room Chat?"}),(0,V.jsx)(I.A,{children:(0,V.jsxs)(c.A,{children:[(null===ze||void 0===ze?void 0:ze.username)||"This creator",' has a server chat room: "',null===De||void 0===De?void 0:De.name,'". Would you like to join it to receive updates and connect with other followers?']})}),(0,V.jsxs)(E.A,{children:[(0,V.jsx)(D.A,{onClick:si,children:"Not Now"}),(0,V.jsx)(D.A,{onClick:()=>{De&&ce("/chat/room/".concat(De.id)),Me(!1)},variant:"contained",color:"primary",children:"Join"})]})]})]})}},4066:(e,i,t)=>{t.d(i,{A:()=>s});var a=t(3235),r=t(4414);const s=(0,a.A)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"}),"Public")},6164:(e,i,t)=>{t.d(i,{A:()=>s});var a=t(3235),r=t(4414);const s=(0,a.A)((0,r.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm-2 16-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"VerifiedUser")},7081:(e,i,t)=>{t.d(i,{A:()=>A});var a=t(3840),r=t(7476),s=t(2588),o=t(4369),n=t(6792),l=t(8889),d=t(4388);var c=t(2434),u=t(8397),m=1440,h=2520,x=43200,p=86400;function v(e,i,t){var v,A;(0,u.A)(2,arguments);var f=(0,a.q)(),b=null!==(v=null!==(A=null===t||void 0===t?void 0:t.locale)&&void 0!==A?A:f.locale)&&void 0!==v?v:n.A;if(!b.formatDistance)throw new RangeError("locale must contain formatDistance property");var g=(0,r.A)(e,i);if(isNaN(g))throw new RangeError("Invalid time value");var y,j,w,P=(0,d.A)((y=t,(0,d.A)({},y)),{addSuffix:Boolean(null===t||void 0===t?void 0:t.addSuffix),comparison:g});g>0?(j=(0,l.A)(i),w=(0,l.A)(e)):(j=(0,l.A)(e),w=(0,l.A)(i));var C,S=(0,o.A)(w,j),k=((0,c.A)(w)-(0,c.A)(j))/1e3,M=Math.round((S-k)/60);if(M<2)return null!==t&&void 0!==t&&t.includeSeconds?S<5?b.formatDistance("lessThanXSeconds",5,P):S<10?b.formatDistance("lessThanXSeconds",10,P):S<20?b.formatDistance("lessThanXSeconds",20,P):S<40?b.formatDistance("halfAMinute",0,P):S<60?b.formatDistance("lessThanXMinutes",1,P):b.formatDistance("xMinutes",1,P):0===M?b.formatDistance("lessThanXMinutes",1,P):b.formatDistance("xMinutes",M,P);if(M<45)return b.formatDistance("xMinutes",M,P);if(M<90)return b.formatDistance("aboutXHours",1,P);if(M<m){var D=Math.round(M/60);return b.formatDistance("aboutXHours",D,P)}if(M<h)return b.formatDistance("xDays",1,P);if(M<x){var U=Math.round(M/m);return b.formatDistance("xDays",U,P)}if(M<p)return C=Math.round(M/x),b.formatDistance("aboutXMonths",C,P);if((C=(0,s.A)(w,j))<12){var z=Math.round(M/x);return b.formatDistance("xMonths",z,P)}var I=C%12,E=Math.floor(C/12);return I<3?b.formatDistance("aboutXYears",E,P):I<9?b.formatDistance("overXYears",E,P):b.formatDistance("almostXYears",E+1,P)}function A(e,i){return(0,u.A)(1,arguments),v(e,Date.now(),i)}}}]);