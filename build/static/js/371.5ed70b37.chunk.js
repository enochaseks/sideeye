"use strict";(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[371],{4454:(e,t,n)=>{n.d(t,{A:()=>i});n(9950);var r=n(6491),o=n(2053),a=n(5277),s=n(4414);const i=e=>{let{links:t}=e;return t&&0!==t.length?(0,s.jsxs)(r.A,{mt:1,children:[(0,s.jsx)(o.A,{variant:"caption",sx:{display:"block",color:"text.secondary",fontStyle:"italic",mb:.5},children:"Sources:"}),(0,s.jsx)(r.A,{display:"flex",flexWrap:"wrap",gap:.5,children:t.map(((e,t)=>(0,s.jsx)(a.A,{size:"small",label:e.title,component:"a",href:e.url,target:"_blank",rel:"noopener noreferrer",clickable:!0,sx:{maxWidth:"100%","& .MuiChip-label":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},fontSize:"0.7rem",backgroundColor:"rgba(0, 0, 0, 0.05)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}},t)))})]}):null}},6699:(e,t,n)=>{n.d(t,{A:()=>D});var r=n(7528),o=n(8587),a=n(8168),s=n(9950),i=n(2004),l=n(8465),c=n(8283),d=n(9269),u=n(4730),g=n(1676),m=n(9254),h=n(8463),p=n(1763),x=n(423);function b(e){return(0,x.Ay)("MuiLinearProgress",e)}(0,p.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var f,v,y,A,S,w,_=n(4414);const k=["className","color","value","valueBuffer","variant"];let I,C,P,j,T,R;const E=(0,c.i7)(I||(I=f||(f=(0,r.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"])))),F=(0,c.i7)(C||(C=v||(v=(0,r.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"])))),B=(0,c.i7)(P||(P=y||(y=(0,r.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"])))),N=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress["".concat(t,"Bg")]:"light"===e.palette.mode?(0,d.a)(e.palette[t].main,.62):(0,d.e$)(e.palette[t].main,.5),L=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["color".concat((0,g.A)(n.color))],t[n.variant]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,a.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:N(n,t.color)},"inherit"===t.color&&"buffer"!==t.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===t.variant&&{backgroundColor:"transparent"},"query"===t.variant&&{transform:"rotate(180deg)"})})),O=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.dashed,t["dashedColor".concat((0,g.A)(n.color))]]}})((e=>{let{ownerState:t,theme:n}=e;const r=N(n,t.color);return(0,a.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===t.color&&{opacity:.3},{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,c.AH)(j||(j=A||(A=(0,r.A)(["\n    animation: "," 3s infinite linear;\n  "]))),B)),M=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t["barColor".concat((0,g.A)(n.color))],("indeterminate"===n.variant||"query"===n.variant)&&t.bar1Indeterminate,"determinate"===n.variant&&t.bar1Determinate,"buffer"===n.variant&&t.bar1Buffer]}})((e=>{let{ownerState:t,theme:n}=e;return(0,a.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===t.color?"currentColor":(n.vars||n).palette[t.color].main},"determinate"===t.variant&&{transition:"transform .".concat(4,"s linear")},"buffer"===t.variant&&{zIndex:1,transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.AH)(T||(T=S||(S=(0,r.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    "]))),E)})),W=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t["barColor".concat((0,g.A)(n.color))],("indeterminate"===n.variant||"query"===n.variant)&&t.bar2Indeterminate,"buffer"===n.variant&&t.bar2Buffer]}})((e=>{let{ownerState:t,theme:n}=e;return(0,a.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==t.variant&&{backgroundColor:"inherit"===t.color?"currentColor":(n.vars||n).palette[t.color].main},"inherit"===t.color&&{opacity:.3},"buffer"===t.variant&&{backgroundColor:N(n,t.color),transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.AH)(R||(R=w||(w=(0,r.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    "]))),F)})),D=s.forwardRef((function(e,t){const n=(0,h.b)({props:e,name:"MuiLinearProgress"}),{className:r,color:s="primary",value:c,valueBuffer:d,variant:m="indeterminate"}=n,p=(0,o.A)(n,k),x=(0,a.A)({},n,{color:s,variant:m}),f=(e=>{const{classes:t,variant:n,color:r}=e,o={root:["root","color".concat((0,g.A)(r)),n],dashed:["dashed","dashedColor".concat((0,g.A)(r))],bar1:["bar","barColor".concat((0,g.A)(r)),("indeterminate"===n||"query"===n)&&"bar1Indeterminate","determinate"===n&&"bar1Determinate","buffer"===n&&"bar1Buffer"],bar2:["bar","buffer"!==n&&"barColor".concat((0,g.A)(r)),"buffer"===n&&"color".concat((0,g.A)(r)),("indeterminate"===n||"query"===n)&&"bar2Indeterminate","buffer"===n&&"bar2Buffer"]};return(0,l.A)(o,b,t)})(x),v=(0,u.I)(),y={},A={bar1:{},bar2:{}};if("determinate"===m||"buffer"===m)if(void 0!==c){y["aria-valuenow"]=Math.round(c),y["aria-valuemin"]=0,y["aria-valuemax"]=100;let e=c-100;v&&(e=-e),A.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===m)if(void 0!==d){let e=(d||0)-100;v&&(e=-e),A.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,_.jsxs)(L,(0,a.A)({className:(0,i.A)(f.root,r),ownerState:x,role:"progressbar"},y,{ref:t},p,{children:["buffer"===m?(0,_.jsx)(O,{className:f.dashed,ownerState:x}):null,(0,_.jsx)(M,{className:f.bar1,ownerState:x,style:A.bar1}),"determinate"===m?null:(0,_.jsx)(W,{className:f.bar2,ownerState:x,style:A.bar2})]}))}))},8371:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(9379),o=n(9950),a=n(6491),s=n(899),i=n(2053),l=n(2235),c=n(4745),d=n(1413),u=n(5277),g=n(226),m=n(6699),h=n(8145),p=n(5333),x=n(9223),b=n(3422),f=n(8429),v=n(1367),y=n(4414);const A=()=>(0,y.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",pl:1,py:1.2},children:[" ",(0,y.jsx)(a.A,{sx:{height:8,width:8,borderRadius:"50%",bgcolor:"grey.400",animation:"bounce 1.4s infinite ease-in-out both",mx:.5,animationName:"bounceKeyframes"}}),(0,y.jsx)(a.A,{sx:{height:8,width:8,borderRadius:"50%",bgcolor:"grey.400",animation:"bounce 1.4s infinite ease-in-out both",mx:.5,animationDelay:"0.2s",animationName:"bounceKeyframes"}}),(0,y.jsx)(a.A,{sx:{height:8,width:8,borderRadius:"50%",bgcolor:"grey.400",animation:"bounce 1.4s infinite ease-in-out both",mx:.5,animationDelay:"0.4s",animationName:"bounceKeyframes"}}),(0,y.jsx)("style",{children:"\n          @keyframes bounceKeyframes {\n            0%, 80%, 100% {\n              transform: scale(0);\n            }\n            40% {\n              transform: scale(1.0);\n            }\n          }\n        "})]});var S=n(4454);const w=e=>{var t;let{board:n}=e;n.length;const r=(null===(t=n[0])||void 0===t?void 0:t.length)||0,o={"\ud83d\udd34":"#ff4136","\ud83d\udfe1":"#ffdc00","\u26aa":"#dddddd"};return(0,y.jsx)(a.A,{sx:{bgcolor:"#0074D9",p:1,borderRadius:2,mb:2,display:"inline-block",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.2)"},children:(0,y.jsxs)(s.Ay,{container:!0,spacing:.5,sx:{width:"auto"},children:[" ",n.map(((e,t)=>(0,y.jsx)(s.Ay,{container:!0,item:!0,xs:12,justifyContent:"center",spacing:.5,children:e.map(((e,n)=>(0,y.jsx)(s.Ay,{item:!0,children:(0,y.jsx)(a.A,{sx:{width:{xs:30,sm:35},height:{xs:30,sm:35},borderRadius:"50%",bgcolor:o[e]||"#FFFFFF",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.2)"}})},"".concat(t,"-").concat(n))))},t))),(0,y.jsx)(s.Ay,{container:!0,item:!0,xs:12,justifyContent:"center",spacing:.5,sx:{mt:.5},children:Array.from({length:r}).map(((e,t)=>(0,y.jsx)(s.Ay,{item:!0,sx:{width:{xs:30,sm:35},textAlign:"center"},children:(0,y.jsx)(i.A,{variant:"caption",sx:{color:"white",fontWeight:"bold"},children:t+1})},"label-".concat(t))))})]})})},_=()=>{var e,t,n;const{currentUser:s}=(0,v.As)(),[_,k]=(0,o.useState)([]),[I,C]=(0,o.useState)(""),[P,j]=(0,o.useState)(!1),[T,R]=(0,o.useState)(!1),[E,F]=(0,o.useState)(!1),[B,N]=(0,o.useState)(null),[L,O]=(0,o.useState)(null),[M,W]=(0,o.useState)(null),[D,H]=(0,o.useState)(null),G=(0,f.zy)(),[U,z]=(0,o.useState)(""),[K,q]=(0,o.useState)(!1),[J]=(0,o.useState)(30),Y=((0,o.useRef)(null),(0,o.useRef)(null)),X=(0,o.useRef)(null);(0,o.useEffect)((()=>{(()=>{var e;null===(e=X.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()}),[_,U]),(0,o.useEffect)((()=>{if(!K||!U)return;let e=0;const t=U,n=()=>{e<t.length?(k((n=>{const r=[...n];return r.length>0&&"ai"===r[r.length-1].sender&&(r[r.length-1].text=t.substring(0,e+1)),r})),e++,setTimeout(n,J)):(q(!1),z(""))};return n(),()=>{q(!1)}}),[K,U,J]);const V=e=>{e&&(k((e=>{const t=e[e.length-1];if(t&&"ai"===t.sender&&(""===t.text||"Thinking..."===t.text)){const n=[...e];return n[n.length-1]=(0,r.A)((0,r.A)({},t),{},{text:""}),n}return[...e,{sender:"ai",text:""}]})),z(e),q(!0))};(0,o.useEffect)((()=>{const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ALGOLIA_API_KEY:"b94f7163a6855940c1a0d94e635a307c",REACT_APP_ALGOLIA_APP_ID:"7PVTC2J64R",REACT_APP_ALGOLIA_INDEX_NAME:"searches",REACT_APP_API_URL:"https://sideeye-backend-production.up.railway.app",REACT_APP_FIREBASE_API_KEY:"AIzaSyBI9pvyseKR-5dw3eXuZgTLnG3OcvNGbeI",REACT_APP_FIREBASE_APP_ID:"1:864667627333:web:1ec087179141d1e91a982c",REACT_APP_FIREBASE_AUTH_DOMAIN:"sideeye.uk",REACT_APP_FIREBASE_DATABASE_URL:"https://sideeye-bafda-default-rtdb.europe-west1.firebasedatabase.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"864667627333",REACT_APP_FIREBASE_PROJECT_ID:"sideeye-bafda",REACT_APP_FIREBASE_STORAGE_BUCKET:"sideeye-bafda.firebasestorage.app",REACT_APP_SHOTSTACK_API_KEY:"c0Bpc85oj7cHuDdfhz54eQJmmoEI1qauJyodpw9d",REACT_APP_SOCKET_SERVER_URL:"wss://sideeye-backend-production.up.railway.app",REACT_APP_STREAM_API_KEY:"2nufecjmzmzh"}.REACT_APP_SOCKET_URL||"https://sideeye-backend-production.up.railway.app";console.log("[Frontend] Connecting Socket.IO to: ".concat(e));const t=(0,b.io)(e,{});return H(t),t.on("connect",(()=>{console.log("[Frontend] Socket connected:",t.id)})),t.on("disconnect",(e=>{console.log("[Frontend] Socket disconnected:",e)})),t.on("connect_error",(e=>{console.error("[Frontend] Socket connection error:",e)})),()=>{console.log("[Frontend] Disconnecting socket..."),t.disconnect(),H(null)}}),[]),(0,o.useEffect)((()=>{if(D){const e=e=>{e&&"ai"===e.sender&&"string"===typeof e.text?(console.log("[Frontend] Received 'ai-message' via Socket:",e),k((t=>[...t,{sender:"ai",text:e.text}]))):console.warn("[Frontend] Received malformed 'ai-message' data via Socket:",e)};return D.on("ai-message",e),()=>{console.log("[Frontend] Removing 'ai-message' listener"),D.off("ai-message",e)}}}),[D]),(0,o.useEffect)((()=>{if("help"===new URLSearchParams(G.search).get("intent")&&0===_.length){console.log("[Frontend] Detected intent=help from URL params.");k([{sender:"ai",text:"Hi there! Looks like you clicked 'Get Help' in settings. How can I assist you today? Just type your question below. \ud83d\ude0a"}])}}),[G.search]),(0,o.useEffect)((()=>{if(!s)return;const e="sadeai_chat_history_".concat(s.uid),t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);k(e),console.log("[SadeAIPage] Loaded ".concat(e.length," messages from history for user ").concat(s.uid))}catch(n){console.error("[SadeAIPage] Error parsing chat history:",n),localStorage.removeItem(e)}}),[s]),(0,o.useEffect)((()=>{if(!s)return;const e="sadeai_chat_history_".concat(s.uid);localStorage.setItem(e,JSON.stringify(_))}),[_,null===s||void 0===s?void 0:s.uid]);const Q=()=>{Y.current&&(clearInterval(Y.current),Y.current=null)},Z=()=>{W((e=>{if(!e||!e.active)return console.log("[Frontend] handleTimerTick: No active state, clearing interval."),Q(),null;const t=e.timer-1;return console.log("[Frontend] handleTimerTick: Prev Timer: ".concat(e.timer,", New Timer: ").concat(t,", Step Index: ").concat(e.currentStepIndex)),t<=0?(console.log("[Frontend] handleTimerTick: Timer reached 0, starting next step."),setTimeout($,0),(0,r.A)((0,r.A)({},e),{},{timer:0})):(0,r.A)((0,r.A)({},e),{},{timer:t})}))},$=()=>{console.log("[Frontend] startNextBreathingStep called."),Q(),W((e=>{if(!e||!e.active)return console.warn("[Frontend] startNextBreathingStep: No active breathing state found on entry."),null;const t=e.currentStepIndex+1;if(console.log("[Frontend] startNextBreathingStep: Prev Index: ".concat(e.currentStepIndex,", Next Index: ").concat(t)),t>=e.steps.length)return console.log("[Frontend] startNextBreathingStep: Exercise finished."),console.log("[Frontend] endBreathingExercise called."),Q(),V("Nicely done! Hope that helped you feel a bit calmer, mate. \ud83d\ude0a"),W(null),R(!1),null;const n=e.steps[t];console.log("[Frontend] startNextBreathingStep: Next step details:",n),k((e=>{const t=e[e.length-1];return"ai"===(null===t||void 0===t?void 0:t.sender)&&(null===t||void 0===t?void 0:t.text)===n.text?e:[...e,{sender:"ai",text:n.text}]})),0!==t&&(Y.current=setInterval(Z,1e3),console.log("[Frontend] startNextBreathingStep: Interval started:",Y.current));const o=(0,r.A)((0,r.A)({},e),{},{currentStepIndex:t,timer:1.5*n.duration+2,intervalId:Y.current});return console.log("[Frontend] startNextBreathingStep: Setting new state:",o),o}))},ee=()=>{W((e=>null!==e&&void 0!==e&&e.active?(console.log("[Frontend] Manually stopping breathing exercise."),Q(),V("Okay, no worries! Stopping the exercise now."),R(!1),null):e))};(0,o.useEffect)((()=>()=>Q()),[]);const te=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.trim())return;if(!s)return console.error("[SadeAIPage] Error: No user logged in. Cannot send message."),void V("Sorry, I can't send messages if you're not logged in.");const n={sender:"user",text:e};k((e=>[...e,n])),C(""),R(!0),F(!1);try{if(console.log("[Frontend] sendMessage called. forceSearch=",t,"Connect4Game:",L,"ActiveGame:",B,"BreathingState:",M),null!==M&&void 0!==M&&M.active&&e.toLowerCase().includes("stop"))return void ee();if(null!==M&&void 0!==M&&M.active)return void V("Let's focus on breathing for now. You can type 'stop' if you need to.");if(B&&"guess_the_number"===B.gameType){console.log("[Frontend] Guess the Number game is active. Processing locally.");const t=parseInt(e,10),n=e.toLowerCase();if(isNaN(t))if(n.includes("even")||n.includes("odd")){const e=B.targetNumber%2===0?"Okay, cheeky hint for you... It's an **even** number! \ud83d\ude09":"Alright, since you asked nicely... It's an **odd** number! \ud83e\udd14";k((t=>[...t,{sender:"ai",text:e}]))}else{const e="Ah, trying to be clever? \ud83d\ude09 Just give me a number guess between 1 and 100!";k((t=>[...t,{sender:"ai",text:e}]))}else re(t);return}if(L&&"connect_4"===L.gameType&&!L.gameOver&&"User"===L.turn){console.log("[Frontend] Connect 4 game is active and it's User's turn. Processing input as move.");const t=parseInt(e.trim(),10);if(!isNaN(t)&&t>=1&&t<=7){console.log("[Frontend] Sending Connect 4 move (column ".concat(t,") to backend.")),k((e=>[...e,{sender:"ai",text:"Thinking..."}]));const e="https://sideeye-backend-production.up.railway.app";if(!e)return console.error("[SadeAIPage] ERROR: REACT_APP_API_URL is not defined."),void V("Configuration error: Backend URL not set.");const n="".concat(e,"/api/sade-ai"),o={message:"connect4_move_".concat(t),userId:s.uid};console.log("[Frontend] Sending Connect 4 move request body:",o);const a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},i=await fetch(n,a);if(!i.ok){let e="HTTP error! status: ".concat(i.status);try{e=(await i.json()).error||e}catch(r){}throw new Error(e)}const l=await i.json();if(console.log("[Frontend] Connect 4 move response data:",l),k((e=>e.length>0&&"ai"===e[e.length-1].sender&&"Thinking..."===e[e.length-1].text?e.slice(0,-1):e)),"connect_4"===l.gameUpdate&&l.board&&l.response){console.log("[Frontend] Received Connect 4 game update from backend.");const e={gameType:"connect_4",board:l.board,turn:l.turn,gameOver:l.gameOver,winner:l.winner};O(e),V(l.response),l.gameOver&&console.log("[Frontend] Connect 4 game is over. Winner:",l.winner)}else l.error?V(l.error):(console.error("[SadeAIPage] Received unexpected response structure after Connect 4 move:",l),V("Sorry, something went wrong with the game."),O(null))}else console.log("[Frontend] Connect 4 active, but input is not a valid column number (1-7)."),V("Please enter a column number from 1 to 7 to make your move, mate.");return}console.log("[Frontend] No active game/exercise or local action. Sending message to backend via HTTP.");const n="https://sideeye-backend-production.up.railway.app";if(!n)return console.error("[SadeAIPage] ERROR: REACT_APP_API_URL is not defined."),void V("Configuration error: Backend URL not set.");const o="".concat(n,"/api/sade-ai");k((e=>[...e,{sender:"ai",text:"Thinking..."}]));const a={message:e,history:_.slice(-10),forceSearch:t,userId:s.uid};console.log("[Frontend] Sending HTTP request body:",a);const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},l=await fetch(o,i);if(!l.ok){let e="HTTP error! status: ".concat(l.status);try{e=(await l.json()).error||e}catch(r){}throw new Error(e)}const c=await l.json();if(console.log("[Frontend] HTTP Backend response data:",c),k((e=>e.filter(((t,n)=>n!==e.length-1)))),c.startBreathingExercise&&c.steps){console.log("[Frontend] sendMessage: Received signal to start breathing exercise."),V(c.response);const e={active:!0,steps:c.steps,currentStepIndex:-1,timer:0,intervalId:null};W(e),setTimeout($,100),O(null),N(null)}else if("guess_the_number"===c.startGame&&c.response)V(c.response),ne("guess_the_number"),O(null),W(null);else if("connect_4"===c.startGame&&c.board&&c.response){console.log("[Frontend] sendMessage: Received signal to start Connect 4 game."),V(c.response);const e={gameType:"connect_4",board:c.board,turn:"User",gameOver:!1,winner:null};O(e),N(null),W(null)}else if(c.response)if(c.sourceLinks&&Array.isArray(c.sourceLinks)&&c.sourceLinks.length>0){const e=c.sourceLinks;k((t=>[...t,{sender:"ai",text:"",sourceLinks:e}])),z(c.response),q(!0)}else V(c.response);else console.error("[SadeAIPage] Received unexpected HTTP response structure:",c),V("Sorry, I got a bit confused there.")}catch(o){console.error("[SadeAIPage] sendMessage Error:",o),k((e=>e.length>0&&"ai"===e[e.length-1].sender&&"Thinking..."===e[e.length-1].text?e.slice(0,-1):e)),V("Sorry, there was an error: ".concat(o.message||"Unknown error"))}finally{console.log("[SadeAIPage sendMessage finally] Setting loading to false."),R(!1)}},ne=(e,t)=>{if("guess_the_number"===e){const e={gameType:"guess_the_number",targetNumber:Math.floor(100*Math.random())+1,guessesMade:0,lowerBound:1,upperBound:100};console.log("[Frontend] startGame called. Setting activeGame state to:",e),N(e),k((e=>[...e,{sender:"ai",text:t||"Hi there! I'm Sade AI. How can I assist you today? Just type your question below. \ud83d\ude0a"}]))}},re=e=>{if(!B||"guess_the_number"!==B.gameType)return;let t="";const n=B.guessesMade+1;let o=B.lowerBound,a=B.upperBound,s=!1;console.log("[Frontend] handleGuess called with valid number: ".concat(e)),e<1||e>100?(t="Whoops! That number's not between 1 and 100, mate. Try again!",console.log("[Frontend] handleGuess: Input out of bounds.")):e===B.targetNumber?(t="Yes! You got it in ".concat(n," guesses! Proper smart. \ud83c\udf89 Fancy another round? (Just ask!)"),s=!0):e<B.targetNumber?(t="A bit higher than ".concat(e,"... \ud83d\ude09"),o=Math.max(B.lowerBound,e+1)):(t="Lower than ".concat(e,", try again! \ud83d\udc47"),a=Math.min(B.upperBound,e-1)),V(t),s?N(null):e>=1&&e<=100&&N((0,r.A)((0,r.A)({},B),{},{guessesMade:n,lowerBound:o,upperBound:a}))},oe=null===M||void 0===M?void 0:M.active,ae=null!==(e=null===M||void 0===M?void 0:M.currentStepIndex)&&void 0!==e?e:-1,se=oe&&ae>=0?M.steps[ae]:null,ie=null!==(t=null===se||void 0===se?void 0:se.duration)&&void 0!==t?t:0,le=null!==(n=null===M||void 0===M?void 0:M.timer)&&void 0!==n?n:0,ce=ie>0?(ie-le)/ie*100:0;return(0,y.jsx)(a.A,{sx:{minHeight:"100vh",background:e=>"dark"===e.palette.mode?"linear-gradient(135deg, #1a1a2e 0%, #333355 100%)":"linear-gradient(135deg, #FFF8DC 0%, #FFC0CB 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",pb:{xs:10,sm:7},pt:{xs:2,sm:6}},children:(0,y.jsxs)(l.A,{elevation:6,sx:{width:"100%",maxWidth:500,p:{xs:2,sm:4},borderRadius:4,mb:2,mt:2,bgcolor:e=>"dark"===e.palette.mode?"background.paper":"#fffefa",boxShadow:"0 12px 40px rgba(0, 0, 0, 0.12)"},children:[(0,y.jsxs)(i.A,{variant:"h4",align:"center",fontWeight:700,color:"primary.dark",gutterBottom:!0,sx:{letterSpacing:.5,display:"flex",alignItems:"center",justifyContent:"center"},children:["Sade AI \u2728",(0,y.jsx)(i.A,{component:"span",variant:"body1",sx:{ml:1.5,fontWeight:400,fontSize:"1.1rem",color:"text.secondary"},children:"(SHA-DEY)"})]}),(0,y.jsx)(c.A,{sx:{mb:2}}),(0,y.jsxs)(a.A,{sx:{minHeight:320,maxHeight:{xs:350,sm:400},overflowY:"auto",bgcolor:e=>"dark"===e.palette.mode?"rgba(0, 0, 0, 0.2)":"rgba(255, 255, 255, 0.6)",borderRadius:3,p:2,mb:2,boxShadow:e=>"dark"===e.palette.mode?"inset 0 1px 3px rgba(255,255,255,0.05)":"inset 0 1px 3px rgba(0,0,0,0.05)",transition:"background 0.3s"},children:[0===_.length&&(0,y.jsxs)(i.A,{color:"text.secondary",align:"center",sx:{mt:8},children:["Say hello to ",(0,y.jsx)("b",{children:"Sade AI"}),", your friendly AI chatbot! \ud83c\udf38",(0,y.jsx)("br",{}),"Ask me anything! Search the web for information, or just chat."]}),_.map(((e,t)=>(0,y.jsxs)(a.A,{sx:{display:"flex",alignItems:"ai"===e.sender?"flex-start":"flex-end",justifyContent:"user"===e.sender?"flex-end":"flex-start",mb:1.5},children:["ai"===e.sender&&(0,y.jsx)(d.A,{src:"/images/sade-avatar.jpg",alt:"Sade AI Avatar",sx:{width:36,height:36,mr:1.5}}),(0,y.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",alignItems:"user"===e.sender?"flex-end":"flex-start",maxWidth:"80%"},children:[(0,y.jsx)(l.A,{elevation:0,sx:{bgcolor:"user"===e.sender?"primary.main":e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.15)":"#f3f6fb",color:"user"===e.sender?"primary.contrastText":e=>"dark"===e.palette.mode?"common.white":"text.primary",borderRadius:"user"===e.sender?"18px 18px 4px 18px":"18px 18px 18px 4px",px:2,py:1.2,maxWidth:"100%",boxShadow:"user"===e.sender?"0 2px 8px 0 rgba(33, 150, 243, 0.10)":"0 2px 8px 0 rgba(31, 38, 135, 0.05)",fontSize:"1.08rem",wordBreak:"break-word",fontFamily:"inherit"},children:e.text}),"ai"===e.sender&&e.sourceLinks&&(0,y.jsx)(S.A,{links:e.sourceLinks})]})]},t))),T&&!B&&!(null!==M&&void 0!==M&&M.active)&&(0,y.jsxs)(a.A,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"flex-start",mb:1.5},children:[(0,y.jsx)(d.A,{src:"/images/sade-avatar.jpg",alt:"Sade AI Avatar",sx:{width:36,height:36,mr:1.5}}),(0,y.jsx)(a.A,{sx:{bgcolor:e=>"dark"===e.palette.mode?"rgba(255, 255, 255, 0.15)":"#f3f6fb",borderRadius:"18px 18px 18px 4px",px:1,py:.5,display:"inline-block"},children:(0,y.jsx)(A,{})})]}),(0,y.jsx)("div",{ref:X})]}),!T&&!B&&!(null!==M&&void 0!==M&&M.active)&&_.length<=1&&(0,y.jsxs)(a.A,{sx:{pt:1,pb:1.5,mb:2,overflow:"hidden"},children:[(0,y.jsx)(i.A,{variant:"caption",sx:{width:"100%",textAlign:"center",color:"text.secondary",mb:1},children:"Try asking:"}),(0,y.jsx)(a.A,{sx:{display:"flex",gap:1,flexWrap:"nowrap",overflowX:"auto",justifyContent:"flex-start",px:{xs:2,sm:0},pb:1,"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none","-ms-overflow-style":"none"},children:["Play Connect 4","I'm feeling a bit down today","Can we just talk?","Tell me a fact","What does 'wagwan' mean?","Play 'Would You Rather?'","Feeling a bit lost","Play Guess the Number","Breathing exercise"].map(((e,t)=>(0,y.jsx)(u.A,{label:e,onClick:()=>{te(e)},clickable:!0,variant:"outlined",color:"primary",size:"small",disabled:T,sx:{fontWeight:500}},t)))})]}),B&&!(null!==M&&void 0!==M&&M.active)&&"guess_the_number"===B.gameType&&(0,y.jsxs)(i.A,{variant:"caption",sx:{display:"block",textAlign:"center",mb:1,color:"text.secondary"},children:["Guessing between ",B.lowerBound," and"," ",B.upperBound," (Guess #",B.guessesMade+1,")"]}),oe&&ae>=0&&(0,y.jsxs)(a.A,{sx:{p:1,mt:1,border:"1px dashed grey",borderRadius:2,textAlign:"center",bgcolor:"rgba(255,255,255,0.7)"},children:[(0,y.jsx)(i.A,{variant:"caption",display:"block",sx:{mb:.5,fontWeight:500},children:null===se||void 0===se?void 0:se.text}),0===ae?(0,y.jsxs)(a.A,{sx:{my:2},children:[(0,y.jsx)(i.A,{variant:"body2",sx:{mb:1},children:"Take a moment to get comfortable, then click when you're ready to begin."}),(0,y.jsx)(g.A,{variant:"contained",color:"primary",size:"large",onClick:()=>{console.log("[Frontend] User clicked 'Ready to Begin' button"),Q(),W((e=>{if(!e||!e.active)return null;const t=e.steps[1];return k((e=>[...e,{sender:"ai",text:t.text}])),Y.current=setInterval(Z,1e3),(0,r.A)((0,r.A)({},e),{},{currentStepIndex:1,timer:1.5*t.duration+2,intervalId:Y.current})}))},startIcon:(0,y.jsx)("span",{role:"img","aria-label":"breath",children:"\ud83e\uddd8"}),sx:{px:3,fontWeight:"bold"},children:"I'm Ready to Begin"})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(m.A,{variant:"determinate",value:ce,sx:{height:8,borderRadius:4,mb:.5,"& .MuiLinearProgress-bar":{transition:"transform .2s linear"}}}),(0,y.jsxs)(i.A,{variant:"caption",display:"block",children:[le,"s remaining... (type 'stop' to end)"]})]})]}),L&&"connect_4"===L.gameType&&!L.gameOver&&(0,y.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",width:"100%",mb:2},children:(0,y.jsx)(w,{board:L.board})}),(0,y.jsxs)(a.A,{sx:{display:"flex",gap:1,alignItems:"center",position:{xs:"fixed",sm:"static"},bottom:{xs:64,sm:"auto"},left:0,width:{xs:"100vw",sm:"auto"},maxWidth:{xs:"100vw",sm:"none"},bgcolor:e=>({xs:"dark"===e.palette.mode?"rgba(0,0,0,0.85)":"rgba(255,255,255,0.95)",sm:"transparent"}),p:{xs:2,sm:0},borderTop:e=>({xs:"1px solid ".concat("dark"===e.palette.mode?"rgba(255,255,255,0.1)":"#eee"),sm:"none"}),zIndex:1200},children:[(0,y.jsx)(h.A,{fullWidth:!0,variant:"outlined",placeholder:null!==M&&void 0!==M&&M.active?"Focus on breathing... (or type 'stop')":B?"Enter your guess...":"Type your message...",value:I,onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&I.trim()&&te(I,E)},disabled:T||!(null!==D&&void 0!==D&&D.connected),type:"guess_the_number"===(null===B||void 0===B?void 0:B.gameType)?"number":"text",sx:{bgcolor:e=>"dark"===e.palette.mode?"rgba(255,255,255,0.05)":"white",borderRadius:2,boxShadow:"0 1px 4px 0 rgba(31,38,135,0.04)"}}),null!==M&&void 0!==M&&M.active?(0,y.jsx)(g.A,{variant:"contained",color:"secondary",onClick:ee,sx:{minWidth:80,fontWeight:600},children:"Stop"}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(g.A,{variant:"contained",onClick:()=>te(I,!1),disabled:T||!I.trim()||!(null!==D&&void 0!==D&&D.connected),sx:{minWidth:80,fontWeight:600},children:B?"Guess":"Send"}),(0,y.jsx)(p.A,{color:"primary",onClick:()=>te(I,!0),disabled:T||!I.trim()||!(null!==D&&void 0!==D&&D.connected),sx:{border:"1px solid",borderColor:"primary.main",ml:.5},title:"Search the web for this query",children:(0,y.jsx)(x.A,{})})]}),!B&&!(null!==M&&void 0!==M&&M.active)&&(0,y.jsx)(g.A,{variant:"outlined",color:"secondary",onClick:()=>{k([]),null!==s&&void 0!==s&&s.uid&&(localStorage.removeItem("sadeai_chat_history_".concat(s.uid)),console.log("[SadeAIPage] Cleared chat history for user ".concat(s.uid))),N(null),W(null)},disabled:T,sx:{minWidth:90,fontWeight:500},children:"Clear Chat"})]})]})})}},9223:(e,t,n)=>{var r=n(4994);t.A=void 0;var o=r(n(9526)),a=n(4414);t.A=(0,o.default)((0,a.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);