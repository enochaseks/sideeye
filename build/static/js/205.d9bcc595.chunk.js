/*! For license information please see 205.d9bcc595.chunk.js.LICENSE.txt */
(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[205],{18:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var i={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},227:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(3235),s=n(4414);const r=(0,i.A)((0,s.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},937:(e,t,n)=>{"use strict";function i(e,t,n,i,s){void 0===i&&(i=0),void 0===s&&(s=!1);var r=t.schedule((function(){n(),s?e.add(this.schedule(null,i)):this.unsubscribe()}),i);if(e.add(r),!s)return r}n.d(t,{N:()=>i})},1190:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var i=n(9351);function s(e){return function(t){if(function(e){return(0,i.T)(null===e||void 0===e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}},1633:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var i=n(9351);function s(e){return Symbol.asyncIterator&&(0,i.T)(null===e||void 0===e?void 0:e[Symbol.asyncIterator])}},1998:(e,t,n)=>{"use strict";n.d(t,{Tg:()=>m});var i=n(7827),s=n(5505),r=n(3554),o=n(5868),a=n(3983),c=n(1633),l=n(7391),u=n(5637),d=n(9788),h=n(9351),p=n(3414),f=n(4294);function m(e){if(e instanceof o.c)return e;if(null!=e){if((0,a.l)(e))return b=e,new o.c((function(e){var t=b[f.s]();if((0,h.T)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,s.X)(e))return v=e,new o.c((function(e){for(var t=0;t<v.length&&!e.closed;t++)e.next(v[t]);e.complete()}));if((0,r.y)(e))return m=e,new o.c((function(e){m.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,p.m)}));if((0,c.T)(e))return g(e);if((0,u.x)(e))return n=e,new o.c((function(e){var t,s;try{for(var r=(0,i.Ju)(n),o=r.next();!o.done;o=r.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(c){t={error:c}}finally{try{o&&!o.done&&(s=r.return)&&s.call(r)}finally{if(t)throw t.error}}e.complete()}));if((0,d.U)(e))return t=e,g((0,d.C)(t))}var t,n,m,v,b;throw(0,l.L)(e)}function g(e){return new o.c((function(t){(function(e,t){var n,s,r,o;return(0,i.sH)(this,void 0,void 0,(function(){var a,c;return(0,i.YH)(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=(0,i.xN)(e),l.label=1;case 1:return[4,n.next()];case 2:if((s=l.sent()).done)return[3,4];if(a=s.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=l.sent(),r={error:c},[3,11];case 6:return l.trys.push([6,,9,10]),s&&!s.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},2047:(e,t,n)=>{"use strict";n.d(t,{Kn:()=>c,yU:()=>a,Uv:()=>l});var i=n(7827),s=n(9351),r=(0,n(4861).L)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),o=n(4004),a=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,o,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var l=(0,i.Ju)(c),d=l.next();!d.done;d=l.next()){d.value.remove(this)}}catch(v){e={error:v}}finally{try{d&&!d.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else c.remove(this);var h=this.initialTeardown;if((0,s.T)(h))try{h()}catch(b){a=b instanceof r?b.errors:[b]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var f=(0,i.Ju)(p),m=f.next();!m.done;m=f.next()){var g=m.value;try{u(g)}catch(y){a=null!==a&&void 0!==a?a:[],y instanceof r?a=(0,i.fX)((0,i.fX)([],(0,i.zs)(a)),(0,i.zs)(y.errors)):a.push(y)}}}catch(w){n={error:w}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}}if(a)throw new r(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)u(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,o.o)(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&(0,o.o)(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),c=a.EMPTY;function l(e){return e instanceof a||e&&"closed"in e&&(0,s.T)(e.remove)&&(0,s.T)(e.add)&&(0,s.T)(e.unsubscribe)}function u(e){(0,s.T)(e)?e():e.unsubscribe()}},2476:(e,t,n)=>{"use strict";n.d(t,{R0:()=>a,ms:()=>r,lI:()=>o});var i=n(9351);function s(e){return e[e.length-1]}function r(e){return(0,i.T)(s(e))?e.pop():void 0}function o(e){return(t=s(e))&&(0,i.T)(t.schedule)?e.pop():void 0;var t}function a(e,t){return"number"===typeof s(e)?e.pop():t}},2960:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(3235),s=n(4414);const r=(0,i.A)((0,s.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"}),"EmojiEvents")},3217:(e,t,n)=>{var i=n(6238),s=n(7542);n(3992),t.qg=i.parse,i.parseParams,i.parseFmtpConfig,i.parsePayloads,i.parseRemoteCandidates,i.parseImageAttributes,i.parseSimulcastStreamList},3414:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var i=n(18),s=n(6950);function r(e){s.f.setTimeout((function(){var t=i.$.onUnhandledError;if(!t)throw e;t(e)}))}},3554:(e,t,n)=>{"use strict";n.d(t,{y:()=>s});var i=n(9351);function s(e){return(0,i.T)(null===e||void 0===e?void 0:e.then)}},3983:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(4294),s=n(9351);function r(e){return(0,s.T)(e[i.s])}},3992:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},4004:(e,t,n)=>{"use strict";function i(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}n.d(t,{o:()=>i})},4066:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(3235),s=n(4414);const r=(0,i.A)((0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"}),"Public")},4294:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});var i="function"===typeof Symbol&&Symbol.observable||"@@observable"},4861:(e,t,n)=>{"use strict";function i(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}n.d(t,{L:()=>i})},5257:(e,t,n)=>{"use strict";n.d(t,{of:()=>r});var i=n(2476),s=n(8165);function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,i.lI)(e);return(0,s.H)(e,n)}},5505:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});var i=function(e){return e&&"number"===typeof e.length&&"function"!==typeof e}},5637:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(8041),s=n(9351);function r(e){return(0,s.T)(null===e||void 0===e?void 0:e[i.l])}},5868:(e,t,n)=>{"use strict";n.d(t,{c:()=>d});var i=n(7917),s=n(2047),r=n(4294),o=n(8117);function a(e){return 0===e.length?o.D:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var c=n(18),l=n(9351),u=n(6634),d=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o=this,a=(r=e)&&r instanceof i.vU||function(e){return e&&(0,l.T)(e.next)&&(0,l.T)(e.error)&&(0,l.T)(e.complete)}(r)&&(0,s.Uv)(r)?e:new i.Ms(e,t,n);return(0,u.Y)((function(){var e=o,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?o._subscribe(a):o._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=h(t))((function(t,s){var r=new i.Ms({next:function(t){try{e(t)}catch(n){s(n),r.unsubscribe()}},error:s,complete:t});n.subscribe(r)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[r.s]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=h(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function h(e){var t;return null!==(t=null!==e&&void 0!==e?e:c.$.Promise)&&void 0!==t?t:Promise}},6164:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(3235),s=n(4414);const r=(0,i.A)((0,s.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm-2 16-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"VerifiedUser")},6238:(e,t,n)=>{var i=function(e){return String(Number(e))===e?Number(e):e},s=function(e,t,n){var s=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:s&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:s?t[e.name]:t;!function(e,t,n,s){if(s&&!n)t[s]=i(e[1]);else for(var r=0;r<n.length;r+=1)null!=e[r+1]&&(t[n[r]]=i(e[r+1]))}(n.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},r=n(3992),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1]);for(var a=0;a<(r[t]||[]).length;a+=1){var c=r[t][a];if(c.reg.test(o))return s(c,i,o)}})),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=i(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),s=0;s<n.length;s+=3)t.push({component:n[s],ip:n[s+1],port:n[s+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=i(e):(t=i(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},6634:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r,l:()=>o});var i=n(18),s=null;function r(e){if(i.$.useDeprecatedSynchronousErrorHandling){var t=!s;if(t&&(s={errorThrown:!1,error:null}),e(),t){var n=s,r=n.errorThrown,o=n.error;if(s=null,r)throw o}}else e()}function o(e){i.$.useDeprecatedSynchronousErrorHandling&&s&&(s.errorThrown=!0,s.error=e)}},6932:(e,t,n)=>{"use strict";n.d(t,{c7:()=>Ee,kb:()=>te,Dv:()=>me,Gc:()=>ne,R3:()=>ke,s9:()=>pe});var i=n(9379),s=n(45),r=n(4414),o=n(9950);const a=e=>"string"===typeof e,c=()=>{let e,t;const n=new Promise(((n,i)=>{e=n,t=i}));return n.resolve=e,n.reject=t,n},l=e=>null==e?"":""+e,u=/###/g,d=e=>e&&e.indexOf("###")>-1?e.replace(u,"."):e,h=e=>!e||a(e),p=(e,t,n)=>{const i=a(t)?t.split("."):t;let s=0;for(;s<i.length-1;){if(h(e))return{};const t=d(i[s]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++s}return h(e)?{}:{obj:e,k:d(i[s])}},f=(e,t,n)=>{const{obj:i,k:s}=p(e,t,Object);if(void 0!==i||1===t.length)return void(i[s]=n);let r=t[t.length-1],o=t.slice(0,t.length-1),a=p(e,o,Object);for(;void 0===a.obj&&o.length;)r="".concat(o[o.length-1],".").concat(r),o=o.slice(0,o.length-1),a=p(e,o,Object),a&&a.obj&&"undefined"!==typeof a.obj["".concat(a.k,".").concat(r)]&&(a.obj=void 0);a.obj["".concat(a.k,".").concat(r)]=n},m=(e,t)=>{const{obj:n,k:i}=p(e,t);if(n)return n[i]},g=(e,t,n)=>{for(const i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?a(e[i])||e[i]instanceof String||a(t[i])||t[i]instanceof String?n&&(e[i]=t[i]):g(e[i],t[i],n):e[i]=t[i]);return e},v=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const y=e=>a(e)?e.replace(/[&<>"'\/]/g,(e=>b[e])):e;const w=[" ",",","?","!",";"],S=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}(20),T=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t])return e[t];const i=t.split(n);let s=e;for(let r=0;r<i.length;){if(!s||"object"!==typeof s)return;let e,t="";for(let o=r;o<i.length;++o)if(o!==r&&(t+=n),t+=i[o],e=s[t],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&o<i.length-1)continue;r+=o-r+1;break}s=e}return s},C=e=>e&&e.replace("_","-"),k={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class E{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||k,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(a(e[0])&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}create(e){return new E(this.logger,(0,i.A)((0,i.A)({},{prefix:"".concat(this.prefix,":").concat(e,":")}),this.options))}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new E(this.logger,e)}}var _=new E;class R{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const n=this.observers[e].get(t)||0;this.observers[e].set(t,n+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.observers[e]){Array.from(this.observers[e].entries()).forEach((e=>{let[t,i]=e;for(let s=0;s<i;s++)t(...n)}))}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach((t=>{let[i,s]=t;for(let r=0;r<s;r++)i.apply(i,[e,...n])}))}}}class I extends R{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,r=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],n&&(Array.isArray(n)?o.push(...n):a(n)&&s?o.push(...n.split(s)):o.push(n)));const c=m(this.data,o);return!c&&!t&&!n&&e.indexOf(".")>-1&&(e=o[0],t=o[1],n=o.slice(2).join(".")),!c&&r&&a(n)?T(this.data&&this.data[e]&&this.data[e][t],n,s):c}addResource(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const r=void 0!==s.keySeparator?s.keySeparator:this.options.keySeparator;let o=[e,t];n&&(o=o.concat(r?n.split(r):n)),e.indexOf(".")>-1&&(o=e.split("."),i=t,t=o[1]),this.addNamespaces(t),f(this.data,o,i),s.silent||this.emit("added",e,t,n,i)}addResources(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const s in n)(a(n[s])||Array.isArray(n[s]))&&this.addResource(e,t,s,n[s],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,s,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),s=n,n=t,t=a[1]),this.addNamespaces(t);let c=m(this.data,a)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),s?g(c,n,r):c=(0,i.A)((0,i.A)({},c),n),f(this.data,a,c),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?(0,i.A)((0,i.A)({},{}),this.getResource(e,t)):this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var A={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,n,i,s){return e.forEach((e=>{this.processors[e]&&(t=this.processors[e].process(t,n,i,s))})),t}};const P={};class x extends R{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((e,t,n)=>{e.forEach((e=>{t[e]&&(n[e]=t[e])}))})(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=_.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(void 0===e||null===e)return!1;const n=this.resolve(e,t);return n&&void 0!==n.res}extractFromKey(e,t){let n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const r=n&&e.indexOf(n)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!((e,t,n)=>{t=t||"",n=n||"";const i=w.filter((e=>t.indexOf(e)<0&&n.indexOf(e)<0));if(0===i.length)return!0;const s=S.getRegExp("(".concat(i.map((e=>"?"===e?"\\?":e)).join("|"),")"));let r=!s.test(e);if(!r){const t=e.indexOf(n);t>0&&!s.test(e.substring(0,t))&&(r=!0)}return r})(e,n,i);if(r&&!o){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:a(s)?[s]:s};const r=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(r[0])>-1)&&(s=r.shift()),e=r.join(i)}return{key:e,namespaces:a(s)?[s]:s}}translate(e,t,n){if("object"!==typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"===typeof t&&(t=(0,i.A)({},t)),t||(t={}),void 0===e||null===e)return"";Array.isArray(e)||(e=[String(e)]);const s=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:o,namespaces:c}=this.extractFromKey(e[e.length-1],t),l=c[c.length-1],u=t.lng||this.language,d=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&"cimode"===u.toLowerCase()){if(d){const e=t.nsSeparator||this.options.nsSeparator;return s?{res:"".concat(l).concat(e).concat(o),usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:"".concat(l).concat(e).concat(o)}return s?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:o}const h=this.resolve(e,t);let p=h&&h.res;const f=h&&h.usedKey||o,m=h&&h.exactUsedKey||o,g=Object.prototype.toString.apply(p),v=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,y=!a(p)&&"boolean"!==typeof p&&"number"!==typeof p;if(!(b&&p&&y&&["[object Number]","[object Function]","[object RegExp]"].indexOf(g)<0)||a(v)&&Array.isArray(p))if(b&&a(v)&&Array.isArray(p))p=p.join(v),p&&(p=this.extendTranslation(p,e,t,n));else{let s=!1,c=!1;const d=void 0!==t.count&&!a(t.count),f=x.hasDefaultValue(t),m=d?this.pluralResolver.getSuffix(u,t.count,t):"",g=t.ordinal&&d?this.pluralResolver.getSuffix(u,t.count,{ordinal:!1}):"",v=d&&!t.ordinal&&0===t.count&&this.pluralResolver.shouldUseIntlApi(),b=v&&t["defaultValue".concat(this.options.pluralSeparator,"zero")]||t["defaultValue".concat(m)]||t["defaultValue".concat(g)]||t.defaultValue;!this.isValidLookup(p)&&f&&(s=!0,p=b),this.isValidLookup(p)||(c=!0,p=o);const y=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&c?void 0:p,w=f&&b!==p&&this.options.updateMissing;if(c||s||w){if(this.logger.log(w?"updateKey":"missingKey",u,l,o,w?b:p),r){const e=this.resolve(o,(0,i.A)((0,i.A)({},t),{},{keySeparator:!1}));e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&n&&n[0])for(let t=0;t<n.length;t++)e.push(n[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const s=(e,n,i)=>{const s=f&&i!==p?i:y;this.options.missingKeyHandler?this.options.missingKeyHandler(e,l,n,s,w,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(e,l,n,s,w,t),this.emit("missingKey",e,l,n,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&d?e.forEach((e=>{const n=this.pluralResolver.getSuffixes(e,t);v&&t["defaultValue".concat(this.options.pluralSeparator,"zero")]&&n.indexOf("".concat(this.options.pluralSeparator,"zero"))<0&&n.push("".concat(this.options.pluralSeparator,"zero")),n.forEach((n=>{s([e],o+n,t["defaultValue".concat(n)]||b)}))})):s(e,o,b))}p=this.extendTranslation(p,e,t,h,n),c&&p===o&&this.options.appendNamespaceToMissingKey&&(p="".concat(l,":").concat(o)),(c||s)&&this.options.parseMissingKeyHandler&&(p="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(l,":").concat(o):o,s?p:void 0):this.options.parseMissingKeyHandler(p))}else{if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,p,(0,i.A)((0,i.A)({},t),{},{ns:c})):"key '".concat(o," (").concat(this.language,")' returned an object instead of string.");return s?(h.res=e,h.usedParams=this.getUsedParamsDetails(t),h):e}if(r){const e=Array.isArray(p),n=e?[]:{},s=e?m:f;for(const o in p)if(Object.prototype.hasOwnProperty.call(p,o)){const e="".concat(s).concat(r).concat(o);n[o]=this.translate(e,(0,i.A)((0,i.A)({},t),{joinArrays:!1,ns:c})),n[o]===e&&(n[o]=p[o])}p=n}}return s?(h.res=p,h.usedParams=this.getUsedParamsDetails(t),h):p}extendTranslation(e,t,n,s,r){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,(0,i.A)((0,i.A)({},this.options.interpolation.defaultVariables),n),n.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init((0,i.A)((0,i.A)({},n),{interpolation:(0,i.A)((0,i.A)({},this.options.interpolation),n.interpolation)}));const c=a(e)&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let l;if(c){const t=e.match(this.interpolator.nestingRegexp);l=t&&t.length}let u=n.replace&&!a(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(u=(0,i.A)((0,i.A)({},this.options.interpolation.defaultVariables),u)),e=this.interpolator.interpolate(e,u,n.lng||this.language||s.usedLng,n),c){const t=e.match(this.interpolator.nestingRegexp);l<(t&&t.length)&&(n.nest=!1)}!n.lng&&"v1"!==this.options.compatibilityAPI&&s&&s.res&&(n.lng=this.language||s.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return r&&r[0]===i[0]&&!n.context?(o.logger.warn("It seems you are nesting recursively key: ".concat(i[0]," in key: ").concat(t[0])),null):o.translate(...i,t)}),n)),n.interpolation&&this.interpolator.reset()}const c=n.postProcess||this.options.postProcess,l=a(c)?[c]:c;return void 0!==e&&null!==e&&l&&l.length&&!1!==n.applyPostProcessor&&(e=A.handle(l,e,t,this.options&&this.options.postProcessPassResolved?(0,i.A)({i18nResolved:(0,i.A)((0,i.A)({},s),{},{usedParams:this.getUsedParamsDetails(n)})},n):n,this)),e}resolve(e){let t,n,i,s,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(t))return;const c=this.extractFromKey(e,o),l=c.key;n=l;let u=c.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const d=void 0!==o.count&&!a(o.count),h=d&&!o.ordinal&&0===o.count&&this.pluralResolver.shouldUseIntlApi(),p=void 0!==o.context&&(a(o.context)||"number"===typeof o.context)&&""!==o.context,f=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);u.forEach((e=>{this.isValidLookup(t)||(r=e,!P["".concat(f[0],"-").concat(e)]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(r)&&(P["".concat(f[0],"-").concat(e)]=!0,this.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(r,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((n=>{if(this.isValidLookup(t))return;s=n;const r=[l];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(r,l,n,e,o);else{let e;d&&(e=this.pluralResolver.getSuffix(n,o.count,o));const t="".concat(this.options.pluralSeparator,"zero"),i="".concat(this.options.pluralSeparator,"ordinal").concat(this.options.pluralSeparator);if(d&&(r.push(l+e),o.ordinal&&0===e.indexOf(i)&&r.push(l+e.replace(i,this.options.pluralSeparator)),h&&r.push(l+t)),p){const n="".concat(l).concat(this.options.contextSeparator).concat(o.context);r.push(n),d&&(r.push(n+e),o.ordinal&&0===e.indexOf(i)&&r.push(n+e.replace(i,this.options.pluralSeparator)),h&&r.push(n+t))}}let a;for(;a=r.pop();)this.isValidLookup(t)||(i=a,t=this.getResource(n,e,a,o))})))}))})),{res:t,usedKey:n,exactUsedKey:i,usedLng:s,usedNS:r}}isValidLookup(e){return void 0!==e&&!(!this.options.returnNull&&null===e)&&!(!this.options.returnEmptyString&&""===e)}getResource(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!a(e.replace);let s=n?e.replace:e;if(n&&"undefined"!==typeof e.count&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s=(0,i.A)((0,i.A)({},this.options.interpolation.defaultVariables),s)),!n){s=(0,i.A)({},s);for(const e of t)delete s[e]}return s}static hasDefaultValue(e){const t="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,12)&&void 0!==e[n])return!0;return!1}}const O=e=>e.charAt(0).toUpperCase()+e.slice(1);class N{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_.create("languageUtils")}getScriptPartFromCode(e){if(!(e=C(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=C(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(a(e)&&e.indexOf("-")>-1){if("undefined"!==typeof Intl&&"undefined"!==typeof Intl.getCanonicalLocales)try{let t=Intl.getCanonicalLocales(e)[0];if(t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t)return t}catch(t){}const n=["hans","hant","latn","cyrl","cans","mong","arab"];let i=e.split("-");return this.options.lowerCaseLng?i=i.map((e=>e.toLowerCase())):2===i.length?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=O(i[1].toLowerCase()))):3===i.length&&(i[0]=i[0].toLowerCase(),2===i[1].length&&(i[1]=i[1].toUpperCase()),"sgn"!==i[0]&&2===i[2].length&&(i[2]=i[2].toUpperCase()),n.indexOf(i[1].toLowerCase())>-1&&(i[1]=O(i[1].toLowerCase())),n.indexOf(i[2].toLowerCase())>-1&&(i[2]=O(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const n=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(n)||(t=n)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const n=this.getLanguagePartFromCode(e);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find((e=>e===n?e:e.indexOf("-")<0&&n.indexOf("-")<0?void 0:e.indexOf("-")>0&&n.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===n||0===e.indexOf(n)&&n.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"===typeof e&&(e=e(t)),a(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){const n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],s=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return a(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&s(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&s(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&s(this.getLanguagePartFromCode(e))):a(e)&&s(this.formatLanguageCode(e)),n.forEach((e=>{i.indexOf(e)<0&&s(this.formatLanguageCode(e))})),i}}let D=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],j={1:e=>Number(e>1),2:e=>Number(1!=e),3:e=>0,4:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),5:e=>Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5),6:e=>Number(1==e?0:e>=2&&e<=4?1:2),7:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),8:e=>Number(1==e?0:2==e?1:8!=e&&11!=e?2:3),9:e=>Number(e>=2),10:e=>Number(1==e?0:2==e?1:e<7?2:e<11?3:4),11:e=>Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3),12:e=>Number(e%10!=1||e%100==11),13:e=>Number(0!==e),14:e=>Number(1==e?0:2==e?1:3==e?2:3),15:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2),16:e=>Number(e%10==1&&e%100!=11?0:0!==e?1:2),17:e=>Number(1==e||e%10==1&&e%100!=11?0:1),18:e=>Number(0==e?0:1==e?1:2),19:e=>Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3),20:e=>Number(1==e?0:0==e||e%100>0&&e%100<20?1:2),21:e=>Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0),22:e=>Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)};const L=["v1","v2","v3"],U=["v4"],F={zero:0,one:1,two:2,few:3,many:4,other:5};class M{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=_.create("pluralResolver"),this.options.compatibilityJSON&&!U.includes(this.options.compatibilityJSON)||"undefined"!==typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(()=>{const e={};return D.forEach((t=>{t.lngs.forEach((n=>{e[n]={numbers:t.nr,plurals:j[t.fc]}}))})),e})(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi()){const i=C("dev"===e?"en":e),s=t.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:i,type:s});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let o;try{o=new Intl.PluralRules(i,{type:s})}catch(n){if(!e.match(/-|_/))return;const i=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(i,t)}return this.pluralRulesCache[r]=o,o}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((e=>"".concat(t).concat(e)))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.getRule(e,t);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort(((e,t)=>F[e]-F[t])).map((e=>"".concat(this.options.prepend).concat(t.ordinal?"ordinal".concat(this.options.prepend):"").concat(e))):n.numbers.map((n=>this.getSuffix(e,n,t))):[]}getSuffix(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getRule(e,n);return i?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(n.ordinal?"ordinal".concat(this.options.prepend):"").concat(i.select(t)):this.getSuffixRetroCompatible(i,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}getSuffixRetroCompatible(e,t){const n=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let i=e.numbers[n];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===i?i="plural":1===i&&(i=""));const s=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return"v1"===this.options.compatibilityJSON?1===i?"":"number"===typeof i?"_plural_".concat(i.toString()):s():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?s():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!L.includes(this.options.compatibilityJSON)}}const V=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=((e,t,n)=>{const i=m(e,n);return void 0!==i?i:m(t,n)})(e,t,n);return!r&&s&&a(n)&&(r=T(e,n,i),void 0===r&&(r=T(t,n,i))),r},B=e=>e.replace(/\$/g,"$$$$");class H{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=_.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:s,prefixEscaped:r,suffix:o,suffixEscaped:a,formatSeparator:c,unescapeSuffix:l,unescapePrefix:u,nestingPrefix:d,nestingPrefixEscaped:h,nestingSuffix:p,nestingSuffixEscaped:f,nestingOptionsSeparator:m,maxReplaces:g,alwaysFormat:b}=e.interpolation;this.escape=void 0!==t?t:y,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==i&&i,this.prefix=s?v(s):r||"{{",this.suffix=o?v(o):a||"}}",this.formatSeparator=c||",",this.unescapePrefix=l?"":u||"-",this.unescapeSuffix=this.unescapePrefix?"":l||"",this.nestingPrefix=d?v(d):h||v("$t("),this.nestingSuffix=p?v(p):f||v(")"),this.nestingOptionsSeparator=m||",",this.maxReplaces=g||1e3,this.alwaysFormat=void 0!==b&&b,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e&&e.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,"".concat(this.prefix,"(.+?)").concat(this.suffix)),this.regexpUnescape=e(this.regexpUnescape,"".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix)),this.nestingRegexp=e(this.nestingRegexp,"".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix))}interpolate(e,t,n,s){let r,o,c;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=e=>{if(e.indexOf(this.formatSeparator)<0){const r=V(t,u,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(r,void 0,n,(0,i.A)((0,i.A)((0,i.A)({},s),t),{},{interpolationkey:e})):r}const r=e.split(this.formatSeparator),o=r.shift().trim(),a=r.join(this.formatSeparator).trim();return this.format(V(t,u,o,this.options.keySeparator,this.options.ignoreJSONStructure),a,n,(0,i.A)((0,i.A)((0,i.A)({},s),t),{},{interpolationkey:o}))};this.resetRegExp();const h=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,p=s&&s.interpolation&&void 0!==s.interpolation.skipOnVariables?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>B(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?B(this.escape(e)):B(e)}].forEach((t=>{for(c=0;r=t.regex.exec(e);){const n=r[1].trim();if(o=d(n),void 0===o)if("function"===typeof h){const t=h(e,r,s);o=a(t)?t:""}else if(s&&Object.prototype.hasOwnProperty.call(s,n))o="";else{if(p){o=r[0];continue}this.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),o=""}else a(o)||this.useRawValueToEscape||(o=l(o));const i=t.safeValue(o);if(e=e.replace(r[0],i),p?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=r[0].length):t.regex.lastIndex=0,c++,c>=this.maxReplaces)break}})),e}nest(e,t){let n,s,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const c=(e,t)=>{const n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;const s=e.split(new RegExp("".concat(n,"[ ]*{")));let o="{".concat(s[1]);e=s[0],o=this.interpolate(o,r);const a=o.match(/'/g),c=o.match(/"/g);(a&&a.length%2===0&&!c||c.length%2!==0)&&(o=o.replace(/'/g,'"'));try{r=JSON.parse(o),t&&(r=(0,i.A)((0,i.A)({},t),r))}catch(l){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),l),"".concat(e).concat(n).concat(o)}return r.defaultValue&&r.defaultValue.indexOf(this.prefix)>-1&&delete r.defaultValue,e};for(;n=this.nestingRegexp.exec(e);){let u=[];r=(0,i.A)({},o),r=r.replace&&!a(r.replace)?r.replace:r,r.applyPostProcessor=!1,delete r.defaultValue;let d=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){const e=n[1].split(this.formatSeparator).map((e=>e.trim()));n[1]=e.shift(),u=e,d=!0}if(s=t(c.call(this,n[1].trim(),r),r),s&&n[0]===e&&!a(s))return s;a(s)||(s=l(s)),s||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),s=""),d&&(s=u.reduce(((e,t)=>this.format(e,t,o.lng,(0,i.A)((0,i.A)({},o),{},{interpolationkey:n[1].trim()}))),s.trim())),e=e.replace(n[0],s),this.regexp.lastIndex=0}return e}}const q=e=>{const t={};return(n,s,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o=(0,i.A)((0,i.A)({},o),{},{[r.interpolationkey]:void 0}));const a=s+JSON.stringify(o);let c=t[a];return c||(c=e(C(s),r),t[a]=c),c(n)}};class W{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=_.create("formatter"),this.options=e,this.formats={number:q(((e,t)=>{const n=new Intl.NumberFormat(e,(0,i.A)({},t));return e=>n.format(e)})),currency:q(((e,t)=>{const n=new Intl.NumberFormat(e,(0,i.A)((0,i.A)({},t),{},{style:"currency"}));return e=>n.format(e)})),datetime:q(((e,t)=>{const n=new Intl.DateTimeFormat(e,(0,i.A)({},t));return e=>n.format(e)})),relativetime:q(((e,t)=>{const n=new Intl.RelativeTimeFormat(e,(0,i.A)({},t));return e=>n.format(e,t.range||"day")})),list:q(((e,t)=>{const n=new Intl.ListFormat(e,(0,i.A)({},t));return e=>n.format(e)}))},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=q(t)}format(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=t.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find((e=>e.indexOf(")")>-1))){const e=r.findIndex((e=>e.indexOf(")")>-1));r[0]=[r[0],...r.splice(1,e)].join(this.formatSeparator)}return r.reduce(((e,t)=>{const{formatName:r,formatOptions:o}=(e=>{let t=e.toLowerCase().trim();const n={};if(e.indexOf("(")>-1){const i=e.split("(");t=i[0].toLowerCase().trim();const s=i[1].substring(0,i[1].length-1);"currency"===t&&s.indexOf(":")<0?n.currency||(n.currency=s.trim()):"relativetime"===t&&s.indexOf(":")<0?n.range||(n.range=s.trim()):s.split(";").forEach((e=>{if(e){const[t,...i]=e.split(":"),s=i.join(":").trim().replace(/^'+|'+$/g,""),r=t.trim();n[r]||(n[r]=s),"false"===s&&(n[r]=!1),"true"===s&&(n[r]=!0),isNaN(s)||(n[r]=parseInt(s,10))}}))}return{formatName:t,formatOptions:n}})(t);if(this.formats[r]){let t=e;try{const a=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},c=a.locale||a.lng||s.locale||s.lng||n;t=this.formats[r](e,c,(0,i.A)((0,i.A)((0,i.A)({},o),s),a))}catch(a){this.logger.warn(a)}return t}return this.logger.warn("there was no format function for ".concat(r)),e}),e)}}class $ extends R{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=_.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,i.backend,i)}queueLoad(e,t,n,i){const s={},r={},o={},a={};return e.forEach((e=>{let i=!0;t.forEach((t=>{const o="".concat(e,"|").concat(t);!n.reload&&this.store.hasResourceBundle(e,t)?this.state[o]=2:this.state[o]<0||(1===this.state[o]?void 0===r[o]&&(r[o]=!0):(this.state[o]=1,i=!1,void 0===r[o]&&(r[o]=!0),void 0===s[o]&&(s[o]=!0),void 0===a[t]&&(a[t]=!0)))})),i||(o[e]=!0)})),(Object.keys(s).length||Object.keys(r).length)&&this.queue.push({pending:r,pendingCount:Object.keys(r).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(s),pending:Object.keys(r),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(a)}}loaded(e,t,n){const i=e.split("|"),s=i[0],r=i[1];t&&this.emit("failedLoading",s,r,t),!t&&n&&this.store.addResourceBundle(s,r,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);const o={};this.queue.forEach((n=>{((e,t,n)=>{const{obj:i,k:s}=p(e,t,Object);i[s]=i[s]||[],i[s].push(n)})(n.loaded,[s],r),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((e=>{o[e]||(o[e]={});const t=n.loaded[e];t.length&&t.forEach((t=>{void 0===o[e][t]&&(o[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",o),this.queue=this.queue.filter((e=>!e.done))}read(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,r=arguments.length>5?arguments[5]:void 0;if(!e.length)return r(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:s,callback:r});this.readingCalls++;const o=(o,a)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}o&&a&&i<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,n,i+1,2*s,r)}),s):r(o,a)},a=this.backend[n].bind(this.backend);if(2!==a.length)return a(e,t,o);try{const n=a(e,t);n&&"function"===typeof n.then?n.then((e=>o(null,e))).catch(o):o(null,n)}catch(c){o(c)}}prepareLoading(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();a(e)&&(e=this.languageUtils.toResolveHierarchy(e)),a(t)&&(t=[t]);const s=this.queueLoad(e,t,n,i);if(!s.toLoad.length)return s.pending.length||i(),null;s.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.split("|"),i=n[0],s=n[1];this.read(i,s,"read",void 0,void 0,((n,r)=>{n&&this.logger.warn("".concat(t,"loading namespace ").concat(s," for language ").concat(i," failed"),n),!n&&r&&this.logger.log("".concat(t,"loaded namespace ").concat(s," for language ").concat(i),r),this.loaded(e,n,r)}))}saveMissing(e,t,n,s,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(void 0!==n&&null!==n&&""!==n){if(this.backend&&this.backend.create){const l=(0,i.A)((0,i.A)({},o),{},{isUpdate:r}),u=this.backend.create.bind(this.backend);if(u.length<6)try{let i;i=5===u.length?u(e,t,n,s,l):u(e,t,n,s),i&&"function"===typeof i.then?i.then((e=>a(null,e))).catch(a):a(null,i)}catch(c){a(c)}else u(e,t,n,s,a,l)}e&&e[0]&&this.store.addResource(e[0],t,n,s)}}}const J=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"===typeof e[1]&&(t=e[1]),a(e[1])&&(t.defaultValue=e[1]),a(e[2])&&(t.tDescription=e[2]),"object"===typeof e[2]||"object"===typeof e[3]){const n=e[3]||e[2];Object.keys(n).forEach((e=>{t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),z=e=>(a(e.ns)&&(e.ns=[e.ns]),a(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),a(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),G=()=>{};class K extends R{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var n;if(super(),this.options=z(e),this.services={},this.logger=_,this.modules={external:[]},n=this,Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach((e=>{"function"===typeof n[e]&&(n[e]=n[e].bind(n))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"===typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&(a(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const s=J();this.options=(0,i.A)((0,i.A)((0,i.A)({},s),this.options),z(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=(0,i.A)((0,i.A)({},s.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const r=e=>e?"function"===typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?_.init(r(this.modules.logger),this.options):_.init(null,this.options),this.modules.formatter?t=this.modules.formatter:"undefined"!==typeof Intl&&(t=W);const n=new N(this.options);this.store=new I(this.options.resources,this.options);const i=this.services;i.logger=_,i.resourceStore=this.store,i.languageUtils=n,i.pluralResolver=new M(n,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!t||this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format||(i.formatter=r(t),i.formatter.init(i,this.options),this.options.interpolation.format=i.formatter.format.bind(i.formatter)),i.interpolator=new H(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new $(r(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];e.emit(t,...i)})),this.modules.languageDetector&&(i.languageDetector=r(this.modules.languageDetector),i.languageDetector.init&&i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=r(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new x(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];e.emit(t,...i)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,n||(n=G),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((t=>{this[t]=function(){return e.store[t](...arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((t=>{this[t]=function(){return e.store[t](...arguments),e}}));const o=c(),l=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(t),n(e,t)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),o}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;const n=a(e)?e:this.language;if("function"===typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){if(n&&"cimode"===n.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],i=t=>{if(!t)return;if("cimode"===t)return;this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};if(n)i(n);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>i(e)))}this.options.preload&&this.options.preload.forEach((e=>i(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)}))}else t(null)}reloadResources(e,t,n){const i=c();return"function"===typeof e&&(n=e,e=void 0),"function"===typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=G),this.services.backendConnector.reload(e,t,(e=>{i.resolve(),n(e)})),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&A.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}}changeLanguage(e,t){var n=this;this.isLanguageChangingTo=e;const i=c();this.emit("languageChanging",e);const s=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},r=(e,r)=>{r?(s(r),this.translator.changeLanguage(r),this.isLanguageChangingTo=void 0,this.emit("languageChanged",r),this.logger.log("languageChanged",r)):this.isLanguageChangingTo=void 0,i.resolve((function(){return n.t(...arguments)})),t&&t(e,(function(){return n.t(...arguments)}))},o=t=>{e||t||!this.services.languageDetector||(t=[]);const n=a(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);n&&(this.language||s(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(n)),this.loadResources(n,(e=>{r(e,n)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e):o(this.services.languageDetector.detect()),i}getFixedT(e,t,n){var s=this;const r=function(e,t){let o;if("object"!==typeof t){for(var a=arguments.length,c=new Array(a>2?a-2:0),l=2;l<a;l++)c[l-2]=arguments[l];o=s.options.overloadTranslationOptionHandler([e,t].concat(c))}else o=(0,i.A)({},t);o.lng=o.lng||r.lng,o.lngs=o.lngs||r.lngs,o.ns=o.ns||r.ns,""!==o.keyPrefix&&(o.keyPrefix=o.keyPrefix||n||r.keyPrefix);const u=s.options.keySeparator||".";let d;return d=o.keyPrefix&&Array.isArray(e)?e.map((e=>"".concat(o.keyPrefix).concat(u).concat(e))):o.keyPrefix?"".concat(o.keyPrefix).concat(u).concat(e):e,s.t(d,o)};return a(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=n,r}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,s=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;const r=(e,t)=>{const n=this.services.backendConnector.state["".concat(e,"|").concat(t)];return-1===n||0===n||2===n};if(t.precheck){const e=t.precheck(this,r);if(void 0!==e)return e}return!!this.hasResourceBundle(n,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!r(n,e)||i&&!r(s,e)))}loadNamespaces(e,t){const n=c();return this.options.ns?(a(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){const n=c();a(e)&&(e=[e]);const i=this.options.preload||[],s=e.filter((e=>i.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return s.length?(this.options.preload=i.concat(s),this.loadResources((e=>{n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services&&this.services.languageUtils||new N(J());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new K(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;const n=e.forkResourceStore;n&&delete e.forkResourceStore;const s=(0,i.A)((0,i.A)((0,i.A)({},this.options),e),{isClone:!0}),r=new K(s);void 0===e.debug&&void 0===e.prefix||(r.logger=r.logger.clone(e));return["store","services","language"].forEach((e=>{r[e]=this[e]})),r.services=(0,i.A)({},this.services),r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},n&&(r.store=new I(this.store.data,s),r.services.resourceStore=r.store),r.translator=new x(r.services,s),r.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];r.emit(e,...n)})),r.init(s,t),r.translator.options=s,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Y=K.createInstance();Y.createInstance=K.createInstance;Y.createInstance,Y.dir,Y.init,Y.loadResources,Y.reloadResources,Y.use,Y.changeLanguage,Y.getFixedT,Y.t,Y.exists,Y.setDefaultNamespace,Y.hasLoadedNamespace,Y.loadNamespaces,Y.loadLanguages;var X=n(7493),Z=n(5257);const Q=["children"],ee=(0,o.createContext)(void 0),te=e=>{const{call:t,children:n}=e;return(0,r.jsx)(ee.Provider,{value:t,children:n})},ne=()=>(0,o.useContext)(ee),ie="stream-video",se={debug:!1,currentLanguage:"en",fallbackLanguage:!1},re=(oe={},ae=ie,Object.entries(oe).reduce(((e,t)=>{let[n,i]=t;return e[n]={[ae]:i},e}),{}));var oe,ae;const ce=e=>e;class le{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.t=ce,this.init=async()=>{try{this.t=await this.i18nInstance.init()}catch(e){console.error("Failed to initialize translations: ".concat(JSON.stringify(e)))}return this},this.changeLanguage=async(e,t)=>{if(!this._checkIsInitialized())return;const n="undefined"!==typeof window&&window.navigator?window.navigator.language:void 0;await this.i18nInstance.changeLanguage(e||n),null===t||void 0===t||t(this.currentLanguage)},this.registerTranslationsForLanguage=e=>{let{lng:t,translations:n}=e;this._checkIsInitialized()&&this.i18nInstance.addResourceBundle(t,ie,n,!0,!0)},this._checkIsInitialized=()=>(this.i18nInstance.isInitialized||console.warn("I18n instance is not initialized. Call yourStreamI18nInstance.init()."),this.i18nInstance.isInitialized);const{debug:t=se.debug,currentLanguage:n=se.currentLanguage,fallbackLanguage:i=se.fallbackLanguage,translationsOverrides:s}=e;this.i18nInstance=Y.createInstance({debug:t,defaultNS:ie,fallbackLng:i,interpolation:{escapeValue:!1},keySeparator:!1,lng:n,nsSeparator:!1,parseMissingKeyHandler:e=>e,resources:re}),s&&this.i18nInstance.on("initialized",(()=>{Object.entries(s).forEach((e=>{let[t,n]=e;this.registerTranslationsForLanguage({lng:t,translations:n})}))}))}get currentLanguage(){return this._checkIsInitialized(),this.i18nInstance.language}get isInitialized(){return this.i18nInstance.isInitialized}}const ue=(0,o.createContext)({t:ce}),de=e=>{let{children:t}=e,n=(0,s.A)(e,Q);const{i18n:i,t:o}=he(n);return(0,r.jsx)(ue.Provider,{value:{t:o,i18n:i},children:t})},he=e=>{let{i18nInstance:t,language:n,fallbackLanguage:i,translationsOverrides:s}=e;const[r]=(0,o.useState)((()=>t||new le({currentLanguage:n,fallbackLanguage:i,translationsOverrides:s}))),[a,c]=(0,o.useState)((()=>ce));return(0,o.useEffect)((()=>{const{isInitialized:e}=r;e?n&&(null===r||void 0===r?void 0:r.currentLanguage)!==n&&r.changeLanguage(n).catch((e=>{console.log("Error while changing language",e)})):r.init().then((e=>c((()=>e.i18nInstance.t))))}),[r,t,n,s]),{i18n:r,t:a}},pe=()=>(0,o.useContext)(ue),fe=(0,o.createContext)(void 0),me=e=>{let{children:t,client:n,i18nInstance:i,language:s,translationsOverrides:o}=e;return(0,r.jsx)(fe.Provider,{value:n,children:(0,r.jsx)(de,{i18nInstance:i,language:s,translationsOverrides:o,children:t})})},ge=(e,t)=>{const[n,i]=(0,o.useState)((()=>{try{return X.mg.getCurrentValue(e)}catch(n){if("undefined"===typeof t)throw n;return t}}));return(0,o.useEffect)((()=>X.mg.createSubscription(e,i,(e=>{console.log("An error occurred while reading an observable",e),t&&i(t)}))),[t,e]),n},ve=Object.freeze([]),be=()=>{const e=ne();if(!e){const e='You are using useCallState() outside a Call context. Please wrap your component in <StreamCall /> and provide a "call" instance.';return console.warn(e),new X.iP}return e.state},ye=()=>{const{recording$:e}=be();return ge(e)},we=()=>{const{ownCapabilities$:e}=be();return ge(e)};function Se(e,t){const n=null!==t&&void 0!==t?t:e;return{status:e,optimisticStatus:n,isEnabled:"enabled"===e,isMute:"enabled"!==e,optimisticIsMute:"enabled"!==n,isTogglePending:n!==e}}function Te(e){const t=(0,o.useMemo)((()=>(0,Z.of)(ve)),[]),[n,i]=(0,o.useState)(t),s=ge(n,ve);return{getDevices:()=>(n===t&&i(e.listDevices()),s)}}var Ce=Object.freeze({__proto__:null,useAnonymousParticipantCount:()=>{const{anonymousParticipantCount$:e}=be();return ge(e)},useCallBlockedUserIds:()=>{const{blockedUserIds$:e}=be();return ge(e)},useCallCallingState:()=>{const{callingState$:e}=be();return ge(e)},useCallClosedCaptions:()=>{const{closedCaptions$:e}=be();return ge(e)},useCallCreatedAt:()=>{const{createdAt$:e}=be();return ge(e)},useCallCreatedBy:()=>{const{createdBy$:e}=be();return ge(e)},useCallCustomData:()=>{const{custom$:e}=be();return ge(e)},useCallEgress:()=>{const{egress$:e}=be();return ge(e)},useCallEndedAt:()=>{const{endedAt$:e}=be();return ge(e)},useCallEndedBy:()=>{const{endedBy$:e}=be();return ge(e)},useCallIngress:()=>{const{ingress$:e}=be();return ge(e)},useCallMembers:()=>{const{members$:e}=be();return ge(e)},useCallSession:()=>{const{session$:e}=be();return ge(e)},useCallSettings:()=>{const{settings$:e}=be();return ge(e)},useCallStartedAt:()=>{const{startedAt$:e}=be();return ge(e)},useCallStartsAt:()=>{const{startsAt$:e}=be();return ge(e)},useCallState:be,useCallStatsReport:()=>{const{callStatsReport$:e}=be();return ge(e)},useCallThumbnail:()=>{const{thumbnails$:e}=be();return ge(e)},useCallUpdatedAt:()=>{const{updatedAt$:e}=be();return ge(e)},useCameraState:()=>{const e=ne(),{camera:t}=e,{state:n}=t,s=ge(n.direction$),r=ge(n.mediaStream$),o=ge(n.selectedDevice$),{getDevices:a}=Te(t),c=ge(n.hasBrowserPermission$),l=ge(n.isPromptingPermission$);return(0,i.A)({camera:t,direction:s,mediaStream:r,get devices(){return a()},hasBrowserPermission:c,isPromptingPermission:l,selectedDevice:o},Se(ge(n.status$),ge(n.optimisticStatus$)))},useDominantSpeaker:()=>{const{dominantSpeaker$:e}=be();return ge(e)},useHasOngoingScreenShare:()=>{const{hasOngoingScreenShare$:e}=be();return ge(e)},useHasPermissions:function(){const e=we();for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.every((t=>null===e||void 0===e?void 0:e.includes(t)))},useIncomingVideoSettings:()=>{const e=ne();return ge(e.dynascaleManager.incomingVideoSettings$)},useIsCallCaptioningInProgress:()=>{const{captioning$:e}=be();return ge(e)},useIsCallHLSBroadcastingInProgress:()=>{const{egress$:e}=be(),t=ge(e);return!!t&&t.broadcasting},useIsCallLive:()=>{const{backstage$:e}=be();return!ge(e)},useIsCallRecordingInProgress:ye,useIsCallTranscribingInProgress:()=>{const{transcribing$:e}=be();return ge(e)},useLocalParticipant:()=>{const{localParticipant$:e}=be();return ge(e)},useMicrophoneState:()=>{const e=ne(),{microphone:t}=e,{state:n}=t,s=ge(n.mediaStream$),r=ge(n.selectedDevice$),{getDevices:o}=Te(t),a=ge(n.hasBrowserPermission$),c=ge(n.isPromptingPermission$),l=ge(n.speakingWhileMuted$);return(0,i.A)({microphone:t,mediaStream:s,get devices(){return o()},selectedDevice:r,hasBrowserPermission:a,isPromptingPermission:c,isSpeakingWhileMuted:l},Se(ge(n.status$),ge(n.optimisticStatus$)))},useOwnCapabilities:we,useParticipantCount:()=>{const{participantCount$:e}=be();return ge(e)},useParticipants:function(){let{sortBy:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{participants$:t}=be(),n=ge(t);return(0,o.useMemo)((()=>e?[...n].sort(e):n),[n,e])},useRemoteParticipants:()=>{const{remoteParticipants$:e}=be();return ge(e)},useScreenShareState:()=>{const e=ne(),{screenShare:t}=e;return(0,i.A)({screenShare:t,mediaStream:ge(t.state.mediaStream$)},Se(ge(t.state.status$),ge(t.state.optimisticStatus$)))},useSpeakerState:()=>{if((()=>{var e;return"undefined"!==typeof navigator&&"reactnative"===(null===(e=navigator.product)||void 0===e?void 0:e.toLowerCase())})())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");const e=ne(),{speaker:t}=e,{getDevices:n}=Te(t),i=ge(t.state.selectedDevice$);return{speaker:t,get devices(){return n()},selectedDevice:i,isDeviceSelectionSupported:t.state.isDeviceSelectionSupported}}});const ke=()=>Ce,Ee=e=>{let{canRequestOnly:t,hasPermissionsOnly:n,requiredGrants:i,requireAll:s=!0,children:o}=e;const a=ne(),{useCallSettings:c,useOwnCapabilities:l}=ke(),u=l(),d=c(),h=i[s?"every":"some"]((e=>null===u||void 0===u?void 0:u.includes(e)));if(n)return h?(0,r.jsx)(r.Fragment,{children:o}):null;const p=i.some((e=>null===a||void 0===a?void 0:a.permissionsContext.canRequest(e,d)));return t?p?(0,r.jsx)(r.Fragment,{children:o}):null:h||p?(0,r.jsx)(r.Fragment,{children:o}):null}},6950:(e,t,n)=>{"use strict";n.d(t,{f:()=>s});var i=n(7827),s={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=s.delegate;return(null===o||void 0===o?void 0:o.setTimeout)?o.setTimeout.apply(o,(0,i.fX)([e,t],(0,i.zs)(n))):setTimeout.apply(void 0,(0,i.fX)([e,t],(0,i.zs)(n)))},clearTimeout:function(e){var t=s.delegate;return((null===t||void 0===t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},7341:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(3235),s=n(4414);const r=(0,i.A)((0,s.jsx)("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11z"}),"Videocam")},7391:(e,t,n)=>{"use strict";function i(e){return new TypeError("You provided "+(null!==e&&"object"===typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}n.d(t,{L:()=>i})},7493:(e,t,n)=>{"use strict";n.d(t,{cV:()=>bc,iP:()=>dc,iV:()=>Ll,Ko:()=>Ma,pI:()=>rr,mg:()=>Va,hc:()=>Kr,Hq:()=>ku,cy:()=>Zo,SJ:()=>qa,B6:()=>oc,Fv:()=>Ja,Mc:()=>za,sf:()=>Ga,aV:()=>$a,T4:()=>Ka,bT:()=>cc,Vz:()=>Za,x8:()=>Pc,ND:()=>ac});var i={};n.r(i),n.d(i,{fixNegotiationNeeded:()=>D,shimAddTrackRemoveTrack:()=>O,shimAddTrackRemoveTrackWithNative:()=>x,shimGetDisplayMedia:()=>E,shimGetSendersWithDtmf:()=>I,shimGetStats:()=>A,shimGetUserMedia:()=>k,shimMediaStream:()=>_,shimOnTrack:()=>R,shimPeerConnection:()=>N,shimSenderReceiverGetStats:()=>P});var s={};n.r(s),n.d(s,{shimAddTransceiver:()=>q,shimCreateAnswer:()=>J,shimCreateOffer:()=>$,shimGetDisplayMedia:()=>L,shimGetParameters:()=>W,shimGetUserMedia:()=>j,shimOnTrack:()=>U,shimPeerConnection:()=>F,shimRTCDataChannel:()=>H,shimReceiverGetStats:()=>V,shimRemoveStream:()=>B,shimSenderGetStats:()=>M});var r={};n.r(r),n.d(r,{shimAudioContext:()=>te,shimCallbacksAPI:()=>K,shimConstraints:()=>X,shimCreateOfferLegacy:()=>ee,shimGetUserMedia:()=>Y,shimLocalStreamsAPI:()=>z,shimRTCIceServerUrls:()=>Z,shimRemoteStreamsAPI:()=>G,shimTrackEventTransceiver:()=>Q});var o={};n.r(o),n.d(o,{removeExtmapAllowMixed:()=>le,shimAddIceCandidateNullOrEmpty:()=>ue,shimConnectionState:()=>ce,shimMaxMessageSize:()=>oe,shimParameterlessSetLocalDescription:()=>de,shimRTCIceCandidate:()=>se,shimRTCIceCandidateRelayProtocol:()=>re,shimSendThrowTypeError:()=>ae});var a={};n.r(a),n.d(a,{hasBrowserEnv:()=>bn,hasStandardBrowserEnv:()=>wn,hasStandardBrowserWebWorkerEnv:()=>Sn,navigator:()=>yn,origin:()=>Tn});var c=n(816),l=n(45),u=n(9379);let d=!0,h=!0;function p(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function f(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);const r=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,r),s.apply(this,[e,r])};const r=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return r.apply(this,arguments);if(!this._eventMap[t].has(n))return r.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,r.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function m(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(d=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function g(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(h=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function v(){if("object"===typeof window){if(d)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function b(e,t){h&&console.warn(e+" is deprecated, please use "+t+" instead.")}function y(e){return"[object Object]"===Object.prototype.toString.call(e)}function w(e){return y(e)?Object.keys(e).reduce((function(t,n){const i=y(e[n]),s=i?w(e[n]):e[n],r=i&&!Object.keys(s).length;return void 0===s||r?t:Object.assign(t,{[n]:s})}),{}):e}function S(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?S(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{S(e,e.get(t),n)}))})))}function T(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;const r=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)})),r.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&S(e,n,s)}))})),s}const C=v;function k(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[s("min",n)]=i.ideal,t.optional.push(e),e={},e[s("max",n)]=i.ideal,t.optional.push(e)):(e[s("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,s){if(t.version>=61)return s(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let r=e.video.facingMode;r=r&&("object"===typeof r?r:{ideal:r});const o=t.version<66;if(r&&("user"===r.exact||"environment"===r.exact||"user"===r.ideal||"environment"===r.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===r.exact||"environment"===r.ideal?t=["back","rear"]:"user"!==r.exact&&"user"!==r.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let o=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!o&&n.length&&t.includes("back")&&(o=n[n.length-1]),o&&(e.video.deviceId=r.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),C("chrome: "+JSON.stringify(e)),s(e)}))}e.video=i(e.video)}return C("chrome: "+JSON.stringify(e)),s(e)},r=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){s(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(r(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return s(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(r(e))))))}}}function E(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,s=n.video&&n.video.height,r=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r||3}},i&&(n.video.mandatory.maxWidth=i),s&&(n.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function _(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function R(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const s=new Event("track");s.track=n.track,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const s=new Event("track");s.track=n,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else f(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function I(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let s=n.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function A(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const s=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},r=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(r(s(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(r(s(t)))},n])})).then(n,i)}}function P(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>T(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),f(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>T(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function x(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),s.apply(this,arguments)}}function O(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return x(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const s=e.RTCPeerConnection.prototype.removeStream;function r(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const s=this._streams[n.id];if(s)s.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=r(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>r(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:r(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function N(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function D(e,t){f(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}function j(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){b("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function L(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function U(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function F(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,s,r]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!s)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(i){if("TypeError"!==i.name)throw i;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(s,r)}}function M(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function V(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),f(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function B(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){b("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function H(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function q(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function W(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function $(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function J(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function z(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function G(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function K(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,s=t.setLocalDescription,r=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],s=i.apply(this,[n]);return t?(s.then(e,t),Promise.resolve()):s};let a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function Y(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(X(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function X(e){return e&&void 0!==e.video?Object.assign({},e,{video:w(e.video)}):e}function Z(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(b("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Q(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ee(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function te(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var ne=n(9569),ie=n.n(ne);function se(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=ie().parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,f(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function re(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||f(e,"icecandidate",(e=>{if(e.candidate){const t=ie().parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function oe(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=ie().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=ie().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const s=ie().matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?i=parseInt(s[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let s;s=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const r={};Object.defineProperty(r,"maxMessageSize",{get:()=>s}),this._sctp=r}return n.apply(this,arguments)}}function ae(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},f(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function ce(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function le(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function ue(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function de(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=v,a=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(p(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(p(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(p(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=p(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),c={browserDetails:a,commonShim:o,extractVersion:p,disableLog:m,disableWarnings:g,sdp:ne};switch(a.browser){case"chrome":if(!i||!N||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),c;if(null===a.version)return n("Chrome shim can not determine version, not shimming."),c;n("adapter.js shimming chrome."),c.browserShim=i,ue(e,a),de(e),k(e,a),_(e),N(e,a),R(e),O(e,a),I(e),A(e),P(e),D(e,a),se(e),re(e),ce(e),oe(e,a),ae(e),le(e,a);break;case"firefox":if(!s||!F||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),c;n("adapter.js shimming firefox."),c.browserShim=s,ue(e,a),de(e),j(e,a),F(e,a),U(e),B(e),M(e),V(e),H(e),q(e),W(e),$(e),J(e),se(e),ce(e),oe(e,a),ae(e);break;case"safari":if(!r||!t.shimSafari)return n("Safari shim is not included in this adapter release."),c;n("adapter.js shimming safari."),c.browserShim=r,ue(e,a),de(e),Z(e),ee(e),K(e),z(e),G(e),Q(e),Y(e),te(e),se(e),re(e),oe(e,a),ae(e),le(e,a);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const he=Symbol.for("protobuf-ts/message-type");function pe(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let s=e.charAt(i);"_"==s?t=!0:/\d/.test(s)?(n.push(s),t=!0):t?(n.push(s.toUpperCase()),t=!1):0==i?n.push(s.toLowerCase()):n.push(s)}return n.join("")}var fe,me,ge;function ve(e){var t,n,i,s;return e.localName=null!==(t=e.localName)&&void 0!==t?t:pe(e.name),e.jsonName=null!==(n=e.jsonName)&&void 0!==n?n:pe(e.name),e.repeat=null!==(i=e.repeat)&&void 0!==i?i:ge.NO,e.opt=null!==(s=e.opt)&&void 0!==s?s:!e.repeat&&(!e.oneof&&"message"==e.kind),e}function be(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(fe||(fe={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(me||(me={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(ge||(ge={}));class ye{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}prepare(){if(this.data)return;const e=[],t=[],n=[];for(let i of this.fields)if(i.oneof)n.includes(i.oneof)||(n.push(i.oneof),e.push(i.oneof),t.push(i.oneof));else switch(t.push(i.localName),i.kind){case"scalar":case"enum":i.opt&&!i.repeat||e.push(i.localName);break;case"message":i.repeat&&e.push(i.localName);break;case"map":e.push(i.localName)}this.data={req:e,known:t,oneofs:Object.values(n)}}is(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t<0)return!0;if(null===e||void 0===e||"object"!=typeof e)return!1;this.prepare();let i=Object.keys(e),s=this.data;if(i.length<s.req.length||s.req.some((e=>!i.includes(e))))return!1;if(!n&&i.some((e=>!s.known.includes(e))))return!1;if(t<1)return!0;for(const r of s.oneofs){const i=e[r];if(!be(i))return!1;if(void 0===i.oneofKind)continue;const s=this.fields.find((e=>e.localName===i.oneofKind));if(!s)return!1;if(!this.field(i[i.oneofKind],s,n,t))return!1}for(const r of this.fields)if(void 0===r.oneof&&!this.field(e[r.localName],r,n,t))return!1;return!0}field(e,t,n,i){let s=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:s?this.scalars(e,t.T,i,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:s?this.scalars(e,fe.INT32,i):this.scalar(e,fe.INT32);case"message":return void 0===e||(s?this.messages(e,t.T(),n,i):this.message(e,t.T(),n,i));case"map":if("object"!=typeof e||null===e)return!1;if(i<2)return!0;if(!this.mapKeys(e,t.K,i))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,i,t.V.L);case"enum":return this.scalars(Object.values(e),fe.INT32,i);case"message":return this.messages(Object.values(e),t.V.T(),n,i)}}return!0}message(e,t,n,i){return n?t.isAssignable(e,i):t.is(e,i)}messages(e,t,n,i){if(!Array.isArray(e))return!1;if(i<2)return!0;if(n){for(let s=0;s<e.length&&s<i;s++)if(!t.isAssignable(e[s],i-1))return!1}else for(let s=0;s<e.length&&s<i;s++)if(!t.is(e[s],i-1))return!1;return!0}scalar(e,t,n){let i=typeof e;switch(t){case fe.UINT64:case fe.FIXED64:case fe.INT64:case fe.SFIXED64:case fe.SINT64:switch(n){case me.BIGINT:return"bigint"==i;case me.NUMBER:return"number"==i&&!isNaN(e);default:return"string"==i}case fe.BOOL:return"boolean"==i;case fe.STRING:return"string"==i;case fe.BYTES:return e instanceof Uint8Array;case fe.DOUBLE:case fe.FLOAT:return"number"==i&&!isNaN(e);default:return"number"==i&&Number.isInteger(e)}}scalars(e,t,n,i){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e))for(let s=0;s<e.length&&s<n;s++)if(!this.scalar(e[s],t,i))return!1;return!0}mapKeys(e,t,n){let i=Object.keys(e);switch(t){case fe.INT32:case fe.FIXED32:case fe.SFIXED32:case fe.SINT32:case fe.UINT32:return this.scalars(i.slice(0,n).map((e=>parseInt(e))),t,n);case fe.BOOL:return this.scalars(i.slice(0,n).map((e=>"true"==e||"false"!=e&&e)),t,n);default:return this.scalars(i,t,n,me.STRING)}}}function we(e){let t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}function Se(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}let Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Ce=[];for(let Eu=0;Eu<Te.length;Eu++)Ce[Te[Eu].charCodeAt(0)]=Eu;function ke(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Ee(e,t,n){for(let r=0;r<28;r+=7){const i=e>>>r,s=!(i>>>7==0&&0==t),o=255&(s?128|i:i);if(n.push(o),!s)return}const i=e>>>28&15|(7&t)<<4,s=!(t>>3==0);if(n.push(255&(s?128|i:i)),s){for(let e=3;e<31;e+=7){const i=t>>>e,s=!(i>>>7==0),r=255&(s?128|i:i);if(n.push(r),!s)return}n.push(t>>>31&1)}}Ce["-".charCodeAt(0)]=Te.indexOf("+"),Ce["_".charCodeAt(0)]=Te.indexOf("/");const _e=4294967296;function Re(e){let t="-"==e[0];t&&(e=e.slice(1));const n=1e6;let i=0,s=0;function r(t,r){const o=Number(e.slice(t,r));s*=n,i=i*n+o,i>=_e&&(s+=i/_e|0,i%=_e)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),[t,i,s]}function Ie(e,t){if(t>>>0<=2097151)return""+(_e*t+(e>>>0));let n=(e>>>24|t<<8)>>>0&16777215,i=t>>16&65535,s=(16777215&e)+6777216*n+6710656*i,r=n+8147497*i,o=2*i,a=1e7;function c(e,t){let n=e?String(e):"";return t?"0000000".slice(n.length)+n:n}return s>=a&&(r+=Math.floor(s/a),s%=a),r>=a&&(o+=Math.floor(r/a),r%=a),c(o,0)+c(r,o)+c(s,1)}function Ae(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Pe(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}let xe;function Oe(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}!function(){const e=new DataView(new ArrayBuffer(8)),t=void 0!==globalThis.BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64;xe=t?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();const Ne=/^-?[0-9]+$/,De=4294967296,je=2147483648;class Le{constructor(e,t){this.lo=0|e,this.hi=0|t}isZero(){return 0==this.lo&&0==this.hi}toNumber(){let e=this.hi*De+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class Ue extends Le{static from(e){if(xe)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=xe.C(e);case"number":if(0===e)return this.ZERO;e=xe.C(e);case"bigint":if(!e)return this.ZERO;if(e<xe.UMIN)throw new Error("signed value for ulong");if(e>xe.UMAX)throw new Error("ulong too large");return xe.V.setBigUint64(0,e,!0),new Ue(xe.V.getInt32(0,!0),xe.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!Ne.test(e))throw new Error("string is no integer");let[t,n,i]=Re(e);if(t)throw new Error("signed value for ulong");return new Ue(n,i);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new Ue(e,e/De)}throw new Error("unknown value "+typeof e)}toString(){return xe?this.toBigInt().toString():Ie(this.lo,this.hi)}toBigInt(){return Oe(xe),xe.V.setInt32(0,this.lo,!0),xe.V.setInt32(4,this.hi,!0),xe.V.getBigUint64(0,!0)}}Ue.ZERO=new Ue(0,0);class Fe extends Le{static from(e){if(xe)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=xe.C(e);case"number":if(0===e)return this.ZERO;e=xe.C(e);case"bigint":if(!e)return this.ZERO;if(e<xe.MIN)throw new Error("signed long too small");if(e>xe.MAX)throw new Error("signed long too large");return xe.V.setBigInt64(0,e,!0),new Fe(xe.V.getInt32(0,!0),xe.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!Ne.test(e))throw new Error("string is no integer");let[t,n,i]=Re(e);if(t){if(i>je||i==je&&0!=n)throw new Error("signed long too small")}else if(i>=je)throw new Error("signed long too large");let s=new Fe(n,i);return t?s.negate():s;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new Fe(e,e/De):new Fe(-e,-e/De).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return 0!==(this.hi&je)}negate(){let e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new Fe(t,e)}toString(){if(xe)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+Ie(e.lo,e.hi)}return Ie(this.lo,this.hi)}toBigInt(){return Oe(xe),xe.V.setInt32(0,this.lo,!0),xe.V.setInt32(4,this.hi,!0),xe.V.getBigInt64(0,!0)}}function Me(e,t){if(!e)throw new Error(t)}Fe.ZERO=new Fe(0,0);function Ve(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function Be(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function He(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}function qe(e,t){switch(t){case me.BIGINT:return e.toBigInt();case me.NUMBER:return e.toNumber();default:return e.toString()}}class We{constructor(e){this.info=e}prepare(){var e;if(void 0===this.fMap){this.fMap={};const t=null!==(e=this.info.fields)&&void 0!==e?e:[];for(const e of t)this.fMap[e.name]=e,this.fMap[e.jsonName]=e,this.fMap[e.localName]=e}}assert(e,t,n){if(!e){let e=we(n);throw"number"!=e&&"boolean"!=e||(e=n.toString()),new Error("Cannot parse JSON ".concat(e," for ").concat(this.info.typeName,"#").concat(t))}}read(e,t,n){this.prepare();const i=[];for(const[s,r]of Object.entries(e)){const e=this.fMap[s];if(!e){if(!n.ignoreUnknownFields)throw new Error("Found unknown field while reading ".concat(this.info.typeName," from JSON format. JSON key: ").concat(s));continue}const o=e.localName;let a;if(e.oneof){if(null===r&&("enum"!==e.kind||"google.protobuf.NullValue"!==e.T()[0]))continue;if(i.includes(e.oneof))throw new Error('Multiple members of the oneof group "'.concat(e.oneof,'" of ').concat(this.info.typeName," are present in JSON."));i.push(e.oneof),a=t[e.oneof]={oneofKind:o}}else a=t;if("map"==e.kind){if(null===r)continue;this.assert(Se(r),e.name,r);const t=a[o];for(const[i,s]of Object.entries(r)){let r;switch(this.assert(null!==s,e.name+" map value",null),e.V.kind){case"message":r=e.V.T().internalJsonRead(s,n);break;case"enum":if(r=this.enum(e.V.T(),s,e.name,n.ignoreUnknownFields),!1===r)continue;break;case"scalar":r=this.scalar(s,e.V.T,e.V.L,e.name)}this.assert(void 0!==r,e.name+" map value",s);let o=i;e.K==fe.BOOL&&(o="true"==o||"false"!=o&&o),o=this.scalar(o,e.K,me.STRING,e.name).toString(),t[o]=r}}else if(e.repeat){if(null===r)continue;this.assert(Array.isArray(r),e.name,r);const t=a[o];for(const i of r){let s;switch(this.assert(null!==i,e.name,null),e.kind){case"message":s=e.T().internalJsonRead(i,n);break;case"enum":if(s=this.enum(e.T(),i,e.name,n.ignoreUnknownFields),!1===s)continue;break;case"scalar":s=this.scalar(i,e.T,e.L,e.name)}this.assert(void 0!==s,e.name,r),t.push(s)}}else switch(e.kind){case"message":if(null===r&&"google.protobuf.Value"!=e.T().typeName){this.assert(void 0===e.oneof,e.name+" (oneof member)",null);continue}a[o]=e.T().internalJsonRead(r,n,a[o]);break;case"enum":if(null===r)continue;let t=this.enum(e.T(),r,e.name,n.ignoreUnknownFields);if(!1===t)continue;a[o]=t;break;case"scalar":if(null===r)continue;a[o]=this.scalar(r,e.T,e.L,e.name)}}}enum(e,t,n,i){if("google.protobuf.NullValue"==e[0]&&Me(null===t||"NULL_VALUE"===t,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum ").concat(e[0]," only accepts null.")),null===t)return 0;switch(typeof t){case"number":return Me(Number.isInteger(t),"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum can only be integral number, got ").concat(t,".")),t;case"string":let s=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(s=t.substring(e[2].length));let r=e[1][s];return("undefined"!==typeof r||!i)&&(Me("number"==typeof r,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum ").concat(e[0],' has no value for "').concat(t,'".')),r)}Me(!1,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", cannot parse enum value from ").concat(typeof t,'".'))}scalar(e,t,n,i){let s;try{switch(t){case fe.DOUBLE:case fe.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){s="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){s="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;let i=Number(e);if(Number.isNaN(i)){s="not a number";break}if(!Number.isFinite(i)){s="too large or small";break}return t==fe.FLOAT&&He(i),i;case fe.INT32:case fe.FIXED32:case fe.SFIXED32:case fe.SINT32:case fe.UINT32:if(null===e)return 0;let r;if("number"==typeof e?r=e:""===e?s="empty string":"string"==typeof e&&(e.trim().length!==e.length?s="extra whitespace":r=Number(e)),void 0===r)break;return t==fe.UINT32?Be(r):Ve(r),r;case fe.INT64:case fe.SFIXED64:case fe.SINT64:if(null===e)return qe(Fe.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return qe(Fe.from(e),n);case fe.FIXED64:case fe.UINT64:if(null===e)return qe(Ue.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return qe(Ue.from(e),n);case fe.BOOL:if(null===e)return!1;if("boolean"!==typeof e)break;return e;case fe.STRING:if(null===e)return"";if("string"!==typeof e){s="extra whitespace";break}try{encodeURIComponent(e)}catch(s){s="invalid UTF8";break}return e;case fe.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!==typeof e)break;return function(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),s=0,r=0,o=0;for(let a=0;a<e.length;a++){if(n=Ce[e.charCodeAt(a)],void 0===n)switch(e[a]){case"=":r=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:o=n,r=1;break;case 1:i[s++]=o<<2|(48&n)>>4,o=n,r=2;break;case 2:i[s++]=(15&o)<<4|(60&n)>>2,o=n,r=3;break;case 3:i[s++]=(3&o)<<6|n,r=0}}if(1==r)throw Error("invalid base64 string.");return i.subarray(0,s)}(e)}}catch(r){s=r.message}this.assert(!1,i+(s?" - "+s:""),e)}}class $e{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}write(e,t){const n={},i=e;for(const s of this.fields){if(!s.oneof){let e=this.field(s,i[s.localName],t);void 0!==e&&(n[t.useProtoFieldName?s.name:s.jsonName]=e);continue}const e=i[s.oneof];if(e.oneofKind!==s.localName)continue;const r="scalar"==s.kind||"enum"==s.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let o=this.field(s,e[s.localName],r);Me(void 0!==o),n[t.useProtoFieldName?s.name:s.jsonName]=o}return n}field(e,t,n){let i;if("map"==e.kind){Me("object"==typeof t&&null!==t);const s={};switch(e.V.kind){case"scalar":for(const[n,o]of Object.entries(t)){const t=this.scalar(e.V.T,o,e.name,!1,!0);Me(void 0!==t),s[n.toString()]=t}break;case"message":const i=e.V.T();for(const[o,a]of Object.entries(t)){const t=this.message(i,a,e.name,n);Me(void 0!==t),s[o.toString()]=t}break;case"enum":const r=e.V.T();for(const[o,a]of Object.entries(t)){Me(void 0===a||"number"==typeof a);const t=this.enum(r,a,e.name,!1,!0,n.enumAsInteger);Me(void 0!==t),s[o.toString()]=t}}(n.emitDefaultValues||Object.keys(s).length>0)&&(i=s)}else if(e.repeat){Me(Array.isArray(t));const s=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++){const i=this.scalar(e.T,t[n],e.name,e.opt,!0);Me(void 0!==i),s.push(i)}break;case"enum":const i=e.T();for(let o=0;o<t.length;o++){Me(void 0===t[o]||"number"==typeof t[o]);const r=this.enum(i,t[o],e.name,e.opt,!0,n.enumAsInteger);Me(void 0!==r),s.push(r)}break;case"message":const r=e.T();for(let o=0;o<t.length;o++){const i=this.message(r,t[o],e.name,n);Me(void 0!==i),s.push(i)}}(n.emitDefaultValues||s.length>0||n.emitDefaultValues)&&(i=s)}else switch(e.kind){case"scalar":i=this.scalar(e.T,t,e.name,e.opt,n.emitDefaultValues);break;case"enum":i=this.enum(e.T(),t,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":i=this.message(e.T(),t,e.name,n)}return i}enum(e,t,n,i,s,r){if("google.protobuf.NullValue"==e[0])return s||i?null:void 0;if(void 0!==t){if(0!==t||s||i)return Me("number"==typeof t),Me(Number.isInteger(t)),r||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else Me(i)}message(e,t,n,i){return void 0===t?i.emitDefaultValues?null:void 0:e.internalJsonWrite(t,i)}scalar(e,t,n,i,s){if(void 0===t)return void Me(i);const r=s||i;switch(e){case fe.INT32:case fe.SFIXED32:case fe.SINT32:return 0===t?r?0:void 0:(Ve(t),t);case fe.FIXED32:case fe.UINT32:return 0===t?r?0:void 0:(Be(t),t);case fe.FLOAT:He(t);case fe.DOUBLE:return 0===t?r?0:void 0:(Me("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case fe.STRING:return""===t?r?"":void 0:(Me("string"==typeof t),t);case fe.BOOL:return!1===t?!r&&void 0:(Me("boolean"==typeof t),t);case fe.UINT64:case fe.FIXED64:Me("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let e=Ue.from(t);if(e.isZero()&&!r)return;return e.toString();case fe.INT64:case fe.SFIXED64:case fe.SINT64:Me("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let n=Fe.from(t);if(n.isZero()&&!r)return;return n.toString();case fe.BYTES:return Me(t instanceof Uint8Array),t.byteLength?function(e){let t,n="",i=0,s=0;for(let r=0;r<e.length;r++)switch(t=e[r],i){case 0:n+=Te[t>>2],s=(3&t)<<4,i=1;break;case 1:n+=Te[s|t>>4],s=(15&t)<<2,i=2;break;case 2:n+=Te[s|t>>6],n+=Te[63&t],i=0}return i&&(n+=Te[s],n+="=",1==i&&(n+="=")),n}(t):r?"":void 0}}}var Je,ze;function Ge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:me.STRING;switch(e){case fe.BOOL:return!1;case fe.UINT64:case fe.FIXED64:return qe(Ue.ZERO,t);case fe.INT64:case fe.SFIXED64:case fe.SINT64:return qe(Fe.ZERO,t);case fe.DOUBLE:case fe.FLOAT:return 0;case fe.BYTES:return new Uint8Array(0);case fe.STRING:return"";default:return 0}}!function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(n,i,s,r,o)=>{(t(i)?i[e.symbol]:i[e.symbol]=[]).push({no:s,wireType:r,data:o})},e.onWrite=(t,n,i)=>{for(let{no:s,wireType:r,data:o}of e.list(n))i.tag(s,r).raw(o)},e.list=(n,i)=>{if(t(n)){let t=n[e.symbol];return i?t.filter((e=>e.no==i)):t}return[]},e.last=(t,n)=>e.list(t,n).slice(-1)[0];const t=t=>t&&Array.isArray(t[e.symbol])}(Je||(Je={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(ze||(ze={}));class Ke{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((e=>[e.no,e])))}}read(e,t,n,i){this.prepare();const s=void 0===i?e.len:e.pos+i;for(;e.pos<s;){const[i,s]=e.tag(),r=this.fieldNoToField.get(i);if(!r){let r=n.readUnknownField;if("throw"==r)throw new Error("Unknown field ".concat(i," (wire type ").concat(s,") for ").concat(this.info.typeName));let o=e.skip(s);!1!==r&&(!0===r?Je.onRead:r)(this.info.typeName,t,i,s,o);continue}let o=t,a=r.repeat,c=r.localName;switch(r.oneof&&(o=o[r.oneof],o.oneofKind!==c&&(o=t[r.oneof]={oneofKind:c})),r.kind){case"scalar":case"enum":let t="enum"==r.kind?fe.INT32:r.T,i="scalar"==r.kind?r.L:void 0;if(a){let n=o[c];if(s==ze.LengthDelimited&&t!=fe.STRING&&t!=fe.BYTES){let s=e.uint32()+e.pos;for(;e.pos<s;)n.push(this.scalar(e,t,i))}else n.push(this.scalar(e,t,i))}else o[c]=this.scalar(e,t,i);break;case"message":if(a){let t=o[c],i=r.T().internalBinaryRead(e,e.uint32(),n);t.push(i)}else o[c]=r.T().internalBinaryRead(e,e.uint32(),n,o[c]);break;case"map":let[l,u]=this.mapEntry(r,e,n);o[c][l]=u}}}mapEntry(e,t,n){let i,s,r=t.uint32(),o=t.pos+r;for(;t.pos<o;){let[r,o]=t.tag();switch(r){case 1:i=e.K==fe.BOOL?t.bool().toString():this.scalar(t,e.K,me.STRING);break;case 2:switch(e.V.kind){case"scalar":s=this.scalar(t,e.V.T,e.V.L);break;case"enum":s=t.int32();break;case"message":s=e.V.T().internalBinaryRead(t,t.uint32(),n)}break;default:throw new Error("Unknown field ".concat(r," (wire type ").concat(o,") in map entry for ").concat(this.info.typeName,"#").concat(e.name))}}if(void 0===i){let t=Ge(e.K);i=e.K==fe.BOOL?t.toString():t}if(void 0===s)switch(e.V.kind){case"scalar":s=Ge(e.V.T,e.V.L);break;case"enum":s=0;break;case"message":s=e.V.T().create()}return[i,s]}scalar(e,t,n){switch(t){case fe.INT32:return e.int32();case fe.STRING:return e.string();case fe.BOOL:return e.bool();case fe.DOUBLE:return e.double();case fe.FLOAT:return e.float();case fe.INT64:return qe(e.int64(),n);case fe.UINT64:return qe(e.uint64(),n);case fe.FIXED64:return qe(e.fixed64(),n);case fe.FIXED32:return e.fixed32();case fe.BYTES:return e.bytes();case fe.UINT32:return e.uint32();case fe.SFIXED32:return e.sfixed32();case fe.SFIXED64:return qe(e.sfixed64(),n);case fe.SINT32:return e.sint32();case fe.SINT64:return qe(e.sint64(),n)}}}class Ye{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort(((e,t)=>e.no-t.no))}}write(e,t,n){this.prepare();for(const s of this.fields){let i,r,o=s.repeat,a=s.localName;if(s.oneof){const t=e[s.oneof];if(t.oneofKind!==a)continue;i=t[a],r=!0}else i=e[a],r=!1;switch(s.kind){case"scalar":case"enum":let e="enum"==s.kind?fe.INT32:s.T;if(o)if(Me(Array.isArray(i)),o==ge.PACKED)this.packed(t,e,s.no,i);else for(const n of i)this.scalar(t,e,s.no,n,!0);else void 0===i?Me(s.opt):this.scalar(t,e,s.no,i,r||s.opt);break;case"message":if(o){Me(Array.isArray(i));for(const e of i)this.message(t,n,s.T(),s.no,e)}else this.message(t,n,s.T(),s.no,i);break;case"map":Me("object"==typeof i&&null!==i);for(const[r,o]of Object.entries(i))this.mapEntry(t,n,s,r,o)}}let i=n.writeUnknownFields;!1!==i&&(!0===i?Je.onWrite:i)(this.info.typeName,e,t)}mapEntry(e,t,n,i,s){e.tag(n.no,ze.LengthDelimited),e.fork();let r=i;switch(n.K){case fe.INT32:case fe.FIXED32:case fe.UINT32:case fe.SFIXED32:case fe.SINT32:r=Number.parseInt(i);break;case fe.BOOL:Me("true"==i||"false"==i),r="true"==i}switch(this.scalar(e,n.K,1,r,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,s,!0);break;case"enum":this.scalar(e,fe.INT32,2,s,!0);break;case"message":this.message(e,t,n.V.T(),2,s)}e.join()}message(e,t,n,i,s){void 0!==s&&(n.internalBinaryWrite(s,e.tag(i,ze.LengthDelimited).fork(),t),e.join())}scalar(e,t,n,i,s){let[r,o,a]=this.scalarInfo(t,i);a&&!s||(e.tag(n,r),e[o](i))}packed(e,t,n,i){if(!i.length)return;Me(t!==fe.BYTES&&t!==fe.STRING),e.tag(n,ze.LengthDelimited),e.fork();let[,s]=this.scalarInfo(t);for(let r=0;r<i.length;r++)e[s](i[r]);e.join()}scalarInfo(e,t){let n,i=ze.Varint,s=void 0===t,r=0===t;switch(e){case fe.INT32:n="int32";break;case fe.STRING:r=s||!t.length,i=ze.LengthDelimited,n="string";break;case fe.BOOL:r=!1===t,n="bool";break;case fe.UINT32:n="uint32";break;case fe.DOUBLE:i=ze.Bit64,n="double";break;case fe.FLOAT:i=ze.Bit32,n="float";break;case fe.INT64:r=s||Fe.from(t).isZero(),n="int64";break;case fe.UINT64:r=s||Ue.from(t).isZero(),n="uint64";break;case fe.FIXED64:r=s||Ue.from(t).isZero(),i=ze.Bit64,n="fixed64";break;case fe.BYTES:r=s||!t.byteLength,i=ze.LengthDelimited,n="bytes";break;case fe.FIXED32:i=ze.Bit32,n="fixed32";break;case fe.SFIXED32:i=ze.Bit32,n="sfixed32";break;case fe.SFIXED64:r=s||Fe.from(t).isZero(),i=ze.Bit64,n="sfixed64";break;case fe.SINT32:n="sint32";break;case fe.SINT64:r=s||Fe.from(t).isZero(),n="sint64"}return[i,n,s||r]}}function Xe(e,t,n){let i,s,r=n;for(let o of e.fields){let e=o.localName;if(o.oneof){const n=r[o.oneof];if(void 0==(null===n||void 0===n?void 0:n.oneofKind))continue;if(i=n[e],s=t[o.oneof],s.oneofKind=n.oneofKind,void 0==i){delete s[e];continue}}else if(i=r[e],s=t,void 0==i)continue;switch(o.repeat&&(s[e].length=i.length),o.kind){case"scalar":case"enum":if(o.repeat)for(let n=0;n<i.length;n++)s[e][n]=i[n];else s[e]=i;break;case"message":let t=o.T();if(o.repeat)for(let n=0;n<i.length;n++)s[e][n]=t.create(i[n]);else void 0===s[e]?s[e]=t.create(i):t.mergePartial(s[e],i);break;case"map":switch(o.V.kind){case"scalar":case"enum":Object.assign(s[e],i);break;case"message":let t=o.V.T();for(let n of Object.keys(i))s[e][n]=t.create(i[n])}}}}const Ze={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},Qe={ignoreUnknownFields:!1};function et(e,t){var n,i;let s=Object.assign(Object.assign({},e),t);return s.typeRegistry=[...null!==(n=null===e||void 0===e?void 0:e.typeRegistry)&&void 0!==n?n:[],...null!==(i=null===t||void 0===t?void 0:t.typeRegistry)&&void 0!==i?i:[]],s}const tt=Object.values;function nt(e,t,n){if(t===n)return!0;if(e!==fe.BYTES)return!1;let i=t,s=n;if(i.length!==s.length)return!1;for(let r=0;r<i.length;r++)if(i[r]!=s[r])return!1;return!0}function it(e,t,n){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!nt(e,t[i],n[i]))return!1;return!0}function st(e,t,n){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!e.equals(t[i],n[i]))return!1;return!0}const rt={writeUnknownFields:!0,writerFactory:()=>new ot};class ot{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Be(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return Ve(e),Ae(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){He(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Be(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Ve(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Ve(e),Ae(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Fe.from(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Ue.from(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=Fe.from(e);return Ee(t.lo,t.hi,this.buf),this}sint64(e){let t=Fe.from(e),n=t.hi>>31;return Ee(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Ue.from(e);return Ee(t.lo,t.hi,this.buf),this}}const at={readUnknownField:!0,readerFactory:e=>new ct(e)};class ct{constructor(e,t){this.varint64=ke,this.uint32=Pe,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case ze.Varint:for(;128&this.buf[this.pos++];);break;case ze.Bit64:this.pos+=4;case ze.Bit32:this.pos+=4;break;case ze.LengthDelimited:let t=this.uint32();this.pos+=t;break;case ze.StartGroup:let n;for(;(n=this.tag()[1])!==ze.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return new Fe(...this.varint64())}uint64(){return new Ue(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,new Fe(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new Ue(this.sfixed32(),this.sfixed32())}sfixed64(){return new Fe(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}const lt=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({}));class ut{constructor(e,t,n){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(ve),this.options=null!==n&&void 0!==n?n:{},this.messagePrototype=Object.create(null,Object.assign(Object.assign({},lt),{[he]:{value:this}})),this.refTypeCheck=new ye(this),this.refJsonReader=new We(this),this.refJsonWriter=new $e(this),this.refBinReader=new Ke(this),this.refBinWriter=new Ye(this)}create(e){let t=function(e){const t=e.messagePrototype?Object.create(e.messagePrototype):Object.defineProperty({},he,{value:e});for(let n of e.fields){let e=n.localName;if(!n.opt)if(n.oneof)t[n.oneof]={oneofKind:void 0};else if(n.repeat)t[e]=[];else switch(n.kind){case"scalar":t[e]=Ge(n.T,n.L);break;case"enum":t[e]=0;break;case"map":t[e]={}}}return t}(this);return void 0!==e&&Xe(this,t,e),t}clone(e){let t=this.create();return Xe(this,t,e),t}equals(e,t){return function(e,t,n){if(t===n)return!0;if(!t||!n)return!1;for(let i of e.fields){let e=i.localName,s=i.oneof?t[i.oneof][e]:t[e],r=i.oneof?n[i.oneof][e]:n[e];switch(i.kind){case"enum":case"scalar":let e="enum"==i.kind?fe.INT32:i.T;if(!(i.repeat?it(e,s,r):nt(e,s,r)))return!1;break;case"map":if(!("message"==i.V.kind?st(i.V.T(),tt(s),tt(r)):it("enum"==i.V.kind?fe.INT32:i.V.T,tt(s),tt(r))))return!1;break;case"message":let t=i.T();if(!(i.repeat?st(t,s,r):t.equals(s,r)))return!1}}return!0}(this,e,t)}is(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultCheckDepth;return this.refTypeCheck.is(e,t,!1)}isAssignable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultCheckDepth;return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){Xe(this,e,t)}fromBinary(e,t){let n=function(e){return e?Object.assign(Object.assign({},at),e):at}(t);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}fromJson(e,t){return this.internalJsonRead(e,function(e){return e?Object.assign(Object.assign({},Qe),e):Qe}(t))}fromJsonString(e,t){let n=JSON.parse(e);return this.fromJson(n,t)}toJson(e,t){return this.internalJsonWrite(e,function(e){return e?Object.assign(Object.assign({},Ze),e):Ze}(t))}toJsonString(e,t){var n;let i=this.toJson(e,t);return JSON.stringify(i,null,null!==(n=null===t||void 0===t?void 0:t.prettySpaces)&&void 0!==n?n:0)}toBinary(e,t){let n=function(e){return e?Object.assign(Object.assign({},rt),e):rt}(t);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}internalJsonRead(e,t,n){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){let i=null!==n&&void 0!==n?n:this.create();return this.refJsonReader.read(e,i,t),i}throw new Error("Unable to parse message ".concat(this.typeName," from JSON ").concat(we(e),"."))}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,n){return this.refBinWriter.write(e,t,n),t}internalBinaryRead(e,t,n,i){let s=null!==i&&void 0!==i?i:this.create();return this.refBinReader.read(e,s,n,t),s}}function dt(e,t,n,i,s){var r,o,a,c;if("unary"==e){let e=(e,n,i)=>t.unary(e,n,i);for(const t of(null!==(r=i.interceptors)&&void 0!==r?r:[]).filter((e=>e.interceptUnary)).reverse()){const n=e;e=(e,i,s)=>t.interceptUnary(n,e,i,s)}return e(n,s,i)}if("serverStreaming"==e){let e=(e,n,i)=>t.serverStreaming(e,n,i);for(const t of(null!==(o=i.interceptors)&&void 0!==o?o:[]).filter((e=>e.interceptServerStreaming)).reverse()){const n=e;e=(e,i,s)=>t.interceptServerStreaming(n,e,i,s)}return e(n,s,i)}if("clientStreaming"==e){let e=(e,n)=>t.clientStreaming(e,n);for(const t of(null!==(a=i.interceptors)&&void 0!==a?a:[]).filter((e=>e.interceptClientStreaming)).reverse()){const n=e;e=(e,i)=>t.interceptClientStreaming(n,e,i)}return e(n,i)}if("duplex"==e){let e=(e,n)=>t.duplex(e,n);for(const t of(null!==(c=i.interceptors)&&void 0!==c?c:[]).filter((e=>e.interceptDuplex)).reverse()){const n=e;e=(e,i)=>t.interceptDuplex(n,e,i)}return e(n,i)}!function(e,t){throw new Error(null!==t&&void 0!==t?t:"Unexpected object: "+e)}(e)}class ht extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UNKNOWN",n=arguments.length>2?arguments[2]:void 0;super(e),this.name="RpcError",Object.setPrototypeOf(this,new.target.prototype),this.code=t,this.meta=null!==n&&void 0!==n?n:{}}toString(){const e=[this.name+": "+this.message];this.code&&(e.push(""),e.push("Code: "+this.code)),this.serviceName&&this.methodName&&e.push("Method: "+this.serviceName+"/"+this.methodName);let t=Object.entries(this.meta);if(t.length){e.push(""),e.push("Meta:");for(let[n,i]of t)e.push("  ".concat(n,": ").concat(i))}return e.join("\n")}}function pt(e,t){return function(){return e.apply(t,arguments)}}const{toString:ft}=Object.prototype,{getPrototypeOf:mt}=Object,{iterator:gt,toStringTag:vt}=Symbol,bt=(yt=Object.create(null),e=>{const t=ft.call(e);return yt[t]||(yt[t]=t.slice(8,-1).toLowerCase())});var yt;const wt=e=>(e=e.toLowerCase(),t=>bt(t)===e),St=e=>t=>typeof t===e,{isArray:Tt}=Array,Ct=St("undefined");const kt=wt("ArrayBuffer");const Et=St("string"),_t=St("function"),Rt=St("number"),It=e=>null!==e&&"object"===typeof e,At=e=>{if("object"!==bt(e))return!1;const t=mt(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(vt in e)&&!(gt in e)},Pt=wt("Date"),xt=wt("File"),Ot=wt("Blob"),Nt=wt("FileList"),Dt=wt("URLSearchParams"),[jt,Lt,Ut,Ft]=["ReadableStream","Request","Response","Headers"].map(wt);function Mt(e,t){let n,i,{allOwnKeys:s=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Tt(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{const i=s?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let o;for(n=0;n<r;n++)o=i[n],t.call(null,e[o],o,e)}}function Vt(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,s=n.length;for(;s-- >0;)if(i=n[s],t===i.toLowerCase())return i;return null}const Bt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Ht=e=>!Ct(e)&&e!==Bt;const qt=(Wt="undefined"!==typeof Uint8Array&&mt(Uint8Array),e=>Wt&&e instanceof Wt);var Wt;const $t=wt("HTMLFormElement"),Jt=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),zt=wt("RegExp"),Gt=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};Mt(n,((n,s)=>{let r;!1!==(r=t(n,s,e))&&(i[s]=r||n)})),Object.defineProperties(e,i)};const Kt=wt("AsyncFunction"),Yt=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),i=[],Bt.addEventListener("message",(e=>{let{source:t,data:s}=e;t===Bt&&s===n&&i.length&&i.shift()()}),!1),e=>{i.push(e),Bt.postMessage(n,"*")}):e=>setTimeout(e);var n,i})("function"===typeof setImmediate,_t(Bt.postMessage)),Xt="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Bt):"undefined"!==typeof process&&process.nextTick||Yt,Zt={isArray:Tt,isArrayBuffer:kt,isBuffer:function(e){return null!==e&&!Ct(e)&&null!==e.constructor&&!Ct(e.constructor)&&_t(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||_t(e.append)&&("formdata"===(t=bt(e))||"object"===t&&_t(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&kt(e.buffer),t},isString:Et,isNumber:Rt,isBoolean:e=>!0===e||!1===e,isObject:It,isPlainObject:At,isReadableStream:jt,isRequest:Lt,isResponse:Ut,isHeaders:Ft,isUndefined:Ct,isDate:Pt,isFile:xt,isBlob:Ot,isRegExp:zt,isFunction:_t,isStream:e=>It(e)&&_t(e.pipe),isURLSearchParams:Dt,isTypedArray:qt,isFileList:Nt,forEach:Mt,merge:function e(){const{caseless:t}=Ht(this)&&this||{},n={},i=(i,s)=>{const r=t&&Vt(n,s)||s;At(n[r])&&At(i)?n[r]=e(n[r],i):At(i)?n[r]=e({},i):Tt(i)?n[r]=i.slice():n[r]=i};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Mt(arguments[s],i);return n},extend:function(e,t,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Mt(t,((t,i)=>{n&&_t(t)?e[i]=pt(t,n):e[i]=t}),{allOwnKeys:i}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let s,r,o;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),r=s.length;r-- >0;)o=s[r],i&&!i(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&mt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:bt,kindOfTest:wt,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(Tt(e))return e;let t=e.length;if(!Rt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[gt]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:$t,hasOwnProperty:Jt,hasOwnProp:Jt,reduceDescriptors:Gt,freezeMethods:e=>{Gt(e,((t,n)=>{if(_t(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];_t(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return Tt(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Vt,global:Bt,isContextDefined:Ht,isSpecCompliantForm:function(e){return!!(e&&_t(e.append)&&"FormData"===e[vt]&&e[gt])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(It(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const s=Tt(e)?[]:{};return Mt(e,((e,t)=>{const r=n(e,i+1);!Ct(r)&&(s[t]=r)})),t[i]=void 0,s}}return e};return n(e,0)},isAsyncFn:Kt,isThenable:e=>e&&(It(e)||_t(e))&&_t(e.then)&&_t(e.catch),setImmediate:Yt,asap:Xt,isIterable:e=>null!=e&&_t(e[gt])};function Qt(e,t,n,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}Zt.inherits(Qt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Zt.toJSONObject(this.config),code:this.code,status:this.status}}});const en=Qt.prototype,tn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{tn[e]={value:e}})),Object.defineProperties(Qt,tn),Object.defineProperty(en,"isAxiosError",{value:!0}),Qt.from=(e,t,n,i,s,r)=>{const o=Object.create(en);return Zt.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Qt.call(o,e.message,t,n,i,s),o.cause=e,o.name=e.name,r&&Object.assign(o,r),o};const nn=Qt;function sn(e){return Zt.isPlainObject(e)||Zt.isArray(e)}function rn(e){return Zt.endsWith(e,"[]")?e.slice(0,-2):e}function on(e,t,n){return e?e.concat(t).map((function(e,t){return e=rn(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const an=Zt.toFlatObject(Zt,{},null,(function(e){return/^is[A-Z]/.test(e)}));const cn=function(e,t,n){if(!Zt.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=Zt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Zt.isUndefined(t[e])}))).metaTokens,s=n.visitor||l,r=n.dots,o=n.indexes,a=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Zt.isSpecCompliantForm(t);if(!Zt.isFunction(s))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Zt.isDate(e))return e.toISOString();if(!a&&Zt.isBlob(e))throw new nn("Blob is not supported. Use a Buffer instead.");return Zt.isArrayBuffer(e)||Zt.isTypedArray(e)?a&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,s){let a=e;if(e&&!s&&"object"===typeof e)if(Zt.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(Zt.isArray(e)&&function(e){return Zt.isArray(e)&&!e.some(sn)}(e)||(Zt.isFileList(e)||Zt.endsWith(n,"[]"))&&(a=Zt.toArray(e)))return n=rn(n),a.forEach((function(e,i){!Zt.isUndefined(e)&&null!==e&&t.append(!0===o?on([n],i,r):null===o?n:n+"[]",c(e))})),!1;return!!sn(e)||(t.append(on(s,n,r),c(e)),!1)}const u=[],d=Object.assign(an,{defaultVisitor:l,convertValue:c,isVisitable:sn});if(!Zt.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!Zt.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),Zt.forEach(n,(function(n,r){!0===(!(Zt.isUndefined(n)||null===n)&&s.call(t,n,Zt.isString(r)?r.trim():r,i,d))&&e(n,i?i.concat(r):[r])})),u.pop()}}(e),t};function ln(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function un(e,t){this._pairs=[],e&&cn(e,this,t)}const dn=un.prototype;dn.append=function(e,t){this._pairs.push([e,t])},dn.toString=function(e){const t=e?function(t){return e.call(this,t,ln)}:ln;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const hn=un;function pn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function fn(e,t,n){if(!t)return e;const i=n&&n.encode||pn;Zt.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let r;if(r=s?s(t,n):Zt.isURLSearchParams(t)?t.toString():new hn(t,n).toString(i),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}const mn=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Zt.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},gn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vn={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:hn,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},bn="undefined"!==typeof window&&"undefined"!==typeof document,yn="object"===typeof navigator&&navigator||void 0,wn=bn&&(!yn||["ReactNative","NativeScript","NS"].indexOf(yn.product)<0),Sn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Tn=bn&&window.location.href||"http://localhost",Cn=(0,u.A)((0,u.A)({},a),vn);const kn=function(e){function t(e,n,i,s){let r=e[s++];if("__proto__"===r)return!0;const o=Number.isFinite(+r),a=s>=e.length;if(r=!r&&Zt.isArray(i)?i.length:r,a)return Zt.hasOwnProp(i,r)?i[r]=[i[r],n]:i[r]=n,!o;i[r]&&Zt.isObject(i[r])||(i[r]=[]);return t(e,n,i[r],s)&&Zt.isArray(i[r])&&(i[r]=function(e){const t={},n=Object.keys(e);let i;const s=n.length;let r;for(i=0;i<s;i++)r=n[i],t[r]=e[r];return t}(i[r])),!o}if(Zt.isFormData(e)&&Zt.isFunction(e.entries)){const n={};return Zt.forEachEntry(e,((e,i)=>{t(function(e){return Zt.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,n,0)})),n}return null};const En={transitional:gn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,s=Zt.isObject(e);s&&Zt.isHTMLForm(e)&&(e=new FormData(e));if(Zt.isFormData(e))return i?JSON.stringify(kn(e)):e;if(Zt.isArrayBuffer(e)||Zt.isBuffer(e)||Zt.isStream(e)||Zt.isFile(e)||Zt.isBlob(e)||Zt.isReadableStream(e))return e;if(Zt.isArrayBufferView(e))return e.buffer;if(Zt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return cn(e,new Cn.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return Cn.isNode&&Zt.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=Zt.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return cn(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),function(e,t,n){if(Zt.isString(e))try{return(t||JSON.parse)(e),Zt.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||En.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(Zt.isResponse(e)||Zt.isReadableStream(e))return e;if(e&&Zt.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(s){if(n){if("SyntaxError"===s.name)throw nn.from(s,nn.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Cn.classes.FormData,Blob:Cn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Zt.forEach(["delete","get","head","post","put","patch"],(e=>{En.headers[e]={}}));const _n=En,Rn=Zt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),In=Symbol("internals");function An(e){return e&&String(e).trim().toLowerCase()}function Pn(e){return!1===e||null==e?e:Zt.isArray(e)?e.map(Pn):String(e)}function xn(e,t,n,i,s){return Zt.isFunction(i)?i.call(this,t,n):(s&&(t=n),Zt.isString(t)?Zt.isString(i)?-1!==t.indexOf(i):Zt.isRegExp(i)?i.test(t):void 0:void 0)}class On{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function s(e,t,n){const s=An(t);if(!s)throw new Error("header name must be a non-empty string");const r=Zt.findKey(i,s);(!r||void 0===i[r]||!0===n||void 0===n&&!1!==i[r])&&(i[r||t]=Pn(e))}const r=(e,t)=>Zt.forEach(e,((e,n)=>s(e,n,t)));if(Zt.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(Zt.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))r((e=>{const t={};let n,i,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),i=e.substring(s+1).trim(),!n||t[n]&&Rn[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t})(e),t);else if(Zt.isObject(e)&&Zt.isIterable(e)){let n,i,s={};for(const t of e){if(!Zt.isArray(t))throw TypeError("Object iterator must return a key-value pair");s[i=t[0]]=(n=s[i])?Zt.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}r(s,t)}else null!=e&&s(t,e,n);return this}get(e,t){if(e=An(e)){const n=Zt.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(Zt.isFunction(t))return t.call(this,e,n);if(Zt.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=An(e)){const n=Zt.findKey(this,e);return!(!n||void 0===this[n]||t&&!xn(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function s(e){if(e=An(e)){const s=Zt.findKey(n,e);!s||t&&!xn(0,n[s],s,t)||(delete n[s],i=!0)}}return Zt.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const s=t[n];e&&!xn(0,this[s],s,e,!0)||(delete this[s],i=!0)}return i}normalize(e){const t=this,n={};return Zt.forEach(this,((i,s)=>{const r=Zt.findKey(n,s);if(r)return t[r]=Pn(i),void delete t[s];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();o!==s&&delete t[s],t[o]=Pn(i),n[o]=!0})),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Zt.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&Zt.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((e=>{let[t,n]=e;return t+": "+n})).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return i.forEach((e=>t.set(e))),t}static accessor(e){const t=(this[In]=this[In]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=An(e);t[i]||(!function(e,t){const n=Zt.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,s){return this[i].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[i]=!0)}return Zt.isArray(e)?e.forEach(i):i(e),this}}On.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Zt.reduceDescriptors(On.prototype,((e,t)=>{let{value:n}=e,i=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[i]=e}}})),Zt.freezeMethods(On);const Nn=On;function Dn(e,t){const n=this||_n,i=t||n,s=Nn.from(i.headers);let r=i.data;return Zt.forEach(e,(function(e){r=e.call(n,r,s.normalize(),t?t.status:void 0)})),s.normalize(),r}function jn(e){return!(!e||!e.__CANCEL__)}function Ln(e,t,n){nn.call(this,null==e?"canceled":e,nn.ERR_CANCELED,t,n),this.name="CanceledError"}Zt.inherits(Ln,nn,{__CANCEL__:!0});const Un=Ln;function Fn(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new nn("Request failed with status code "+n.status,[nn.ERR_BAD_REQUEST,nn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Mn=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let s,r=0,o=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=i[o];s||(s=c),n[r]=a,i[r]=c;let u=o,d=0;for(;u!==r;)d+=n[u++],u%=e;if(r=(r+1)%e,r===o&&(o=(o+1)%e),c-s<t)return;const h=l&&c-l;return h?Math.round(1e3*d/h):void 0}};const Vn=function(e,t){let n,i,s=0,r=1e3/t;const o=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();s=r,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-s;for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];t>=r?o(c,e):(n=c,i||(i=setTimeout((()=>{i=null,o(n)}),r-t)))},()=>n&&o(n)]},Bn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const s=Mn(50,250);return Vn((n=>{const r=n.loaded,o=n.lengthComputable?n.total:void 0,a=r-i,c=s(a);i=r;e({loaded:r,total:o,progress:o?r/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&r<=o?(o-r)/c:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),n)},Hn=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},qn=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Zt.asap((()=>e(...n)))},Wn=Cn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Cn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Cn.origin),Cn.navigator&&/(msie|trident)/i.test(Cn.navigator.userAgent)):()=>!0,$n=Cn.hasStandardBrowserEnv?{write(e,t,n,i,s,r){const o=[e+"="+encodeURIComponent(t)];Zt.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Zt.isString(i)&&o.push("path="+i),Zt.isString(s)&&o.push("domain="+s),!0===r&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Jn(e,t,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const zn=e=>e instanceof Nn?(0,u.A)({},e):e;function Gn(e,t){t=t||{};const n={};function i(e,t,n,i){return Zt.isPlainObject(e)&&Zt.isPlainObject(t)?Zt.merge.call({caseless:i},e,t):Zt.isPlainObject(t)?Zt.merge({},t):Zt.isArray(t)?t.slice():t}function s(e,t,n,s){return Zt.isUndefined(t)?Zt.isUndefined(e)?void 0:i(void 0,e,0,s):i(e,t,0,s)}function r(e,t){if(!Zt.isUndefined(t))return i(void 0,t)}function o(e,t){return Zt.isUndefined(t)?Zt.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function a(n,s,r){return r in t?i(n,s):r in e?i(void 0,n):void 0}const c={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t,n)=>s(zn(e),zn(t),0,!0)};return Zt.forEach(Object.keys(Object.assign({},e,t)),(function(i){const r=c[i]||s,o=r(e[i],t[i],i);Zt.isUndefined(o)&&r!==a||(n[i]=o)})),n}const Kn=e=>{const t=Gn({},e);let n,{data:i,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:o,headers:a,auth:c}=t;if(t.headers=a=Nn.from(a),t.url=fn(Jn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&a.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Zt.isFormData(i))if(Cn.hasStandardBrowserEnv||Cn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(Cn.hasStandardBrowserEnv&&(s&&Zt.isFunction(s)&&(s=s(t)),s||!1!==s&&Wn(t.url))){const e=r&&o&&$n.read(o);e&&a.set(r,e)}return t},Yn="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const i=Kn(e);let s=i.data;const r=Nn.from(i.headers).normalize();let o,a,c,l,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=i;function f(){l&&l(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=Nn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Fn((function(e){t(e),f()}),(function(e){n(e),f()}),{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new nn("Request aborted",nn.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new nn("Network Error",nn.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const s=i.transitional||gn;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new nn(t,s.clarifyTimeoutError?nn.ETIMEDOUT:nn.ECONNABORTED,e,m)),m=null},void 0===s&&r.setContentType(null),"setRequestHeader"in m&&Zt.forEach(r.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),Zt.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),d&&"json"!==d&&(m.responseType=i.responseType),p&&([c,u]=Bn(p,!0),m.addEventListener("progress",c)),h&&m.upload&&([a,l]=Bn(h),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(o=t=>{m&&(n(!t||t.type?new Un(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);v&&-1===Cn.protocols.indexOf(v)?n(new nn("Unsupported protocol "+v+":",nn.ERR_BAD_REQUEST,e)):m.send(s||null)}))},Xn=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const s=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof nn?t:new Un(t instanceof Error?t.message:t))}};let r=t&&setTimeout((()=>{r=null,s(new nn("timeout ".concat(t," of ms exceeded"),nn.ETIMEDOUT))}),t);const o=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)})),e=null)};e.forEach((e=>e.addEventListener("abort",s)));const{signal:a}=i;return a.unsubscribe=()=>Zt.asap(o),a}};function Zn(e,t){this.v=e,this.k=t}function Qn(e){return function(){return new ei(e.apply(this,arguments))}}function ei(e){var t,n;function i(t,n){try{var r=e[t](n),o=r.value,a=o instanceof Zn;Promise.resolve(a?o.v:o).then((function(n){if(a){var c="return"===t?"return":"next";if(!o.k||n.done)return i(c,n);n=e[c](n).value}s(r.done?"return":"normal",n)}),(function(e){i("throw",e)}))}catch(e){s("throw",e)}}function s(e,s){switch(e){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,s){return new Promise((function(r,o){var a={key:e,arg:s,resolve:r,reject:o,next:null};n?n=n.next=a:(t=n=a,i(e,s))}))},"function"!=typeof e.return&&(this.return=void 0)}function ti(e){return new Zn(e,0)}function ni(e){var t={},n=!1;function i(t,i){return n=!0,i=new Promise((function(n){n(e[t](i))})),{done:!1,value:new Zn(i,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):i("return",e)}),t}function ii(e){var t,n,i,s=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new si(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function si(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return si=function(e){this.s=e,this.n=e.next},si.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new si(e)}ei.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},ei.prototype.next=function(e){return this._invoke("next",e)},ei.prototype.throw=function(e){return this._invoke("throw",e)},ei.prototype.return=function(e){return this._invoke("return",e)};const ri=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,s=0;for(;s<n;)i=s+t,yield e.slice(s,i),s=i},oi=function(){var e=Qn((function*(e,t){var n,i=!1,s=!1;try{for(var r,o=ii(ai(e));i=!(r=yield ti(o.next())).done;i=!1){const e=r.value;yield*ni(ii(ri(e,t)))}}catch(a){s=!0,n=a}finally{try{i&&null!=o.return&&(yield ti(o.return()))}finally{if(s)throw n}}}));return function(t,n){return e.apply(this,arguments)}}(),ai=function(){var e=Qn((function*(e){if(e[Symbol.asyncIterator])return void(yield*ni(ii(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield ti(t.read());if(e)break;yield n}}finally{yield ti(t.cancel())}}));return function(t){return e.apply(this,arguments)}}(),ci=(e,t,n,i)=>{const s=oi(e,t);let r,o=0,a=e=>{r||(r=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await s.next();if(t)return a(),void e.close();let r=i.byteLength;if(n){let e=o+=r;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw a(t),t}},cancel:e=>(a(e),s.return())},{highWaterMark:2})},li="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,ui=li&&"function"===typeof ReadableStream,di=li&&("function"===typeof TextEncoder?(hi=new TextEncoder,e=>hi.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var hi;const pi=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return!!e(...n)}catch(s){return!1}},fi=ui&&pi((()=>{let e=!1;const t=new Request(Cn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),mi=ui&&pi((()=>Zt.isReadableStream(new Response("").body))),gi={stream:mi&&(e=>e.body)};var vi;li&&(vi=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!gi[e]&&(gi[e]=Zt.isFunction(vi[e])?t=>t[e]():(t,n)=>{throw new nn("Response type '".concat(e,"' is not supported"),nn.ERR_NOT_SUPPORT,n)})})));const bi=async(e,t)=>{const n=Zt.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(Zt.isBlob(e))return e.size;if(Zt.isSpecCompliantForm(e)){const t=new Request(Cn.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Zt.isArrayBufferView(e)||Zt.isArrayBuffer(e)?e.byteLength:(Zt.isURLSearchParams(e)&&(e+=""),Zt.isString(e)?(await di(e)).byteLength:void 0)})(t):n},yi={http:null,xhr:Yn,fetch:li&&(async e=>{let{url:t,method:n,data:i,signal:s,cancelToken:r,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:d,withCredentials:h="same-origin",fetchOptions:p}=Kn(e);l=l?(l+"").toLowerCase():"text";let f,m=Xn([s,r&&r.toAbortSignal()],o);const g=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(c&&fi&&"get"!==n&&"head"!==n&&0!==(v=await bi(d,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(Zt.isFormData(i)&&(e=n.headers.get("content-type"))&&d.setContentType(e),n.body){const[e,t]=Hn(v,Bn(qn(c)));i=ci(n.body,65536,e,t)}}Zt.isString(h)||(h=h?"include":"omit");const s="credentials"in Request.prototype;f=new Request(t,(0,u.A)((0,u.A)({},p),{},{signal:m,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",credentials:s?h:void 0}));let r=await fetch(f);const o=mi&&("stream"===l||"response"===l);if(mi&&(a||o&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=r[t]}));const t=Zt.toFiniteNumber(r.headers.get("content-length")),[n,i]=a&&Hn(t,Bn(qn(a),!0))||[];r=new Response(ci(r.body,65536,n,(()=>{i&&i(),g&&g()})),e)}l=l||"text";let b=await gi[Zt.findKey(gi,l)||"text"](r,e);return!o&&g&&g(),await new Promise(((t,n)=>{Fn(t,n,{data:b,headers:Nn.from(r.headers),status:r.status,statusText:r.statusText,config:e,request:f})}))}catch(b){if(g&&g(),b&&"TypeError"===b.name&&/Load failed|fetch/i.test(b.message))throw Object.assign(new nn("Network Error",nn.ERR_NETWORK,e,f),{cause:b.cause||b});throw nn.from(b,b&&b.code,e,f)}})};Zt.forEach(yi,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}}));const wi=e=>"- ".concat(e),Si=e=>Zt.isFunction(e)||null===e||!1===e,Ti=e=>{e=Zt.isArray(e)?e:[e];const{length:t}=e;let n,i;const s={};for(let r=0;r<t;r++){let t;if(n=e[r],i=n,!Si(n)&&(i=yi[(t=String(n)).toLowerCase()],void 0===i))throw new nn("Unknown adapter '".concat(t,"'"));if(i)break;s[t||"#"+r]=i}if(!i){const e=Object.entries(s).map((e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")}));let n=t?e.length>1?"since :\n"+e.map(wi).join("\n"):" "+wi(e[0]):"as no adapter specified";throw new nn("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function Ci(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Un(null,e)}function ki(e){Ci(e),e.headers=Nn.from(e.headers),e.data=Dn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ti(e.adapter||_n.adapter)(e).then((function(t){return Ci(e),t.data=Dn.call(e,e.transformResponse,t),t.headers=Nn.from(t.headers),t}),(function(t){return jn(t)||(Ci(e),t&&t.response&&(t.response.data=Dn.call(e,e.transformResponse,t.response),t.response.headers=Nn.from(t.response.headers))),Promise.reject(t)}))}const Ei="1.9.0",_i={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{_i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Ri={};_i.transitional=function(e,t,n){function i(e,t){return"[Axios v1.9.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,s,r)=>{if(!1===e)throw new nn(i(s," has been removed"+(t?" in "+t:"")),nn.ERR_DEPRECATED);return t&&!Ri[s]&&(Ri[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,s,r)}},_i.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const Ii={assertOptions:function(e,t,n){if("object"!==typeof e)throw new nn("options must be an object",nn.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const r=i[s],o=t[r];if(o){const t=e[r],n=void 0===t||o(t,r,e);if(!0!==n)throw new nn("option "+r+" must be "+n,nn.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new nn("Unknown option "+r,nn.ERR_BAD_OPTION)}},validators:_i},Ai=Ii.validators;class Pi{constructor(e){this.defaults=e||{},this.interceptors={request:new mn,response:new mn}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(i){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Gn(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:s}=t;void 0!==n&&Ii.assertOptions(n,{silentJSONParsing:Ai.transitional(Ai.boolean),forcedJSONParsing:Ai.transitional(Ai.boolean),clarifyTimeoutError:Ai.transitional(Ai.boolean)},!1),null!=i&&(Zt.isFunction(i)?t.paramsSerializer={serialize:i}:Ii.assertOptions(i,{encode:Ai.function,serialize:Ai.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ii.assertOptions(t,{baseUrl:Ai.spelling("baseURL"),withXsrfToken:Ai.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=s&&Zt.merge(s.common,s[t.method]);s&&Zt.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=Nn.concat(r,s);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(e){c.push(e.fulfilled,e.rejected)}));let u,d=0;if(!a){const e=[ki.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=o.length;let h=t;for(d=0;d<u;){const e=o[d++],t=o[d++];try{h=e(h)}catch(p){t.call(this,p);break}}try{l=ki.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return fn(Jn((e=Gn(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Zt.forEach(["delete","get","head","options"],(function(e){Pi.prototype[e]=function(t,n){return this.request(Gn(n||{},{method:e,url:t,data:(n||{}).data}))}})),Zt.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,s){return this.request(Gn(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Pi.prototype[e]=t(),Pi.prototype[e+"Form"]=t(!0)}));const xi=Pi;class Oi{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,s){n.reason||(n.reason=new Un(e,i,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Oi((function(t){e=t})),cancel:e}}}const Ni=Oi;const Di={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Di).forEach((e=>{let[t,n]=e;Di[n]=t}));const ji=Di;const Li=function e(t){const n=new xi(t),i=pt(xi.prototype.request,n);return Zt.extend(i,xi.prototype,n,{allOwnKeys:!0}),Zt.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(Gn(t,n))},i}(_n);Li.Axios=xi,Li.CanceledError=Un,Li.CancelToken=Ni,Li.isCancel=jn,Li.VERSION=Ei,Li.toFormData=cn,Li.AxiosError=nn,Li.Cancel=Li.CanceledError,Li.all=function(e){return Promise.all(e)},Li.spread=function(e){return function(t){return e.apply(null,t)}},Li.isAxiosError=function(e){return Zt.isObject(e)&&!0===e.isAxiosError},Li.mergeConfig=Gn,Li.AxiosHeaders=Nn,Li.formToJSON=e=>kn(Zt.isHTMLForm(e)?new FormData(e):e),Li.getAdapter=Ti,Li.HttpStatusCode=ji,Li.default=Li;const Ui=Li;var Fi,Mi;function Vi(e,t,n){if(n)for(let[i,s]of Object.entries(n))if("string"==typeof s)e.append(i,s);else for(let t of s)e.append(i,t);return e.set("Content-Type",t?"application/json":"application/protobuf"),e.set("Accept",t?"application/json":"application/protobuf, application/json"),e}function Bi(e,t){if(!e)return;let n=t;for(let[i,s]of Object.entries(e))s instanceof Date?n[i]=new Date(s.getTime()):Array.isArray(s)?n[i]=s.concat():n[i]=s}!function(e){e[e.cancelled=0]="cancelled",e[e.unknown=1]="unknown",e[e.invalid_argument=2]="invalid_argument",e[e.malformed=3]="malformed",e[e.deadline_exceeded=4]="deadline_exceeded",e[e.not_found=5]="not_found",e[e.bad_route=6]="bad_route",e[e.already_exists=7]="already_exists",e[e.permission_denied=8]="permission_denied",e[e.unauthenticated=9]="unauthenticated",e[e.resource_exhausted=10]="resource_exhausted",e[e.failed_precondition=11]="failed_precondition",e[e.aborted=12]="aborted",e[e.out_of_range=13]="out_of_range",e[e.unimplemented=14]="unimplemented",e[e.internal=15]="internal",e[e.unavailable=16]="unavailable",e[e.dataloss=17]="dataloss"}(Fi||(Fi={})),function(e){e[e.PENDING=0]="PENDING",e[e.REJECTED=1]="REJECTED",e[e.RESOLVED=2]="RESOLVED"}(Mi||(Mi={}));class Hi{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._state=Mi.PENDING,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),e&&this._promise.catch((e=>{}))}get state(){return this._state}get promise(){return this._promise}resolve(e){if(this.state!==Mi.PENDING)throw new Error("cannot resolve ".concat(Mi[this.state].toLowerCase()));this._resolve(e),this._state=Mi.RESOLVED}reject(e){if(this.state!==Mi.PENDING)throw new Error("cannot reject ".concat(Mi[this.state].toLowerCase()));this._reject(e),this._state=Mi.REJECTED}resolvePending(e){this._state===Mi.PENDING&&this.resolve(e)}rejectPending(e){this._state===Mi.PENDING&&this.reject(e)}}var qi=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{c(i.next(e))}catch(t){r(t)}}function a(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class Wi{constructor(e,t,n,i,s,r,o){this.method=e,this.requestHeaders=t,this.request=n,this.headers=i,this.response=s,this.status=r,this.trailers=o}then(e,t){return this.promiseFinished().then((t=>e?Promise.resolve(e(t)):t),(e=>t?Promise.resolve(t(e)):Promise.reject(e)))}promiseFinished(){return qi(this,void 0,void 0,(function*(){let[e,t,n,i]=yield Promise.all([this.headers,this.response,this.status,this.trailers]);return{method:this.method,requestHeaders:this.requestHeaders,request:this.request,headers:e,response:t,status:n,trailers:i}}))}}class $i{constructor(e){this.defaultOptions=e}mergeOptions(e){return function(e,t){if(!t)return e;let n={};Bi(e,n),Bi(t,n);for(let r of Object.keys(t)){let o=t[r];switch(r){case"jsonOptions":n.jsonOptions=et(e.jsonOptions,n.jsonOptions);break;case"binaryOptions":n.binaryOptions=(i=e.binaryOptions,s=n.binaryOptions,Object.assign(Object.assign({},i),s));break;case"meta":n.meta={},Bi(e.meta,n.meta),Bi(t.meta,n.meta);break;case"interceptors":n.interceptors=e.interceptors?e.interceptors.concat(o):o.concat()}}var i,s;return n}(this.defaultOptions,e)}unary(e,t,n){var i,s,r;let o=n,a=this.makeUrl(e,o),c=null!==(i=o.fetchInit)&&void 0!==i?i:{},l=o.sendJson?e.I.toJsonString(t,o.jsonOptions):e.I.toBinary(t,o.binaryOptions),u=new Hi,d=new Hi,h=new Hi,p=new Hi;return globalThis.fetch(a,Object.assign(Object.assign({},c),{method:"POST",headers:Vi(new globalThis.Headers,!!o.sendJson,o.meta),body:l,signal:null!==(s=n.abort)&&void 0!==s?s:null})).then((t=>{let n;u.resolve(function(e){let t={};return e.forEach(((e,n)=>{"content-type"!==n.toLowerCase()&&"content-length"!==n.toLowerCase()&&(t.hasOwnProperty(n)?t[n].push(e):t[n]=e)})),t}(t.headers));try{n=t.type}catch(i){}switch(n){case"error":case"opaque":case"opaqueredirect":throw new ht("fetch response type ".concat(t.type),Fi[Fi.unknown])}return t.ok?o.sendJson?t.json().then((t=>e.O.fromJson(t,o.jsonOptions)),(()=>{throw new ht("unable to read response body as json",Fi[Fi.dataloss])})):t.arrayBuffer().then((t=>e.O.fromBinary(new Uint8Array(t),o.binaryOptions)),(()=>{throw new ht("unable to read response body",Fi[Fi.dataloss])})):t.json().then((e=>{throw function(e){if(!Se(e)||"string"!==typeof e.code||"string"!==typeof e.msg)return new ht("cannot read twirp error response",Fi[Fi.internal]);let t={};if(Se(e.meta))for(let[n,i]of Object.entries(e.meta))"string"==typeof i&&(t[n]=i);return new ht(e.msg,e.code,t)}(e)}),(()=>{throw new ht("received HTTP "+t.status+", unable to read response body as json",Fi[Fi.internal])}))}),(e=>{if(e instanceof Error&&"AbortError"===e.name)throw new ht(e.message,Fi[Fi.cancelled]);throw new ht(e instanceof Error?e.message:e)})).then((e=>{d.resolve(e),h.resolve({code:"OK",detail:""}),p.resolve({})})).catch((t=>{let n=t instanceof ht?t:new ht(t instanceof Error?t.message:t,Fi[Fi.internal]);n.methodName=e.name,n.serviceName=e.service.typeName,u.rejectPending(n),d.rejectPending(n),h.rejectPending(n),p.rejectPending(n)})),new Wi(e,null!==(r=o.meta)&&void 0!==r?r:{},t,u.promise,d.promise,h.promise,p.promise)}makeUrl(e,t){let n=t.baseUrl;n.endsWith("/")&&(n=n.substring(0,n.length-1));let i=e.name;return!0!==t.useProtoMethodName&&(i=pe(i),i=i.substring(0,1).toUpperCase()+i.substring(1)),"".concat(n,"/").concat(e.service.typeName,"/").concat(i)}clientStreaming(e){const t=new ht("Client streaming is not supported by Twirp",Fi[Fi.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}duplex(e){const t=new ht("Duplex streaming is not supported by Twirp",Fi[Fi.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}serverStreaming(e){const t=new ht("Server streaming is not supported by Twirp",Fi[Fi.unimplemented]);throw t.methodName=e.name,t.serviceName=e.service.typeName,t}}var Ji=n(7827),zi=n(5868),Gi=n(2047),Ki=(0,n(4861).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Yi=n(4004),Xi=n(6634),Zi=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,Ji.C6)(t,e),t.prototype.lift=function(e){var t=new Qi(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Ki},t.prototype.next=function(e){var t=this;(0,Xi.Y)((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=(0,Ji.Ju)(t.currentObservers),r=s.next();!r.done;r=s.next()){r.value.next(e)}}catch(o){n={error:o}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,Xi.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,Xi.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,i=n.hasError,s=n.isStopped,r=n.observers;return i||s?Gi.Kn:(this.currentObservers=null,r.push(e),new Gi.yU((function(){t.currentObservers=null,(0,Yi.o)(r,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,i=t.thrownError,s=t.isStopped;n?e.error(i):s&&e.complete()},t.prototype.asObservable=function(){var e=new zi.c;return e.source=this,e},t.create=function(e,t){return new Qi(e,t)},t}(zi.c),Qi=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return(0,Ji.C6)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Gi.Kn},t}(Zi),es={now:function(){return(es.delegate||Date).now()},delegate:void 0},ts=function(e){function t(t,n,i){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===i&&(i=es);var s=e.call(this)||this;return s._bufferSize=t,s._windowTime=n,s._timestampProvider=i,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=n===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,n),s}return(0,Ji.C6)(t,e),t.prototype.next=function(t){var n=this,i=n.isStopped,s=n._buffer,r=n._infiniteTimeWindow,o=n._timestampProvider,a=n._windowTime;i||(s.push(t),!r&&s.push(o.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,i=this._buffer.slice(),s=0;s<i.length&&!e.closed;s+=n?1:2)e.next(i[s]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,i=e._buffer,s=e._infiniteTimeWindow,r=(s?1:2)*t;if(t<1/0&&r<i.length&&i.splice(0,i.length-r),!s){for(var o=n.now(),a=0,c=1;c<i.length&&i[c]<=o;c+=2)a=c;a&&i.splice(0,a+1)}},t}(Zi),ns=Array.isArray,is=Object.getPrototypeOf,ss=Object.prototype,rs=Object.keys;function os(e){if(1===e.length){var t=e[0];if(ns(t))return{args:t,keys:null};if((i=t)&&"object"===typeof i&&is(i)===ss){var n=rs(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var i;return{args:e,keys:null}}var as=n(8165),cs=n(8117),ls=n(1190),us=n(8344);function ds(e,t){return(0,ls.N)((function(n,i){var s=0;n.subscribe((0,us._)(i,(function(n){i.next(e.call(t,n,s++))})))}))}var hs=Array.isArray;function ps(e){return ds((function(t){return function(e,t){return hs(t)?e.apply(void 0,(0,Ji.fX)([],(0,Ji.zs)(t))):e(t)}(e,t)}))}var fs=n(2476);var ms=n(937);function gs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,fs.lI)(e),i=(0,fs.ms)(e),s=os(e),r=s.args,o=s.keys;if(0===r.length)return(0,as.H)([],n);var a=new zi.c(function(e,t,n){void 0===n&&(n=cs.D);return function(i){vs(t,(function(){for(var s=e.length,r=new Array(s),o=s,a=s,c=function(s){vs(t,(function(){var c=(0,as.H)(e[s],t),l=!1;c.subscribe((0,us._)(i,(function(e){r[s]=e,l||(l=!0,a--),a||i.next(n(r.slice()))}),(function(){--o||i.complete()})))}),i)},l=0;l<s;l++)c(l)}),i)}}(r,n,o?function(e){return function(e,t){return e.reduce((function(e,n,i){return e[n]=t[i],e}),{})}(o,e)}:cs.D));return i?a.pipe(ps(i)):a}function vs(e,t,n){e?(0,ms.N)(n,e,t):t()}var bs=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,Ji.C6)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,i=e._value;if(t)throw n;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Zi),ys=n(1998),ws=n(7917);function Ss(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!0!==t){if(!1!==t){var s=new ws.Ms({next:function(){s.unsubscribe(),e()}});return(0,ys.Tg)(t.apply(void 0,(0,Ji.fX)([],(0,Ji.zs)(n)))).subscribe(s)}}else e()}function Ts(e,t,n){var i,s,r,o,a=!1;return e&&"object"===typeof e?(i=e.bufferSize,o=void 0===i?1/0:i,s=e.windowTime,t=void 0===s?1/0:s,a=void 0!==(r=e.refCount)&&r,n=e.scheduler):o=null!==e&&void 0!==e?e:1/0,function(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new Zi}:t,i=e.resetOnError,s=void 0===i||i,r=e.resetOnComplete,o=void 0===r||r,a=e.resetOnRefCountZero,c=void 0===a||a;return function(e){var t,i,r,a=0,l=!1,u=!1,d=function(){null===i||void 0===i||i.unsubscribe(),i=void 0},h=function(){d(),t=r=void 0,l=u=!1},p=function(){var e=t;h(),null===e||void 0===e||e.unsubscribe()};return(0,ls.N)((function(e,f){a++,u||l||d();var m=r=null!==r&&void 0!==r?r:n();f.add((function(){0!==--a||u||l||(i=Ss(p,c))})),m.subscribe(f),!t&&a>0&&(t=new ws.Ms({next:function(e){return m.next(e)},error:function(e){u=!0,d(),i=Ss(h,s,e),m.error(e)},complete:function(){l=!0,d(),i=Ss(h,o),m.complete()}}),(0,ys.Tg)(e).subscribe(t))}))(e)}}({connector:function(){return new ts(o,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}function Cs(e,t){return void 0===t&&(t=cs.D),e=null!==e&&void 0!==e?e:ks,(0,ls.N)((function(n,i){var s,r=!0;n.subscribe((0,us._)(i,(function(n){var o=t(n);!r&&e(s,o)||(r=!1,s=o,i.next(n))})))}))}function ks(e,t){return e===t}function Es(e,t){return void 0===t&&(t=!1),(0,ls.N)((function(n,i){var s=0;n.subscribe((0,us._)(i,(function(n){var r=e(n,s++);(r||t)&&i.next(n),!r&&i.complete()})))}))}function _s(e,t){return Cs((function(n,i){return t?t(n[e],i[e]):n[e]===i[e]}))}var Rs=n(9351);function Is(e,t,n){return n?Is(e,t).pipe(ps(n)):new zi.c((function(n){var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)},s=e(i);return(0,Rs.T)(t)?function(){return t(i,s)}:void 0}))}function As(e,t,n){return void 0===n&&(n=1/0),(0,Rs.T)(t)?As((function(n,i){return ds((function(e,s){return t(n,e,i,s)}))((0,ys.Tg)(e(n,i)))}),n):("number"===typeof t&&(n=t),(0,ls.N)((function(t,i){return function(e,t,n,i,s,r,o,a){var c=[],l=0,u=0,d=!1,h=function(){!d||c.length||l||t.complete()},p=function(e){return l<i?f(e):c.push(e)},f=function(e){r&&t.next(e),l++;var a=!1;(0,ys.Tg)(n(e,u++)).subscribe((0,us._)(t,(function(e){null===s||void 0===s||s(e),r?p(e):t.next(e)}),(function(){a=!0}),void 0,(function(){if(a)try{l--;for(var e=function(){var e=c.shift();o?(0,ms.N)(t,o,(function(){return f(e)})):f(e)};c.length&&l<i;)e();h()}catch(n){t.error(n)}})))};return e.subscribe((0,us._)(t,p,(function(){d=!0,h()}))),function(){null===a||void 0===a||a()}}(t,i,e,n)})))}var Ps=n(5505),xs=["addListener","removeListener"],Os=["addEventListener","removeEventListener"],Ns=["on","off"];function Ds(e,t,n,i){if((0,Rs.T)(n)&&(i=n,n=void 0),i)return Ds(e,t,n).pipe(ps(i));var s=(0,Ji.zs)(function(e){return(0,Rs.T)(e.addEventListener)&&(0,Rs.T)(e.removeEventListener)}(e)?Os.map((function(i){return function(s){return e[i](t,s,n)}})):function(e){return(0,Rs.T)(e.addListener)&&(0,Rs.T)(e.removeListener)}(e)?xs.map(js(e,t)):function(e){return(0,Rs.T)(e.on)&&(0,Rs.T)(e.off)}(e)?Ns.map(js(e,t)):[],2),r=s[0],o=s[1];if(!r&&(0,Ps.X)(e))return As((function(e){return Ds(e,t,n)}))((0,ys.Tg)(e));if(!r)throw new TypeError("Invalid event target");return new zi.c((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return r(t),function(){return o(t)}}))}function js(e,t){return function(n){return function(i){return e[n](t,i)}}}var Ls=function(e){function t(t,n){return e.call(this)||this}return(0,Ji.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(Gi.yU),Us={setInterval:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=Us.delegate;return(null===s||void 0===s?void 0:s.setInterval)?s.setInterval.apply(s,(0,Ji.fX)([e,t],(0,Ji.zs)(n))):setInterval.apply(void 0,(0,Ji.fX)([e,t],(0,Ji.zs)(n)))},clearInterval:function(e){var t=Us.delegate;return((null===t||void 0===t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Fs=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return(0,Ji.C6)(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Us.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Us.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,i=!1;try{this.work(e)}catch(s){i=!0,n=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Yi.o)(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Ls),Ms=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=es.now,e}(),Vs=new(function(e){function t(t,n){void 0===n&&(n=Ms.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return(0,Ji.C6)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Ms))(Fs);function Bs(e){return void 0===e&&(e=1/0),As(cs.D,e)}var Hs=new zi.c((function(e){return e.complete()}));function qs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,fs.lI)(e),i=(0,fs.R0)(e,1/0),s=e;return s.length?1===s.length?(0,ys.Tg)(s[0]):Bs(i)((0,as.H)(s,n)):Hs}function Ws(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bs(1)((0,as.H)(e,(0,fs.lI)(e)))}function $s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,fs.lI)(e);return(0,ls.N)((function(t,i){(n?Ws(e,t,n):Ws(e,t)).subscribe(i)}))}function Js(e,t){return(0,Rs.T)(t)?As(e,t,1):As(e,1)}var zs=n(5257),Gs=n(7946),Ks=n(3217);const Ys=["sdk"],Xs=["publishOptions"],Zs=["deviceId"],Qs=["deviceId"],er=["maxJoinRetries"],tr=["sdkName","sdkVersion"],nr=["sdkName","sdkVersion"],ir="disabled",sr="auto-on",rr={BLOCK_USERS:"block-users",CHANGE_MAX_DURATION:"change-max-duration",CREATE_CALL:"create-call",CREATE_REACTION:"create-reaction",ENABLE_NOISE_CANCELLATION:"enable-noise-cancellation",END_CALL:"end-call",JOIN_BACKSTAGE:"join-backstage",JOIN_CALL:"join-call",JOIN_ENDED_CALL:"join-ended-call",MUTE_USERS:"mute-users",PIN_FOR_EVERYONE:"pin-for-everyone",READ_CALL:"read-call",REMOVE_CALL_MEMBER:"remove-call-member",SCREENSHARE:"screenshare",SEND_AUDIO:"send-audio",SEND_VIDEO:"send-video",START_BROADCAST_CALL:"start-broadcast-call",START_CLOSED_CAPTIONS_CALL:"start-closed-captions-call",START_FRAME_RECORD_CALL:"start-frame-record-call",START_RECORD_CALL:"start-record-call",START_TRANSCRIPTION_CALL:"start-transcription-call",STOP_BROADCAST_CALL:"stop-broadcast-call",STOP_CLOSED_CAPTIONS_CALL:"stop-closed-captions-call",STOP_FRAME_RECORD_CALL:"stop-frame-record-call",STOP_RECORD_CALL:"stop-record-call",STOP_TRANSCRIPTION_CALL:"stop-transcription-call",UPDATE_CALL:"update-call",UPDATE_CALL_MEMBER:"update-call-member",UPDATE_CALL_PERMISSIONS:"update-call-permissions",UPDATE_CALL_SETTINGS:"update-call-settings"};class or extends Error{constructor(e){let{message:t,code:n,status:i,response:s,unrecoverable:r}=e;super(t),this.name="ErrorFromResponse",this.code=n,this.response=s,this.status=i,this.unrecoverable=r}toJSON(){const e=[["status",this.status],["code",this.code],["unrecoverable",this.unrecoverable]],t=[];for(const[n,i]of e)"undefined"!==typeof i&&null!==i&&t.push("".concat(n,": ").concat(i));return{message:"(".concat(t.join(", "),") - ").concat(this.message),stack:this.stack,name:this.name}}}var ar;!function(e){e[e.NULL_VALUE=0]="NULL_VALUE"}(ar||(ar={}));const cr=new class extends ut{constructor(){super("google.protobuf.Struct",[{no:1,name:"fields",kind:"map",K:9,V:{kind:"message",T:()=>lr}}])}internalJsonWrite(e,t){let n={};for(let[i,s]of Object.entries(e.fields))n[i]=lr.toJson(s);return n}internalJsonRead(e,t,n){if(!Se(e))throw new globalThis.Error("Unable to parse message "+this.typeName+" from JSON "+we(e)+".");n||(n=this.create());for(let[i,s]of globalThis.Object.entries(e))n.fields[i]=lr.fromJson(s);return n}};const lr=new class extends ut{constructor(){super("google.protobuf.Value",[{no:1,name:"null_value",kind:"enum",oneof:"kind",T:()=>["google.protobuf.NullValue",ar]},{no:2,name:"number_value",kind:"scalar",oneof:"kind",T:1},{no:3,name:"string_value",kind:"scalar",oneof:"kind",T:9},{no:4,name:"bool_value",kind:"scalar",oneof:"kind",T:8},{no:5,name:"struct_value",kind:"message",oneof:"kind",T:()=>cr},{no:6,name:"list_value",kind:"message",oneof:"kind",T:()=>ur}])}internalJsonWrite(e,t){if(void 0===e.kind.oneofKind)throw new globalThis.Error;switch(e.kind.oneofKind){case void 0:throw new globalThis.Error;case"boolValue":return e.kind.boolValue;case"nullValue":return null;case"numberValue":let t=e.kind.numberValue;if("number"==typeof t&&!Number.isFinite(t))throw new globalThis.Error;return t;case"stringValue":return e.kind.stringValue;case"listValue":let n=this.fields.find((e=>6===e.no));if("message"!==(null===n||void 0===n?void 0:n.kind))throw new globalThis.Error;return n.T().toJson(e.kind.listValue);case"structValue":let i=this.fields.find((e=>5===e.no));if("message"!==(null===i||void 0===i?void 0:i.kind))throw new globalThis.Error;return i.T().toJson(e.kind.structValue)}}internalJsonRead(e,t,n){switch(n||(n=this.create()),typeof e){case"number":n.kind={oneofKind:"numberValue",numberValue:e};break;case"string":n.kind={oneofKind:"stringValue",stringValue:e};break;case"boolean":n.kind={oneofKind:"boolValue",boolValue:e};break;case"object":null===e?n.kind={oneofKind:"nullValue",nullValue:ar.NULL_VALUE}:globalThis.Array.isArray(e)?n.kind={oneofKind:"listValue",listValue:ur.fromJson(e)}:n.kind={oneofKind:"structValue",structValue:cr.fromJson(e)};break;default:throw new globalThis.Error("Unable to parse "+this.typeName+" from JSON "+we(e))}return n}};const ur=new class extends ut{constructor(){super("google.protobuf.ListValue",[{no:1,name:"values",kind:"message",repeat:1,T:()=>lr}])}internalJsonWrite(e,t){return e.values.map((e=>lr.toJson(e)))}internalJsonRead(e,t,n){if(!globalThis.Array.isArray(e))throw new globalThis.Error("Unable to parse "+this.typeName+" from JSON "+we(e));n||(n=this.create());let i=e.map((e=>lr.fromJson(e)));return n.values.push(...i),n}};const dr=new class extends ut{constructor(){super("google.protobuf.Timestamp",[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}])}now(){const e=this.create(),t=Date.now();return e.seconds=Fe.from(Math.floor(t/1e3)).toString(),e.nanos=t%1e3*1e6,e}toDate(e){return new Date(1e3*Fe.from(e.seconds).toNumber()+Math.ceil(e.nanos/1e6))}fromDate(e){const t=this.create(),n=e.getTime();return t.seconds=Fe.from(Math.floor(n/1e3)).toString(),t.nanos=1e6*(n%1e3+(n<0&&n%1e3!==0?1e3:0)),t}internalJsonWrite(e,t){let n=1e3*Fe.from(e.seconds).toNumber();if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("Unable to encode Timestamp to JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");if(e.nanos<0)throw new Error("Unable to encode invalid Timestamp to JSON. Nanos must not be negative.");let i="Z";if(e.nanos>0){let t=(e.nanos+1e9).toString().substring(1);i="000000"===t.substring(3)?"."+t.substring(0,3)+"Z":"000"===t.substring(6)?"."+t.substring(0,6)+"Z":"."+t+"Z"}return new Date(n).toISOString().replace(".000Z",i)}internalJsonRead(e,t,n){if("string"!==typeof e)throw new Error("Unable to parse Timestamp from JSON "+we(e)+".");let i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("Unable to parse Timestamp from JSON. Invalid format.");let s=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(s))throw new Error("Unable to parse Timestamp from JSON. Invalid value.");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new globalThis.Error("Unable to parse Timestamp from JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");return n||(n=this.create()),n.seconds=Fe.from(s/1e3).toString(),n.nanos=0,i[7]&&(n.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),n}};var hr,pr,fr,mr,gr,vr,br,yr,wr,Sr,Tr,Cr;!function(e){e[e.PUBLISHER_UNSPECIFIED=0]="PUBLISHER_UNSPECIFIED",e[e.SUBSCRIBER=1]="SUBSCRIBER"}(hr||(hr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.POOR=1]="POOR",e[e.GOOD=2]="GOOD",e[e.EXCELLENT=3]="EXCELLENT"}(pr||(pr={})),function(e){e[e.LOW_UNSPECIFIED=0]="LOW_UNSPECIFIED",e[e.MID=1]="MID",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF"}(fr||(fr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.AUDIO=1]="AUDIO",e[e.VIDEO=2]="VIDEO",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"}(mr||(mr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.PUBLISH_TRACK_NOT_FOUND=100]="PUBLISH_TRACK_NOT_FOUND",e[e.PUBLISH_TRACKS_MISMATCH=101]="PUBLISH_TRACKS_MISMATCH",e[e.PUBLISH_TRACK_OUT_OF_ORDER=102]="PUBLISH_TRACK_OUT_OF_ORDER",e[e.PUBLISH_TRACK_VIDEO_LAYER_NOT_FOUND=103]="PUBLISH_TRACK_VIDEO_LAYER_NOT_FOUND",e[e.LIVE_ENDED=104]="LIVE_ENDED",e[e.PARTICIPANT_NOT_FOUND=200]="PARTICIPANT_NOT_FOUND",e[e.PARTICIPANT_MIGRATING_OUT=201]="PARTICIPANT_MIGRATING_OUT",e[e.PARTICIPANT_MIGRATION_FAILED=202]="PARTICIPANT_MIGRATION_FAILED",e[e.PARTICIPANT_MIGRATING=203]="PARTICIPANT_MIGRATING",e[e.PARTICIPANT_RECONNECT_FAILED=204]="PARTICIPANT_RECONNECT_FAILED",e[e.PARTICIPANT_MEDIA_TRANSPORT_FAILURE=205]="PARTICIPANT_MEDIA_TRANSPORT_FAILURE",e[e.CALL_NOT_FOUND=300]="CALL_NOT_FOUND",e[e.REQUEST_VALIDATION_FAILED=400]="REQUEST_VALIDATION_FAILED",e[e.UNAUTHENTICATED=401]="UNAUTHENTICATED",e[e.PERMISSION_DENIED=403]="PERMISSION_DENIED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.SFU_SHUTTING_DOWN=600]="SFU_SHUTTING_DOWN",e[e.SFU_FULL=700]="SFU_FULL"}(gr||(gr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.REACT=1]="REACT",e[e.ANGULAR=2]="ANGULAR",e[e.ANDROID=3]="ANDROID",e[e.IOS=4]="IOS",e[e.FLUTTER=5]="FLUTTER",e[e.REACT_NATIVE=6]="REACT_NATIVE",e[e.UNITY=7]="UNITY",e[e.GO=8]="GO",e[e.PLAIN_JAVASCRIPT=9]="PLAIN_JAVASCRIPT"}(vr||(vr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.USER_MUTED=1]="USER_MUTED",e[e.PERMISSION_REVOKED=2]="PERMISSION_REVOKED",e[e.MODERATION=3]="MODERATION"}(br||(br={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SHUTTING_DOWN=1]="SHUTTING_DOWN",e[e.REBALANCE=2]="REBALANCE"}(yr||(yr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ENDED=1]="ENDED",e[e.LIVE_ENDED=2]="LIVE_ENDED",e[e.KICKED=3]="KICKED",e[e.SESSION_ENDED=4]="SESSION_ENDED"}(wr||(wr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.DISCONNECT=1]="DISCONNECT",e[e.FAST=2]="FAST",e[e.REJOIN=3]="REJOIN",e[e.MIGRATE=4]="MIGRATE"}(Sr||(Sr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.NONE=1]="NONE",e[e.LIGHT=2]="LIGHT",e[e.MODERATE=3]="MODERATE",e[e.SEVERE=4]="SEVERE",e[e.CRITICAL=5]="CRITICAL",e[e.EMERGENCY=6]="EMERGENCY",e[e.SHUTDOWN=7]="SHUTDOWN"}(Tr||(Tr={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.NOMINAL=1]="NOMINAL",e[e.FAIR=2]="FAIR",e[e.SERIOUS=3]="SERIOUS",e[e.CRITICAL=4]="CRITICAL"}(Cr||(Cr={}));const kr=new class extends ut{constructor(){super("stream.video.sfu.models.CallState",[{no:1,name:"participants",kind:"message",repeat:1,T:()=>Rr},{no:2,name:"started_at",kind:"message",T:()=>dr},{no:3,name:"participant_count",kind:"message",T:()=>Er},{no:4,name:"pins",kind:"message",repeat:1,T:()=>_r}])}};const Er=new class extends ut{constructor(){super("stream.video.sfu.models.ParticipantCount",[{no:1,name:"total",kind:"scalar",T:13},{no:2,name:"anonymous",kind:"scalar",T:13}])}};const _r=new class extends ut{constructor(){super("stream.video.sfu.models.Pin",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9}])}};const Rr=new class extends ut{constructor(){super("stream.video.sfu.models.Participant",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"published_tracks",kind:"enum",repeat:1,T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:4,name:"joined_at",kind:"message",T:()=>dr},{no:5,name:"track_lookup_prefix",kind:"scalar",T:9},{no:6,name:"connection_quality",kind:"enum",T:()=>["stream.video.sfu.models.ConnectionQuality",pr,"CONNECTION_QUALITY_"]},{no:7,name:"is_speaking",kind:"scalar",T:8},{no:8,name:"is_dominant_speaker",kind:"scalar",T:8},{no:9,name:"audio_level",kind:"scalar",T:2},{no:10,name:"name",kind:"scalar",T:9},{no:11,name:"image",kind:"scalar",T:9},{no:12,name:"custom",kind:"message",T:()=>cr},{no:13,name:"roles",kind:"scalar",repeat:2,T:9}])}};const Ir=new class extends ut{constructor(){super("stream.video.sfu.models.StreamQuality",[{no:1,name:"video_quality",kind:"enum",T:()=>["stream.video.sfu.models.VideoQuality",fr,"VIDEO_QUALITY_"]},{no:2,name:"user_id",kind:"scalar",T:9}])}};const Ar=new class extends ut{constructor(){super("stream.video.sfu.models.VideoDimension",[{no:1,name:"width",kind:"scalar",T:13},{no:2,name:"height",kind:"scalar",T:13}])}};const Pr=new class extends ut{constructor(){super("stream.video.sfu.models.VideoLayer",[{no:1,name:"rid",kind:"scalar",T:9},{no:2,name:"video_dimension",kind:"message",T:()=>Ar},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"fps",kind:"scalar",T:13},{no:6,name:"quality",kind:"enum",T:()=>["stream.video.sfu.models.VideoQuality",fr,"VIDEO_QUALITY_"]}])}};const xr=new class extends ut{constructor(){super("stream.video.sfu.models.SubscribeOption",[{no:1,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:2,name:"codecs",kind:"message",repeat:1,T:()=>Nr}])}};const Or=new class extends ut{constructor(){super("stream.video.sfu.models.PublishOption",[{no:1,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:2,name:"codec",kind:"message",T:()=>Nr},{no:3,name:"bitrate",kind:"scalar",T:5},{no:4,name:"fps",kind:"scalar",T:5},{no:5,name:"max_spatial_layers",kind:"scalar",T:5},{no:6,name:"max_temporal_layers",kind:"scalar",T:5},{no:7,name:"video_dimension",kind:"message",T:()=>Ar},{no:8,name:"id",kind:"scalar",T:5},{no:9,name:"use_single_layer",kind:"scalar",T:8}])}};const Nr=new class extends ut{constructor(){super("stream.video.sfu.models.Codec",[{no:16,name:"payload_type",kind:"scalar",T:13},{no:10,name:"name",kind:"scalar",T:9},{no:14,name:"clock_rate",kind:"scalar",T:13},{no:15,name:"encoding_parameters",kind:"scalar",T:9},{no:12,name:"fmtp",kind:"scalar",T:9}])}};const Dr=new class extends ut{constructor(){super("stream.video.sfu.models.ICETrickle",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",hr,"PEER_TYPE_"]},{no:2,name:"ice_candidate",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}])}};const jr=new class extends ut{constructor(){super("stream.video.sfu.models.TrackInfo",[{no:1,name:"track_id",kind:"scalar",T:9},{no:2,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:5,name:"layers",kind:"message",repeat:1,T:()=>Pr},{no:6,name:"mid",kind:"scalar",T:9},{no:7,name:"dtx",kind:"scalar",T:8},{no:8,name:"stereo",kind:"scalar",T:8},{no:9,name:"red",kind:"scalar",T:8},{no:10,name:"muted",kind:"scalar",T:8},{no:11,name:"codec",kind:"message",T:()=>Nr},{no:12,name:"publish_option_id",kind:"scalar",T:5}])}};const Lr=new class extends ut{constructor(){super("stream.video.sfu.models.Error",[{no:1,name:"code",kind:"enum",T:()=>["stream.video.sfu.models.ErrorCode",gr,"ERROR_CODE_"]},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"should_retry",kind:"scalar",T:8}])}};const Ur=new class extends ut{constructor(){super("stream.video.sfu.models.ClientDetails",[{no:1,name:"sdk",kind:"message",T:()=>Fr},{no:2,name:"os",kind:"message",T:()=>Mr},{no:3,name:"browser",kind:"message",T:()=>Vr},{no:4,name:"device",kind:"message",T:()=>Hr}])}};const Fr=new class extends ut{constructor(){super("stream.video.sfu.models.Sdk",[{no:1,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.SdkType",vr,"SDK_TYPE_"]},{no:2,name:"major",kind:"scalar",T:9},{no:3,name:"minor",kind:"scalar",T:9},{no:4,name:"patch",kind:"scalar",T:9}])}};const Mr=new class extends ut{constructor(){super("stream.video.sfu.models.OS",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"architecture",kind:"scalar",T:9}])}};const Vr=new class extends ut{constructor(){super("stream.video.sfu.models.Browser",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9}])}};const Br=new class extends ut{constructor(){super("stream.video.sfu.models.RTMPIngress",[{no:1,name:"width",kind:"scalar",T:13},{no:2,name:"height",kind:"scalar",T:13},{no:3,name:"frame_rate",kind:"scalar",T:1},{no:4,name:"software",kind:"scalar",T:9},{no:5,name:"version",kind:"scalar",T:9},{no:6,name:"encoder",kind:"scalar",T:9},{no:7,name:"remote_addr",kind:"scalar",T:9}])}};const Hr=new class extends ut{constructor(){super("stream.video.sfu.models.Device",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9}])}};const qr=new class extends ut{constructor(){super("stream.video.sfu.models.Call",[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:9},{no:3,name:"created_by_user_id",kind:"scalar",T:9},{no:4,name:"host_user_id",kind:"scalar",T:9},{no:5,name:"custom",kind:"message",T:()=>cr},{no:6,name:"created_at",kind:"message",T:()=>dr},{no:7,name:"updated_at",kind:"message",T:()=>dr}])}};const Wr=new class extends ut{constructor(){super("stream.video.sfu.models.CallGrants",[{no:1,name:"can_publish_audio",kind:"scalar",T:8},{no:2,name:"can_publish_video",kind:"scalar",T:8},{no:3,name:"can_screenshare",kind:"scalar",T:8}])}};const $r=new class extends ut{constructor(){super("stream.video.sfu.models.InputDevices",[{no:1,name:"available_devices",kind:"scalar",repeat:2,T:9},{no:2,name:"current_device",kind:"scalar",T:9},{no:3,name:"is_permitted",kind:"scalar",T:8}])}};const Jr=new class extends ut{constructor(){super("stream.video.sfu.models.AndroidState",[{no:1,name:"thermal_state",kind:"enum",T:()=>["stream.video.sfu.models.AndroidThermalState",Tr,"ANDROID_THERMAL_STATE_"]},{no:2,name:"is_power_saver_mode",kind:"scalar",T:8}])}};const zr=new class extends ut{constructor(){super("stream.video.sfu.models.AppleState",[{no:1,name:"thermal_state",kind:"enum",T:()=>["stream.video.sfu.models.AppleThermalState",Cr,"APPLE_THERMAL_STATE_"]},{no:2,name:"is_low_power_mode_enabled",kind:"scalar",T:8}])}};const Gr=new class extends ut{constructor(){super("stream.video.sfu.models.PerformanceStats",[{no:1,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:2,name:"codec",kind:"message",T:()=>Nr},{no:3,name:"avg_frame_time_ms",kind:"scalar",T:2},{no:4,name:"avg_fps",kind:"scalar",T:2},{no:5,name:"video_dimension",kind:"message",T:()=>Ar},{no:6,name:"target_bitrate",kind:"scalar",T:5}])}};var Kr=Object.freeze({__proto__:null,AndroidState:Jr,get AndroidThermalState(){return Tr},AppleState:zr,get AppleThermalState(){return Cr},Browser:Vr,Call:qr,get CallEndedReason(){return wr},CallGrants:Wr,CallState:kr,ClientDetails:Ur,Codec:Nr,get ConnectionQuality(){return pr},Device:Hr,Error:Lr,get ErrorCode(){return gr},get GoAwayReason(){return yr},ICETrickle:Dr,InputDevices:$r,OS:Mr,Participant:Rr,ParticipantCount:Er,get PeerType(){return hr},PerformanceStats:Gr,Pin:_r,PublishOption:Or,RTMPIngress:Br,Sdk:Fr,get SdkType(){return vr},StreamQuality:Ir,SubscribeOption:xr,TrackInfo:jr,get TrackType(){return mr},get TrackUnpublishReason(){return br},VideoDimension:Ar,VideoLayer:Pr,get VideoQuality(){return fr},get WebsocketReconnectStrategy(){return Sr}});const Yr=new class extends ut{constructor(){super("stream.video.sfu.signal.StartNoiseCancellationRequest",[{no:1,name:"session_id",kind:"scalar",T:9}])}};const Xr=new class extends ut{constructor(){super("stream.video.sfu.signal.StartNoiseCancellationResponse",[{no:1,name:"error",kind:"message",T:()=>Lr}])}};const Zr=new class extends ut{constructor(){super("stream.video.sfu.signal.StopNoiseCancellationRequest",[{no:1,name:"session_id",kind:"scalar",T:9}])}};const Qr=new class extends ut{constructor(){super("stream.video.sfu.signal.StopNoiseCancellationResponse",[{no:1,name:"error",kind:"message",T:()=>Lr}])}};const eo=new class extends ut{constructor(){super("stream.video.sfu.signal.Reconnection",[{no:1,name:"time_seconds",kind:"scalar",T:2},{no:2,name:"strategy",kind:"enum",T:()=>["stream.video.sfu.models.WebsocketReconnectStrategy",Sr,"WEBSOCKET_RECONNECT_STRATEGY_"]}])}};const to=new class extends ut{constructor(){super("stream.video.sfu.signal.Telemetry",[{no:1,name:"connection_time_seconds",kind:"scalar",oneof:"data",T:2},{no:2,name:"reconnection",kind:"message",oneof:"data",T:()=>eo}])}};const no=new class extends ut{constructor(){super("stream.video.sfu.signal.SendStatsRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"subscriber_stats",kind:"scalar",T:9},{no:3,name:"publisher_stats",kind:"scalar",T:9},{no:4,name:"webrtc_version",kind:"scalar",T:9},{no:5,name:"sdk",kind:"scalar",T:9},{no:6,name:"sdk_version",kind:"scalar",T:9},{no:7,name:"audio_devices",kind:"message",T:()=>$r},{no:8,name:"video_devices",kind:"message",T:()=>$r},{no:9,name:"android",kind:"message",oneof:"deviceState",T:()=>Jr},{no:10,name:"apple",kind:"message",oneof:"deviceState",T:()=>zr},{no:11,name:"telemetry",kind:"message",T:()=>to},{no:12,name:"rtmp",kind:"message",T:()=>Br},{no:13,name:"subscriber_rtc_stats",kind:"scalar",T:9},{no:14,name:"publisher_rtc_stats",kind:"scalar",T:9},{no:15,name:"rtc_stats",kind:"scalar",T:9},{no:16,name:"encode_stats",kind:"message",repeat:1,T:()=>Gr},{no:17,name:"decode_stats",kind:"message",repeat:1,T:()=>Gr},{no:18,name:"unified_session_id",kind:"scalar",T:9}])}};const io=new class extends ut{constructor(){super("stream.video.sfu.signal.SendStatsResponse",[{no:1,name:"error",kind:"message",T:()=>Lr}])}};const so=new class extends ut{constructor(){super("stream.video.sfu.signal.ICERestartRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",hr,"PEER_TYPE_"]}])}};const ro=new class extends ut{constructor(){super("stream.video.sfu.signal.ICERestartResponse",[{no:1,name:"error",kind:"message",T:()=>Lr}])}};const oo=new class extends ut{constructor(){super("stream.video.sfu.signal.UpdateMuteStatesRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:3,name:"mute_states",kind:"message",repeat:1,T:()=>co}])}};const ao=new class extends ut{constructor(){super("stream.video.sfu.signal.UpdateMuteStatesResponse",[{no:4,name:"error",kind:"message",T:()=>Lr}])}};const co=new class extends ut{constructor(){super("stream.video.sfu.signal.TrackMuteState",[{no:1,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:2,name:"muted",kind:"scalar",T:8}])}};new class extends ut{constructor(){super("stream.video.sfu.signal.AudioMuteChanged",[{no:1,name:"muted",kind:"scalar",T:8}])}};new class extends ut{constructor(){super("stream.video.sfu.signal.VideoMuteChanged",[{no:2,name:"muted",kind:"scalar",T:8}])}};const lo=new class extends ut{constructor(){super("stream.video.sfu.signal.UpdateSubscriptionsRequest",[{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>ho}])}};const uo=new class extends ut{constructor(){super("stream.video.sfu.signal.UpdateSubscriptionsResponse",[{no:4,name:"error",kind:"message",T:()=>Lr}])}};const ho=new class extends ut{constructor(){super("stream.video.sfu.signal.TrackSubscriptionDetails",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:4,name:"dimension",kind:"message",T:()=>Ar}])}};const po=new class extends ut{constructor(){super("stream.video.sfu.signal.SendAnswerRequest",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",hr,"PEER_TYPE_"]},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"session_id",kind:"scalar",T:9}])}};const fo=new class extends ut{constructor(){super("stream.video.sfu.signal.SendAnswerResponse",[{no:4,name:"error",kind:"message",T:()=>Lr}])}};const mo=new class extends ut{constructor(){super("stream.video.sfu.signal.ICETrickleResponse",[{no:4,name:"error",kind:"message",T:()=>Lr}])}};const go=new class extends ut{constructor(){super("stream.video.sfu.signal.SetPublisherRequest",[{no:1,name:"sdp",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"tracks",kind:"message",repeat:1,T:()=>jr}])}};const vo=new class extends ut{constructor(){super("stream.video.sfu.signal.SetPublisherResponse",[{no:1,name:"sdp",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"ice_restart",kind:"scalar",T:8},{no:4,name:"error",kind:"message",T:()=>Lr}])}},bo=new class{constructor(e,t,n){this.typeName=e,this.methods=t.map((e=>function(e,t){var n,i,s;let r=e;return r.service=t,r.localName=null!==(n=r.localName)&&void 0!==n?n:pe(r.name),r.serverStreaming=!!r.serverStreaming,r.clientStreaming=!!r.clientStreaming,r.options=null!==(i=r.options)&&void 0!==i?i:{},r.idempotency=null!==(s=r.idempotency)&&void 0!==s?s:void 0,r}(e,this))),this.options=null!==n&&void 0!==n?n:{}}}("stream.video.sfu.signal.SignalServer",[{name:"SetPublisher",options:{},I:go,O:vo},{name:"SendAnswer",options:{},I:po,O:fo},{name:"IceTrickle",options:{},I:Dr,O:mo},{name:"UpdateSubscriptions",options:{},I:lo,O:uo},{name:"UpdateMuteStates",options:{},I:oo,O:ao},{name:"IceRestart",options:{},I:so,O:ro},{name:"SendStats",options:{},I:no,O:io},{name:"StartNoiseCancellation",options:{},I:Yr,O:Xr},{name:"StopNoiseCancellation",options:{},I:Zr,O:Qr}]);const yo=new class extends ut{constructor(){super("stream.video.sfu.event.SfuEvent",[{no:1,name:"subscriber_offer",kind:"message",oneof:"eventPayload",T:()=>Fo},{no:2,name:"publisher_answer",kind:"message",oneof:"eventPayload",T:()=>Mo},{no:3,name:"connection_quality_changed",kind:"message",oneof:"eventPayload",T:()=>Vo},{no:4,name:"audio_level_changed",kind:"message",oneof:"eventPayload",T:()=>Wo},{no:5,name:"ice_trickle",kind:"message",oneof:"eventPayload",T:()=>Dr},{no:6,name:"change_publish_quality",kind:"message",oneof:"eventPayload",T:()=>Go},{no:10,name:"participant_joined",kind:"message",oneof:"eventPayload",T:()=>jo},{no:11,name:"participant_left",kind:"message",oneof:"eventPayload",T:()=>Lo},{no:12,name:"dominant_speaker_changed",kind:"message",oneof:"eventPayload",T:()=>Ho},{no:13,name:"join_response",kind:"message",oneof:"eventPayload",T:()=>Do},{no:14,name:"health_check_response",kind:"message",oneof:"eventPayload",T:()=>Io},{no:16,name:"track_published",kind:"message",oneof:"eventPayload",T:()=>Ao},{no:17,name:"track_unpublished",kind:"message",oneof:"eventPayload",T:()=>Po},{no:18,name:"error",kind:"message",oneof:"eventPayload",T:()=>Co},{no:19,name:"call_grants_updated",kind:"message",oneof:"eventPayload",T:()=>Ko},{no:20,name:"go_away",kind:"message",oneof:"eventPayload",T:()=>Yo},{no:21,name:"ice_restart",kind:"message",oneof:"eventPayload",T:()=>ko},{no:22,name:"pins_updated",kind:"message",oneof:"eventPayload",T:()=>To},{no:23,name:"call_ended",kind:"message",oneof:"eventPayload",T:()=>Xo},{no:24,name:"participant_updated",kind:"message",oneof:"eventPayload",T:()=>Uo},{no:25,name:"participant_migration_complete",kind:"message",oneof:"eventPayload",T:()=>So},{no:27,name:"change_publish_options",kind:"message",oneof:"eventPayload",T:()=>wo}])}};const wo=new class extends ut{constructor(){super("stream.video.sfu.event.ChangePublishOptions",[{no:1,name:"publish_options",kind:"message",repeat:1,T:()=>Or},{no:2,name:"reason",kind:"scalar",T:9}])}};new class extends ut{constructor(){super("stream.video.sfu.event.ChangePublishOptionsComplete",[])}};const So=new class extends ut{constructor(){super("stream.video.sfu.event.ParticipantMigrationComplete",[])}};const To=new class extends ut{constructor(){super("stream.video.sfu.event.PinsChanged",[{no:1,name:"pins",kind:"message",repeat:1,T:()=>_r}])}};const Co=new class extends ut{constructor(){super("stream.video.sfu.event.Error",[{no:4,name:"error",kind:"message",T:()=>Lr},{no:5,name:"reconnect_strategy",kind:"enum",T:()=>["stream.video.sfu.models.WebsocketReconnectStrategy",Sr,"WEBSOCKET_RECONNECT_STRATEGY_"]}])}};new class extends ut{constructor(){super("stream.video.sfu.event.ICETrickle",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",hr,"PEER_TYPE_"]},{no:2,name:"ice_candidate",kind:"scalar",T:9}])}};const ko=new class extends ut{constructor(){super("stream.video.sfu.event.ICERestart",[{no:1,name:"peer_type",kind:"enum",T:()=>["stream.video.sfu.models.PeerType",hr,"PEER_TYPE_"]}])}};const Eo=new class extends ut{constructor(){super("stream.video.sfu.event.SfuRequest",[{no:1,name:"join_request",kind:"message",oneof:"requestPayload",T:()=>xo},{no:2,name:"health_check_request",kind:"message",oneof:"requestPayload",T:()=>Ro},{no:3,name:"leave_call_request",kind:"message",oneof:"requestPayload",T:()=>_o}])}};const _o=new class extends ut{constructor(){super("stream.video.sfu.event.LeaveCallRequest",[{no:1,name:"session_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9}])}};const Ro=new class extends ut{constructor(){super("stream.video.sfu.event.HealthCheckRequest",[])}};const Io=new class extends ut{constructor(){super("stream.video.sfu.event.HealthCheckResponse",[{no:1,name:"participant_count",kind:"message",T:()=>Er}])}};const Ao=new class extends ut{constructor(){super("stream.video.sfu.event.TrackPublished",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:4,name:"participant",kind:"message",T:()=>Rr}])}};const Po=new class extends ut{constructor(){super("stream.video.sfu.event.TrackUnpublished",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:4,name:"cause",kind:"enum",T:()=>["stream.video.sfu.models.TrackUnpublishReason",br,"TRACK_UNPUBLISH_REASON_"]},{no:5,name:"participant",kind:"message",T:()=>Rr}])}};const xo=new class extends ut{constructor(){super("stream.video.sfu.event.JoinRequest",[{no:1,name:"token",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"subscriber_sdp",kind:"scalar",T:9},{no:8,name:"publisher_sdp",kind:"scalar",T:9},{no:4,name:"client_details",kind:"message",T:()=>Ur},{no:5,name:"migration",kind:"message",T:()=>No},{no:6,name:"fast_reconnect",kind:"scalar",T:8},{no:7,name:"reconnect_details",kind:"message",T:()=>Oo},{no:9,name:"preferred_publish_options",kind:"message",repeat:1,T:()=>Or},{no:10,name:"preferred_subscribe_options",kind:"message",repeat:1,T:()=>xr}])}};const Oo=new class extends ut{constructor(){super("stream.video.sfu.event.ReconnectDetails",[{no:1,name:"strategy",kind:"enum",T:()=>["stream.video.sfu.models.WebsocketReconnectStrategy",Sr,"WEBSOCKET_RECONNECT_STRATEGY_"]},{no:3,name:"announced_tracks",kind:"message",repeat:1,T:()=>jr},{no:4,name:"subscriptions",kind:"message",repeat:1,T:()=>ho},{no:5,name:"reconnect_attempt",kind:"scalar",T:13},{no:6,name:"from_sfu_id",kind:"scalar",T:9},{no:7,name:"previous_session_id",kind:"scalar",T:9},{no:8,name:"reason",kind:"scalar",T:9}])}};const No=new class extends ut{constructor(){super("stream.video.sfu.event.Migration",[{no:1,name:"from_sfu_id",kind:"scalar",T:9},{no:2,name:"announced_tracks",kind:"message",repeat:1,T:()=>jr},{no:3,name:"subscriptions",kind:"message",repeat:1,T:()=>ho}])}};const Do=new class extends ut{constructor(){super("stream.video.sfu.event.JoinResponse",[{no:1,name:"call_state",kind:"message",T:()=>kr},{no:2,name:"reconnected",kind:"scalar",T:8},{no:3,name:"fast_reconnect_deadline_seconds",kind:"scalar",T:5},{no:4,name:"publish_options",kind:"message",repeat:1,T:()=>Or}])}};const jo=new class extends ut{constructor(){super("stream.video.sfu.event.ParticipantJoined",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>Rr}])}};const Lo=new class extends ut{constructor(){super("stream.video.sfu.event.ParticipantLeft",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>Rr}])}};const Uo=new class extends ut{constructor(){super("stream.video.sfu.event.ParticipantUpdated",[{no:1,name:"call_cid",kind:"scalar",T:9},{no:2,name:"participant",kind:"message",T:()=>Rr}])}};const Fo=new class extends ut{constructor(){super("stream.video.sfu.event.SubscriberOffer",[{no:1,name:"ice_restart",kind:"scalar",T:8},{no:2,name:"sdp",kind:"scalar",T:9}])}};const Mo=new class extends ut{constructor(){super("stream.video.sfu.event.PublisherAnswer",[{no:1,name:"sdp",kind:"scalar",T:9}])}};const Vo=new class extends ut{constructor(){super("stream.video.sfu.event.ConnectionQualityChanged",[{no:1,name:"connection_quality_updates",kind:"message",repeat:1,T:()=>Bo}])}};const Bo=new class extends ut{constructor(){super("stream.video.sfu.event.ConnectionQualityInfo",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"connection_quality",kind:"enum",T:()=>["stream.video.sfu.models.ConnectionQuality",pr,"CONNECTION_QUALITY_"]}])}};const Ho=new class extends ut{constructor(){super("stream.video.sfu.event.DominantSpeakerChanged",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9}])}};const qo=new class extends ut{constructor(){super("stream.video.sfu.event.AudioLevel",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"session_id",kind:"scalar",T:9},{no:3,name:"level",kind:"scalar",T:2},{no:4,name:"is_speaking",kind:"scalar",T:8}])}};const Wo=new class extends ut{constructor(){super("stream.video.sfu.event.AudioLevelChanged",[{no:1,name:"audio_levels",kind:"message",repeat:1,T:()=>qo}])}};const $o=new class extends ut{constructor(){super("stream.video.sfu.event.AudioSender",[{no:2,name:"codec",kind:"message",T:()=>Nr},{no:3,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:4,name:"publish_option_id",kind:"scalar",T:5}])}};const Jo=new class extends ut{constructor(){super("stream.video.sfu.event.VideoLayerSetting",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"active",kind:"scalar",T:8},{no:3,name:"max_bitrate",kind:"scalar",T:5},{no:4,name:"scale_resolution_down_by",kind:"scalar",T:2},{no:6,name:"codec",kind:"message",T:()=>Nr},{no:7,name:"max_framerate",kind:"scalar",T:13},{no:8,name:"scalability_mode",kind:"scalar",T:9}])}};const zo=new class extends ut{constructor(){super("stream.video.sfu.event.VideoSender",[{no:2,name:"codec",kind:"message",T:()=>Nr},{no:3,name:"layers",kind:"message",repeat:1,T:()=>Jo},{no:4,name:"track_type",kind:"enum",T:()=>["stream.video.sfu.models.TrackType",mr,"TRACK_TYPE_"]},{no:5,name:"publish_option_id",kind:"scalar",T:5}])}};const Go=new class extends ut{constructor(){super("stream.video.sfu.event.ChangePublishQuality",[{no:1,name:"audio_senders",kind:"message",repeat:1,T:()=>$o},{no:2,name:"video_senders",kind:"message",repeat:1,T:()=>zo}])}};const Ko=new class extends ut{constructor(){super("stream.video.sfu.event.CallGrantsUpdated",[{no:1,name:"current_grants",kind:"message",T:()=>Wr},{no:2,name:"message",kind:"scalar",T:9}])}};const Yo=new class extends ut{constructor(){super("stream.video.sfu.event.GoAway",[{no:1,name:"reason",kind:"enum",T:()=>["stream.video.sfu.models.GoAwayReason",yr,"GO_AWAY_REASON_"]}])}};const Xo=new class extends ut{constructor(){super("stream.video.sfu.event.CallEnded",[{no:1,name:"reason",kind:"enum",T:()=>["stream.video.sfu.models.CallEndedReason",wr,"CALL_ENDED_REASON_"]}])}};var Zo,Qo;!function(e){e.UNKNOWN="UNKNOWN",e.VISIBLE="VISIBLE",e.INVISIBLE="INVISIBLE"}(Zo||(Zo={})),function(e){e[e.IMMEDIATE=20]="IMMEDIATE",e[e.FAST=100]="FAST",e[e.MEDIUM=600]="MEDIUM",e[e.SLOW=1200]="SLOW"}(Qo||(Qo={}));class ea{constructor(e){this._transport=e,this.typeName=bo.typeName,this.methods=bo.methods,this.options=bo.options}setPublisher(e,t){const n=this.methods[0],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}sendAnswer(e,t){const n=this.methods[1],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}iceTrickle(e,t){const n=this.methods[2],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}updateSubscriptions(e,t){const n=this.methods[3],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}updateMuteStates(e,t){const n=this.methods[4],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}iceRestart(e,t){const n=this.methods[5],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}sendStats(e,t){const n=this.methods[6],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}startNoiseCancellation(e,t){const n=this.methods[7],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}stopNoiseCancellation(e,t){const n=this.methods[8],i=this._transport.mergeOptions(t);return dt("unary",this._transport,n,i,e)}}const ta={baseUrl:"",sendJson:!0,timeout:5e3,jsonOptions:{ignoreUnknownFields:!0}},na=(e,t)=>({interceptUnary:(n,i,s,r)=>{let o;try{o=n(i,s,r)}finally{var a,c,l;e(t,"Invoked SFU RPC method ".concat(i.name),{request:null===(a=o)||void 0===a?void 0:a.request,headers:null===(c=o)||void 0===c?void 0:c.requestHeaders,response:null===(l=o)||void 0===l?void 0:l.response})}return o}}),ia=e=>{const t={SendStats:!0};return{interceptUnary(n,i,s,r){if(t[i.name])return n(i,s,r);try{return e(i.name,s),n(i,s,r)}catch(o){throw e("".concat(i.name,"OnFailure"),[s,o]),o}}}},sa=e=>new Promise((t=>setTimeout(t,e)));function ra(e){return e&&("[object Function]"===Object.prototype.toString.call(e)||"function"===typeof e||e instanceof Function)}const oa=40,aa=1e3;function ca(e){const t=Math.min(500+2e3*e,5e3),n=Math.min(Math.max(250,2e3*(e-1)),5e3);return Math.floor(Math.random()*(t-n)+n)}function la(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].toString(16).padStart(2,"0");return t}function ua(){const e=function(e){const t=new Uint8Array(e);return da(t),t}(16);return e[6]=15&e[6]|64,e[8]=191&e[8]|128,[la(e.subarray(0,4)),la(e.subarray(4,6)),la(e.subarray(6,8)),la(e.subarray(8,10)),la(e.subarray(10,16))].join("-")}const da="undefined"!==typeof crypto&&crypto.getRandomValues?crypto.getRandomValues.bind(crypto):function(e){const t=Math.pow(2,8*e.byteLength/e.length);for(let n=0;n<e.length;n++)e[n]=Math.random()*t};function ha(e){"undefined"!==typeof window&&window.addEventListener&&(window.addEventListener("offline",e),window.addEventListener("online",e))}function pa(e){"undefined"!==typeof window&&window.removeEventListener&&(window.removeEventListener("offline",e),window.removeEventListener("online",e))}const fa=()=>{var e;return"undefined"!==typeof navigator&&"reactnative"===(null===(e=navigator.product)||void 0===e?void 0:e.toLowerCase())},ma=Object.freeze({trace:0,debug:1,info:2,warn:3,error:4});let ga,va="info";const ba=function(e,t){let n;switch(e){case"error":if(fa()){t="ERROR: ".concat(t),n=console.info;break}n=console.error;break;case"warn":if(fa()){t="WARN: ".concat(t),n=console.info;break}n=console.warn;break;case"info":n=console.info;break;case"trace":n=console.trace;break;default:n=console.log}for(var i=arguments.length,s=new Array(i>2?i-2:0),r=2;r<i;r++)s[r-2]=arguments[r];n(t,...s)},ya=e=>{va=e},wa=()=>va,Sa=e=>{const t=ga||ba,n=(e||[]).filter(Boolean).join(":");return function(e,i){if(ma[e]>=ma[va]){for(var s=arguments.length,r=new Array(s>2?s-2:0),o=2;o<s;o++)r[o-2]=arguments[o];t(e,"[".concat(n,"]: ").concat(i),...r)}}},Ta=async(e,t)=>{let n,i=0;do{var s;i>0&&await sa(ca(i));try{n=await e()}catch(o){var r;const e=o instanceof ht&&o.code===Fi[Fi.cancelled],n=null!==(r=null===t||void 0===t?void 0:t.aborted)&&void 0!==r&&r;if(e||n)throw o;Sa(["sfu-client","rpc"])("debug","rpc failed (".concat(i,")"),o),i++}}while(!n||null!==(s=n.response.error)&&void 0!==s&&s.shouldRetry);return n},Ca=async e=>{var t;const n=new RTCPeerConnection;n.addTransceiver("video",{direction:e}),n.addTransceiver("audio",{direction:e});const i=null!==(t=(await n.createOffer()).sdp)&&void 0!==t?t:"";return n.getTransceivers().forEach((e=>{var t;null===(t=e.stop)||void 0===t||t.call(e)})),n.close(),i},ka=e=>!!e&&("vp9"===(e=e.toLowerCase())||"av1"===e||"video/vp9"===e||"video/av1"===e),Ea={subscriberOffer:void 0,publisherAnswer:void 0,connectionQualityChanged:void 0,audioLevelChanged:void 0,iceTrickle:void 0,changePublishQuality:void 0,participantJoined:void 0,participantLeft:void 0,dominantSpeakerChanged:void 0,joinResponse:void 0,healthCheckResponse:void 0,trackPublished:void 0,trackUnpublished:void 0,error:void 0,callGrantsUpdated:void 0,goAway:void 0,iceRestart:void 0,pinsUpdated:void 0,callEnded:void 0,participantUpdated:void 0,participantMigrationComplete:void 0,changePublishOptions:void 0},_a=e=>Object.prototype.hasOwnProperty.call(Ea,e);class Ra{constructor(){var e=this;this.logger=Sa(["Dispatcher"]),this.subscribers={},this.dispatch=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";const i=t.eventPayload.oneofKind;if(!i)return;const s=t.eventPayload[i];e.logger("debug","Dispatching ".concat(i,", tag=").concat(n),s);const r=e.subscribers[i];if(r)for(const a of r)try{a(s)}catch(o){e.logger("warn","Listener failed with error",o)}},this.on=(e,t)=>{var n,i;return(null!==(n=(i=this.subscribers)[e])&&void 0!==n?n:i[e]=[]).push(t),()=>{this.off(e,t)}},this.off=(e,t)=>{this.subscribers[e]=(this.subscribers[e]||[]).filter((e=>e!==t))}}}class Ia{constructor(){this.subscriberCandidates=new ts,this.publisherCandidates=new ts,this.push=e=>{const t=Aa(e);if(t)if(e.peerType===hr.SUBSCRIBER)this.subscriberCandidates.next(t);else if(e.peerType===hr.PUBLISHER_UNSPECIFIED)this.publisherCandidates.next(t);else{Sa(["sfu-client"])("warn","ICETrickle, Unknown peer type",e)}},this.dispose=()=>{this.subscriberCandidates.complete(),this.publisherCandidates.complete()}}}const Aa=e=>{try{return JSON.parse(e.iceCandidate)}catch(t){return void Sa(["sfu-client"])("error","Failed to parse ICE Trickle",t,e)}},Pa=Na((function(e,t){let n=!1;return{cb:()=>t().finally((()=>{n||Oa.delete(e)})),onContinued:()=>n=!0}})),xa=Na((function(e,t){const n=new AbortController;return{cb:()=>n.signal.aborted?Promise.resolve("canceled"):t(n.signal).finally((()=>{n.signal.aborted||Oa.delete(e)})),onContinued:()=>n.abort()}})),Oa=new Map;function Na(e){return function(t,n){const{cb:i,onContinued:s}=e(t,n),r=Oa.get(t);null===r||void 0===r||r.onContinued();const o=r?r.promise.then(i,i):i();return Oa.set(t,{promise:o,onContinued:s}),o}}const Da=e=>{let t,n;if(gs([e]).subscribe({next:e=>{let[n]=e;t=n},error:e=>{n=e}}).unsubscribe(),n)throw n;return t},ja=(e,t)=>{const n=(e=>"function"===typeof e)(t)?t(Da(e)):t;return e.next(n),n},La=(e,t)=>{const n=e.getValue(),i=ja(e,t);return{lastValue:n,value:i,rollback:()=>ja(e,n)}},Ua=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>Sa(["RxUtils"])("warn","An observable emitted an error",e);const i=e.subscribe({next:t,error:n});return()=>{i.unsubscribe()}},Fa=(e,t)=>{const n=Symbol();return Ua(e,(e=>{Pa(n,(()=>t(e)))}))};var Ma,Va=Object.freeze({__proto__:null,createSafeAsyncSubscription:Fa,createSubscription:Ua,getCurrentValue:Da,setCurrentValue:ja,updateValue:La});!function(e){e.UNKNOWN="unknown",e.IDLE="idle",e.RINGING="ringing",e.JOINING="joining",e.JOINED="joined",e.LEFT="left",e.RECONNECTING="reconnecting",e.MIGRATING="migrating",e.RECONNECTING_FAILED="reconnecting-failed",e.OFFLINE="offline"}(Ma||(Ma={}));class Ba{constructor(){this.connectedUserSubject=new bs(void 0),this.callsSubject=new bs([]),this.setConnectedUser=e=>ja(this.connectedUserSubject,e),this.setCalls=e=>ja(this.callsSubject,e),this.registerCall=e=>{this.calls.find((t=>t.cid===e.cid))||this.setCalls((t=>[...t,e]))},this.unregisterCall=e=>(Sa(["client-state"])("trace","Unregistering call: ".concat(e.cid)),this.setCalls((t=>t.filter((t=>t!==e))))),this.findCall=(e,t)=>this.calls.find((n=>n.type===e&&n.id===t)),this.connectedUserSubject.subscribe((async e=>{if(!e){const e=Sa(["client-state"]);for(const t of this.calls)t.state.callingState!==Ma.LEFT&&(e("info","User disconnected, leaving call: ".concat(t.cid)),await t.leave({message:"client.disconnectUser() called"}).catch((n=>{e("error","Error leaving call: ".concat(t.cid),n)})))}}))}get connectedUser(){return Da(this.connectedUserSubject)}get calls(){return Da(this.callsSubject)}}class Ha{constructor(e){this.getCurrentValue=Da,this.connectedUser$=e.connectedUserSubject.asObservable(),this.calls$=e.callsSubject.asObservable()}get connectedUser(){return Da(this.connectedUser$)}get calls(){return Da(this.calls$)}}const qa=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(e,n)=>{for(const i of t){const t=i(e,n);if(0!==t)return t}return 0}},Wa=e=>t=>(n,i)=>e(n,i)?t(n,i):0,$a=e=>e.publishedTracks.includes(mr.VIDEO),Ja=e=>e.publishedTracks.includes(mr.AUDIO),za=e=>e.publishedTracks.includes(mr.SCREEN_SHARE),Ga=e=>e.publishedTracks.includes(mr.SCREEN_SHARE_AUDIO),Ka=e=>!!e.pin&&(e.pin.isLocalPin||e.pin.pinnedAt>0),Ya=(e,t)=>e.isDominantSpeaker&&!t.isDominantSpeaker?-1:!e.isDominantSpeaker&&t.isDominantSpeaker?1:0,Xa=(e,t)=>e.isSpeaking&&!t.isSpeaking?-1:!e.isSpeaking&&t.isSpeaking?1:0,Za=(e,t)=>za(e)&&!za(t)?-1:!za(e)&&za(t)?1:0,Qa=(e,t)=>$a(e)&&!$a(t)?-1:!$a(e)&&$a(t)?1:0,ec=(e,t)=>Ja(e)&&!Ja(t)?-1:!Ja(e)&&Ja(t)?1:0,tc=(e,t)=>{if(e.pin&&t.pin){if(!e.pin.isLocalPin&&t.pin.isLocalPin)return-1;if(e.pin.isLocalPin&&!t.pin.isLocalPin)return 1;if(e.pin.pinnedAt>t.pin.pinnedAt)return-1;if(e.pin.pinnedAt<t.pin.pinnedAt)return 1}return e.pin&&!t.pin?-1:!e.pin&&t.pin?1:0},nc=e=>(t,n)=>{var i,s,r,o;return(null===(i=t.reaction)||void 0===i?void 0:i.type)===e&&(null===(s=n.reaction)||void 0===s?void 0:s.type)!==e?-1:(null===(r=t.reaction)||void 0===r?void 0:r.type)!==e&&(null===(o=n.reaction)||void 0===o?void 0:o.type)===e?1:0},ic=(e,t)=>(e.roles||[]).some((e=>t.includes(e))),sc=Wa(((e,t)=>{var n,i;return(null===(n=e.viewportVisibilityState)||void 0===n?void 0:n.videoTrack)===Zo.INVISIBLE||(null===(i=t.viewportVisibilityState)||void 0===i?void 0:i.videoTrack)===Zo.INVISIBLE})),rc=Wa(((e,t)=>{var n,i,s,r;return(null===(n=e.viewportVisibilityState)||void 0===n?void 0:n.videoTrack)===Zo.INVISIBLE||(null===(i=e.viewportVisibilityState)||void 0===i?void 0:i.videoTrack)===Zo.UNKNOWN||(null===(s=t.viewportVisibilityState)||void 0===s?void 0:s.videoTrack)===Zo.INVISIBLE||(null===(r=t.viewportVisibilityState)||void 0===r?void 0:r.videoTrack)===Zo.UNKNOWN})),oc=qa(tc,Za,sc(qa(Ya,Xa,nc("raised-hand"),Qa,ec))),ac=qa(tc,Za,Ya,sc(qa(Xa,nc("raised-hand"),Qa,ec))),cc=qa(tc,rc(qa(Ya,Xa,nc("raised-hand"),Qa,ec))),lc=qa(sc(qa(Ya,Xa,nc("raised-hand"),Qa,ec)),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(e,n)=>ic(e,t)&&!ic(n,t)?-1:!ic(e,t)&&ic(n,t)?1:0}("admin","host","speaker")),uc={broadcasting:!1,hls:{playlist_url:"",status:""},rtmps:[]};class dc{constructor(){this.backstageSubject=new bs(!0),this.blockedUserIdsSubject=new bs([]),this.createdAtSubject=new bs(new Date),this.endedAtSubject=new bs(void 0),this.startsAtSubject=new bs(void 0),this.updatedAtSubject=new bs(new Date),this.createdBySubject=new bs(void 0),this.customSubject=new bs({}),this.egressSubject=new bs(void 0),this.ingressSubject=new bs(void 0),this.recordingSubject=new bs(!1),this.sessionSubject=new bs(void 0),this.settingsSubject=new bs(void 0),this.transcribingSubject=new bs(!1),this.captioningSubject=new bs(!1),this.endedBySubject=new bs(void 0),this.thumbnailsSubject=new bs(void 0),this.membersSubject=new bs([]),this.ownCapabilitiesSubject=new bs([]),this.callingStateSubject=new bs(Ma.UNKNOWN),this.startedAtSubject=new bs(void 0),this.participantCountSubject=new bs(0),this.anonymousParticipantCountSubject=new bs(0),this.participantsSubject=new bs([]),this.callStatsReportSubject=new bs(void 0),this.closedCaptionsSubject=new bs([]),this.orphanedTracks=[],this.logger=Sa(["CallState"]),this.sortParticipantsBy=oc,this.closedCaptionsTasks=new Map,this.dispose=()=>{for(const[e,t]of this.closedCaptionsTasks.entries())clearTimeout(t),this.closedCaptionsTasks.delete(e)},this.setSortParticipantsBy=e=>{this.sortParticipantsBy=e,this.setCurrentValue(this.participantsSubject,(e=>e))},this.getCurrentValue=Da,this.setCurrentValue=ja,this.setParticipantCount=e=>this.setCurrentValue(this.participantCountSubject,e),this.setStartedAt=e=>this.setCurrentValue(this.startedAtSubject,e),this.setCaptioning=e=>La(this.captioningSubject,e),this.setAnonymousParticipantCount=e=>this.setCurrentValue(this.anonymousParticipantCountSubject,e),this.setParticipants=e=>this.setCurrentValue(this.participantsSubject,e),this.setCallingState=e=>this.setCurrentValue(this.callingStateSubject,e),this.setCallStatsReport=e=>this.setCurrentValue(this.callStatsReportSubject,e),this.setMembers=e=>{this.setCurrentValue(this.membersSubject,e)},this.setOwnCapabilities=e=>this.setCurrentValue(this.ownCapabilitiesSubject,e),this.setBackstage=e=>this.setCurrentValue(this.backstageSubject,e),this.setEndedAt=e=>this.setCurrentValue(this.endedAtSubject,e),this.findParticipantBySessionId=e=>this.participants.find((t=>t.sessionId===e)),this.getParticipantLookupBySessionId=()=>this.participants.reduce(((e,t)=>(e[t.sessionId]=t,e)),{}),this.updateParticipant=(e,t)=>{const n=this.findParticipantBySessionId(e);if(!n)return void this.logger("warn","Participant with sessionId ".concat(e," not found"));const i="function"===typeof t?t(n):t,s=(0,u.A)((0,u.A)({},n),i);return this.setParticipants((t=>t.map((t=>t.sessionId===e?s:t))))},this.updateOrAddParticipant=(e,t)=>this.setParticipants((n=>{let i=!0;const s=n.map((n=>n.sessionId===e?(i=!1,(0,u.A)((0,u.A)({},n),t)):n));return i&&s.push(t),s})),this.updateParticipants=e=>0===Object.keys(e).length?this.participants:this.setParticipants((t=>t.map((t=>{const n=e[t.sessionId];return n?(0,u.A)((0,u.A)({},t),n):t})))),this.updateParticipantTracks=(e,t)=>this.updateParticipants(Object.entries(t).reduce(((t,n)=>{let[i,s]=n;s.dimension&&(s.dimension.height=Math.ceil(s.dimension.height),s.dimension.width=Math.ceil(s.dimension.width));const r="videoTrack"===e?"videoDimension":"screenShareTrack"===e?"screenShareDimension":void 0;return r&&(t[i]={[r]:s.dimension}),t}),{})),this.updateFromEvent=e=>{const t=this.eventHandlers[e.type];t&&t(e)},this.setServerSidePins=e=>{const t=e.reduce(((e,t)=>(e[t.sessionId]=Date.now(),e)),{});return this.setParticipants((e=>e.map((e=>{const n=t[e.sessionId];return n?(0,u.A)((0,u.A)({},e),{},{pin:{isLocalPin:!1,pinnedAt:n}}):e.pin&&!e.pin.isLocalPin?(0,u.A)((0,u.A)({},e),{},{pin:void 0}):e}))))},this.registerOrphanedTrack=e=>{this.orphanedTracks.push(e)},this.removeOrphanedTrack=e=>{this.orphanedTracks=this.orphanedTracks.filter((t=>t.id!==e))},this.takeOrphanedTracks=e=>{const t=this.orphanedTracks.filter((t=>t.trackLookupPrefix===e));return t.length>0&&(this.orphanedTracks=this.orphanedTracks.filter((t=>t.trackLookupPrefix!==e))),t},this.updateClosedCaptionSettings=e=>{this.closedCaptionsSettings=(0,u.A)((0,u.A)({},this.closedCaptionsSettings),e)},this.updateFromCallResponse=e=>{this.setBackstage(e.backstage),this.setCurrentValue(this.blockedUserIdsSubject,e.blocked_user_ids),this.setCurrentValue(this.createdAtSubject,new Date(e.created_at)),this.setCurrentValue(this.updatedAtSubject,new Date(e.updated_at)),this.setCurrentValue(this.startsAtSubject,e.starts_at?new Date(e.starts_at):void 0),this.setEndedAt(e.ended_at?new Date(e.ended_at):void 0),this.setCurrentValue(this.createdBySubject,e.created_by),this.setCurrentValue(this.customSubject,e.custom),this.setCurrentValue(this.egressSubject,e.egress),this.setCurrentValue(this.ingressSubject,e.ingress),this.setCurrentValue(this.recordingSubject,e.recording);const t=this.setCurrentValue(this.sessionSubject,e.session);this.updateParticipantCountFromSession(t),this.setCurrentValue(this.settingsSubject,e.settings),this.setCurrentValue(this.transcribingSubject,e.transcribing),this.setCurrentValue(this.captioningSubject,e.captioning),this.setCurrentValue(this.thumbnailsSubject,e.thumbnails)},this.updateFromSfuCallState=(e,t,n)=>{var i;const{participants:s,participantCount:r,startedAt:o,pins:a}=e,c=null!==(i=null===n||void 0===n?void 0:n.announcedTracks.map((e=>e.trackType)))&&void 0!==i?i:[];this.setParticipants((()=>{const e=this.getParticipantLookupBySessionId();return s.map((n=>{var i;const s=e[n.sessionId],r=n.sessionId===t;return Object.assign({},s,n,{isLocalParticipant:r,publishedTracks:r?c:n.publishedTracks,viewportVisibilityState:null!==(i=null===s||void 0===s?void 0:s.viewportVisibilityState)&&void 0!==i?i:{videoTrack:Zo.UNKNOWN,screenShareTrack:Zo.UNKNOWN}})}))})),this.setParticipantCount((null===r||void 0===r?void 0:r.total)||0),this.setAnonymousParticipantCount((null===r||void 0===r?void 0:r.anonymous)||0),this.setStartedAt(o?dr.toDate(o):new Date),this.setServerSidePins(a)},this.updateFromMemberRemoved=e=>{this.updateFromCallResponse(e.call),this.setCurrentValue(this.membersSubject,(t=>t.filter((t=>-1===e.members.indexOf(t.user_id)))))},this.updateFromMemberAdded=e=>{this.updateFromCallResponse(e.call),this.setCurrentValue(this.membersSubject,(t=>[...t,...e.members]))},this.updateFromHLSBroadcastStopped=()=>{this.setCurrentValue(this.egressSubject,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uc;return(0,u.A)((0,u.A)({},e),{},{broadcasting:!1,hls:(0,u.A)((0,u.A)({},e.hls),{},{status:""})})}))},this.updateFromHLSBroadcastingFailed=()=>{this.setCurrentValue(this.egressSubject,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uc;return(0,u.A)((0,u.A)({},e),{},{broadcasting:!1,hls:(0,u.A)((0,u.A)({},e.hls),{},{status:""})})}))},this.updateParticipantCountFromSession=e=>{if(!e||this.callingState===Ma.JOINED)return;const t=Object.values(e.participants_count_by_role).reduce(((e,t)=>e+t),0),n=Math.max(t,e.participants.length);this.setParticipantCount(n),this.setAnonymousParticipantCount(e.anonymous_participant_count||0)},this.updateFromSessionParticipantCountUpdate=e=>{const t=this.setCurrentValue(this.sessionSubject,(t=>t?(0,u.A)((0,u.A)({},t),{},{anonymous_participant_count:e.anonymous_participant_count,participants_count_by_role:e.participants_count_by_role}):t));this.updateParticipantCountFromSession(t)},this.updateFromSessionParticipantLeft=e=>{const t=this.setCurrentValue(this.sessionSubject,(t=>{if(!t)return t;const{participants:n,participants_count_by_role:i}=t,{user:s,user_session_id:r}=e.participant;return(0,u.A)((0,u.A)({},t),{},{participants:n.filter((e=>e.user_session_id!==r)),participants_count_by_role:(0,u.A)((0,u.A)({},i),{},{[s.role]:Math.max(0,(i[s.role]||0)-1)})})}));this.updateParticipantCountFromSession(t)},this.updateFromSessionParticipantJoined=e=>{const t=this.setCurrentValue(this.sessionSubject,(t=>{if(!t)return t;const{participants:n,participants_count_by_role:i}=t,{user:s,user_session_id:r}=e.participant;let o=!0;const a=n.map((t=>t.user_session_id===r?(o=!1,e.participant):t));o&&a.push(e.participant);const c=o?1:0;return(0,u.A)((0,u.A)({},t),{},{participants:a,participants_count_by_role:(0,u.A)((0,u.A)({},i),{},{[s.role]:(i[s.role]||0)+c})})}));this.updateParticipantCountFromSession(t)},this.updateMembers=e=>{this.updateFromCallResponse(e.call),this.setCurrentValue(this.membersSubject,(t=>t.map((t=>{const n=e.members.find((e=>e.user_id===t.user_id));return n||t}))))},this.updateParticipantReaction=e=>{const{user:t,custom:n,type:i,emoji_code:s}=e.reaction;this.setParticipants((e=>e.map((e=>e.userId!==t.id?e:(0,u.A)((0,u.A)({},e),{},{reaction:{type:i,emoji_code:s,custom:n}})))))},this.unblockUser=e=>{this.setCurrentValue(this.blockedUserIdsSubject,(t=>t?t.filter((t=>t!==e.user.id)):t))},this.blockUser=e=>{this.setCurrentValue(this.blockedUserIdsSubject,(t=>[...t||[],e.user.id]))},this.updateOwnCapabilities=e=>{var t;e.user.id===(null===(t=this.localParticipant)||void 0===t?void 0:t.userId)&&this.setCurrentValue(this.ownCapabilitiesSubject,e.own_capabilities)},this.updateFromClosedCaptions=e=>{this.setCurrentValue(this.closedCaptionsSubject,(t=>{const{closed_caption:n}=e,i=e=>"".concat(e.speaker_id,"/").concat(e.start_time),s=i(n);if(t.some((e=>i(e)===s)))return t;const r=[...t,n],{visibilityDurationMs:o=2700,maxVisibleCaptions:a=2}=this.closedCaptionsSettings||{};if(o>0){const e=setTimeout((()=>{this.setCurrentValue(this.closedCaptionsSubject,(e=>e.filter((e=>e!==n)))),this.closedCaptionsTasks.delete(s)}),o);this.closedCaptionsTasks.set(s,e);for(let t=0;t<r.length-a;t++){const e=i(r[t]),n=this.closedCaptionsTasks.get(e);clearTimeout(n),this.closedCaptionsTasks.delete(e)}}return r.slice(-a)}))},this.participants$=this.participantsSubject.asObservable().pipe(ds((e=>e.sort(this.sortParticipantsBy))),Ts({bufferSize:1,refCount:!0})),this.localParticipant$=this.participants$.pipe(ds((e=>e.find((e=>e.isLocalParticipant)))),Ts({bufferSize:1,refCount:!0})),this.remoteParticipants$=this.participants$.pipe(ds((e=>e.filter((e=>!e.isLocalParticipant)))),Ts({bufferSize:1,refCount:!0})),this.pinnedParticipants$=this.participants$.pipe(ds((e=>e.filter((e=>!!e.pin)))),Ts({bufferSize:1,refCount:!0})),this.dominantSpeaker$=this.participants$.pipe(ds((e=>e.find((e=>e.isDominantSpeaker)))),Ts({bufferSize:1,refCount:!0})),this.hasOngoingScreenShare$=this.participants$.pipe(ds((e=>e.some((e=>za(e))))),Cs(),Ts({bufferSize:1,refCount:!0})),this.createdAt$=this.createdAtSubject.asObservable(),this.endedAt$=this.endedAtSubject.asObservable(),this.startsAt$=this.startsAtSubject.asObservable(),this.startedAt$=this.startedAtSubject.asObservable(),this.updatedAt$=this.updatedAtSubject.asObservable(),this.callStatsReport$=this.callStatsReportSubject.asObservable(),this.members$=this.membersSubject.asObservable(),this.createdBy$=this.createdBySubject.asObservable(),this.custom$=this.customSubject.asObservable(),this.egress$=this.egressSubject.asObservable(),this.ingress$=this.ingressSubject.asObservable(),this.session$=this.sessionSubject.asObservable(),this.settings$=this.settingsSubject.asObservable(),this.endedBy$=this.endedBySubject.asObservable(),this.thumbnails$=this.thumbnailsSubject.asObservable(),this.closedCaptions$=this.closedCaptionsSubject.asObservable();const e=(e,t)=>{if(e.length!==t.length)return!1;for(const n of e)if(!t.includes(n))return!1;for(const n of t)if(!e.includes(n))return!1;return!0},t=(e,t)=>e.asObservable().pipe(Cs(t));this.anonymousParticipantCount$=t(this.anonymousParticipantCountSubject),this.blockedUserIds$=t(this.blockedUserIdsSubject,e),this.backstage$=t(this.backstageSubject),this.callingState$=t(this.callingStateSubject),this.ownCapabilities$=t(this.ownCapabilitiesSubject,e),this.participantCount$=t(this.participantCountSubject),this.recording$=t(this.recordingSubject),this.transcribing$=t(this.transcribingSubject),this.captioning$=t(this.captioningSubject),this.eventHandlers={"call.frame_recording_ready":void 0,"call.permission_request":void 0,"call.recording_ready":void 0,"call.rtmp_broadcast_failed":void 0,"call.rtmp_broadcast_started":void 0,"call.rtmp_broadcast_stopped":void 0,"call.transcription_ready":void 0,"call.user_muted":void 0,"connection.error":void 0,"connection.ok":void 0,"health.check":void 0,"user.updated":void 0,custom:void 0,"call.accepted":e=>this.updateFromCallResponse(e.call),"call.blocked_user":this.blockUser,"call.closed_caption":this.updateFromClosedCaptions,"call.closed_captions_failed":()=>{this.setCurrentValue(this.captioningSubject,!1)},"call.closed_captions_started":()=>{this.setCurrentValue(this.captioningSubject,!0)},"call.closed_captions_stopped":()=>{this.setCurrentValue(this.captioningSubject,!1)},"call.created":e=>this.updateFromCallResponse(e.call),"call.deleted":e=>this.updateFromCallResponse(e.call),"call.ended":e=>{this.updateFromCallResponse(e.call),this.setCurrentValue(this.endedBySubject,e.user)},"call.frame_recording_failed":e=>{this.updateFromCallResponse(e.call)},"call.frame_recording_started":e=>{this.updateFromCallResponse(e.call)},"call.frame_recording_stopped":e=>{this.updateFromCallResponse(e.call)},"call.hls_broadcasting_failed":this.updateFromHLSBroadcastingFailed,"call.hls_broadcasting_started":e=>{this.updateFromCallResponse(e.call)},"call.hls_broadcasting_stopped":this.updateFromHLSBroadcastStopped,"call.live_started":e=>this.updateFromCallResponse(e.call),"call.member_added":this.updateFromMemberAdded,"call.member_removed":this.updateFromMemberRemoved,"call.member_updated_permission":this.updateMembers,"call.member_updated":this.updateMembers,"call.notification":e=>{this.updateFromCallResponse(e.call),this.setMembers(e.members)},"call.permissions_updated":this.updateOwnCapabilities,"call.reaction_new":this.updateParticipantReaction,"call.recording_started":()=>this.setCurrentValue(this.recordingSubject,!0),"call.recording_stopped":()=>this.setCurrentValue(this.recordingSubject,!1),"call.recording_failed":()=>this.setCurrentValue(this.recordingSubject,!1),"call.rejected":e=>this.updateFromCallResponse(e.call),"call.ring":e=>this.updateFromCallResponse(e.call),"call.missed":e=>this.updateFromCallResponse(e.call),"call.session_ended":e=>this.updateFromCallResponse(e.call),"call.session_participant_count_updated":this.updateFromSessionParticipantCountUpdate,"call.session_participant_joined":this.updateFromSessionParticipantJoined,"call.session_participant_left":this.updateFromSessionParticipantLeft,"call.session_started":e=>this.updateFromCallResponse(e.call),"call.transcription_started":()=>{this.setCurrentValue(this.transcribingSubject,!0)},"call.transcription_stopped":()=>{this.setCurrentValue(this.transcribingSubject,!1)},"call.transcription_failed":()=>{this.setCurrentValue(this.transcribingSubject,!1)},"call.unblocked_user":this.unblockUser,"call.updated":e=>this.updateFromCallResponse(e.call)}}get participantCount(){return this.getCurrentValue(this.participantCount$)}get startedAt(){return this.getCurrentValue(this.startedAt$)}get captioning(){return this.getCurrentValue(this.captioning$)}get anonymousParticipantCount(){return this.getCurrentValue(this.anonymousParticipantCount$)}get participants(){return this.getCurrentValue(this.participants$)}get localParticipant(){return this.getCurrentValue(this.localParticipant$)}get remoteParticipants(){return this.getCurrentValue(this.remoteParticipants$)}get dominantSpeaker(){return this.getCurrentValue(this.dominantSpeaker$)}get pinnedParticipants(){return this.getCurrentValue(this.pinnedParticipants$)}get hasOngoingScreenShare(){return this.getCurrentValue(this.hasOngoingScreenShare$)}get callingState(){return this.getCurrentValue(this.callingState$)}get callStatsReport(){return this.getCurrentValue(this.callStatsReport$)}get members(){return this.getCurrentValue(this.members$)}get ownCapabilities(){return this.getCurrentValue(this.ownCapabilities$)}get backstage(){return this.getCurrentValue(this.backstage$)}get blockedUserIds(){return this.getCurrentValue(this.blockedUserIds$)}get createdAt(){return this.getCurrentValue(this.createdAt$)}get endedAt(){return this.getCurrentValue(this.endedAt$)}get startsAt(){return this.getCurrentValue(this.startsAt$)}get updatedAt(){return this.getCurrentValue(this.updatedAt$)}get createdBy(){return this.getCurrentValue(this.createdBy$)}get custom(){return this.getCurrentValue(this.custom$)}get egress(){return this.getCurrentValue(this.egress$)}get ingress(){return this.getCurrentValue(this.ingress$)}get recording(){return this.getCurrentValue(this.recording$)}get session(){return this.getCurrentValue(this.session$)}get settings(){return this.getCurrentValue(this.settings$)}get transcribing(){return this.getCurrentValue(this.transcribing$)}get endedBy(){return this.getCurrentValue(this.endedBy$)}get thumbnails(){return this.getCurrentValue(this.thumbnails$)}get closedCaptions(){return this.getCurrentValue(this.closedCaptions$)}}const hc=e=>{const t=[];return e.forEach((e=>{t.push(e)})),t},pc=e=>({id:e.id,tracks:e.getTracks().map((e=>({id:e.id,kind:e.kind,label:e.label,enabled:e.enabled,muted:e.muted,readyState:e.readyState})))}),fc=e=>e&&e.type===vr.REACT?"stream-react":e&&e.type===vr.REACT_NATIVE?"stream-react-native":"stream-js",mc=e=>e?"".concat(e.major,".").concat(e.minor,".").concat(e.patch):"0.0.0-development",gc=()=>"undefined"!==typeof navigator&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent||""),vc=()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Firefox"))};var bc=Object.freeze({__proto__:null,isChrome:()=>{var e;return"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Chrome"))},isFirefox:vc,isSafari:gc});const yc=(e,t)=>{const{trackKind:n,kind:i,publisher:s}=t,r="subscriber"===i?"inbound-rtp":"outbound-rtp",o=hc(e);return{rawStats:e,streams:o.filter((e=>e.type===r&&e.kind===n)).map((e=>{const t=e,n=o.find((e=>"codec"===e.type&&e.id===t.codecId)),r=o.find((e=>"transport"===e.type&&e.id===t.transportId));let a,c;if(r&&"connected"===r.dtlsState){const e=o.find((e=>"candidate-pair"===e.type&&e.id===r.selectedCandidatePairId));a=null===e||void 0===e?void 0:e.currentRoundTripTime}if("publisher"===i&&s){const e=vc(),n=o.find((n=>"media-source"===n.type&&(!!e||n.id===t.mediaSourceId)));n&&(c=s.getTrackType(n.trackIdentifier))}return{bytesSent:t.bytesSent,bytesReceived:t.bytesReceived,codec:null===n||void 0===n?void 0:n.mimeType,currentRoundTripTime:a,frameHeight:t.frameHeight,frameWidth:t.frameWidth,framesPerSecond:t.framesPerSecond,jitter:t.jitter,kind:t.kind,mediaSourceId:t.mediaSourceId,qualityLimitationReason:t.qualityLimitationReason,rid:t.rid,ssrc:t.ssrc,trackType:c}})),timestamp:Date.now()}},wc=e=>({rawReport:null!==e&&void 0!==e?e:{streams:[],timestamp:Date.now()},totalBytesSent:0,totalBytesReceived:0,averageJitterInMs:0,averageRoundTripTimeInMs:0,qualityLimitationReasons:"none",highestFrameWidth:0,highestFrameHeight:0,highestFramesPerSecond:0,codec:"",codecPerTrackType:{},timestamp:Date.now()}),Sc=e=>{const t=wc(e);let n=-1;const i=new Set,s=e.streams,r=s.reduce(((e,t)=>{e.totalBytesSent+=t.bytesSent||0,e.totalBytesReceived+=t.bytesReceived||0,e.averageJitterInMs+=t.jitter||0,e.averageRoundTripTimeInMs+=t.currentRoundTripTime||0;const s=(r=t.frameWidth||0,o=t.frameHeight||0,r*o);var r,o;return s>n&&(e.highestFrameWidth=t.frameWidth||0,e.highestFrameHeight=t.frameHeight||0,e.highestFramesPerSecond=t.framesPerSecond||0,n=s),i.add(t.qualityLimitationReason||""),e}),t);s.length>0&&(r.averageJitterInMs=Math.round(r.averageJitterInMs/s.length*1e3),r.averageRoundTripTimeInMs=Math.round(r.averageRoundTripTimeInMs/s.length*1e3),r.codec=s[0].codec||"",r.codecPerTrackType=s.reduce(((e,t)=>(t.trackType&&(e[t.trackType]=t.codec||""),e)),{}));const o=[i.has("cpu")&&"cpu",i.has("bandwidth")&&"bandwidth",i.has("other")&&"other"].filter(Boolean).join(", ");return o&&(r.qualityLimitationReasons=o),r},[Tc,Cc,kc]="1.22.2".split(".");let Ec,_c,Rc,Ic={type:vr.PLAIN_JAVASCRIPT,major:Tc,minor:Cc,patch:kc},Ac={oneofKind:void 0};const Pc=e=>{Ic=e},xc=()=>Ic,Oc=async()=>{var e,t;if(fa())return{sdk:Ic,os:Ec,device:_c};const n=navigator.userAgentData;let i;if(n&&n.getHighEntropyValues)try{i=await n.getHighEntropyValues(["platform","platformVersion"])}catch(l){}const s=new Gs.UAParser(navigator.userAgent),{browser:r,os:o,device:a,cpu:c}=s.getResult();return{sdk:Ic,browser:{name:r.name||navigator.userAgent,version:r.version||""},os:{name:(null===(e=i)||void 0===e?void 0:e.platform)||o.name||"",version:(null===(t=i)||void 0===t?void 0:t.platformVersion)||o.version||"",architecture:c.architecture||""},device:{name:[a.vendor,a.model,a.type].filter(Boolean).join(" "),version:""}}};class Nc{constructor(e,t){let{options:n,clientDetails:i,subscriber:s,publisher:r,microphone:o,camera:a,state:c,tracer:l,unifiedSessionId:u}=t;this.logger=Sa(["SfuStatsReporter"]),this.inputDevices=new Map,this.observeDevice=(e,t)=>{var n;const{browserPermissionState$:i}=e.state;null===(n=this.unsubscribeDevicePermissionsSubscription)||void 0===n||n.call(this),this.unsubscribeDevicePermissionsSubscription=Ua(gs([i,this.state.ownCapabilities$]),(n=>{var i;let[s,r]=n;null===(i=this.unsubscribeListDevicesSubscription)||void 0===i||i.call(this);const o="mic"===t?r.includes(rr.SEND_AUDIO):r.includes(rr.SEND_VIDEO);"granted"===s&&o?this.unsubscribeListDevicesSubscription=Ua(gs([e.listDevices(),e.state.selectedDevice$]),(e=>{let[n,i]=e;const s=n.find((e=>e.deviceId===i));this.inputDevices.set(t,{currentDevice:(null===s||void 0===s?void 0:s.label)||i||"",availableDevices:n.map((e=>e.label)),isPermitted:!0})})):this.inputDevices.set(t,{currentDevice:"",availableDevices:[],isPermitted:!1})}))},this.sendConnectionTime=e=>{this.sendTelemetryData({data:{oneofKind:"connectionTimeSeconds",connectionTimeSeconds:e}})},this.sendReconnectionTime=(e,t)=>{this.sendTelemetryData({data:{oneofKind:"reconnection",reconnection:{strategy:e,timeSeconds:t}}})},this.sendTelemetryData=e=>{this.run(e).catch((e=>{this.logger("warn","Failed to send telemetry data",e)}))},this.run=async e=>{var t,n,i,s,r,o,a;const[c,l]=await Promise.all([this.subscriber.stats.get(),null===(t=this.publisher)||void 0===t?void 0:t.stats.get()]);var u;(null===(n=this.subscriber.tracer)||void 0===n||n.trace("getstats",c.delta),l)&&(null===(u=this.publisher)||void 0===u||null===(u=u.tracer)||void 0===u||u.trace("getstats",l.delta));const d=null===(i=this.subscriber.tracer)||void 0===i?void 0:i.take(),h=null===(s=this.publisher)||void 0===s||null===(s=s.tracer)||void 0===s?void 0:s.take(),p=this.tracer.take(),f=this.sfuClient.getTrace(),m=[...p.snapshot,...null!==(r=null===f||void 0===f?void 0:f.snapshot)&&void 0!==r?r:[],...null!==(o=null===h||void 0===h?void 0:h.snapshot)&&void 0!==o?o:[],...null!==(a=null===d||void 0===d?void 0:d.snapshot)&&void 0!==a?a:[]];try{var g;await this.sfuClient.sendStats({sdk:this.sdkName,sdkVersion:this.sdkVersion,webrtcVersion:this.webRTCVersion,subscriberStats:JSON.stringify(hc(c.stats)),publisherStats:l?JSON.stringify(hc(l.stats)):"[]",subscriberRtcStats:"",publisherRtcStats:"",rtcStats:JSON.stringify(m),encodeStats:null!==(g=null===l||void 0===l?void 0:l.performanceStats)&&void 0!==g?g:[],decodeStats:c.performanceStats,audioDevices:this.inputDevices.get("mic"),videoDevices:this.inputDevices.get("camera"),unifiedSessionId:this.unifiedSessionId,deviceState:Ac,telemetry:e})}catch(v){throw null===h||void 0===h||h.rollback(),null===d||void 0===d||d.rollback(),p.rollback(),null===f||void 0===f||f.rollback(),v}},this.start=()=>{this.options.reporting_interval_ms<=0||(this.observeDevice(this.microphone,"mic"),this.observeDevice(this.camera,"camera"),clearInterval(this.intervalId),this.intervalId=setInterval((()=>{this.run().catch((e=>{this.logger("warn","Failed to report stats",e)}))}),this.options.reporting_interval_ms))},this.stop=()=>{var e,t;null===(e=this.unsubscribeDevicePermissionsSubscription)||void 0===e||e.call(this),this.unsubscribeDevicePermissionsSubscription=void 0,null===(t=this.unsubscribeListDevicesSubscription)||void 0===t||t.call(this),this.unsubscribeListDevicesSubscription=void 0,this.inputDevices.clear(),clearInterval(this.intervalId),this.intervalId=void 0,clearTimeout(this.timeoutId),this.timeoutId=void 0},this.flush=()=>{this.run().catch((e=>{this.logger("warn","Failed to flush report stats",e)}))},this.scheduleOne=e=>{clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.run().catch((e=>{this.logger("warn","Failed to report stats",e)}))}),e)},this.sfuClient=e,this.options=n,this.subscriber=s,this.publisher=r,this.microphone=o,this.camera=a,this.state=c,this.tracer=l,this.unifiedSessionId=u;const{sdk:d,browser:h}=i;this.sdkName=fc(d),this.sdkVersion=mc(d);const p=Rc;this.webRTCVersion=(null===p||void 0===p?void 0:p.version)||"".concat((null===h||void 0===h?void 0:h.name)||"","-").concat((null===h||void 0===h?void 0:h.version)||"")||"N/A"}}const Dc=(e,t)=>{e.addEventListener("icecandidate",(e=>{t("onicecandidate",e.candidate)})),e.addEventListener("track",(e=>{const n=e.streams.map((e=>"stream:".concat(e.id)));t("ontrack","".concat(e.track.kind,":").concat(e.track.id," ").concat(n))})),e.addEventListener("signalingstatechange",(()=>{t("signalingstatechange",e.signalingState)})),e.addEventListener("iceconnectionstatechange",(()=>{t("iceconnectionstatechange",e.iceConnectionState)})),e.addEventListener("icegatheringstatechange",(()=>{t("icegatheringstatechange",e.iceGatheringState)})),e.addEventListener("connectionstatechange",(()=>{t("connectionstatechange",e.connectionState)})),e.addEventListener("negotiationneeded",(()=>{t("negotiationneeded",void 0)})),e.addEventListener("datachannel",(e=>{let{channel:n}=e;t("datachannel",[n.id,n.label])}));const n=e.close;e.close=function(){return t("close",void 0),n.call(this)};for(const i of["createOffer","createAnswer","setLocalDescription","setRemoteDescription","addIceCandidate"]){const n=e[i];n&&(e[i]=async function(){try{for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];t(i,s);const o=await n.apply(this,s);return t("".concat(i,"OnSuccess"),o),o}catch(o){throw t("".concat(i,"OnFailure"),o.toString()),o}})}};class jc{constructor(e,t,n){var i=this;this.previousStats={},this.frameTimeHistory=[],this.fpsHistory=[],this.get=async()=>{const e=await this.pc.getStats(),t=Lc(e),n=this.withOverrides(this.peerType===hr.SUBSCRIBER?this.getDecodeStats(t):this.getEncodeStats(t)),i=Uc(this.previousStats,t);return this.previousStats=t,this.frameTimeHistory=this.frameTimeHistory.slice(-2),this.fpsHistory=this.fpsHistory.slice(-2),{performanceStats:n,delta:i,stats:e}},this.getEncodeStats=e=>{const t=[];for(const n of Object.values(e)){if("outbound-rtp"!==n.type)continue;const{codecId:i,framesSent:s=0,kind:r,id:o,totalEncodeTime:a=0,framesPerSecond:c=0,frameHeight:l=0,frameWidth:u=0,targetBitrate:d=0,mediaSourceId:h}=n;if("audio"===r||!this.previousStats[o])continue;const p=this.previousStats[o],f=a-(p.totalEncodeTime||0),m=s-(p.framesSent||0),g=m>0?f/m*1e3:0;this.frameTimeHistory.push(g),this.fpsHistory.push(c);let v=mr.VIDEO;if(h&&e[h]){const t=e[h];v=this.trackIdToTrackType.get(t.trackIdentifier)||v}t.push({trackType:v,codec:Mc(e,i),avgFrameTimeMs:Fc(this.frameTimeHistory),avgFps:Fc(this.fpsHistory),targetBitrate:Math.round(d),videoDimension:{width:u,height:l}})}return t},this.getDecodeStats=e=>{let t,n=0;for(const h of Object.values(e)){if("inbound-rtp"!==h.type)continue;const e=h,{kind:i,frameWidth:s=0,frameHeight:r=0}=e,o=s*r;"video"===i&&o>n&&(t=e,n=o)}if(!t||!this.previousStats[t.id])return[];const i=this.previousStats[t.id],{framesDecoded:s=0,framesPerSecond:r=0,totalDecodeTime:o=0,trackIdentifier:a}=t,c=o-(i.totalDecodeTime||0),l=s-(i.framesDecoded||0),u=l>0?c/l*1e3:0;this.frameTimeHistory.push(u),this.fpsHistory.push(r);const d=this.trackIdToTrackType.get(a)||mr.VIDEO;return[Gr.create({trackType:d,codec:Mc(e,t.codecId),avgFrameTimeMs:Fc(this.frameTimeHistory),avgFps:Fc(this.fpsHistory),videoDimension:{width:t.frameWidth,height:t.frameHeight}})]},this.withOverrides=e=>{if(this.costOverrides)for(const t of e){const e=this.costOverrides.get(t.trackType);void 0!==e&&(t.avgFrameTimeMs=e+(t.avgFrameTimeMs||0)/1e3)}return e},this.setCost=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mr.VIDEO;i.costOverrides||(i.costOverrides=new Map),i.costOverrides.set(t,e)},this.pc=e,this.peerType=t,this.trackIdToTrackType=n}}const Lc=e=>{const t={};return e.forEach(((e,n)=>{t[n]=e})),t},Uc=(e,t)=>{t=JSON.parse(JSON.stringify(t));for(const[s,r]of Object.entries(t))if(delete r.id,e[s])for(const[t,n]of Object.entries(r))n===e[s][t]&&delete r[t];let n=-1/0;const i=Object.values(t);for(const s of i)s.timestamp>n&&(n=s.timestamp);for(const s of i)s.timestamp===n&&(s.timestamp=0);return t.timestamp=n,t},Fc=e=>e.reduce(((e,t)=>e+t),0)/e.length,Mc=(e,t)=>{if(!t||!e[t])return;const n=e[t];return Nr.create({name:n.mimeType.split("/").pop(),clockRate:n.clockRate,payloadType:n.payloadType,fmtp:n.sdpFmtpLine})};class Vc{constructor(e){this.buffer=[],this.enabled=!0,this.setEnabled=e=>{this.enabled!==e&&(this.enabled=e,this.buffer=[])},this.trace=(e,t)=>{this.enabled&&this.buffer.push([e,this.id,t,Date.now()])},this.take=()=>{const e=this.buffer;return this.buffer=[],{snapshot:e,rollback:()=>{this.buffer.unshift(...e)}}},this.dispose=()=>{this.buffer=[]},this.id=e}}class Bc{constructor(e,t){let{sfuClient:n,connectionConfig:i,state:s,dispatcher:r,onUnrecoverableError:o,logTag:a,enableTracing:c}=t;if(this.isIceRestarting=!1,this.isDisposed=!1,this.trackIdToTrackType=new Map,this.subscriptions=[],this.lock=Math.random().toString(36).slice(2),this.on=(e,t)=>{this.subscriptions.push(this.dispatcher.on(e,(n=>{const i="pc.".concat(this.lock,".").concat(e);Pa(i,(async()=>t(n))).catch((t=>{this.isDisposed||this.logger("warn","Error handling ".concat(e),t)}))})))},this.addTrickledIceCandidates=()=>{var e;const{iceTrickleBuffer:t}=this.sfuClient,n=this.peerType===hr.SUBSCRIBER?t.subscriberCandidates:t.publisherCandidates;null===(e=this.unsubscribeIceTrickle)||void 0===e||e.call(this),this.unsubscribeIceTrickle=Fa(n,(async e=>this.pc.addIceCandidate(e).catch((t=>{this.isDisposed||this.logger("warn","ICE candidate error",t,e)}))))},this.setSfuClient=e=>{this.sfuClient=e},this.getStats=e=>this.pc.getStats(e),this.getTrackType=e=>this.trackIdToTrackType.get(e),this.onIceCandidate=e=>{const{candidate:t}=e;if(!t)return void this.logger("debug","null ice candidate");const n=this.asJSON(t);this.sfuClient.iceTrickle({peerType:this.peerType,iceCandidate:n}).catch((e=>{this.isDisposed||this.logger("warn","ICETrickle failed",e)}))},this.asJSON=e=>{if(!e.usernameFragment){const t=e.candidate.split(" "),n=t.findIndex((e=>"ufrag"===e))+1,i=t[n];return JSON.stringify((0,u.A)((0,u.A)({},e),{},{usernameFragment:i}))}return JSON.stringify(e.toJSON())},this.onConnectionStateChange=async()=>{const e=this.pc.connectionState;if(this.logger("debug","Connection state changed",e),this.tracer&&("connected"===e||"failed"===e))try{const e=await this.stats.get();this.tracer.trace("getstats",e.delta)}catch(t){this.tracer.trace("getstatsOnFailure",t.toString())}},this.onIceConnectionStateChange=()=>{const e=this.pc.iceConnectionState;var t;(this.logger("debug","ICE connection state changed",e),this.state.callingState!==Ma.OFFLINE)&&(this.state.callingState!==Ma.RECONNECTING&&(this.isIceRestarting||("failed"===e?null===(t=this.onUnrecoverableError)||void 0===t||t.call(this,"ICE connection failed"):"disconnected"===e&&(this.logger("debug","Attempting to restart ICE"),this.restartIce().catch((e=>{var t;const n="ICE restart failed";this.logger("error",n,e),null===(t=this.onUnrecoverableError)||void 0===t||t.call(this,"".concat(n,": ").concat(e))}))))))},this.onIceCandidateError=e=>{const t=e instanceof RTCPeerConnectionIceErrorEvent&&"".concat(e.errorCode,": ").concat(e.errorText),n=this.pc.iceConnectionState,i="connected"===n||"checking"===n?"debug":"warn";this.logger(i,"ICE Candidate error",t)},this.onIceGatherChange=()=>{this.logger("debug","ICE Gathering State",this.pc.iceGatheringState)},this.onSignalingChange=()=>{this.logger("debug","Signaling state changed",this.pc.signalingState)},this.peerType=e,this.sfuClient=n,this.state=s,this.dispatcher=r,this.onUnrecoverableError=o,this.logger=Sa([e===hr.SUBSCRIBER?"Subscriber":"Publisher",a]),this.pc=new RTCPeerConnection(i),this.pc.addEventListener("icecandidate",this.onIceCandidate),this.pc.addEventListener("icecandidateerror",this.onIceCandidateError),this.pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.pc.addEventListener("icegatheringstatechange",this.onIceGatherChange),this.pc.addEventListener("signalingstatechange",this.onSignalingChange),this.pc.addEventListener("connectionstatechange",this.onConnectionStateChange),this.stats=new jc(this.pc,e,this.trackIdToTrackType),c){const t="".concat(a,"-").concat(e===hr.SUBSCRIBER?"sub":"pub");this.tracer=new Vc(t),this.tracer.trace("create",(0,u.A)({url:n.edgeName},i)),Dc(this.pc,this.tracer.trace)}}dispose(){var e;this.onUnrecoverableError=void 0,this.isDisposed=!0,this.detachEventHandlers(),this.pc.close(),null===(e=this.tracer)||void 0===e||e.dispose()}detachEventHandlers(){var e;this.pc.removeEventListener("icecandidate",this.onIceCandidate),this.pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this.pc.removeEventListener("signalingstatechange",this.onSignalingChange),this.pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.pc.removeEventListener("icegatheringstatechange",this.onIceGatherChange),null===(e=this.unsubscribeIceTrickle)||void 0===e||e.call(this),this.subscriptions.forEach((e=>e()))}}class Hc{constructor(){var e=this;this.cache=[],this.layers=[],this.transceiverOrder=[],this.add=(e,t)=>{this.cache.push({publishOption:e,transceiver:t}),this.transceiverOrder.push(t)},this.get=e=>{var t;return null===(t=this.findTransceiver(e))||void 0===t?void 0:t.transceiver},this.has=e=>!!this.get(e),this.find=e=>this.cache.find(e),this.items=()=>this.cache,this.indexOf=e=>this.transceiverOrder.indexOf(e),this.getLayers=e=>{const t=this.layers.find((t=>t.publishOption.id===e.id&&t.publishOption.trackType===e.trackType));return null===t||void 0===t?void 0:t.layers},this.setLayers=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=e.findLayer(t);i?i.layers=n:e.layers.push({publishOption:t,layers:n})},this.findTransceiver=e=>this.cache.find((t=>t.publishOption.id===e.id&&t.publishOption.trackType===e.trackType)),this.findLayer=e=>this.layers.find((t=>t.publishOption.id===e.id&&t.publishOption.trackType===e.trackType))}}const qc=(e,t)=>{Sa(["helpers"])("warn",t,e)},Wc=e=>{switch(e){case mr.SCREEN_SHARE:return"screenShareStream";case mr.SCREEN_SHARE_AUDIO:return"screenShareAudioStream";case mr.VIDEO:return"videoStream";case mr.AUDIO:return"audioStream";case mr.UNSPECIFIED:throw new Error("Track type is unspecified");default:qc(e,"Unknown track type")}},$c=e=>e===mr.AUDIO||e===mr.SCREEN_SHARE_AUDIO,Jc={q:3e5,h:75e4,f:125e4},zc=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>{return{rid:e.rid||"",bitrate:e.maxBitrate||0,fps:e.maxFramerate||0,quality:(t=e.rid||"","q"===t?fr.LOW_UNSPECIFIED:"h"===t?fr.MID:fr.HIGH),videoDimension:{width:e.width,height:e.height}};var t}))},Gc=(e,t)=>{if($c(t.trackType))return;const n=[],i=e.getSettings(),{width:s=0,height:r=0}=i,{bitrate:o,codec:a,fps:c,maxSpatialLayers:l=3,maxTemporalLayers:u=3,videoDimension:d={width:1280,height:720},useSingleLayer:h}=t,p=Kc(d,s,r,o);let f=1,m=1;const g=ka(null===a||void 0===a?void 0:a.name);for(const y of["f","h","q"].slice(0,l)){const e={active:!0,rid:y,width:Math.round(s/f),height:Math.round(r/f),maxBitrate:Math.round(p/m)||Jc[y],maxFramerate:c};g?e.scalabilityMode=(b=u,"L".concat(v=h?1:l,"T").concat(b).concat(v>1?"_KEY":"")):e.scaleResolutionDownBy=f,f*=2,m*=2,n.unshift(e)}var v,b;return Yc(i,n,h)},Kc=(e,t,n,i)=>{const{width:s,height:r}=e;if(t<s||n<r){const e=t*n/(s*r);return Math.round(i*e)}return i},Yc=(e,t,n)=>{let i;const s=Math.max(e.width||0,e.height||0);i=s<=320?t.filter((e=>"f"===e.rid)):s<=640?t.filter((e=>"h"!==e.rid)):t;const r=["q","h","f"];return i.map(((e,t,i)=>(0,u.A)((0,u.A)({},e),{},{rid:r[t],active:!(n&&t<i.length-1)&&e.active})))},Xc=(e,t,n)=>{if(e.mid)return e.mid;if(!n)return String(t);const i=e.sender.track,s=(0,Ks.qg)(n).media.find((e=>{var t,n;return e.type===i.kind&&(null===(t=null===(n=e.msid)||void 0===n?void 0:n.includes(i.id))||void 0===t||t)}));return"undefined"!==typeof(null===s||void 0===s?void 0:s.mid)?String(s.mid):t<0?"":String(t)};class Zc extends Bc{constructor(e){var t;let{publishOptions:n}=e,i=(0,l.A)(e,Xs);super(hr.PUBLISHER_UNSPECIFIED,i),t=this,this.transceiverCache=new Hc,this.clonedTracks=new Set,this.publish=async(e,t)=>{if(!this.publishOptions.some((e=>e.trackType===t)))throw new Error("No publish options found for ".concat(mr[t]));for(const n of this.publishOptions){if(n.trackType!==t)continue;const i=this.cloneTrack(e),s=this.transceiverCache.get(n);if(s){const e=s.sender.track;await this.updateTransceiver(s,i,t),fa()||this.stopTrack(e)}else await this.addTransceiver(i,n)}},this.addTransceiver=async(e,t)=>{var n;const i=Gc(e,t),s=ka(null===(n=t.codec)||void 0===n?void 0:n.name)?(e=>{if(!e)return;const t=e=>t=>t.rid===e,n=e.find(t("f"))||e.find(t("h"))||e.find(t("q"));return[(0,u.A)((0,u.A)({},n),{},{rid:"q"})]})(i):i,r=this.pc.addTransceiver(e,{direction:"sendonly",sendEncodings:s}),o=r.sender.getParameters();o.degradationPreference="maintain-framerate",await r.sender.setParameters(o);const a=t.trackType;this.logger("debug","Added ".concat(mr[a]," transceiver")),this.transceiverCache.add(t,r),this.trackIdToTrackType.set(e.id,a),await this.negotiate()},this.updateTransceiver=async(e,t,n)=>{const i=e.sender;i.track&&this.trackIdToTrackType.delete(i.track.id),await i.replaceTrack(t),t&&this.trackIdToTrackType.set(t.id,n)},this.syncPublishOptions=async()=>{for(const e of this.publishOptions){const{trackType:t}=e;if(!this.isPublishing(t))continue;if(this.transceiverCache.has(e))continue;const n=this.transceiverCache.find((e=>!!e.transceiver.sender.track&&e.publishOption.trackType===t));if(!n||!n.transceiver)continue;const i=this.cloneTrack(n.transceiver.sender.track);await this.addTransceiver(i,e)}for(const e of this.transceiverCache.items()){const{publishOption:t,transceiver:n}=e;this.publishOptions.some((e=>e.id===t.id&&e.trackType===t.trackType))||(this.stopTrack(n.sender.track),await this.updateTransceiver(n,null,t.trackType))}},this.isPublishing=e=>{for(const t of this.transceiverCache.items()){if(t.publishOption.trackType!==e)continue;const n=t.transceiver.sender.track;if(n&&("live"===n.readyState&&n.enabled))return!0}return!1},this.stopTracks=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const s of t.transceiverCache.items()){const{publishOption:e,transceiver:i}=s;n.includes(e.trackType)&&t.stopTrack(i.sender.track)}},this.stopAllTracks=()=>{for(const{transceiver:e}of this.transceiverCache.items())this.stopTrack(e.sender.track);for(const e of this.clonedTracks)this.stopTrack(e)},this.changePublishQuality=async e=>{var t;const{trackType:n,layers:i,publishOptionId:s}=e,r=i.filter((e=>e.active)),o="Update publish quality:";this.logger("info","".concat(o," requested layers by SFU:"),r);const a=this.transceiverCache.find((e=>e.publishOption.id===s&&e.publishOption.trackType===n)),c=null===a||void 0===a?void 0:a.transceiver.sender;if(!c)return this.logger("warn","".concat(o," no video sender found."));const l=c.getParameters();if(0===l.encodings.length)return this.logger("warn","".concat(o," there are no encodings set."));const u=null===a||void 0===a||null===(t=a.publishOption.codec)||void 0===t?void 0:t.name,d=u&&ka(u);let h=!1;for(const m of l.encodings){var p;const e=d?r[0]:null!==(p=r.find((e=>e.name===m.rid)))&&void 0!==p?p:1===l.encodings.length?r[0]:void 0,t=!(null===e||void 0===e||!e.active);if(t!==m.active&&(m.active=t,h=!0),!e)continue;const{maxFramerate:n,scaleResolutionDownBy:i,maxBitrate:s,scalabilityMode:o}=e;i>=1&&i!==m.scaleResolutionDownBy&&(m.scaleResolutionDownBy=i,h=!0),s>0&&s!==m.maxBitrate&&(m.maxBitrate=s,h=!0),n>0&&n!==m.maxFramerate&&(m.maxFramerate=n,h=!0),o&&o!==m.scalabilityMode&&(m.scalabilityMode=o,h=!0)}const f=l.encodings.filter((e=>e.active));if(!h)return this.logger("info","".concat(o," no change:"),f);await c.setParameters(l),this.logger("info","".concat(o," enabled rids:"),f)},this.restartIce=async()=>{this.logger("debug","Restarting ICE connection");const e=this.pc.signalingState;this.isIceRestarting||"have-local-offer"===e?this.logger("debug","ICE restart is already in progress"):await this.negotiate({iceRestart:!0})},this.negotiate=async e=>Pa("publisher.negotiate.".concat(this.lock),(async()=>{const t=await this.pc.createOffer(e),n=this.getAnnouncedTracks(t.sdp);if(!n.length)throw new Error("Can't negotiate without any tracks");try{var i;this.isIceRestarting=null!==(i=null===e||void 0===e?void 0:e.iceRestart)&&void 0!==i&&i,await this.pc.setLocalDescription(t);const{sdp:s=""}=t,{response:r}=await this.sfuClient.setPublisher({sdp:s,tracks:n});if(r.error)throw new Error(r.error.message);const{sdp:o}=r;await this.pc.setRemoteDescription({type:"answer",sdp:o})}finally{this.isIceRestarting=!1}this.addTrickledIceCandidates()})),this.getPublishedTracks=()=>{const e=[];for(const{transceiver:t}of this.transceiverCache.items()){const n=t.sender.track;n&&"live"===n.readyState&&e.push(n)}return e},this.getAnnouncedTracks=e=>{const t=[];for(const n of this.transceiverCache.items()){const{transceiver:i,publishOption:s}=n;i.sender.track&&t.push(this.toTrackInfo(i,s,e))}return t},this.getAnnouncedTracksForReconnect=()=>{var e;const t=null===(e=this.pc.localDescription)||void 0===e?void 0:e.sdp,n=[];for(const i of this.publishOptions){const e=this.transceiverCache.get(i);e&&e.sender.track&&n.push(this.toTrackInfo(e,i,t))}return n},this.toTrackInfo=(e,t,n)=>{var i;const s=e.sender.track,r="live"===s.readyState,o=r?Gc(s,t):this.transceiverCache.getLayers(t);this.transceiverCache.setLayers(t,o);const a=$c(t.trackType),c=a&&2===s.getSettings().channelCount,l=this.transceiverCache.indexOf(e),u=null===(i=this.state.settings)||void 0===i?void 0:i.audio;return{trackId:s.id,layers:zc(o),trackType:t.trackType,mid:Xc(e,l,n),stereo:c,dtx:a&&!(null===u||void 0===u||!u.opus_dtx_enabled),red:a&&!(null===u||void 0===u||!u.redundant_coding_enabled),muted:!r,codec:t.codec,publishOptionId:t.id}},this.cloneTrack=e=>{const t=e.clone();return this.clonedTracks.add(t),t},this.stopTrack=e=>{e&&(e.stop(),this.clonedTracks.delete(e))},this.publishOptions=n,this.on("iceRestart",(e=>{e.peerType===hr.PUBLISHER_UNSPECIFIED&&this.restartIce().catch((e=>{var t;const n="ICE restart failed";this.logger("warn",n,e),null===(t=this.onUnrecoverableError)||void 0===t||t.call(this,"".concat(n,": ").concat(e))}))})),this.on("changePublishQuality",(async e=>{for(const t of e.videoSenders)await this.changePublishQuality(t)})),this.on("changePublishOptions",(e=>(this.publishOptions=e.publishOptions,this.syncPublishOptions())))}dispose(){super.dispose(),this.stopAllTracks(),this.clonedTracks.clear()}}class Qc extends Bc{constructor(e){super(hr.SUBSCRIBER,e),this.restartIce=async()=>{if(this.logger("debug","Restarting ICE connection"),"have-remote-offer"===this.pc.signalingState)return void this.logger("debug","ICE restart is already in progress");if("new"===this.pc.connectionState)return void this.logger("debug","ICE connection is not yet established, skipping restart.");const e=this.isIceRestarting;try{this.isIceRestarting=!0,await this.sfuClient.iceRestart({peerType:hr.SUBSCRIBER})}catch(t){throw this.isIceRestarting=e,t}},this.handleOnTrack=e=>{const[t]=e.streams,[n,i]=t.id.split(":"),s=this.state.participants.find((e=>e.trackLookupPrefix===n));this.logger("debug","[onTrack]: Got remote ".concat(i," track for userId: ").concat(null===s||void 0===s?void 0:s.userId),e.track.id,e.track);const r="".concat(null===s||void 0===s?void 0:s.userId," ").concat(i,":").concat(n);e.track.addEventListener("mute",(()=>{this.logger("info","[onTrack]: Track muted: ".concat(r))})),e.track.addEventListener("unmute",(()=>{this.logger("info","[onTrack]: Track unmuted: ".concat(r))})),e.track.addEventListener("ended",(()=>{this.logger("info","[onTrack]: Track ended: ".concat(r)),this.state.removeOrphanedTrack(t.id)}));const o=(e=>{switch(e){case"TRACK_TYPE_AUDIO":return mr.AUDIO;case"TRACK_TYPE_VIDEO":return mr.VIDEO;case"TRACK_TYPE_SCREEN_SHARE":return mr.SCREEN_SHARE;case"TRACK_TYPE_SCREEN_SHARE_AUDIO":return mr.SCREEN_SHARE_AUDIO;default:return}})(i);if(!o)return this.logger("error","Unknown track type: ".concat(i));if(this.trackIdToTrackType.set(e.track.id,o),!s)return this.logger("warn","[onTrack]: Received track for unknown participant: ".concat(n),e),void this.state.registerOrphanedTrack({id:t.id,trackLookupPrefix:n,track:t,trackType:o});const a=Wc(o);if(!a)return void this.logger("error","Unknown track type: ".concat(i));const c=s[a];this.state.updateParticipant(s.sessionId,{[a]:t}),c&&(this.logger("info","[onTrack]: Cleaning up previous remote ".concat(e.track.kind," tracks for userId: ").concat(s.userId)),c.getTracks().forEach((e=>{e.stop(),c.removeTrack(e)})))},this.negotiate=async e=>{await this.pc.setRemoteDescription({type:"offer",sdp:e.sdp}),this.addTrickledIceCandidates();const t=await this.pc.createAnswer();await this.pc.setLocalDescription(t),await this.sfuClient.sendAnswer({peerType:hr.SUBSCRIBER,sdp:t.sdp||""}),this.isIceRestarting=!1},this.pc.addEventListener("track",this.handleOnTrack),this.on("subscriberOffer",(async e=>this.negotiate(e).catch((e=>{this.logger("error","Negotiation failed.",e)}))))}detachEventHandlers(){super.detachEventHandlers(),this.pc.removeEventListener("track",this.handleOnTrack)}}function el(e){let t=!0;const n=e.then((e=>({status:"resolved",result:e})),(e=>({status:"rejected",error:e}))).finally((()=>t=!1)),i=()=>n.then((e=>{if("rejected"===e.status)throw e.error;return e.result}));return i.checkPending=()=>t,i}const tl=()=>{let e,t;const n=new Promise(((n,i)=>{e=n,t=i}));let i=!1,s=!1;return{promise:n,resolve:t=>{i=!0,e(t)},reject:e=>{s=!0,t(e)},isResolved:()=>i,isRejected:()=>s}},nl=Symbol("uninitialized");function il(e){let t=nl;return()=>(t===nl&&(t=e()),t)}const sl="const timerIdMapping = new Map();\nself.addEventListener('message', (event) => {\n    const request = event.data;\n    switch (request.type) {\n        case 'setTimeout':\n        case 'setInterval':\n            timerIdMapping.set(request.id, (request.type === 'setTimeout' ? setTimeout : setInterval)(() => {\n                tick(request.id);\n                if (request.type === 'setTimeout') {\n                    timerIdMapping.delete(request.id);\n                }\n            }, request.timeout));\n            break;\n        case 'clearTimeout':\n        case 'clearInterval':\n            (request.type === 'clearTimeout' ? clearTimeout : clearInterval)(timerIdMapping.get(request.id));\n            timerIdMapping.delete(request.id);\n            break;\n    }\n});\nfunction tick(id) {\n    const message = { type: 'tick', id };\n    self.postMessage(message);\n}";class rl{constructor(){this.currentTimerId=1,this.callbacks=new Map,this.fallback=!1}setup(){let{useTimerWorker:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e)try{const e=new Blob([sl],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);this.worker=new Worker(t,{name:"str-timer-worker"}),this.worker.addEventListener("message",(e=>{const{type:t,id:n}=e.data;var i;"tick"===t&&(null===(i=this.callbacks.get(n))||void 0===i||i())}))}catch(t){Sa(["timer-worker"])("error",t),this.fallback=!0}else this.fallback=!0}destroy(){var e;this.callbacks.clear(),null===(e=this.worker)||void 0===e||e.terminate(),this.worker=void 0,this.fallback=!1}get ready(){return this.fallback||Boolean(this.worker)}setInterval(e,t){return this.setTimer("setInterval",e,t)}clearInterval(e){this.clearTimer("clearInterval",e)}setTimeout(e,t){return this.setTimer("setTimeout",e,t)}clearTimeout(e){this.clearTimer("clearTimeout",e)}setTimer(e,t,n){if(this.ready||this.setup(),this.fallback)return("setTimeout"===e?setTimeout:setInterval)(t,n);const i=this.getTimerId();return this.callbacks.set(i,(()=>{t(),"setTimeout"===e&&this.callbacks.delete(i)})),this.sendMessage({type:e,id:i,timeout:n}),i}clearTimer(e,t){t&&(this.ready||this.setup(),this.fallback?("clearTimeout"===e?clearTimeout:clearInterval)(t):(this.callbacks.delete(t),this.sendMessage({type:e,id:t})))}getTimerId(){return this.currentTimerId++}sendMessage(e){if(!this.worker)throw new Error("Cannot use timer worker before it's set up");this.worker.postMessage(e)}}let ol=!1;const al=il((()=>{const e=new rl;return e.setup({useTimerWorker:ol}),e}));class cl{constructor(e){var t=this;let{dispatcher:n,credentials:i,sessionId:s,logTag:r,joinResponseTimeout:o=5e3,onSignalClose:a,streamClient:c,enableTracing:l}=e;this.iceTrickleBuffer=new Ia,this.isLeaving=!1,this.isClosing=!1,this.pingIntervalInMs=1e4,this.unhealthyTimeoutInMs=this.pingIntervalInMs+5e3,this.joinResponseTask=tl(),this.abortController=new AbortController,this.createWebSocket=()=>{const e={callEnded:!0,changePublishQuality:!0,error:!0,goAway:!0};this.signalWs=(e=>{const{endpoint:t,onMessage:n,logTag:i}=e,s=Sa(["SfuClientWS",i]);s("debug","Creating signaling WS channel:",t);const r=new WebSocket(t);return r.binaryType="arraybuffer",r.addEventListener("error",(e=>{s("error","Signaling WS channel error",e)})),r.addEventListener("close",(e=>{s("info","Signaling WS channel is closed",e)})),r.addEventListener("open",(e=>{s("info","Signaling WS channel is open",e)})),r.addEventListener("message",(e=>{try{const t=e.data instanceof ArrayBuffer?yo.fromBinary(new Uint8Array(e.data)):yo.fromJsonString(e.data.toString());n(t)}catch(t){s("error","Failed to decode a message. Check whether the Proto models match.",{event:e,error:t})}})),r})({logTag:this.logTag,endpoint:"".concat(this.credentials.server.ws_endpoint,"?tag=").concat(this.logTag),onMessage:t=>{this.lastMessageTimestamp=new Date,this.scheduleConnectionCheck();const n=t.eventPayload.oneofKind;var i;e[n]&&(null===(i=this.tracer)||void 0===i||i.trace(n,t));this.dispatcher.dispatch(t,this.logTag)}}),this.signalReady=el(Promise.race([new Promise(((e,t)=>{const n=()=>{this.signalWs.removeEventListener("open",n),e(this.signalWs)};this.signalWs.addEventListener("open",n),this.signalWs.addEventListener("close",(e=>{this.handleWebSocketClose(e),t(new Error("SFU WS closed unexpectedly"))}))})),new Promise(((e,t)=>{setTimeout((()=>t(new Error("SFU WS connection timed out"))),this.joinResponseTimeout)}))]))},this.cleanUpWebSocket=()=>{this.signalWs.removeEventListener("close",this.handleWebSocketClose)},this.handleWebSocketClose=e=>{var t;this.signalWs.removeEventListener("close",this.handleWebSocketClose),al().clearInterval(this.keepAliveInterval),clearTimeout(this.connectionCheckTimeout),null===(t=this.onSignalClose)||void 0===t||t.call(this,"".concat(e.code," ").concat(e.reason))},this.close=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cl.NORMAL_CLOSURE,n=arguments.length>1?arguments[1]:void 0;t.isClosing=!0,t.signalWs.readyState===WebSocket.OPEN&&(t.logger("debug","Closing SFU WS connection: ".concat(e," - ").concat(n)),t.signalWs.close(e,"js-client: ".concat(n)),t.cleanUpWebSocket()),t.dispose()},this.dispose=()=>{var e;this.logger("debug","Disposing SFU client"),this.unsubscribeIceTrickle(),this.unsubscribeNetworkChanged(),clearInterval(this.keepAliveInterval),clearTimeout(this.connectionCheckTimeout),clearTimeout(this.migrateAwayTimeout),this.abortController.abort(),null===(e=this.migrationTask)||void 0===e||e.resolve(),this.iceTrickleBuffer.dispose()},this.getTrace=()=>{var e;return null===(e=this.tracer)||void 0===e?void 0:e.take()},this.leaveAndClose=async e=>{await this.joinTask;try{this.isLeaving=!0,await this.notifyLeave(e)}catch(t){this.logger("debug","Error notifying SFU about leaving call",t)}this.close(cl.NORMAL_CLOSURE,e.substring(0,115))},this.updateSubscriptions=async e=>(await this.joinTask,Ta((()=>this.rpc.updateSubscriptions({sessionId:this.sessionId,tracks:e})),this.abortController.signal)),this.setPublisher=async e=>(await this.joinTask,Ta((()=>this.rpc.setPublisher((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId}))),this.abortController.signal)),this.sendAnswer=async e=>(await this.joinTask,Ta((()=>this.rpc.sendAnswer((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId}))),this.abortController.signal)),this.iceTrickle=async e=>(await this.joinTask,Ta((()=>this.rpc.iceTrickle((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId}))),this.abortController.signal)),this.iceRestart=async e=>(await this.joinTask,Ta((()=>this.rpc.iceRestart((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId}))),this.abortController.signal)),this.updateMuteStates=async e=>(await this.joinTask,Ta((()=>this.rpc.updateMuteStates({muteStates:e,sessionId:this.sessionId})),this.abortController.signal)),this.sendStats=async e=>(await this.joinTask,this.rpc.sendStats((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId}))),this.startNoiseCancellation=async()=>(await this.joinTask,Ta((()=>this.rpc.startNoiseCancellation({sessionId:this.sessionId})),this.abortController.signal)),this.stopNoiseCancellation=async()=>(await this.joinTask,Ta((()=>this.rpc.stopNoiseCancellation({sessionId:this.sessionId})),this.abortController.signal)),this.enterMigration=async function(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.isLeaving=!0;const{timeout:i=7e3}=n;null===(e=t.migrationTask)||void 0===e||e.reject(new Error("Cancelled previous migration"));const s=t.migrationTask=tl(),r=t.dispatcher.on("participantMigrationComplete",(()=>{r(),clearTimeout(t.migrateAwayTimeout),s.resolve()}));return t.migrateAwayTimeout=setTimeout((()=>{r(),s.reject(new Error("Migration (".concat(t.logTag,") failed to complete in ").concat(i,"ms")))}),i),s.promise},this.join=async e=>{var t;await this.signalReady(),(this.joinResponseTask.isResolved()||this.joinResponseTask.isRejected())&&(this.joinResponseTask=tl());const n=this.joinResponseTask;let i;const s=this.dispatcher.on("joinResponse",(e=>{this.logger("debug","Received joinResponse",e),clearTimeout(i),s(),this.keepAlive(),n.resolve(e)}));i=setTimeout((()=>{s(),n.reject(new Error('Waiting for "joinResponse" has timed out'))}),this.joinResponseTimeout);const r=Eo.create({requestPayload:{oneofKind:"joinRequest",joinRequest:xo.create((0,u.A)((0,u.A)({},e),{},{sessionId:this.sessionId,token:this.credentials.token}))}});return null===(t=this.tracer)||void 0===t||t.trace("joinRequest",r),await this.send(r),n.promise},this.ping=async()=>this.send(Eo.create({requestPayload:{oneofKind:"healthCheckRequest",healthCheckRequest:{}}})),this.notifyLeave=async e=>this.send(Eo.create({requestPayload:{oneofKind:"leaveCallRequest",leaveCallRequest:{sessionId:this.sessionId,reason:e}}})),this.send=async e=>{await this.signalReady();const t=Eo.toJson(e);this.signalWs.readyState===WebSocket.OPEN?(this.logger("debug","Sending message to: ".concat(this.edgeName),t),this.signalWs.send(Eo.toBinary(e))):this.logger("debug","Signal WS is not open. Skipping message",t)},this.keepAlive=()=>{const e=al();e.clearInterval(this.keepAliveInterval),this.keepAliveInterval=e.setInterval((()=>{this.ping().catch((e=>{this.logger("error","Error sending healthCheckRequest to SFU",e)}))}),this.pingIntervalInMs)},this.scheduleConnectionCheck=()=>{clearTimeout(this.connectionCheckTimeout),this.connectionCheckTimeout=setTimeout((()=>{if(this.lastMessageTimestamp){(new Date).getTime()-this.lastMessageTimestamp.getTime()>this.unhealthyTimeoutInMs&&this.close(cl.ERROR_CONNECTION_UNHEALTHY,"SFU connection unhealthy. Didn't receive any message for ".concat(this.unhealthyTimeoutInMs,"ms"))}}),this.unhealthyTimeoutInMs)},this.dispatcher=n,this.sessionId=s||ua(),this.onSignalClose=a,this.credentials=i;const{server:d,token:h}=i;var p;this.edgeName=d.edge_name,this.joinResponseTimeout=o,this.logTag=r,this.logger=Sa(["SfuClient",r]),this.tracer=l?new Vc("".concat(r,"-").concat(this.edgeName)):void 0,this.rpc=(e=>{const t=new $i((0,u.A)((0,u.A)({},ta),e));return new ea(t)})({baseUrl:d.url,interceptors:[(p={Authorization:"Bearer ".concat(h)},{interceptUnary:(e,t,n,i)=>(i.meta=(0,u.A)((0,u.A)({},i.meta),p),e(t,n,i))}),this.tracer&&ia(this.tracer.trace),"trace"===wa()&&na(this.logger,"trace")].filter((e=>!!e))}),this.unsubscribeIceTrickle=n.on("iceTrickle",(e=>{this.iceTrickleBuffer.push(e)})),this.unsubscribeNetworkChanged=c.on("network.changed",(e=>{var t;e.online?null===(t=this.networkAvailableTask)||void 0===t||t.resolve():this.networkAvailableTask=tl()})),this.createWebSocket()}get isHealthy(){return this.signalWs.readyState===WebSocket.OPEN&&this.joinResponseTask.isResolved()}get joinTask(){return this.joinResponseTask.promise}}cl.NORMAL_CLOSURE=1e3,cl.ERROR_CONNECTION_UNHEALTHY=4001,cl.DISPOSE_OLD_SOCKET=4002;const ll=e=>async function(t){if(t.user.id===e.currentUserId)return;const{state:n}=e;t.call.created_by.id===e.currentUserId&&n.callingState===Ma.RINGING&&await e.join()},ul=e=>async function(t){if(t.user.id===e.currentUserId)return;const{call:n}=t,{session:i}=n;if(!i)return void e.logger("warn","No call session provided. Ignoring call.rejected event.",t);const s=i.rejected_by,{members:r,callingState:o}=e.state;if(o===Ma.RINGING)if(e.isCreatedByMe){r.filter((t=>t.user_id!==e.currentUserId)).every((e=>s[e.user_id]))&&(e.logger("info","everyone rejected, leaving the call"),await e.leave({reject:!0,reason:"cancel",message:"ring: everyone rejected"}))}else s[n.created_by.id]&&(e.logger("info","call creator rejected, leaving call"),await e.leave({message:"ring: creator rejected"}));else e.logger("info","Call is not in ringing mode (it is either accepted or rejected already). Ignoring call.rejected event.",t)},dl=e=>function(){const{callingState:t}=e.state;t!==Ma.IDLE&&t!==Ma.LEFT&&e.leave({message:"call.ended event received",reject:!1}).catch((t=>{e.logger("error","Failed to leave call after call.ended ",t)}))},hl=e=>e.on("callEnded",(async t=>{if(e.state.callingState!==Ma.LEFT)try{if(t.reason===wr.LIVE_ENDED){e.state.setBackstage(!0);const{hasPermission:t}=e.permissionsContext;if(t(rr.JOIN_BACKSTAGE))return}e.state.setEndedAt(new Date);const n=wr[t.reason];await e.leave({message:"callEnded received: ".concat(n)})}catch(n){e.logger("error","Failed to leave call after being ended by the SFU",n)}})),pl=e=>function(t){const{currentGrants:n}=t;if(n){const{canPublishAudio:t,canPublishVideo:i,canScreenshare:s}=n,r={[rr.SEND_AUDIO]:t,[rr.SEND_VIDEO]:i,[rr.SCREENSHARE]:s},o=e.ownCapabilities.filter((e=>!1!==r[e]));Object.entries(r).forEach((e=>{let[t,n]=e;n&&!o.includes(t)&&o.push(t)})),e.setOwnCapabilities(o)}},fl=(e,t)=>e.on("connectionQualityChanged",(e=>{const{connectionQualityUpdates:n}=e;n&&t.updateParticipants(n.reduce(((e,t)=>{const{sessionId:n,connectionQuality:i}=t;return e[n]={connectionQuality:i},e}),{}))})),ml=(e,t)=>e.on("healthCheckResponse",(e=>{const{participantCount:n}=e;n&&(t.setParticipantCount(n.total),t.setAnonymousParticipantCount(n.anonymous))})),gl=(e,t)=>e.on("error",(e=>{e.error&&e.error.code!==gr.LIVE_ENDED||(t.state.setBackstage(!0),t.permissionsContext.hasPermission(rr.JOIN_BACKSTAGE)||t.leave({message:"live ended"}).catch((e=>{t.logger("error","Failed to leave call after live ended",e)})))})),vl=e=>e.on("error",(e=>{if(!e.error)return;const t=Sa(["SfuClient"]),{error:n,reconnectStrategy:i}=e;t("error","SFU reported error",{code:gr[n.code],reconnectStrategy:Sr[i],message:n.message,shouldRetry:n.shouldRetry})})),bl=e=>function(t){const{pins:n}=t;e.setServerSidePins(n)},yl=e=>e.on("trackUnpublished",(async t=>{const{cause:n,type:i,sessionId:s}=t,{localParticipant:r}=e.state;if(n===br.MODERATION&&s===(null===r||void 0===r?void 0:r.sessionId)){const t=e.logger;t("info","Local participant's ".concat(mr[i]," track is muted remotely"));try{i===mr.VIDEO?await e.camera.disable():i===mr.AUDIO?await e.microphone.disable():i===mr.SCREEN_SHARE||i===mr.SCREEN_SHARE_AUDIO?await e.screenShare.disable():t("warn","Unsupported track type to soft mute",mr[i])}catch(o){t("error","Failed to stop publishing",o)}}})),wl=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const s of n)e.includes(s)||e.push(s);return e},Sl=e=>function(t){const{participant:n}=t;if(!n)return;const i=_l(e,n);e.updateOrAddParticipant(n.sessionId,Object.assign(n,i,{viewportVisibilityState:{videoTrack:Zo.UNKNOWN,screenShareTrack:Zo.UNKNOWN}}))},Tl=e=>function(t){const{participant:n}=t;n&&e.setParticipants((e=>e.filter((e=>e.sessionId!==n.sessionId))))},Cl=e=>function(t){const{participant:n}=t;n&&e.updateParticipant(n.sessionId,n)},kl=e=>function(t){const{type:n,sessionId:i}=t;if(t.participant){const n=_l(e,t.participant),s=Object.assign(t.participant,n);e.updateOrAddParticipant(i,s)}else e.updateParticipant(i,(e=>({publishedTracks:wl([...e.publishedTracks],n)})))},El=e=>function(t){const{type:n,sessionId:i}=t;if(t.participant){const n=_l(e,t.participant),s=Object.assign(t.participant,n);e.updateOrAddParticipant(i,s)}else e.updateParticipant(i,(e=>({publishedTracks:e.publishedTracks.filter((e=>e!==n))})))},_l=(e,t)=>{const n=e.takeOrphanedTracks(t.trackLookupPrefix);if(!n.length)return;const i={};for(const s of n){const e=Wc(s.trackType);e&&(i[e]=s.track)}return i},Rl=(e,t)=>e.on("dominantSpeakerChanged",(e=>{var n;const{sessionId:i}=e;i!==(null===(n=t.dominantSpeaker)||void 0===n?void 0:n.sessionId)&&t.setParticipants((e=>e.map((e=>e.sessionId===i?(0,u.A)((0,u.A)({},e),{},{isDominantSpeaker:!0}):e.isDominantSpeaker?(0,u.A)((0,u.A)({},e),{},{isDominantSpeaker:!1}):e))))})),Il=(e,t)=>e.on("audioLevelChanged",(e=>{const{audioLevels:n}=e;t.updateParticipants(n.reduce(((e,t)=>(e[t.sessionId]={audioLevel:t.level,isSpeaking:t.isSpeaking},e)),{}))})),Al=e=>{const t={"call.accepted":ll(e),"call.rejected":ul(e)},n=Object.keys(t).map((n=>{const i=n;return e.on(i,t[i])}));return()=>{n.forEach((e=>e()))}};class Pl{constructor(){this.elementHandlerMap=new Map,this.observer=null,this.queueSet=new Set,this.setViewport=(e,t)=>{var n;return this.observer=new IntersectionObserver((e=>{e.forEach((e=>{const t=this.elementHandlerMap.get(e.target);null===t||void 0===t||t(e)}))}),(0,u.A)((0,u.A)({root:e},t),{},{threshold:null!==(n=null===t||void 0===t?void 0:t.threshold)&&void 0!==n?n:.35})),this.queueSet.size&&(this.queueSet.forEach((t=>{let[n,i]=t;e.contains(n)&&(this.observer.observe(n),this.elementHandlerMap.set(n,i))})),this.queueSet.clear()),()=>{var e;null===(e=this.observer)||void 0===e||e.disconnect(),this.observer=null,this.elementHandlerMap.clear()}},this.observe=(e,t)=>{const n=[e,t],i=()=>{var t;this.elementHandlerMap.delete(e),null===(t=this.observer)||void 0===t||t.unobserve(e),this.queueSet.delete(n)};return this.elementHandlerMap.has(e)?i:this.observer?(this.observer.root.contains(e)&&(this.elementHandlerMap.set(e,t),this.observer.observe(e)),i):(this.queueSet.add(n),i)}}}const xl={videoTrack:Zo.UNKNOWN,screenShareTrack:Zo.UNKNOWN},Ol=Symbol("globalOverrideKey");class Nl{constructor(e,t){var n=this;this.viewportTracker=new Pl,this.logger=Sa(["DynascaleManager"]),this.pendingSubscriptionsUpdate=null,this.videoTrackSubscriptionOverridesSubject=new bs({}),this.videoTrackSubscriptionOverrides$=this.videoTrackSubscriptionOverridesSubject.asObservable(),this.incomingVideoSettings$=this.videoTrackSubscriptionOverrides$.pipe(ds((e=>{const{[Ol]:t}=e,n=(0,l.A)(e,[Ol].map(c.A));return{enabled:!1!==(null===t||void 0===t?void 0:t.enabled),preferredResolution:null!==t&&void 0!==t&&t.enabled?t.dimension:void 0,participants:Object.fromEntries(Object.entries(n).map((e=>{let[t,n]=e;return[t,{enabled:!1!==(null===n||void 0===n?void 0:n.enabled),preferredResolution:null!==n&&void 0!==n&&n.enabled?n.dimension:void 0}]}))),isParticipantVideoEnabled:t=>{var n,i,s,r;return null===(n=null!==(i=null===(s=e[t])||void 0===s?void 0:s.enabled)&&void 0!==i?i:null===(r=e[Ol])||void 0===r?void 0:r.enabled)||void 0===n||n}}})),Ts(1)),this.setVideoTrackSubscriptionOverrides=(e,t)=>ja(this.videoTrackSubscriptionOverridesSubject,t?n=>(0,u.A)((0,u.A)({},n),Object.fromEntries(t.map((t=>[t,e])))):e?{[Ol]:e}:{}),this.applyTrackSubscriptions=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qo.SLOW;n.pendingSubscriptionsUpdate&&clearTimeout(n.pendingSubscriptionsUpdate);const t=()=>{var e;n.pendingSubscriptionsUpdate=null,null===(e=n.sfuClient)||void 0===e||e.updateSubscriptions(n.trackSubscriptions).catch((e=>{n.logger("debug","Failed to update track subscriptions",e)}))};e?n.pendingSubscriptionsUpdate=setTimeout(t,e):t()},this.trackElementVisibility=(e,t,n)=>{const i=this.viewportTracker.observe(e,(i=>{this.callState.updateParticipant(t,(t=>{var s;const r=null!==(s=t.viewportVisibilityState)&&void 0!==s?s:xl,o=i.isIntersecting||document.fullscreenElement===e?Zo.VISIBLE:Zo.INVISIBLE;return(0,u.A)((0,u.A)({},t),{},{viewportVisibilityState:(0,u.A)((0,u.A)({},r),{},{[n]:o})})}))}));return()=>{i(),this.callState.updateParticipant(t,(e=>{var t;const i=null!==(t=e.viewportVisibilityState)&&void 0!==t?t:xl;return(0,u.A)((0,u.A)({},e),{},{viewportVisibilityState:(0,u.A)((0,u.A)({},i),{},{[n]:Zo.UNKNOWN})})}))}},this.setViewport=e=>this.viewportTracker.setViewport(e),this.bindVideoElement=(e,t,n)=>{const i=this.callState.findParticipantBySessionId(t);if(!i)return;const s=(e,s)=>{!s||0!==s.width&&0!==s.height||(this.logger("debug","Ignoring 0x0 dimension",i),s=void 0),this.callState.updateParticipantTracks(n,{[t]:{dimension:s}}),this.applyTrackSubscriptions(e)},r=this.callState.participants$.pipe(ds((e=>e.find((e=>e.sessionId===t)))),Es((e=>!!e)),Cs(),Ts({bufferSize:1,refCount:!0}));let o;const a=i.isLocalParticipant?null:r.pipe(ds((e=>{var t;return null===(t=e.viewportVisibilityState)||void 0===t?void 0:t[n]})),Cs()).subscribe((t=>{if(o){if(o=null!==t&&void 0!==t?t:Zo.UNKNOWN,t===Zo.INVISIBLE)return s(Qo.MEDIUM,void 0);s(Qo.MEDIUM,{width:e.clientWidth,height:e.clientHeight})}else o=null!==t&&void 0!==t?t:Zo.UNKNOWN}));let c;const l=i.isLocalParticipant?null:new ResizeObserver((()=>{const t={width:e.clientWidth,height:e.clientHeight};if(!c)return void(c=t);if(c.width===t.width&&c.height===t.height||o===Zo.INVISIBLE)return;const n=Math.max(t.width/c.width,t.height/c.height)>1.2?Qo.IMMEDIATE:Qo.MEDIUM;s(n,{width:e.clientWidth,height:e.clientHeight}),c=t}));null===l||void 0===l||l.observe(e);const u=i.isLocalParticipant?null:r.pipe(_s("publishedTracks"),ds((e=>"videoTrack"===n?$a(e):za(e))),Cs()).subscribe((t=>{t?s(Qo.IMMEDIATE,{width:e.clientWidth,height:e.clientHeight}):s(Qo.FAST,void 0)}));e.autoplay=!0,e.playsInline=!0,e.muted=!0;const d=r.pipe(_s("videoTrack"===n?"videoStream":"screenShareStream")).subscribe((t=>{const i="videoTrack"===n?t.videoStream:t.screenShareStream;e.srcObject!==i&&(e.srcObject=null!==i&&void 0!==i?i:null,(gc()||vc())&&setTimeout((()=>{e.srcObject=null!==i&&void 0!==i?i:null,e.play().catch((e=>{this.logger("warn","Failed to play stream",e)}))}),25))}));return()=>{s(Qo.FAST,void 0),null===a||void 0===a||a.unsubscribe(),null===u||void 0===u||u.unsubscribe(),d.unsubscribe(),null===l||void 0===l||l.disconnect()}},this.bindAudioElement=(e,t,n)=>{const i=this.callState.findParticipantBySessionId(t);if(!i||i.isLocalParticipant)return;const s=this.callState.participants$.pipe(ds((e=>e.find((e=>e.sessionId===t)))),Es((e=>!!e)),Cs(),Ts({bufferSize:1,refCount:!0})),r=s.pipe(_s("screenShareAudioTrack"===n?"screenShareAudioStream":"audioStream")).subscribe((t=>{const i="screenShareAudioTrack"===n?t.screenShareAudioStream:t.audioStream;e.srcObject!==i&&setTimeout((()=>{if(e.srcObject=null!==i&&void 0!==i?i:null,e.srcObject){e.play().catch((e=>{this.logger("warn","Failed to play stream",e)}));const{selectedDevice:t}=this.speaker.state;t&&"setSinkId"in e&&e.setSinkId(t)}}))})),o="setSinkId"in e?this.speaker.state.selectedDevice$.subscribe((t=>{t&&e.setSinkId(t)})):null,a=gs([this.speaker.state.volume$,s.pipe(_s("audioVolume"))]).subscribe((t=>{var n;let[i,s]=t;e.volume=null!==(n=s.audioVolume)&&void 0!==n?n:i}));return e.autoplay=!0,()=>{null===o||void 0===o||o.unsubscribe(),a.unsubscribe(),r.unsubscribe()}},this.callState=e,this.speaker=t}setSfuClient(e){this.sfuClient=e}get trackSubscriptions(){const e=[];for(const i of this.callState.remoteParticipants){if(i.videoDimension&&$a(i)){var t;const s=null!==(t=this.videoTrackSubscriptionOverrides[i.sessionId])&&void 0!==t?t:this.videoTrackSubscriptionOverrides[Ol];var n;if(!1!==(null===s||void 0===s?void 0:s.enabled))e.push({userId:i.userId,sessionId:i.sessionId,trackType:mr.VIDEO,dimension:null!==(n=null===s||void 0===s?void 0:s.dimension)&&void 0!==n?n:i.videoDimension})}i.screenShareDimension&&za(i)&&e.push({userId:i.userId,sessionId:i.sessionId,trackType:mr.SCREEN_SHARE,dimension:i.screenShareDimension}),Ga(i)&&e.push({userId:i.userId,sessionId:i.sessionId,trackType:mr.SCREEN_SHARE_AUDIO})}return e}get videoTrackSubscriptionOverrides(){return Da(this.videoTrackSubscriptionOverrides$)}}class Dl{constructor(){var e=this;this.permissions=[],this.setPermissions=e=>{this.permissions=e||[]},this.setCallSettings=e=>{this.settings=e},this.hasPermission=e=>this.permissions.includes(e),this.canPublish=e=>{switch(e){case mr.AUDIO:return this.hasPermission(rr.SEND_AUDIO);case mr.VIDEO:return this.hasPermission(rr.SEND_VIDEO);case mr.SCREEN_SHARE:case mr.SCREEN_SHARE_AUDIO:return this.hasPermission(rr.SCREENSHARE);case mr.UNSPECIFIED:return!1;default:qc(e,"Unknown track type")}},this.canRequest=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.settings;if(!n)return!1;const{audio:i,video:s,screensharing:r}=n;switch(t){case rr.SEND_AUDIO:return i.access_request_enabled;case rr.SEND_VIDEO:return s.access_request_enabled;case rr.SCREENSHARE:return r.access_request_enabled;default:return!1}}}}class jl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{sortParticipantsBy:oc};this.name=e,this.options=t}}const Ll=new class{constructor(e){this.register=e=>{this.callTypes[e.name]=e},this.unregister=e=>{delete this.callTypes[e]},this.get=e=>(this.callTypes[e]||this.register(new jl(e)),this.callTypes[e]),this.callTypes=e.reduce(((e,t)=>(e[t.name]=t,e)),{})}}([new jl("default",{sortParticipantsBy:oc}),new jl("development",{sortParticipantsBy:oc}),new jl("livestream",{sortParticipantsBy:lc}),new jl("audio_room",{sortParticipantsBy:lc})]);class Ul{constructor(e){this.permission=e,this.disposeController=new AbortController,this.wasPrompted=!1,this.listeners=new Set,this.logger=Sa(["permissions"]);const t=this.disposeController.signal;this.ready=(async()=>{const n=()=>{this.setState("prompt")};if(!function(){var e;return!fa()&&"undefined"!==typeof navigator&&!(null===(e=navigator.permissions)||void 0===e||!e.query)}())return n();try{const n=await navigator.permissions.query({name:e.queryName});t.aborted||(this.setState(n.state),n.addEventListener("change",(()=>this.setState(n.state)),{signal:t}))}catch(i){this.logger("debug","Failed to query permission status",i),n()}})()}dispose(){this.state=void 0,this.disposeController.abort()}async getState(){if(await this.ready,!this.state)throw new Error("BrowserPermission instance possibly disposed");return this.state}async prompt(){let{forcePrompt:e=!1,throwOnNotAllowed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await Pa("permission-prompt-".concat(this.permission.queryName),(async()=>{if("prompt"!==await this.getState()||this.wasPrompted&&!e){const e="granted"===this.state;if(!e&&t)throw new Error("Permission was not granted previously, and prompting again is not allowed");return e}try{this.wasPrompted=!0,this.setState("prompting");const e=await navigator.mediaDevices.getUserMedia(this.permission.constraints);return eu(e),this.setState("granted"),!0}catch(n){if(n&&"object"===typeof n&&"name"in n&&("NotAllowedError"===n.name||"SecurityError"===n.name)){if(this.logger("info","Browser permission was not granted",{permission:this.permission}),this.setState("denied"),t)throw n;return!1}throw this.logger("error","Failed to getUserMedia",{error:n,permission:this.permission}),this.setState("prompt"),n}}))}listen(e){return this.listeners.add(e),this.state&&e(this.state),()=>this.listeners.delete(e)}asObservable(){return this.getStateObservable().pipe(ds((e=>"denied"!==e)))}asStateObservable(){return this.getStateObservable()}getIsPromptingObservable(){return this.getStateObservable().pipe(ds((e=>"prompting"===e)))}getStateObservable(){return Is((e=>this.listen(e)),((e,t)=>t()))}setState(e){this.state!==e&&(this.state=e,this.listeners.forEach((t=>t(e))))}}const Fl=(e,t)=>(0,as.H)((async()=>{let n=await navigator.mediaDevices.enumerateDevices();return n.some((e=>e.kind===t&&""===e.label))&&await e.prompt()&&(n=await navigator.mediaDevices.enumerateDevices()),n.filter((e=>e.kind===t&&""!==e.label&&"default"!==e.deviceId))})()),Ml={audio:{autoGainControl:!0,noiseSuppression:!0,echoCancellation:!0}},Vl={video:{width:1280,height:720}},Bl=il((()=>new Ul({constraints:Ml,queryName:"microphone"}))),Hl=il((()=>new Ul({constraints:Vl,queryName:"camera"}))),ql=il((()=>{return navigator.mediaDevices.addEventListener?Ds(navigator.mediaDevices,"devicechange").pipe(ds((()=>{})),(e=500,void 0===t&&(t=Vs),(0,ls.N)((function(n,i){var s=null,r=null,o=null,a=function(){if(s){s.unsubscribe(),s=null;var e=r;r=null,i.next(e)}};function c(){var n=o+e,r=t.now();if(r<n)return s=this.schedule(void 0,n-r),void i.add(s);a()}n.subscribe((0,us._)(i,(function(n){r=n,o=t.now(),s||(s=t.schedule(c,e),i.add(s))}),(function(){a(),i.complete()}),void 0,(function(){r=s=null})))})))):(0,as.H)([]);var e,t})),Wl=il((()=>qs(ql(),Bl().asObservable()).pipe($s(void 0),Js((()=>Fl(Bl(),"audioinput"))),Ts(1)))),$l=il((()=>qs(ql(),Hl().asObservable()).pipe($s(void 0),Js((()=>Fl(Hl(),"videoinput"))),Ts(1)))),Jl=il((()=>qs(ql(),Bl().asObservable()).pipe($s(void 0),Js((()=>Fl(Bl(),"audiooutput"))),Ts(1))));let zl=0;const Gl=async(e,t)=>{const n="navigator.mediaDevices.getUserMedia.".concat(zl++,".");try{null===t||void 0===t||t.trace(n,e);const i=await navigator.mediaDevices.getUserMedia(e);return null===t||void 0===t||t.trace("".concat(n,"OnSuccess"),pc(i)),vc()&&navigator.mediaDevices.dispatchEvent(new Event("devicechange")),i}catch(i){throw null===t||void 0===t||t.trace("".concat(n,"OnFailure"),i.name),i}};function Kl(e){if(!e||"object"!==typeof e)return!1;if("name"in e&&"string"===typeof e.name){const t=e.name;if(["OverconstrainedError","NotFoundError"].includes(t))return!0}if("message"in e&&"string"===typeof e.message){if(e.message.startsWith("OverconstrainedError"))return!0}return!1}const Yl=async(e,t)=>{const n={audio:(0,u.A)((0,u.A)({},Ml.audio),e)};try{return await Bl().prompt({throwOnNotAllowed:!0,forcePrompt:!0}),await Gl(n,t)}catch(i){if(Kl(i)&&null!==e&&void 0!==e&&e.deviceId){const{deviceId:t}=e,s=(0,l.A)(e,Zs);return Sa(["devices"])("warn","Failed to get audio stream, will try again with relaxed constraints",{error:i,constraints:n,relaxedConstraints:s}),Yl(s)}throw Sa(["devices"])("error","Failed to get audio stream",{error:i,constraints:n}),i}},Xl=async(e,t)=>{const n={video:(0,u.A)((0,u.A)({},Vl.video),e)};try{return await Hl().prompt({throwOnNotAllowed:!0,forcePrompt:!0}),await Gl(n,t)}catch(i){if(Kl(i)&&null!==e&&void 0!==e&&e.deviceId){const{deviceId:t}=e,s=(0,l.A)(e,Qs);return Sa(["devices"])("warn","Failed to get video stream, will try again with relaxed constraints",{error:i,constraints:n,relaxedConstraints:s}),Xl(s)}throw Sa(["devices"])("error","Failed to get video stream",{error:i,constraints:n}),i}};let Zl=0;const Ql="undefined"!==typeof navigator&&"undefined"!==typeof navigator.mediaDevices?ql().pipe($s(void 0),Js((()=>navigator.mediaDevices.enumerateDevices())),Ts(1)):void 0,eu=e=>{e.active&&(e.getTracks().forEach((e=>{e.stop()})),"function"===typeof e.release&&e.release())},tu=()=>/Mobi/i.test(navigator.userAgent);class nu{constructor(e,t,n){this.stopOnLeave=!0,this.subscriptions=[],this.isTrackStoppedDueToTrackEnd=!1,this.filters=[],this.statusChangeConcurrencyTag=Symbol("statusChangeConcurrencyTag"),this.filterRegistrationConcurrencyTag=Symbol("filterRegistrationConcurrencyTag"),this.dispose=()=>{this.subscriptions.forEach((e=>e()))},this.call=e,this.state=t,this.trackType=n,this.logger=Sa(["".concat(mr[n].toLowerCase()," manager")]),!Ql||fa()||this.trackType!==mr.AUDIO&&this.trackType!==mr.VIDEO||this.handleDisconnectedOrReplacedDevices()}listDevices(){return this.getDevices()}get enabled(){return"enabled"===this.state.status}async enable(){this.state.prevStatus=this.state.optimisticStatus,"enabled"!==this.state.optimisticStatus&&(this.state.setPendingStatus("enabled"),await xa(this.statusChangeConcurrencyTag,(async e=>{try{await this.unmuteStream(),this.state.setStatus("enabled")}finally{e.aborted||this.state.setPendingStatus(this.state.status)}})))}async disable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.prevStatus=this.state.optimisticStatus,(e||"disabled"!==this.state.optimisticStatus)&&(this.state.setPendingStatus("disabled"),await xa(this.statusChangeConcurrencyTag,(async t=>{try{const t=e||"stop-tracks"===this.state.disableMode;await this.muteStream(t),this.state.setStatus("disabled")}finally{t.aborted||this.state.setPendingStatus(this.state.status)}})))}async statusChangeSettled(){await async function(e){let t;for(;t=Oa.get(e);)await t.promise}(this.statusChangeConcurrencyTag)}async resume(){"enabled"===this.state.prevStatus&&"enabled"!==this.state.status&&await this.enable()}async toggle(){return"enabled"===this.state.optimisticStatus?await this.disable():await this.enable()}registerFilter(e){const t={start:e,stop:void 0};return{registered:Pa(this.filterRegistrationConcurrencyTag,(async()=>{this.filters.push(t),await this.applySettingsToStream()})),unregister:()=>Pa(this.filterRegistrationConcurrencyTag,(async()=>{var e;null===(e=t.stop)||void 0===e||e.call(t),this.filters=this.filters.filter((e=>e!==t)),await this.applySettingsToStream()}))}}setDefaultConstraints(e){this.state.setDefaultConstraints(e)}async select(e){if(fa())throw new Error("This method is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for reference.");const t=this.state.selectedDevice;if(e!==t)try{this.state.setDevice(e),await this.applySettingsToStream()}catch(n){throw this.state.setDevice(t),n}}async applySettingsToStream(){await xa(this.statusChangeConcurrencyTag,(async()=>{this.enabled&&(await this.muteStream(),await this.unmuteStream())}))}publishStream(e){return this.call.publish(e,this.trackType)}stopPublishStream(){return this.call.stopPublish(this.trackType)}getTracks(){var e,t;return null!==(e=null===(t=this.state.mediaStream)||void 0===t?void 0:t.getTracks())&&void 0!==e?e:[]}async muteStream(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.state.mediaStream;if(!t)return;this.logger("debug","".concat(e?"Stopping":"Disabling"," stream")),this.call.state.callingState===Ma.JOINED&&await this.stopPublishStream(),this.muteLocalStream(e);this.getTracks().every((e=>"ended"===e.readyState))&&("function"===typeof t.release&&t.release(),this.state.setMediaStream(void 0,void 0),this.filters.forEach((e=>{var t;return null===(t=e.stop)||void 0===t?void 0:t.call(e)})))}disableTracks(){this.getTracks().forEach((e=>{e.enabled&&(e.enabled=!1)}))}enableTracks(){this.getTracks().forEach((e=>{e.enabled||(e.enabled=!0)}))}stopTracks(){this.getTracks().forEach((e=>{"live"===e.readyState&&e.stop()}))}muteLocalStream(e){this.state.mediaStream&&(e?this.stopTracks():this.disableTracks())}async unmuteStream(){let e,t;this.logger("debug","Starting stream");try{if(this.state.mediaStream&&this.getTracks().every((e=>"live"===e.readyState)))e=this.state.mediaStream,this.enableTracks();else{const n=this.state.defaultConstraints,i=(0,u.A)((0,u.A)({},n),{},{deviceId:this.state.selectedDevice?{exact:this.state.selectedDevice}:void 0}),s=e=>async t=>{if(!e)return t;const n=await e;return t.getTracks().forEach((e=>{const t=e.stop;e.stop=function(){t.call(e),n.getTracks().forEach((t=>{t.kind===e.kind&&t.stop()}))}})),n.getTracks().forEach((e=>{const n=()=>{t.getTracks().forEach((t=>{e.kind===t.kind&&(t.stop(),t.dispatchEvent(new Event("ended")))}))};e.addEventListener("ended",n),this.subscriptions.push((()=>{e.removeEventListener("ended",n)}))})),t};t=this.getStream(i),e=await this.filters.reduce(((e,t)=>e.then((e=>{const{stop:n,output:i}=t.start(e);return t.stop=n,i})).then(s(e),(t=>(this.logger("warn","Filter failed to start and will be ignored",t),e)))),t)}if(this.call.state.callingState===Ma.JOINED&&await this.publishStream(e),this.state.mediaStream!==e){this.state.setMediaStream(e,await t);const n=async()=>{await this.statusChangeSettled(),this.enabled&&(this.isTrackStoppedDueToTrackEnd=!0,setTimeout((()=>{this.isTrackStoppedDueToTrackEnd=!1}),2e3),await this.disable())},i=e=>()=>{tu()&&this.trackType===mr.VIDEO&&this.call.notifyTrackMuteState(e,this.trackType).catch((e=>{this.logger("warn","Error while notifying track mute state",e)}))};e.getTracks().forEach((e=>{const t=i(!0),s=i(!1);e.addEventListener("mute",t),e.addEventListener("unmute",s),e.addEventListener("ended",n),this.subscriptions.push((()=>{e.removeEventListener("mute",t),e.removeEventListener("unmute",s),e.removeEventListener("ended",n)}))}))}}catch(n){throw t&&eu(await t),n}}get mediaDeviceKind(){return this.trackType===mr.AUDIO?"audioinput":this.trackType===mr.VIDEO?"videoinput":""}handleDisconnectedOrReplacedDevices(){this.subscriptions.push(Ua(gs([Ql.pipe((0,ls.N)((function(e,t){var n,i=!1;e.subscribe((0,us._)(t,(function(e){var s=n;n=e,i&&t.next([s,e]),i=!0})))}))),this.state.selectedDevice$]),(async e=>{let[[t,n],i]=e;try{if(!i)return;await this.statusChangeSettled();let e=!1,s=!1;const r=this.findDevice(n,i),o=this.findDevice(t,i);!r&&o?e=!0:r&&o&&r.deviceId===o.deviceId&&r.groupId!==o.groupId&&(s=!0),e&&(await this.disable(),await this.select(void 0)),s&&(this.isTrackStoppedDueToTrackEnd&&"disabled"===this.state.status?(await this.enable(),this.isTrackStoppedDueToTrackEnd=!1):await this.applySettingsToStream())}catch(s){this.logger("warn","Unexpected error while handling disconnected or replaced device",s)}})))}findDevice(e,t){const n=this.mediaDeviceKind;return e.find((e=>e.deviceId===t&&e.kind===n))}}class iu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stop-tracks",t=arguments.length>1?arguments[1]:void 0;this.disableMode=e,this.statusSubject=new bs(void 0),this.optimisticStatusSubject=new bs(void 0),this.mediaStreamSubject=new bs(void 0),this.selectedDeviceSubject=new bs(void 0),this.defaultConstraintsSubject=new bs(void 0),this.mediaStream$=this.mediaStreamSubject.asObservable(),this.selectedDevice$=this.selectedDeviceSubject.asObservable().pipe(Cs()),this.status$=this.statusSubject.asObservable().pipe(Cs()),this.optimisticStatus$=this.optimisticStatusSubject.asObservable().pipe(Cs()),this.defaultConstraints$=this.defaultConstraintsSubject.asObservable(),this.hasBrowserPermission$=t?t.asObservable().pipe(Ts(1)):(0,zs.of)(!0),this.browserPermissionState$=t?t.asStateObservable().pipe(Ts(1)):(0,zs.of)("prompt"),this.isPromptingPermission$=t?t.getIsPromptingObservable().pipe(Ts(1)):(0,zs.of)(!1)}get status(){return Da(this.status$)}get optimisticStatus(){return Da(this.optimisticStatus$)}get selectedDevice(){return Da(this.selectedDevice$)}get mediaStream(){return Da(this.mediaStream$)}setStatus(e){ja(this.statusSubject,e)}setPendingStatus(e){ja(this.optimisticStatusSubject,e)}setMediaStream(e,t){ja(this.mediaStreamSubject,e),t&&this.setDevice(this.getDeviceIdFromStream(t))}setDevice(e){ja(this.selectedDeviceSubject,e)}get defaultConstraints(){return Da(this.defaultConstraints$)}setDefaultConstraints(e){ja(this.defaultConstraintsSubject,e)}}class su extends iu{constructor(){super("stop-tracks",Hl()),this.directionSubject=new bs(void 0),this.direction$=this.directionSubject.asObservable().pipe(Cs())}get direction(){return Da(this.direction$)}setDirection(e){ja(this.directionSubject,e)}setMediaStream(e,t){if(super.setMediaStream(e,t),e){var n;const t=fa()?this.direction:"environment"===(null===(n=e.getVideoTracks()[0])||void 0===n?void 0:n.getSettings().facingMode)?"back":"front";this.setDirection(t)}}getDeviceIdFromStream(e){const[t]=e.getVideoTracks();return null===t||void 0===t?void 0:t.getSettings().deviceId}}class ru extends nu{constructor(e){super(e,new su,mr.VIDEO),this.targetResolution={width:1280,height:720}}isDirectionSupportedByDevice(){return fa()||tu()}async selectDirection(e){if(this.isDirectionSupportedByDevice())if(this.state.setDirection(e),this.state.setDevice(void 0),fa()){const t=this.getTracks()[0];await(null===t||void 0===t?void 0:t.applyConstraints({facingMode:"front"===e?"user":"environment"}))}else{this.getTracks().forEach((e=>e.stop()));try{await this.unmuteStream()}catch(t){throw t instanceof Error&&"NotReadableError"===t.name&&(await this.muteStream(),await this.unmuteStream()),t}}else this.logger("warn","Setting direction is not supported on this device")}async flip(){const e="front"===this.state.direction?"back":"front";await this.selectDirection(e)}async selectTargetResolution(e){if(this.targetResolution.height=e.height,this.targetResolution.width=e.width,"enabled"===this.state.optimisticStatus)try{await this.statusChangeSettled()}catch(t){this.logger("warn","could not apply target resolution",t)}if(this.enabled&&this.state.mediaStream){const[e]=this.state.mediaStream.getVideoTracks();if(!e)return;const{width:t,height:n}=e.getSettings();t===this.targetResolution.width&&n===this.targetResolution.height||(await this.applySettingsToStream(),this.logger("debug","".concat(t,"x").concat(n," target resolution applied to media stream")))}}async apply(e,t){var n;const i=!(null===(n=this.call.state.localParticipant)||void 0===n||!n.videoStream),s=this.call.permissionsContext.hasPermission(rr.SEND_AUDIO);if(i||!s)return;await this.statusChangeSettled();const{target_resolution:r,camera_facing:o,camera_default_on:a}=e;if(await this.selectTargetResolution(r),this.state.direction||this.state.selectedDevice||this.state.setDirection("front"===o?"front":"back"),!t)return;const{mediaStream:c}=this.state;this.enabled&&c?await this.publishStream(c):void 0===this.state.status&&a&&await this.enable()}getDevices(){return $l()}getStream(e){return e.width=this.targetResolution.width,e.height=this.targetResolution.height,!e.deviceId&&this.state.direction&&this.isDirectionSupportedByDevice()&&(e.facingMode="front"===this.state.direction?"user":"environment"),Xl(e,this.call.tracer)}}class ou extends iu{constructor(e){super(e,Bl()),this.speakingWhileMutedSubject=new bs(!1),this.speakingWhileMuted$=this.speakingWhileMutedSubject.asObservable().pipe(Cs())}get speakingWhileMuted(){return Da(this.speakingWhileMuted$)}setSpeakingWhileMuted(e){ja(this.speakingWhileMutedSubject,e)}getDeviceIdFromStream(e){const[t]=e.getAudioTracks();return null===t||void 0===t?void 0:t.getSettings().deviceId}}const au=500,cu=150,lu=128;class uu{constructor(){this.pc1=new RTCPeerConnection({}),this.pc2=new RTCPeerConnection({})}async start(e){try{this.cleanupAudioStream();const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.audioStream=t,this.pc1.addEventListener("icecandidate",(async e=>{await this.pc2.addIceCandidate(e.candidate)})),this.pc2.addEventListener("icecandidate",(async e=>{await this.pc1.addIceCandidate(e.candidate)})),this.pc2.addEventListener("track",(e=>{e.streams[0].getTracks().forEach((e=>{e._setVolume(0)}))})),t.getTracks().forEach((e=>this.pc1.addTrack(e,t)));const n=await this.pc1.createOffer({});await this.pc2.setRemoteDescription(n),await this.pc1.setLocalDescription(n);const i=await this.pc2.createAnswer();await this.pc1.setRemoteDescription(i),await this.pc2.setLocalDescription(i);const s=this.onSpeakingDetectedStateChange(e);return()=>{s(),this.stop()}}catch(t){return Sa(["RNSpeechDetector"])("error","error handling permissions: ",t),()=>{}}}stop(){this.pc1.close(),this.pc2.close(),this.cleanupAudioStream()}onSpeakingDetectedStateChange(e){let t,n,i=.13,s=!1;const r=[],o=setInterval((async()=>{try{const o=await this.pc1.getStats(),a=hc(o).find((e=>"media-source"===e.type&&"audio"===e.kind));if(a){const{audioLevel:o}=a;if(o){r.push(o),r.length>10&&r.shift();const a=r.reduce(((e,t)=>e+t),0)/r.length;a<1.1*i?n||(n=setTimeout((()=>{i=Math.min(.9*a,.13)}),5e3)):(clearTimeout(n),n=void 0),a>1.5*i&&(s||(s=!0,e({isSoundDetected:!0,audioLevel:o})),clearTimeout(t),t=setTimeout((()=>{s=!1,e({isSoundDetected:!1,audioLevel:0})}),500))}}}catch(o){Sa(["RNSpeechDetector"])("error","error checking audio level from stats",o)}}),100);return()=>{clearInterval(o),clearTimeout(t),clearTimeout(n)}}cleanupAudioStream(){this.audioStream&&(this.audioStream.getTracks().forEach((e=>e.stop())),"function"===typeof this.audioStream.release&&this.audioStream.release())}}class du extends nu{constructor(e){super(e,new ou(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stop-tracks"),mr.AUDIO),this.speakingWhileMutedNotificationEnabled=!0,this.soundDetectorConcurrencyTag=Symbol("soundDetectorConcurrencyTag"),this.subscriptions.push(Fa(gs([this.call.state.callingState$,this.call.state.ownCapabilities$,this.state.selectedDevice$,this.state.status$]),(async e=>{let[t,n,i,s]=e;try{if(t===Ma.LEFT&&await this.stopSpeakingWhileMutedDetection(),t!==Ma.JOINED)return;if(!this.speakingWhileMutedNotificationEnabled)return;n.includes(rr.SEND_AUDIO)&&"disabled"===s?await this.startSpeakingWhileMutedDetection(i):await this.stopSpeakingWhileMutedDetection()}catch(r){this.logger("warn","Could not enable speaking while muted",r)}}))),this.subscriptions.push(Ua(this.call.state.callingState$,(e=>{var t;if(!this.noiseCancellationRegistration||!this.noiseCancellation)return;(null===(t=this.call.state.settings)||void 0===t||null===(t=t.audio.noise_cancellation)||void 0===t?void 0:t.mode)===sr&&e===Ma.JOINED?this.noiseCancellationRegistration.then((()=>{var e;return null===(e=this.noiseCancellation)||void 0===e?void 0:e.enable()})).catch((e=>(this.logger("warn","Failed to enable noise cancellation",e),this.call.notifyNoiseCancellationStopped()))):e===Ma.LEFT&&this.noiseCancellationRegistration.then((()=>{var e;return null===(e=this.noiseCancellation)||void 0===e?void 0:e.disable()})).catch((e=>{this.logger("warn","Failed to disable noise cancellation",e)}))})))}async enableNoiseCancellation(e){if(fa())throw new Error("Noise cancellation is not supported in React Native");const{ownCapabilities:t,settings:n}=this.call.state;if(!t.includes(rr.ENABLE_NOISE_CANCELLATION))throw new Error("Noise cancellation is not available.");const i=null===n||void 0===n?void 0:n.audio.noise_cancellation;if(!i||i.mode===ir)throw new Error("Noise cancellation is disabled for this call type.");try{this.noiseCancellation=e,this.noiseCancellationChangeUnsubscribe=this.noiseCancellation.on("change",(e=>{e?this.call.notifyNoiseCancellationStarting().catch((e=>{this.logger("warn","notifyNoiseCancellationStart failed",e)})):this.call.notifyNoiseCancellationStopped().catch((e=>{this.logger("warn","notifyNoiseCancellationStop failed",e)}))}));const t=this.registerFilter(e.toFilter());this.noiseCancellationRegistration=t.registered,this.unregisterNoiseCancellation=t.unregister,await this.noiseCancellationRegistration,i.mode===sr&&this.call.state.callingState===Ma.JOINED&&e.enable()}catch(s){this.logger("warn","Failed to enable noise cancellation",s),await this.disableNoiseCancellation().catch((e=>{this.logger("warn","Failed to disable noise cancellation",e)}))}}async disableNoiseCancellation(){var e,t;if(fa())throw new Error("Noise cancellation is not supported in React Native");await(null!==(e=null===(t=this.unregisterNoiseCancellation)||void 0===t?void 0:t.call(this))&&void 0!==e?e:Promise.resolve()).then((()=>{var e;return null===(e=this.noiseCancellation)||void 0===e?void 0:e.disable()})).then((()=>{var e;return null===(e=this.noiseCancellationChangeUnsubscribe)||void 0===e?void 0:e.call(this)})).catch((e=>{this.logger("warn","Failed to unregister noise cancellation",e)})),await this.call.notifyNoiseCancellationStopped()}async enableSpeakingWhileMutedNotification(){this.speakingWhileMutedNotificationEnabled=!0,"disabled"===this.state.status&&await this.startSpeakingWhileMutedDetection(this.state.selectedDevice)}async disableSpeakingWhileMutedNotification(){this.speakingWhileMutedNotificationEnabled=!1,await this.stopSpeakingWhileMutedDetection()}async apply(e,t){var n;if(!t)return;const i=!(null===(n=this.call.state.localParticipant)||void 0===n||!n.audioStream),s=this.call.permissionsContext.hasPermission(rr.SEND_AUDIO);if(i||!s)return;await this.statusChangeSettled();const{mediaStream:r}=this.state;this.enabled&&r?await this.publishStream(r):void 0===this.state.status&&e.mic_default_on&&await this.enable()}getDevices(){return Wl()}getStream(e){return Yl(e,this.call.tracer)}async startSpeakingWhileMutedDetection(e){await Pa(this.soundDetectorConcurrencyTag,(async()=>{if(await this.stopSpeakingWhileMutedDetection(),fa()){this.rnSpeechDetector=new uu;const e=await this.rnSpeechDetector.start((e=>{this.state.setSpeakingWhileMuted(e.isSoundDetected)}));this.soundDetectorCleanup=()=>{e(),this.rnSpeechDetector=void 0}}else{const t=await this.getStream({deviceId:{exact:e}});this.soundDetectorCleanup=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{detectionFrequencyInMs:i=au,audioLevelThreshold:s=cu,fftSize:r=lu,destroyStreamOnStop:o=!0}=n,a=new AudioContext,c=a.createAnalyser();c.fftSize=r;const l=a.createMediaStreamSource(e);l.connect(c);const u=setInterval((()=>{var n;const i=new Uint8Array(c.frequencyBinCount);c.getByteFrequencyData(i);const r=i.some((e=>e>=s)),o=i.reduce(((e,t)=>e+t),0)/i.length,a=o>s?100:Math.round(o/s*100);null!==(n=e.getAudioTracks()[0])&&void 0!==n&&n.enabled?t({isSoundDetected:r,audioLevel:a}):t({isSoundDetected:!1,audioLevel:0})}),i);return async function(){clearInterval(u),l.disconnect(),c.disconnect(),"closed"!==a.state&&await a.close(),o&&e.getTracks().forEach((t=>{t.stop(),e.removeTrack(t)}))}}(t,(e=>{this.state.setSpeakingWhileMuted(e.isSoundDetected)}))}}))}async stopSpeakingWhileMutedDetection(){await Pa(this.soundDetectorConcurrencyTag,(async()=>{if(!this.soundDetectorCleanup)return;const e=this.soundDetectorCleanup;this.soundDetectorCleanup=void 0,this.state.setSpeakingWhileMuted(!1),await e()}))}}class hu extends iu{constructor(){super(...arguments),this.audioEnabledSubject=new bs(!0),this.settingsSubject=new bs(void 0),this.audioEnabled$=this.audioEnabledSubject.asObservable().pipe(Cs()),this.settings$=this.settingsSubject.asObservable(),this.getDeviceIdFromStream=e=>{const[t]=e.getTracks();return null===t||void 0===t?void 0:t.getSettings().deviceId}}get audioEnabled(){return Da(this.audioEnabled$)}setAudioEnabled(e){ja(this.audioEnabledSubject,e)}get settings(){return Da(this.settings$)}setSettings(e){ja(this.settingsSubject,e)}}class pu extends nu{constructor(e){super(e,new hu,mr.SCREEN_SHARE),this.subscriptions.push(Ua(e.state.settings$,(e=>{const t=null===e||void 0===e?void 0:e.screensharing.target_resolution;t&&this.setDefaultConstraints({video:{width:t.width,height:t.height}})})))}enableScreenShareAudio(){this.state.setAudioEnabled(!0)}async disableScreenShareAudio(){var e;this.state.setAudioEnabled(!1),null!==(e=this.call.publisher)&&void 0!==e&&e.isPublishing(mr.SCREEN_SHARE_AUDIO)&&await this.call.stopPublish(mr.SCREEN_SHARE_AUDIO)}getSettings(){return this.state.settings}setSettings(e){this.state.setSettings(e)}getDevices(){return(0,zs.of)([])}getStream(e){return this.state.audioEnabled||(e.audio=!1),(async(e,t)=>{const n="navigator.mediaDevices.getDisplayMedia.".concat(Zl++,".");try{null===t||void 0===t||t.trace(n,e);const i=await navigator.mediaDevices.getDisplayMedia((0,u.A)({video:!0,audio:{channelCount:{ideal:2},echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1},systemAudio:"include"},e));return null===t||void 0===t||t.trace("".concat(n,"OnSuccess"),pc(i)),i}catch(i){throw null===t||void 0===t||t.trace("".concat(n,"OnFailure"),i.name),Sa(["devices"])("error","Failed to get screen share stream",i),i}})(e,this.call.tracer)}async stopPublishStream(){return this.call.stopPublish(mr.SCREEN_SHARE,mr.SCREEN_SHARE_AUDIO)}async select(){throw new Error("Not supported")}}class fu{constructor(e){this.selectedDeviceSubject=new bs(""),this.volumeSubject=new bs(1),this.isDeviceSelectionSupported="undefined"!==typeof document&&"setSinkId"in document.createElement("audio"),this.tracer=e,this.selectedDevice$=this.selectedDeviceSubject.asObservable().pipe(Cs()),this.volume$=this.volumeSubject.asObservable().pipe(Cs())}get selectedDevice(){return Da(this.selectedDevice$)}get volume(){return Da(this.volume$)}setDevice(e){ja(this.selectedDeviceSubject,e),this.tracer.trace("navigator.mediaDevices.setSinkId",e)}setVolume(e){ja(this.volumeSubject,e)}}class mu{constructor(e){this.subscriptions=[],this.dispose=()=>{this.subscriptions.forEach((e=>e.unsubscribe()))},this.call=e,this.state=new fu(e.tracer),Ql&&!fa()&&this.subscriptions.push(gs([Ql,this.state.selectedDevice$]).subscribe((e=>{let[t,n]=e;if(!n)return;t.find((e=>e.deviceId===n&&"audiooutput"===e.kind))||this.select("")})))}listDevices(){if(fa())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");return Jl()}select(e){if(fa())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");this.state.setDevice(e)}setVolume(e){if(fa())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");if(e&&(e<0||e>1))throw new Error("Volume must be between 0 and 1");this.state.setVolume(e)}setParticipantVolume(e,t){if(fa())throw new Error("This feature is not supported in React Native. Please visit https://getstream.io/video/docs/reactnative/core/camera-and-microphone/#speaker-management for more details");if(t&&(t<0||t>1))throw new Error("Volume must be between 0 and 1, or undefined");this.call.state.updateParticipant(e,{audioVolume:t})}}class gu{constructor(e){var t=this;let{type:n,id:i,streamClient:s,members:r,ownCapabilities:o,sortParticipantsBy:a,clientStore:c,ringing:d=!1,watching:h=!1}=e;this.state=new dc,this.permissionsContext=new Dl,this.tracer=new Vc(null),this.dispatcher=new Ra,this.sfuClientTag=0,this.reconnectConcurrencyTag=Symbol("reconnectConcurrencyTag"),this.reconnectAttempts=0,this.reconnectStrategy=Sr.UNSPECIFIED,this.reconnectReason="",this.fastReconnectDeadlineSeconds=0,this.disconnectionTimeoutSeconds=0,this.lastOfflineTimestamp=0,this.trackPublishOrder=[],this.hasJoinedOnce=!1,this.deviceSettingsAppliedOnce=!1,this.initialized=!1,this.joinLeaveConcurrencyTag=Symbol("joinLeaveConcurrencyTag"),this.leaveCallHooks=new Set,this.streamClientEventHandlers=new Map,this.setup=async()=>{await Pa(this.joinLeaveConcurrencyTag,(async()=>{this.initialized||(this.leaveCallHooks.add(this.on("all",(e=>{this.state.updateFromEvent(e)}))),this.leaveCallHooks.add(this.on("changePublishOptions",(e=>{this.currentPublishOptions=e.publishOptions}))),this.leaveCallHooks.add(((e,t)=>{const n=e.state,i=[e.on("call.ended",dl(e)),hl(e),gl(t,e),vl(t),fl(t,n),ml(t,n),e.on("participantJoined",Sl(n)),e.on("participantLeft",Tl(n)),e.on("participantUpdated",Cl(n)),e.on("trackPublished",kl(n)),e.on("trackUnpublished",El(n)),Il(t,n),Rl(t,n),e.on("callGrantsUpdated",pl(n)),e.on("pinsUpdated",bl(n)),yl(e)];return e.ringing&&i.push(Al(e)),()=>{i.forEach((e=>e()))}})(this,this.dispatcher)),this.registerEffects(),this.registerReconnectHandlers(),this.state.callingState===Ma.LEFT&&this.state.setCallingState(Ma.IDLE),this.initialized=!0)}))},this.registerEffects=()=>{this.leaveCallHooks.add(Ua(this.state.settings$,(e=>{e&&this.permissionsContext.setCallSettings(e)}))),this.leaveCallHooks.add(Fa(this.state.ownCapabilities$,this.handleOwnCapabilitiesUpdated)),this.leaveCallHooks.add(Ua(this.state.blockedUserIds$,(async e=>{if(!e||0===e.length)return;const t=this.currentUserId;t&&e.includes(t)&&(this.logger("info","Leaving call because of being blocked"),await this.leave({message:"user blocked"}).catch((e=>{this.logger("error","Error leaving call after being blocked",e)})))}))),this.leaveCallHooks.add(Ua(this.state.session$,(e=>{var t;if(!this.ringing)return;const n=null===(t=this.clientStore.connectedUser)||void 0===t?void 0:t.id;if(!n)return;const i=Boolean(null===e||void 0===e?void 0:e.accepted_by[n]),s=Boolean(null===e||void 0===e?void 0:e.rejected_by[n]);(i||s)&&this.cancelAutoDrop();var r;!(i&&this.state.callingState===Ma.RINGING)&&!s||(r=this.joinLeaveConcurrencyTag,Oa.has(r))||this.leave().catch((()=>{this.logger("error","Could not leave a call that was accepted or rejected elsewhere")}))}))),this.leaveCallHooks.add(Ua(this.ringingSubject,(e=>{var t,n;if(!e)return;const i=this.state.session,s=null===(t=this.clientStore.connectedUser)||void 0===t?void 0:t.id,r=null===i||void 0===i?void 0:i.ended_at,o=null===(n=this.state.createdBy)||void 0===n?void 0:n.id,a=null===i||void 0===i?void 0:i.rejected_by,c=null===i||void 0===i?void 0:i.accepted_by;let l=!1;r?l=!0:o&&a?a[o]&&(l=!0):s&&a?a[s]&&(l=!0):s&&c&&c[s]&&(l=!0),l?this.state.callingState!==Ma.IDLE&&this.state.setCallingState(Ma.IDLE):(this.state.callingState===Ma.IDLE&&this.state.setCallingState(Ma.RINGING),this.scheduleAutoDrop(),this.leaveCallHooks.add(Al(this)))})))},this.handleOwnCapabilitiesUpdated=async e=>{if(this.permissionsContext.setPermissions(e),!this.publisher)return;const t={[rr.SEND_AUDIO]:mr.AUDIO,[rr.SEND_VIDEO]:mr.VIDEO,[rr.SCREENSHARE]:mr.SCREEN_SHARE};for(const[i,s]of Object.entries(t)){if(!this.permissionsContext.hasPermission(i))try{switch(s){case mr.AUDIO:this.microphone.enabled&&await this.microphone.disable();break;case mr.VIDEO:this.camera.enabled&&await this.camera.disable();break;case mr.SCREEN_SHARE:this.screenShare.enabled&&await this.screenShare.disable()}}catch(n){this.logger("error","Can't disable mic/camera/screenshare after revoked permissions",n)}}},this.on=(e,t)=>{if(_a(e))return this.dispatcher.on(e,t);const n=this.streamClient.on(e,(e=>{const n=e;n.call_cid&&n.call_cid===this.cid&&t(n)}));return this.streamClientEventHandlers.set(t,n),()=>{this.off(e,t)}},this.off=(e,t)=>{if(_a(e))return this.dispatcher.off(e,t);const n=this.streamClientEventHandlers.get(t);n&&n()},this.leave=async function(){let{reject:e,reason:n,message:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await Pa(t.joinLeaveConcurrencyTag,(async()=>{var s,r,o,a,c,l,u;const d=t.state.callingState;if(d===Ma.LEFT)throw new Error("Cannot leave call that has already been left.");if(d===Ma.JOINING){const e=()=>new Promise((e=>{t.state.callingState$.pipe(Es((e=>e!==Ma.JOINED),!0)).subscribe((()=>e()))}));await e()}if(d===Ma.RINGING&&!1!==e)if(e)await t.reject(null!==n&&void 0!==n?n:"decline");else{const e=t.state.remoteParticipants.length>0;t.isCreatedByMe&&!e&&await t.reject("cancel")}null===(s=t.statsReporter)||void 0===s||s.stop(),t.statsReporter=void 0,null===(r=t.sfuStatsReporter)||void 0===r||r.flush(),null===(o=t.sfuStatsReporter)||void 0===o||o.stop(),t.sfuStatsReporter=void 0,null===(a=t.subscriber)||void 0===a||a.dispose(),t.subscriber=void 0,null===(c=t.publisher)||void 0===c||c.dispose(),t.publisher=void 0,await(null===(l=t.sfuClient)||void 0===l?void 0:l.leaveAndClose(null!==(u=null!==i&&void 0!==i?i:n)&&void 0!==u?u:"user is leaving the call")),t.sfuClient=void 0,t.dynascaleManager.setSfuClient(void 0),t.state.setCallingState(Ma.LEFT),t.state.setParticipants([]),t.state.dispose(),t.leaveCallHooks.forEach((e=>e())),t.initialized=!1,t.hasJoinedOnce=!1,t.unifiedSessionId=void 0,t.ringingSubject.next(!1),t.cancelAutoDrop(),t.clientStore.unregisterCall(t),t.camera.dispose(),t.microphone.dispose(),t.screenShare.dispose(),t.speaker.dispose();const h=[];t.camera.stopOnLeave&&h.push(t.camera.disable(!0)),t.microphone.stopOnLeave&&h.push(t.microphone.disable(!0)),t.screenShare.stopOnLeave&&h.push(t.screenShare.disable(!0)),await Promise.all(h)}))},this.updateFromRingingEvent=async e=>{await this.setup();const{created_by:t,settings:n}=e.call,i=this.state.members.find((e=>e.user.id===t.id));i?this.state.setMembers([i,...e.members]):this.state.setMembers(e.members),this.state.updateFromCallResponse(e.call),this.watching=!0,this.ringingSubject.next(!0);const s=this.clientStore.calls.filter((e=>e.cid!==this.cid));this.clientStore.setCalls([this,...s]),await this.applyDeviceConfig(n,!1)},this.get=async e=>{await this.setup();const t=await this.streamClient.get(this.streamClientBasePath,e);return this.state.updateFromCallResponse(t.call),this.state.setMembers(t.members),this.state.setOwnCapabilities(t.own_capabilities),null!==e&&void 0!==e&&e.ring&&this.ringingSubject.next(!0),this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this)),await this.applyDeviceConfig(t.call.settings,!1),t},this.getOrCreate=async e=>{await this.setup();const t=await this.streamClient.post(this.streamClientBasePath,e);return this.state.updateFromCallResponse(t.call),this.state.setMembers(t.members),this.state.setOwnCapabilities(t.own_capabilities),null!==e&&void 0!==e&&e.ring&&this.ringingSubject.next(!0),this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this)),await this.applyDeviceConfig(t.call.settings,!1),t},this.create=async e=>this.getOrCreate(e),this.delete=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.streamClient.post("".concat(t.streamClientBasePath,"/delete"),e)},this.ring=async()=>await this.get({ring:!0}),this.notify=async()=>await this.get({notify:!0}),this.accept=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/accept")),this.reject=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decline";return t.streamClient.post("".concat(t.streamClientBasePath,"/reject"),{reason:e})},this.join=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxJoinRetries:n=3}=e,i=(0,l.A)(e,er);await t.setup();const s=t.state.callingState;if([Ma.JOINED,Ma.JOINING].includes(s))throw new Error("Illegal State: call.join() shall be called only once");t.state.setCallingState(Ma.JOINING),n=Math.max(n,1);for(let o=0;o<n;o++){try{return t.logger("trace","Joining call (".concat(o,")"),t.cid),await t.doJoin(i)}catch(r){if(t.logger("warn","Failed to join call (".concat(o,")"),t.cid),o===n-1)throw t.state.setCallingState(s),r}await sa(ca(o))}},this.doJoin=async e=>{var t,n,i;const s=Date.now(),r=this.state.callingState;this.joinCallData=e,this.logger("debug","Starting join flow"),this.state.setCallingState(Ma.JOINING);const o=this.reconnectStrategy===Sr.MIGRATE,a=this.reconnectStrategy===Sr.REJOIN,c=this.reconnectStrategy===Sr.FAST;let l=null===(t=this.sfuStatsReporter)||void 0===t?void 0:t.options;if(!this.credentials||!l||a||o)try{const t=await this.doJoinRequest(e);this.credentials=t.credentials,l=t.stats_options}catch(g){throw this.state.callingState===Ma.OFFLINE||this.state.setCallingState(r),g}const u=this.sfuClient,d=null===u||void 0===u?void 0:u.sessionId,h=!(null===u||void 0===u||!u.isHealthy),p=a||o||!h?new cl({logTag:String(++this.sfuClientTag),dispatcher:this.dispatcher,credentials:this.credentials,streamClient:this.streamClient,enableTracing:l.enable_rtc_stats,sessionId:a?void 0:d,onSignalClose:e=>this.handleSfuSignalClose(p,e)}):u;this.sfuClient=p,this.dynascaleManager.setSfuClient(p);const f=await Oc();if(u!==p){const[t,n]=await Promise.all([Ca("recvonly"),Ca("sendonly")]),i=this.reconnectStrategy!==Sr.UNSPECIFIED,s=i?this.getReconnectDetails(null===e||void 0===e?void 0:e.migrating_from,d):void 0,o=i?this.currentPublishOptions||[]:this.getPreferredPublishOptions(),a=i?[]:this.getPreferredSubscribeOptions();try{const{callState:e,fastReconnectDeadlineSeconds:i,publishOptions:r}=await p.join({subscriberSdp:t,publisherSdp:n,clientDetails:f,fastReconnect:c,reconnectDetails:s,preferredPublishOptions:o,preferredSubscribeOptions:a});this.currentPublishOptions=r,this.fastReconnectDeadlineSeconds=i,e&&this.state.updateFromSfuCallState(e,p.sessionId,s)}catch(g){throw this.logger("warn","Join SFU request failed",g),p.close(cl.ERROR_CONNECTION_UNHEALTHY,"Join request failed, connection considered unhealthy"),this.state.setCallingState(r),g}}if(o||this.state.setCallingState(Ma.JOINED),this.hasJoinedOnce=!0,c)await this.restoreICE(p,{includeSubscriber:!1});else{const e={bundlePolicy:"max-bundle",iceServers:this.credentials.ice_servers.map((e=>({urls:e.urls,username:e.username,credential:e.password})))};this.initPublisherAndSubscriber({sfuClient:p,connectionConfig:e,clientDetails:f,statsOptions:l,publishOptions:this.currentPublishOptions||[],closePreviousInstances:!o})}var m;a||c||o||(null===(m=this.sfuStatsReporter)||void 0===m||m.sendConnectionTime((Date.now()-s)/1e3));if(a&&h){const e=Sr[this.reconnectStrategy];await(null===u||void 0===u?void 0:u.leaveAndClose("Closing previous WS after reconnect with strategy: ".concat(e)))}else h||null===u||void 0===u||u.close(cl.DISPOSE_OLD_SOCKET,"Closing unhealthy WS after reconnect");!this.deviceSettingsAppliedOnce&&this.state.settings&&(await this.applyDeviceConfig(this.state.settings,!0),this.deviceSettingsAppliedOnce=!0),null===(n=this.joinCallData)||void 0===n||delete n.ring,null===(i=this.joinCallData)||void 0===i||delete i.notify,this.reconnectStrategy=Sr.UNSPECIFIED,this.reconnectReason="",this.logger("info","Joined call ".concat(this.cid))},this.getReconnectDetails=(e,t)=>{var n;const i=this.reconnectStrategy,s=i===Sr.REJOIN;return{strategy:i,announcedTracks:(null===(n=this.publisher)||void 0===n?void 0:n.getAnnouncedTracksForReconnect())||[],subscriptions:this.dynascaleManager.trackSubscriptions,reconnectAttempt:this.reconnectAttempts,fromSfuId:e||"",previousSessionId:s&&t||"",reason:this.reconnectReason}},this.getPreferredPublishOptions=()=>{const{preferredCodec:e,fmtpLine:t,preferredBitrate:n,maxSimulcastLayers:i}=this.clientPublishOptions||{};if(!e&&!n&&!i)return[];const s=e?Nr.create({name:e.split("/").pop(),fmtp:t}):void 0,r=[Or.create({trackType:mr.VIDEO,codec:s,bitrate:n,maxSpatialLayers:i})],o=this.screenShare.getSettings();return o&&r.push(Or.create({trackType:mr.SCREEN_SHARE,fps:o.maxFramerate,bitrate:o.maxBitrate})),r},this.getPreferredSubscribeOptions=()=>{const{subscriberCodec:e,subscriberFmtpLine:t}=this.clientPublishOptions||{};return e&&t?[xr.create({trackType:mr.VIDEO,codecs:[{name:e.split("/").pop(),fmtp:t}]})]:[]},this.restoreICE=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{includeSubscriber:i=!0,includePublisher:s=!0}=n;t.subscriber&&(t.subscriber.setSfuClient(e),i&&await t.subscriber.restartIce()),t.publisher&&(t.publisher.setSfuClient(e),s&&await t.publisher.restartIce())},this.initPublisherAndSubscriber=e=>{var t,n,i;const{sfuClient:s,connectionConfig:r,clientDetails:o,statsOptions:a,publishOptions:c,closePreviousInstances:l}=e,{enable_rtc_stats:u}=a;l&&this.subscriber&&this.subscriber.dispose(),this.subscriber=new Qc({sfuClient:s,dispatcher:this.dispatcher,state:this.state,connectionConfig:r,logTag:String(this.sfuClientTag),enableTracing:u,onUnrecoverableError:e=>{this.reconnect(Sr.REJOIN,e).catch((t=>{this.logger("warn","[Reconnect] Error reconnecting after a subscriber error: ".concat(e),t)}))}});var d;("anonymous"===(null===(t=this.streamClient.user)||void 0===t?void 0:t.type)||(l&&this.publisher&&this.publisher.dispose(),this.publisher=new Zc({sfuClient:s,dispatcher:this.dispatcher,state:this.state,connectionConfig:r,publishOptions:c,logTag:String(this.sfuClientTag),enableTracing:u,onUnrecoverableError:e=>{this.reconnect(Sr.REJOIN,e).catch((t=>{this.logger("warn","[Reconnect] Error reconnecting after a publisher error: ".concat(e),t)}))}})),null===(n=this.statsReporter)||void 0===n||n.stop(),this.statsReporter=(e=>{let{subscriber:t,publisher:n,state:i,datacenter:s,pollingIntervalInMs:r=2e3}=e;const o=Sa(["stats"]),a=async(e,i)=>"subscriber"===e&&t?t.getStats(i):"publisher"===e&&n?n.getStats(i):void 0,c=async(e,i)=>{const s="subscriber"===e?t:n;if(!s)return[];const r=[];for(const t of i){const n=await s.getStats(t),i=yc(n,{trackKind:t.kind,kind:e,publisher:void 0});r.push(i)}return r},l=new Set,u=async()=>{const e={};if(l.size>0){const t=new Set(l);for(const s of i.participants){if(!t.has(s.sessionId))continue;const{audioStream:i,isLocalParticipant:r,sessionId:a,userId:l,videoStream:u}=s,d=r?"publisher":"subscriber";try{const t=r?(null===n||void 0===n?void 0:n.getPublishedTracks())||[]:[...(null===u||void 0===u?void 0:u.getVideoTracks())||[],...(null===i||void 0===i?void 0:i.getAudioTracks())||[]];e[a]=await c(d,t)}catch(p){o("warn","Failed to collect ".concat(d," stats for ").concat(l),p)}}}const[t,r]=await Promise.all([a("subscriber"),n?a("publisher"):void 0]),u=(e,t)=>Sc(yc(e,{kind:t,trackKind:"video",publisher:n})),d=t?u(t,"subscriber"):wc(),h=r?u(r,"publisher"):wc();i.setCallStatsReport({datacenter:s,publisherStats:h,subscriberStats:d,subscriberRawStats:t,publisherRawStats:r,participants:e,timestamp:Date.now()})};let d;if(r>0){const e=async()=>{await u().catch((e=>{o("debug","Failed to collect stats",e)})),d=setTimeout(e,r)};e()}return{getRawStatsForTrack:a,getStatsForStream:c,startReportingStatsFor:e=>{l.add(e),u()},stopReportingStatsFor:e=>{l.delete(e),u()},stop:()=>{d&&clearTimeout(d)}}})({subscriber:this.subscriber,publisher:this.publisher,state:this.state,datacenter:s.edgeName}),this.tracer.setEnabled(u),null===(i=this.sfuStatsReporter)||void 0===i||i.stop(),(null===a||void 0===a?void 0:a.reporting_interval_ms)>0)&&(null!==(d=this.unifiedSessionId)&&void 0!==d||(this.unifiedSessionId=s.sessionId),this.sfuStatsReporter=new Nc(s,{clientDetails:o,options:a,subscriber:this.subscriber,publisher:this.publisher,microphone:this.microphone,camera:this.camera,state:this.state,tracer:this.tracer,unifiedSessionId:this.unifiedSessionId}),this.sfuStatsReporter.start())},this.doJoinRequest=async e=>{const t=await this.streamClient.getLocationHint(),n=(0,u.A)((0,u.A)({},e),{},{location:t}),i=await this.streamClient.post("".concat(this.streamClientBasePath,"/join"),n);this.state.updateFromCallResponse(i.call),this.state.setMembers(i.members),this.state.setOwnCapabilities(i.own_capabilities),null!==e&&void 0!==e&&e.ring&&this.ringingSubject.next(!0);return this.reconnectStrategy!==Sr.UNSPECIFIED||!this.ringing||this.isCreatedByMe||await this.accept(),this.streamClient._hasConnectionID()&&(this.watching=!0,this.clientStore.registerCall(this)),i},this.handleSfuSignalClose=(e,t)=>{this.logger("debug","[Reconnect] SFU signal connection closed");const{callingState:n}=this.state;n!==Ma.JOINING&&n!==Ma.RECONNECTING&&n!==Ma.IDLE&&n!==Ma.LEFT&&(e.isLeaving||e.isClosing||this.reconnect(Sr.REJOIN,t).catch((e=>{this.logger("warn","[Reconnect] Error reconnecting",e)})))},this.reconnect=async(e,t)=>{if(this.state.callingState!==Ma.RECONNECTING&&this.state.callingState!==Ma.MIGRATING&&this.state.callingState!==Ma.RECONNECTING_FAILED)return Pa(this.reconnectConcurrencyTag,(async()=>{const n=Date.now();this.reconnectStrategy=e,this.reconnectReason=t;do{if(this.disconnectionTimeoutSeconds>0&&(Date.now()-n)/1e3>this.disconnectionTimeoutSeconds)return this.logger("warn","[Reconnect] Stopping reconnection attempts after reaching disconnection timeout"),void this.state.setCallingState(Ma.RECONNECTING_FAILED);this.reconnectStrategy!==Sr.FAST&&this.reconnectAttempts++;const e=Sr[this.reconnectStrategy];try{var i;switch(await(null===(i=this.networkAvailableTask)||void 0===i?void 0:i.promise),this.logger("info","[Reconnect] Reconnecting with strategy ".concat(Sr[this.reconnectStrategy])),this.reconnectStrategy){case Sr.UNSPECIFIED:case Sr.DISCONNECT:this.logger("debug","[Reconnect] No-op strategy ".concat(e));break;case Sr.FAST:await this.reconnectFast();break;case Sr.REJOIN:await this.reconnectRejoin();break;case Sr.MIGRATE:await this.reconnectMigrate();break;default:qc(this.reconnectStrategy,"Unknown reconnection strategy")}break}catch(s){if(this.state.callingState===Ma.OFFLINE){this.logger("trace","[Reconnect] Can't reconnect while offline, stopping reconnection attempts");break}if(s instanceof or&&s.unrecoverable)return this.logger("warn","[Reconnect] Can't reconnect due to coordinator unrecoverable error",s),void this.state.setCallingState(Ma.RECONNECTING_FAILED);this.logger("warn","[Reconnect] ".concat(e," (").concat(this.reconnectAttempts,") failed. Attempting with REJOIN"),s),await sa(500),this.reconnectStrategy=Sr.REJOIN}}while(this.state.callingState!==Ma.JOINED&&this.state.callingState!==Ma.RECONNECTING_FAILED&&this.state.callingState!==Ma.LEFT);this.logger("info","[Reconnect] Reconnection flow finished")}))},this.reconnectFast=async()=>{var e;const t=Date.now();this.reconnectStrategy=Sr.FAST,this.state.setCallingState(Ma.RECONNECTING),await this.doJoin(this.joinCallData),null===(e=this.sfuStatsReporter)||void 0===e||e.sendReconnectionTime(Sr.FAST,(Date.now()-t)/1e3)},this.reconnectRejoin=async()=>{var e;const t=Date.now();this.reconnectStrategy=Sr.REJOIN,this.state.setCallingState(Ma.RECONNECTING),await this.doJoin(this.joinCallData),await this.restorePublishedTracks(),this.restoreSubscribedTracks(),null===(e=this.sfuStatsReporter)||void 0===e||e.sendReconnectionTime(Sr.REJOIN,(Date.now()-t)/1e3)},this.reconnectMigrate=async()=>{var e;const t=Date.now(),n=this.sfuClient;if(!n)throw new Error("Cannot migrate without an active SFU client");this.reconnectStrategy=Sr.MIGRATE,this.state.setCallingState(Ma.MIGRATING);const i=this.subscriber,s=this.publisher;null===i||void 0===i||i.detachEventHandlers(),null===s||void 0===s||s.detachEventHandlers();const r=el(n.enterMigration());try{const e=n.edgeName;await this.doJoin((0,u.A)((0,u.A)({},this.joinCallData),{},{migrating_from:e}))}finally{var o;null===(o=this.joinCallData)||void 0===o||delete o.migrating_from}await this.restorePublishedTracks(),this.restoreSubscribedTracks();try{await r(),this.state.setCallingState(Ma.JOINED)}finally{null===i||void 0===i||i.dispose(),null===s||void 0===s||s.dispose(),n.close(cl.NORMAL_CLOSURE,"Migrating away")}null===(e=this.sfuStatsReporter)||void 0===e||e.sendReconnectionTime(Sr.MIGRATE,(Date.now()-t)/1e3)},this.registerReconnectHandlers=()=>{const e=this.on("goAway",(()=>{this.reconnect(Sr.MIGRATE,"goAway").catch((e=>this.logger("warn","[Reconnect] Error reconnecting",e)))})),t=this.on("error",(e=>{const{reconnectStrategy:t,error:n}=e;t!==Sr.UNSPECIFIED&&(t===Sr.DISCONNECT?this.leave({message:"SFU instructed to disconnect"}).catch((e=>{this.logger("warn","Can't leave call after disconnect request",e)})):this.reconnect(t,(null===n||void 0===n?void 0:n.message)||"SFU Error").catch((e=>{this.logger("warn","[Reconnect] Error reconnecting",e)})))})),n=this.streamClient.on("network.changed",(e=>{if(this.tracer.trace("network.changed",e),e.online){var t,n,i;this.logger("debug","[Reconnect] Going online"),null===(t=this.sfuClient)||void 0===t||t.close(cl.DISPOSE_OLD_SOCKET,"Closing WS to reconnect after going online"),null===(n=this.networkAvailableTask)||void 0===n||n.resolve(),this.networkAvailableTask=void 0,null===(i=this.sfuStatsReporter)||void 0===i||i.start()}else{var s;if(this.logger("debug","[Reconnect] Going offline"),!this.hasJoinedOnce)return;this.lastOfflineTimestamp=Date.now();const e=tl();e.promise.then((()=>{let e=Sr.FAST;if(this.lastOfflineTimestamp){(Date.now()-this.lastOfflineTimestamp)/1e3>this.fastReconnectDeadlineSeconds&&(e=Sr.REJOIN)}this.reconnect(e,"Going online").catch((e=>{this.logger("warn","[Reconnect] Error reconnecting after going online",e)}))})),this.networkAvailableTask=e,null===(s=this.sfuStatsReporter)||void 0===s||s.stop(),this.state.setCallingState(Ma.OFFLINE)}}));this.leaveCallHooks.add(e).add(t).add(n)},this.restorePublishedTracks=async()=>{for(const e of this.trackPublishOrder){let t;switch(e){case mr.AUDIO:t=this.microphone.state.mediaStream;break;case mr.VIDEO:t=this.camera.state.mediaStream;break;case mr.SCREEN_SHARE:t=this.screenShare.state.mediaStream;break;case mr.SCREEN_SHARE_AUDIO:case mr.UNSPECIFIED:break;default:qc(e,"Unknown track type")}t&&await this.publish(t,e)}},this.restoreSubscribedTracks=()=>{const{remoteParticipants:e}=this.state;e.length<=0||this.dynascaleManager.applyTrackSubscriptions(void 0)},this.publishVideoStream=async e=>{await this.publish(e,mr.VIDEO)},this.publishAudioStream=async e=>{await this.publish(e,mr.AUDIO)},this.publishScreenShareStream=async e=>{await this.publish(e,mr.SCREEN_SHARE)},this.publish=async(e,t)=>{if(!this.sfuClient)throw new Error("Call not joined yet.");if(await this.sfuClient.joinTask,!this.permissionsContext.canPublish(t))throw new Error("No permission to publish ".concat(mr[t]));if(!this.publisher)throw new Error("Publisher is not initialized");const[n]=$c(t)?e.getAudioTracks():e.getVideoTracks();if(!n)throw new Error("There is no ".concat(mr[t]," track in the stream"));if("ended"===n.readyState)throw new Error("Can't publish ended tracks.");wl(this.trackPublishOrder,t),await this.publisher.publish(n,t);const i=[t];if(t===mr.SCREEN_SHARE){const[t]=e.getAudioTracks();t&&(wl(this.trackPublishOrder,mr.SCREEN_SHARE_AUDIO),await this.publisher.publish(t,mr.SCREEN_SHARE_AUDIO),i.push(mr.SCREEN_SHARE_AUDIO))}var s;"video"===n.kind&&(null===(s=this.sfuStatsReporter)||void 0===s||s.scheduleOne(3e3));await this.updateLocalStreamState(e,...i)},this.stopPublish=async function(){if(t.sfuClient&&t.publisher){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.publisher.stopTracks(...n),await t.updateLocalStreamState(void 0,...n)}},this.updateLocalStreamState=async function(e){if(!t.sfuClient||!t.sfuClient.sessionId)return;for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];await t.notifyTrackMuteState(!e,...i);const{sessionId:r}=t.sfuClient;for(const o of i){const n=Wc(o);n&&t.state.updateParticipant(r,(t=>({publishedTracks:e?wl([...t.publishedTracks],o):t.publishedTracks.filter((e=>e!==o)),[n]:e})))}},this.updatePublishOptions=e=>{this.logger("warn","[call.updatePublishOptions]: You are manually overriding the publish options for this call. This is not recommended, and it can cause call stability/compatibility issues. Use with caution."),this.state.callingState===Ma.JOINED&&this.logger("warn","Updating publish options after joining the call does not have an effect"),this.clientPublishOptions=(0,u.A)((0,u.A)({},this.clientPublishOptions),e)},this.notifyNoiseCancellationStarting=async()=>{var e;return null===(e=this.sfuClient)||void 0===e?void 0:e.startNoiseCancellation().catch((e=>{this.logger("warn","Failed to notify start of noise cancellation",e)}))},this.notifyNoiseCancellationStopped=async()=>{var e;return null===(e=this.sfuClient)||void 0===e?void 0:e.stopNoiseCancellation().catch((e=>{this.logger("warn","Failed to notify stop of noise cancellation",e)}))},this.notifyTrackMuteState=async function(e){if(t.sfuClient){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];await t.sfuClient.updateMuteStates(i.map((t=>({trackType:t,muted:e}))))}},this.startReportingStatsFor=e=>{var t;return null===(t=this.statsReporter)||void 0===t?void 0:t.startReportingStatsFor(e)},this.stopReportingStatsFor=e=>{var t;return null===(t=this.statsReporter)||void 0===t?void 0:t.stopReportingStatsFor(e)},this.resetReaction=e=>{this.state.updateParticipant(e,{reaction:void 0})},this.setSortParticipantsBy=e=>this.state.setSortParticipantsBy(e),this.sendReaction=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/reaction"),e),this.blockUser=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/block"),{user_id:e}),this.unblockUser=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/unblock"),{user_id:e}),this.muteSelf=e=>{const t=this.currentUserId;if(t)return this.muteUser(t,e)},this.muteOthers=e=>{const t=(e=>{switch(e){case"audio":return mr.AUDIO;case"video":return mr.VIDEO;case"screenshare":return mr.SCREEN_SHARE;case"screenshare_audio":return mr.SCREEN_SHARE_AUDIO;default:qc(e,"Unknown mute type")}})(e);if(!t)return;const n=[];for(const i of this.state.remoteParticipants)i.publishedTracks.includes(t)&&n.push(i.userId);return n.length>0?this.muteUser(n,e):void 0},this.muteUser=(e,t)=>this.streamClient.post("".concat(this.streamClientBasePath,"/mute_users"),{user_ids:Array.isArray(e)?e:[e],[t]:!0}),this.muteAllUsers=e=>this.streamClient.post("".concat(this.streamClientBasePath,"/mute_users"),{mute_all_users:!0,[e]:!0}),this.startRecording=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/start_recording"),e||{}),this.stopRecording=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/stop_recording"),{}),this.startTranscription=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/start_transcription"),e),this.stopTranscription=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/stop_transcription")),this.startClosedCaptions=async e=>{const t=this.state.setCaptioning(!0);try{return await this.streamClient.post("".concat(this.streamClientBasePath,"/start_closed_captions"),e)}catch(n){throw t.rollback(),n}},this.stopClosedCaptions=async e=>{const t=this.state.setCaptioning(!1);try{return await this.streamClient.post("".concat(this.streamClientBasePath,"/stop_closed_captions"),e)}catch(n){throw t.rollback(),n}},this.updateClosedCaptionSettings=e=>{this.state.updateClosedCaptionSettings(e)},this.requestPermissions=async e=>{const{permissions:t}=e;if(!t.every((e=>this.permissionsContext.canRequest(e))))throw new Error("You are not allowed to request permissions: ".concat(t.join(", ")));return this.streamClient.post("".concat(this.streamClientBasePath,"/request_permission"),e)},this.grantPermissions=async(e,t)=>this.updateUserPermissions({user_id:e,grant_permissions:t}),this.revokePermissions=async(e,t)=>this.updateUserPermissions({user_id:e,revoke_permissions:t}),this.updateUserPermissions=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/user_permissions"),e),this.goLive=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return t.streamClient.post("".concat(t.streamClientBasePath,"/go_live"),e,n)},this.stopLive=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.streamClient.post("".concat(t.streamClientBasePath,"/stop_live"),e)},this.startHLS=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/start_broadcasting"),{}),this.stopHLS=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/stop_broadcasting"),{}),this.startRTMPBroadcasts=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/rtmp_broadcasts"),e),this.stopAllRTMPBroadcasts=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/rtmp_broadcasts/stop")),this.stopRTMPBroadcast=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/rtmp_broadcasts/").concat(e,"/stop")),this.startFrameRecording=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/start_frame_recording"),e),this.stopFrameRecording=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/stop_frame_recording")),this.update=async e=>{const t=await this.streamClient.patch("".concat(this.streamClientBasePath),e),{call:n,members:i,own_capabilities:s}=t;return this.state.updateFromCallResponse(n),this.state.setMembers(i),this.state.setOwnCapabilities(s),t},this.endCall=async()=>this.streamClient.post("".concat(this.streamClientBasePath,"/mark_ended")),this.pin=e=>{this.state.updateParticipant(e,{pin:{isLocalPin:!0,pinnedAt:Date.now()}})},this.unpin=e=>{this.state.updateParticipant(e,{pin:void 0})},this.pinForEveryone=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/pin"),e),this.unpinForEveryone=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/unpin"),e),this.queryMembers=e=>this.streamClient.post("/call/members",(0,u.A)((0,u.A)({},e||{}),{},{id:this.id,type:this.type})),this.updateCallMembers=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/members"),e),this.scheduleAutoDrop=()=>{this.cancelAutoDrop();const e=this.state.settings;if(!e)return;if(this.state.callingState!==Ma.RINGING)return;const t=this.isCreatedByMe?e.ring.auto_cancel_timeout_ms:e.ring.incoming_call_timeout_ms;t<=0||(this.dropTimeout=setTimeout((()=>{this.state.callingState===Ma.RINGING&&this.leave({reject:!0,reason:"timeout",message:"ringing timeout - ".concat(this.isCreatedByMe?"no one accepted":"user didn't interact with incoming call screen")}).catch((e=>{this.logger("error","Failed to drop call",e)}))}),t))},this.cancelAutoDrop=()=>{clearTimeout(this.dropTimeout),this.dropTimeout=void 0},this.queryRecordings=async e=>{let t=this.streamClientBasePath;return e&&(t="".concat(t,"/").concat(e)),this.streamClient.get("".concat(t,"/recordings"))},this.queryTranscriptions=async()=>this.streamClient.get("".concat(this.streamClientBasePath,"/transcriptions")),this.getCallStats=async e=>{const t="".concat(this.streamClientBasePath,"/stats/").concat(e);return this.streamClient.get(t)},this.getCallReport=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const n="".concat(t.streamClientBasePath,"/report"),i=""!==e?{session_id:e}:{};return t.streamClient.get(n,i)},this.submitFeedback=async function(e){var n;let{reason:i,custom:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=(e=>{const{sdk:t}=e,n=(0,l.A)(e,Ys),i=fc(t),s=mc(t);return(0,u.A)({sdkName:i,sdkVersion:s},n)})(await Oc()),{sdkName:o,sdkVersion:a}=r,c=(0,l.A)(r,tr);return t.streamClient.post("".concat(t.streamClientBasePath,"/feedback"),{rating:e,reason:i,user_session_id:null===(n=t.sfuClient)||void 0===n?void 0:n.sessionId,sdk:o,sdk_version:a,custom:(0,u.A)((0,u.A)({},s),{},{"x-stream-platform-data":c})})},this.sendCustomEvent=async e=>this.streamClient.post("".concat(this.streamClientBasePath,"/event"),{custom:e}),this.applyDeviceConfig=async(e,t)=>{await this.camera.apply(e.video,t).catch((e=>{this.logger("warn","Camera init failed",e)})),await this.microphone.apply(e.audio,t).catch((e=>{this.logger("warn","Mic init failed",e)}))},this.trackElementVisibility=(e,t,n)=>this.dynascaleManager.trackElementVisibility(e,t,n),this.setViewport=e=>this.dynascaleManager.setViewport(e),this.bindVideoElement=(e,t,n)=>{const i=this.dynascaleManager.bindVideoElement(e,t,n);if(i)return this.leaveCallHooks.add(i),()=>{this.leaveCallHooks.delete(i),i()}},this.bindAudioElement=function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"audioTrack";const s=t.dynascaleManager.bindAudioElement(e,n,i);if(s)return t.leaveCallHooks.add(s),()=>{t.leaveCallHooks.delete(s),s()}},this.bindCallThumbnailElement=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=()=>{e.src=n.fallbackImageSource||"https://getstream.io/random_svg/?name=x&id=x"},s=Ua(t.state.thumbnails$,(t=>{if(!t)return;e.addEventListener("error",i);const n=new URL(t.image_url);n.searchParams.set("w",String(e.clientWidth)),n.searchParams.set("h",String(e.clientHeight)),e.src=n.toString()}));return()=>{s(),e.removeEventListener("error",i)}},this.setPreferredIncomingVideoResolution=(e,t)=>{this.dynascaleManager.setVideoTrackSubscriptionOverrides(e?{enabled:!0,dimension:e}:void 0,t),this.dynascaleManager.applyTrackSubscriptions()},this.setIncomingVideoEnabled=e=>{this.dynascaleManager.setVideoTrackSubscriptionOverrides(e?void 0:{enabled:!1}),this.dynascaleManager.applyTrackSubscriptions()},this.setDisconnectionTimeout=e=>{this.disconnectionTimeoutSeconds=e},this.type=n,this.id=i,this.cid="".concat(n,":").concat(i),this.ringingSubject=new bs(d),this.watching=h,this.streamClient=s,this.clientStore=c,this.streamClientBasePath="/call/".concat(this.type,"/").concat(this.id),this.logger=Sa(["Call"]);const p=Ll.get(n),f=a||p.options.sortParticipantsBy;f&&this.state.setSortParticipantsBy(f),this.state.setMembers(r||[]),this.state.setOwnCapabilities(o||[]),this.state.setCallingState(d?Ma.RINGING:Ma.IDLE),this.camera=new ru(this),this.microphone=new du(this),this.speaker=new mu(this),this.screenShare=new pu(this),this.dynascaleManager=new Nl(this.state,this.speaker)}get ringing(){return Da(this.ringingSubject)}get currentUserId(){var e;return null===(e=this.clientStore.connectedUser)||void 0===e?void 0:e.id}get isCreatedByMe(){var e;return(null===(e=this.state.createdBy)||void 0===e?void 0:e.id)===this.currentUserId}}class vu{constructor(e){var t=this;this._log=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";t.client.logger(i,"connection:".concat(e),n)},this.setClient=e=>{this.client=e},this._buildUrl=()=>{const e=new URLSearchParams;return e.set("api_key",this.client.key),e.set("stream-auth-type",this.client.getAuthType()),e.set("X-Stream-Client",this.client.getUserAgent()),"".concat(this.client.wsBaseURL,"/connect?").concat(e.toString())},this.onlineStatusChanged=e=>{"offline"===e.type?(this._log("onlineStatusChanged() - Status changing to offline"),this._setHealth(!1,!0)):"online"===e.type&&(this._log("onlineStatusChanged() - Status changing to online. isHealthy: ".concat(this.isHealthy)),this.isHealthy||this._reconnect({interval:10}))},this.onopen=e=>{var t;if(this.wsID!==e)return;const n=this.client.user;if(!n)return void this.client.logger("error","User not set, can't connect to WS");const i=this.client._getToken();if(!i)return void this.client.logger("error","Token not set, can't connect authenticate");const s=JSON.stringify({token:i,user_details:{id:n.id,name:n.name,image:n.image,custom:n.custom}});this._log("onopen() - Sending auth message ".concat(s),{},"trace"),null===(t=this.ws)||void 0===t||t.send(s),this._log("onopen() - onopen callback",{wsID:e})},this.onmessage=(e,t)=>{if(this.wsID!==e)return;this._log("onmessage() - onmessage callback",{event:t,wsID:e});const n="string"===typeof t.data?JSON.parse(t.data):null;var i,s;if(!this.isConnectionOpenResolved&&n&&"connection.error"===n.type&&(this.isConnectionOpenResolved=!0,n.error))return void(null===(i=this.rejectConnectionOpen)||void 0===i||i.call(this,this._errorFromWSEvent(n,!1)));(this.lastEvent=new Date,!n||"health.check"!==n.type&&"connection.ok"!==n.type||this.scheduleNextPing(),n&&"connection.ok"===n.type)&&(null===(s=this.resolveConnectionOpen)||void 0===s||s.call(this,n),this._setHealth(!0));if(n&&"connection.error"===n.type&&n.error){const{code:e}=n.error;this.isHealthy=!1,this.isConnecting=!1,this.consecutiveFailures+=1,e!==oa||this.client.tokenManager.isStatic()||(clearTimeout(this.connectionCheckTimeoutRef),this._log("connect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0}))}n&&(n.received_at=new Date,this.client.dispatchEvent(n)),this.scheduleConnectionCheck()},this.onclose=(e,t)=>{if(this.wsID===e)if(this._log("onclose() - onclose callback - "+t.code,{event:t,wsID:e}),t.code===aa){var n;const e=new Error("WS connection reject with error ".concat(t.reason));e.reason=t.reason,e.code=t.code,e.wasClean=t.wasClean,e.target=t.target,null===(n=this.rejectConnectionOpen)||void 0===n||n.call(this,e),this._log("onclose() - WS connection reject with error ".concat(t.reason),{event:t})}else{var i;this.consecutiveFailures+=1,this.totalFailures+=1,this._setHealth(!1),this.isConnecting=!1,null===(i=this.rejectConnectionOpen)||void 0===i||i.call(this,this._errorFromWSEvent(t)),this._log("onclose() - WS connection closed. Calling reconnect ...",{event:t}),this._reconnect()}},this.onerror=(e,t)=>{var n;this.wsID===e&&(this.consecutiveFailures+=1,this.totalFailures+=1,this._setHealth(!1),this.isConnecting=!1,null===(n=this.rejectConnectionOpen)||void 0===n||n.call(this,new Error("WebSocket error: ".concat(t))),this._log("onerror() - WS connection resulted into error",{event:t}),this._reconnect())},this._setHealth=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e!==t.isHealthy&&(t.isHealthy=e,t.isHealthy||n?t.client.dispatchEvent({type:"connection.changed",online:t.isHealthy}):setTimeout((()=>{t.isHealthy||t.client.dispatchEvent({type:"connection.changed",online:t.isHealthy})}),5e3))},this._errorFromWSEvent=function(e){let n,i,s,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(function(e){return void 0!==e.code}(e))n=e.code,s=e.reason,i=0;else{const{error:t}=e;n=t.code,s=t.message,i=t.StatusCode}const o="WS failed with code: ".concat(n," and reason: ").concat(s);t._log(o,{event:e},"warn");const a=new Error(o);return a.code=n,a.StatusCode=i,a.isWSFailure=r,a},this._setupConnectionPromise=()=>{this.isConnectionOpenResolved=!1,this.connectionOpenSafe=el(new Promise(((e,t)=>{this.resolveConnectionOpen=e,this.rejectConnectionOpen=t})))},this.scheduleNextPing=()=>{const e=al();this.healthCheckTimeoutRef&&e.clearTimeout(this.healthCheckTimeoutRef),this.healthCheckTimeoutRef=e.setTimeout((()=>{const e=[{type:"health.check",client_id:this.client.clientID}];try{var t;null===(t=this.ws)||void 0===t||t.send(JSON.stringify(e))}catch(n){}}),this.pingInterval)},this.scheduleConnectionCheck=()=>{clearTimeout(this.connectionCheckTimeoutRef),this.connectionCheckTimeoutRef=setTimeout((()=>{const e=new Date;this.lastEvent&&e.getTime()-this.lastEvent.getTime()>this.connectionCheckTimeout&&(this._log("scheduleConnectionCheck - going to reconnect"),this._setHealth(!1),this._reconnect())}),this.connectionCheckTimeout)},this.client=e,this.consecutiveFailures=0,this.totalFailures=0,this.isConnecting=!1,this.isDisconnected=!1,this.isConnectionOpenResolved=!1,this.isHealthy=!1,this.wsID=1,this.lastEvent=null,this.pingInterval=25e3,this.connectionCheckTimeout=this.pingInterval+1e4,ha(this.onlineStatusChanged)}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;if(this.isConnecting)throw Error("You've called connect twice, can only attempt 1 connection at the time");this.isDisconnected=!1;try{const e=await this._connect();this.consecutiveFailures=0,this._log("connect() - Established ws connection with healthcheck: ".concat(e))}catch(t){if(this.isHealthy=!1,this.consecutiveFailures+=1,t.code!==oa||this.client.tokenManager.isStatic()){if(!t.isWSFailure)throw new Error(JSON.stringify({code:t.code,StatusCode:t.StatusCode,message:t.message,isWSFailure:t.isWSFailure}))}else this._log("connect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0})}return await this._waitForHealthy(e)}async _waitForHealthy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;return Promise.race([(async()=>{for(let n=0;n<=e;n+=50)try{return await this.connectionOpen}catch(t){if(n===e)throw new Error(JSON.stringify({code:t.code,StatusCode:t.StatusCode,message:t.message,isWSFailure:t.isWSFailure}));await sa(50)}})(),(async()=>{throw await sa(e),this.isConnecting=!1,new Error(JSON.stringify({code:"",StatusCode:"",message:"initial WS connection could not be established",isWSFailure:!0}))})()])}disconnect(e){let t;this._log("disconnect() - Closing the websocket connection for wsID ".concat(this.wsID)),this.wsID+=1,this.isConnecting=!1,this.isDisconnected=!0,this.healthCheckTimeoutRef&&al().clearInterval(this.healthCheckTimeoutRef),this.connectionCheckTimeoutRef&&clearInterval(this.connectionCheckTimeoutRef),pa(this.onlineStatusChanged),this.isHealthy=!1;const{ws:n}=this;return n&&n.close&&n.readyState===n.OPEN?(t=new Promise((t=>{const i=e=>{this._log("disconnect() - resolving isClosedPromise ".concat(e?"with":"without"," close frame"),{event:e}),t()};n.onclose=i,setTimeout(i,null!=e?e:1e3)})),this._log("disconnect() - Manually closed connection by calling client.disconnect()"),n.close(aa,"Manually closed connection by calling client.disconnect()")):(this._log("disconnect() - ws connection doesn't exist or it is already closed."),t=Promise.resolve()),delete this.ws,t}async _connect(){if(this.isConnecting)return;this.isConnecting=!0;let e=!1;try{this._log("_connect() - waiting for token"),await this.client.tokenManager.tokenReady(),e=!0}catch(o){}try{var t;e||(this._log("_connect() - tokenProvider failed before, so going to retry"),await this.client.tokenManager.loadToken()),this.client.isConnectionIsPromisePending||this.client._setupConnectionIdPromise(),this._setupConnectionPromise();const s=this._buildUrl();this._log("_connect() - Connecting to ".concat(s));const r=null!==(t=this.client.options.WebSocketImpl)&&void 0!==t?t:WebSocket;this.ws=new r(s),this.ws.onopen=this.onopen.bind(this,this.wsID),this.ws.onclose=this.onclose.bind(this,this.wsID),this.ws.onerror=this.onerror.bind(this,this.wsID),this.ws.onmessage=this.onmessage.bind(this,this.wsID);const o=await this.connectionOpen;var n,i;if(this.isConnecting=!1,o)return this.connectionID=o.connection_id,null===(n=(i=this.client).resolveConnectionId)||void 0===n||n.call(i,this.connectionID),o}catch(a){var s,r;throw this.client._setupConnectionIdPromise(),this.isConnecting=!1,this._log("_connect() - Error - ",a),null===(s=(r=this.client).rejectConnectionId)||void 0===s||s.call(r,a),a}}async _reconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._log("_reconnect() - Initiating the reconnect"),this.isConnecting||this.isHealthy)return void this._log("_reconnect() - Abort (1) since already connecting or healthy");let t=e.interval;if(t||(t=ca(this.consecutiveFailures)),await sa(t),this.isConnecting||this.isHealthy)this._log("_reconnect() - Abort (2) since already connecting or healthy");else if(this.isDisconnected)this._log("_reconnect() - Abort (3) since disconnect() is called");else{this._log("_reconnect() - Destroying current WS connection"),this._destroyCurrentWSConnection(),e.refreshToken&&await this.client.tokenManager.loadToken();try{await this._connect(),this._log("_reconnect() - Waiting for recoverCallBack"),this._log("_reconnect() - Finished recoverCallBack"),this.consecutiveFailures=0}catch(n){if(this.isHealthy=!1,this.consecutiveFailures+=1,n.code===oa&&!this.client.tokenManager.isStatic())return this._log("_reconnect() - WS failure due to expired token, so going to try to reload token and reconnect"),this._reconnect({refreshToken:!0});n.isWSFailure&&(this._log("_reconnect() - WS failure, so going to try to reconnect"),this._reconnect())}this._log("_reconnect() - == END ==")}}_destroyCurrentWSConnection(){this.wsID+=1;try{var e;null===this||void 0===this||null===(e=this.ws)||void 0===e||e.close()}catch(t){}}get connectionOpen(){var e;return null===(e=this.connectionOpenSafe)||void 0===e?void 0:e.call(this)}}const bu=e=>{const t={},n=String.fromCharCode,i=e.length;let s,r,o,a,c=0,l=0,u="";for(s=0;s<64;s++)t["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s)]=s;for(o=0;o<i;o++)for(r=t[e.charAt(o)],c=(c<<6)+r,l+=6;l>=8;)((a=c>>>(l-=8)&255)||o<i-2)&&(u+=n(a));return u};class yu{constructor(e){this.loadTokenPromise=null,this.type="static",this.setTokenOrProvider=async(e,t,n)=>{this.user=t,this.isAnonymous=n,this.validateToken(e),ra(e)&&(this.tokenProvider=e,this.type="provider"),"string"===typeof e&&(this.token=e,this.type="static"),await this.loadToken()},this.reset=()=>{this.token=void 0,this.tokenProvider=void 0,this.type="static",this.user=void 0,this.loadTokenPromise=null},this.validateToken=e=>{if(!this.user||!this.isAnonymous||e){if(!this.secret&&!e)throw new Error("User token can not be empty");if("string"!==typeof e&&!ra(e))throw new Error("User token should either be a string or a function");if("string"===typeof e){if(this.isAnonymous&&""===e)return;const t=function(e){const t=e.split(".");if(3!==t.length)return"";const n=t[1],i=bu(n);return JSON.parse(i).user_id}(e);if(null!=e&&(null==t||""===t||!this.isAnonymous&&t!==this.user.id))throw new Error("userToken does not have a user_id or is not matching with user.id")}}},this.tokenReady=()=>this.loadTokenPromise,this.loadToken=()=>(this.loadTokenPromise=new Promise((async(e,t)=>{if("static"===this.type)return e(this.token);if(this.tokenProvider&&"string"!==typeof this.tokenProvider){try{const e=await this.tokenProvider();this.validateToken(e),this.token=e}catch(n){return t(new Error("Call to tokenProvider failed with message: ".concat(n)))}e(this.token)}})),this.loadTokenPromise),this.getToken=()=>{if(this.token)return this.token;if(this.user&&!this.token)return this.token;throw new Error("User token is not set. Either client.connectUser wasn't called or client.disconnect was called")},this.isStatic=()=>"static"===this.type,this.secret=e}}const wu=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://hint.stream-io-video.com/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const i=Sa(["location-hint"]);let s=0,r="ERR";do{const n=new AbortController,s=setTimeout((()=>n.abort()),t);try{const t=(await fetch(e,{method:"HEAD",signal:n.signal})).headers.get("x-amz-cf-pop")||"ERR";i("debug","Location header: ".concat(t)),r=t.substring(0,3)}catch(o){i("warn","Failed to get location hint from ".concat(e),o),r="ERR"}finally{clearTimeout(s)}}while("ERR"===r&&++s<n);return r};class Su{constructor(e,t){var n,i,s=this;this.listeners={},this.getAuthType=()=>this.anonymous?"anonymous":"jwt",this.setBaseURL=e=>{this.baseURL=e,this.wsBaseURL=this.baseURL.replace("http","ws").replace(":3030",":8800")},this.getLocationHint=async(e,t)=>{const n=await this.locationHint;return n&&"ERR"!==n?n:(this.locationHint=wu(null!==e&&void 0!==e?e:this.options.locationHintUrl,null!==t&&void 0!==t?t:this.options.locationHintTimeout),this.locationHint)},this._getConnectionID=()=>{var e;return null===(e=this.wsConnection)||void 0===e?void 0:e.connectionID},this._hasConnectionID=()=>Boolean(this._getConnectionID()),this.connectUser=async(e,t)=>{if(!e.id)throw new Error('The "id" field on the user is missing');if(this.userID===e.id&&this.connectUserTask)return this.logger("warn","Consecutive calls to connectUser is detected, ideally you should only call this function once in your app."),this.connectUserTask;if(this.userID)throw new Error("Use client.disconnect() before trying to connect as a different user. connectUser was called twice.");!this.secret&&!this.node||this.options.allowServerSideConnect||this.logger("warn","Please do not use connectUser server side. Use our @stream-io/node-sdk instead: https://getstream.io/video/docs/api/"),this.userID=e.id,this.anonymous=!1,await this.tokenManager.setTokenOrProvider(t,e,!1),this._setUser(e),this.connectUserTask=this.openConnection();try{return ha(this.updateNetworkConnectionStatus),await this.connectUserTask}catch(n){throw this.persistUserOnConnectionFailure?await this.closeConnection():await this.disconnectUser(),n}},this._setUser=e=>{this.user=e,this.userID=e.id,this._user=(0,u.A)({},e)},this.closeConnection=async e=>{var t;await(null===(t=this.wsConnection)||void 0===t?void 0:t.disconnect(e))},this.openConnection=async()=>{var e,t,n;if(!this.userID)throw Error("UserWithId is not set on client, use client.connectUser or client.connectAnonymousUser instead");const i=null===(e=this.wsPromiseSafe)||void 0===e?void 0:e.call(this);if(null!==(t=this.wsConnection)&&void 0!==t&&t.isConnecting&&i)return this.logger("info","client:openConnection() - connection already in progress"),await i;if(null!==(n=this.wsConnection)&&void 0!==n&&n.isHealthy&&this._hasConnectionID())return void this.logger("info","client:openConnection() - openConnection called twice, healthy connection already exists");this._setupConnectionIdPromise(),this.clientID="".concat(this.userID,"--").concat(ua());const s=this.connect();return this.wsPromiseSafe=el(s),await s},this.disconnectUser=async e=>{this.logger("info","client:disconnect() - Disconnecting the client"),delete this.user,delete this._user,delete this.userID,this.anonymous=!1,await this.closeConnection(e),pa(this.updateNetworkConnectionStatus),this.tokenManager.reset(),this.connectionIdPromiseSafe=void 0,this.rejectConnectionId=void 0,this.resolveConnectionId=void 0},this.connectGuestUser=async e=>{this.guestUserCreatePromise=this.doAxiosRequest("post","/guest",{user:e},{publicEndpoint:!0});const t=await this.guestUserCreatePromise;return this.guestUserCreatePromise.finally((()=>this.guestUserCreatePromise=void 0)),this.connectUser(t.user,t.access_token)},this.connectAnonymousUser=async(e,t)=>{var n;ha(this.updateNetworkConnectionStatus),this._setupConnectionIdPromise(),this.anonymous=!0,await this.tokenManager.setTokenOrProvider(t,e,!0),this._setUser(e),null===(n=this.resolveConnectionId)||void 0===n||n.call(this)},this.on=(e,t)=>{var n;return this.listeners[e]||(this.listeners[e]=[]),this.logger("debug","Adding listener for ".concat(e," event")),null===(n=this.listeners[e])||void 0===n||n.push(t),()=>{this.off(e,t)}},this.off=(e,t)=>{var n;this.listeners[e]||(this.listeners[e]=[]),this.logger("debug","Removing listener for ".concat(e," event")),this.listeners[e]=null===(n=this.listeners[e])||void 0===n?void 0:n.filter((e=>e!==t))},this._setupConnectionIdPromise=()=>{this.connectionIdPromiseSafe=el(new Promise(((e,t)=>{this.resolveConnectionId=e,this.rejectConnectionId=t})))},this._logApiRequest=(e,t,n,i)=>{"trace"===wa()&&this.logger("trace","client: ".concat(e," - Request - ").concat(t),{payload:n,config:i})},this._logApiResponse=(e,t,n)=>{"trace"===wa()&&this.logger("trace","client:".concat(e," - Response - url: ").concat(t," > status ").concat(n.status),{response:n})},this._logApiError=(e,t,n)=>{this.logger("error","client:".concat(e," - Error - url: ").concat(t),{url:t,error:n})},this.doAxiosRequest=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!i.publicEndpoint){await Promise.all([s.tokenManager.tokenReady(),s.guestUserCreatePromise]);try{await s.connectionIdPromise}catch(c){var r;await(null===(r=s.wsConnection)||void 0===r?void 0:r._waitForHealthy()),await s.connectionIdPromise}}const o=s._enrichAxiosOptions(i);try{let i;switch(s._logApiRequest(e,t,n,o),e){case"get":i=await s.axiosInstance.get(t,o);break;case"delete":i=await s.axiosInstance.delete(t,o);break;case"post":i=await s.axiosInstance.post(t,n,o);break;case"put":i=await s.axiosInstance.put(t,n,o);break;case"patch":i=await s.axiosInstance.patch(t,n,o);break;case"options":i=await s.axiosInstance.options(t,o);break;default:throw new Error("Invalid request type")}return s._logApiResponse(e,t,i),s.consecutiveFailures=0,s.handleResponse(i)}catch(l){var a;if(l.client_request_id=null===(a=o.headers)||void 0===a?void 0:a["x-client-request-id"],s.consecutiveFailures+=1,l.response)return s._logApiError(e,t,l.response),l.response.data.code!==oa||s.tokenManager.isStatic()?s.handleResponse(l.response):(s.consecutiveFailures>1&&await sa(ca(s.consecutiveFailures)),await s.tokenManager.loadToken(),await s.doAxiosRequest(e,t,n,i));throw s._logApiError(e,t,l),l}},this.get=(e,t)=>this.doAxiosRequest("get",e,null,{params:t}),this.put=(e,t,n)=>this.doAxiosRequest("put",e,t,{params:n}),this.post=(e,t,n)=>this.doAxiosRequest("post",e,t,{params:n}),this.patch=(e,t,n)=>this.doAxiosRequest("patch",e,t,{params:n}),this.delete=(e,t)=>this.doAxiosRequest("delete",e,null,{params:t}),this.errorFromResponse=e=>{var t,n;const{data:i,status:s}=e;return new or({message:"Stream error code ".concat(i.code,": ").concat(i.message),code:null!==(t=i.code)&&void 0!==t?t:null,unrecoverable:null!==(n=i.unrecoverable)&&void 0!==n?n:null,response:e,status:s})},this.handleResponse=e=>{const t=e.data;if(function(e){return!e.status||e.status<200||300<=e.status}(e))throw this.errorFromResponse(e);return t},this.dispatchEvent=e=>{if(this.logger("debug","Dispatching event: ".concat(e.type),e),this.listeners){for(const t of this.listeners.all||[])t(e);for(const t of this.listeners[e.type]||[])t(e)}},this.connect=async()=>{if(!this.userID||!this._user)throw Error("Call connectUser or connectAnonymousUser before starting the connection");if(!this.wsBaseURL)throw Error("Websocket base url not set");if(!this.clientID)throw Error("clientID is not set");return this.wsConnection=new vu(this),this.logger("info","StreamClient.connect: this.wsConnection.connect()"),await this.wsConnection.connect(this.defaultWSTimeout)},this.getUserAgent=()=>{if(!this.cachedUserAgent){const{clientAppIdentifier:e={}}=this.options,{sdkName:t="js",sdkVersion:n="1.22.2"}=e,i=(0,l.A)(e,nr);this.cachedUserAgent=["stream-video-".concat(t,"-v").concat(n),...Object.entries(i).map((e=>{let[t,n]=e;return"".concat(t,"=").concat(n)})),"client_bundle=".concat("browser-esm")].join("|")}return this.cachedUserAgent},this._enrichAxiosOptions=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{params:{},headers:{},config:{}};const n=t.publicEndpoint&&!s.user?void 0:s._getToken(),i=n?{Authorization:n}:void 0;return null!==(e=t.headers)&&void 0!==e&&e["x-client-request-id"]||(t.headers=(0,u.A)((0,u.A)({},t.headers),{},{"x-client-request-id":ua()})),(0,u.A)((0,u.A)({params:(0,u.A)({user_id:s.userID,connection_id:s._getConnectionID(),api_key:s.key},t.params),headers:(0,u.A)((0,u.A)({},i),{},{"stream-auth-type":t.publicEndpoint&&!s.user?"anonymous":s.getAuthType(),"X-Stream-Client":s.getUserAgent()},t.headers)},t.config),s.options.axiosRequestConfig)},this._getToken=()=>this.tokenManager?this.tokenManager.getToken():null,this.updateNetworkConnectionStatus=e=>{"offline"===e.type?(this.logger("debug","device went offline"),this.dispatchEvent({type:"network.changed",online:!1})):"online"===e.type&&(this.logger("debug","device went online"),this.dispatchEvent({type:"network.changed",online:!0}))},this.key=e,this.secret=null===t||void 0===t?void 0:t.secret;const r=t||{browser:"undefined"!==typeof window};this.browser=r.browser||"undefined"!==typeof window,this.node=!this.browser,this.browser&&(this.locationHint=wu(null===t||void 0===t?void 0:t.locationHintUrl,null===t||void 0===t?void 0:t.locationHintTimeout,null===t||void 0===t?void 0:t.locationHintMaxAttempts)),this.options=(0,u.A)({timeout:5e3,withCredentials:!1},r),this.node&&!this.options.httpsAgent&&(this.options.httpsAgent=new null.Agent({keepAlive:!0,keepAliveMsecs:3e3})),this.setBaseURL(this.options.baseURL||"https://video.stream-io-api.com/video"),this.axiosInstance=Ui.create((0,u.A)((0,u.A)({},this.options),{},{baseURL:this.baseURL})),this.wsConnection=null,this.wsPromiseSafe=null,this.connectUserTask=null,this.anonymous=!1,this.persistUserOnConnectionFailure=null===(n=this.options)||void 0===n?void 0:n.persistUserOnConnectionFailure,this.tokenManager=new yu(this.secret),this.consecutiveFailures=0,this.defaultWSTimeout=null!==(i=this.options.defaultWsTimeout)&&void 0!==i?i:15e3,this.logger=ra(r.logger)?r.logger:()=>null}get connectionIdPromise(){var e;return null===(e=this.connectionIdPromiseSafe)||void 0===e?void 0:e.call(this)}get isConnectionIsPromisePending(){var e,t;return null!==(e=null===(t=this.connectionIdPromiseSafe)||void 0===t?void 0:t.checkPending())&&void 0!==e&&e}get wsPromise(){var e;return null===(e=this.wsPromiseSafe)||void 0===e?void 0:e.call(this)}}const Tu=(e,t)=>"".concat(e,"/").concat(t.id),Cu=(e,t)=>{const n=(e=>{const t=(null===e||void 0===e?void 0:e.clientAppIdentifier)||{},n=xc();return n&&(t.sdkName=vr[n.type].toLowerCase(),t.sdkVersion="".concat(n.major,".").concat(n.minor,".").concat(n.patch)),t})(t),i=Sa(["coordinator"]);return new Su(e,(0,u.A)((0,u.A)({persistUserOnConnectionFailure:!0},t),{},{clientAppIdentifier:n,logger:i}))};class ku{constructor(e,t){var n=this;this.effectsRegistered=!1,this.eventHandlersToUnregister=[],this.connectionConcurrencyTag=Symbol("connectionConcurrencyTag"),this.registerClientInstance=(e,t)=>{const n=Tu(e,t);ku._instances.has(n)&&this.logger("warn","A StreamVideoClient already exists for ".concat(t.id,"; Prefer using getOrCreateInstance method")),ku._instances.set(n,this)},this.registerEffects=()=>{this.effectsRegistered||(this.eventHandlersToUnregister.push(this.on("connection.changed",(e=>{if(!e.online)return;const t=this.writeableStateStore.calls.filter((e=>e.watching)).map((e=>e.cid));t.length<=0||(this.logger("info","Rewatching calls ".concat(t.join(", "))),this.queryCalls({watch:!0,filter_conditions:{cid:{$in:t}},sort:[{field:"cid",direction:1}]}).catch((e=>{this.logger("error","Failed to re-watch calls",e)})))}))),this.eventHandlersToUnregister.push(this.on("call.created",(e=>{var t;const{call:n,members:i}=e;if((null===(t=this.state.connectedUser)||void 0===t?void 0:t.id)===n.created_by.id)return void this.logger("warn","Received `call.created` sent by the current user");this.logger("info","New call created and registered: ".concat(n.cid));const s=new gu({streamClient:this.streamClient,type:n.type,id:n.id,members:i,clientStore:this.writeableStateStore});s.state.updateFromCallResponse(n),this.writeableStateStore.registerCall(s)}))),this.eventHandlersToUnregister.push(this.on("call.ring",(async e=>{var t;const{call:n,members:i}=e;if((null===(t=this.state.connectedUser)||void 0===t?void 0:t.id)===n.created_by.id)return void this.logger("debug","Received `call.ring` sent by the current user so ignoring the event");const s=this.writeableStateStore.findCall(n.type,n.id);if(s)await s.updateFromRingingEvent(e);else{const e=new gu({streamClient:this.streamClient,type:n.type,id:n.id,members:i,clientStore:this.writeableStateStore,ringing:!0});await e.get()}}))),this.effectsRegistered=!0)},this.connectUser=async(e,t)=>{if("anonymous"===e.type)return e.id="!anon",this.connectAnonymousUser(e,t);const n=await Pa(this.connectionConcurrencyTag,(async()=>{const n=this.streamClient,{onConnectUserError:i,persistUserOnConnectionFailure:s}=n.options;let{maxConnectUserRetries:r=5}=n.options;r=Math.max(r,1);const o=[];for(let c=0;c<r;c++)try{return this.logger("trace","Connecting user (".concat(c,")"),e),"guest"===e.type?await n.connectGuestUser(e):await n.connectUser(e,t)}catch(a){if(this.logger("warn","Failed to connect a user (".concat(c,")"),a),o.push(a),c===r-1)throw null===i||void 0===i||i(a,o),a;s&&await n.disconnectUser(),await sa(ca(c))}}));return null!==n&&void 0!==n&&n.me&&this.writeableStateStore.setConnectedUser(n.me),this.registerEffects(),n},this.disconnectUser=async e=>{await Pa(this.connectionConcurrencyTag,(async()=>{const{user:t,key:n}=this.streamClient;t&&(await this.streamClient.disconnectUser(e),t.id&&ku._instances.delete(Tu(n,t)),this.eventHandlersToUnregister.forEach((e=>e())),this.eventHandlersToUnregister=[],this.effectsRegistered=!1,this.writeableStateStore.setConnectedUser(void 0))}))},this.on=(e,t)=>this.streamClient.on(e,t),this.off=(e,t)=>this.streamClient.off(e,t),this.call=(e,t)=>new gu({streamClient:this.streamClient,id:t,type:e,clientStore:this.writeableStateStore}),this.createGuestUser=async e=>this.streamClient.doAxiosRequest("post","/guest",e,{publicEndpoint:!0}),this.queryCalls=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await n.streamClient.post("/calls",e),i=[];for(const s of t.calls){const t=new gu({streamClient:n.streamClient,id:s.call.id,type:s.call.type,members:s.members,ownCapabilities:s.own_capabilities,watching:e.watch,clientStore:n.writeableStateStore});t.state.updateFromCallResponse(s.call),await t.applyDeviceConfig(s.call.settings,!1),e.watch&&(await t.setup(),n.writeableStateStore.registerCall(t)),i.push(t)}return(0,u.A)((0,u.A)({},t),{},{calls:i})},this.queryCallStats=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.streamClient.post("/call/stats",e)},this.queryAggregateCallStats=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.streamClient.post("/stats",e)},this.edges=async()=>this.streamClient.get("/edges"),this.addDevice=async(e,t,n,i,s)=>await this.streamClient.post("/devices",(0,u.A)((0,u.A)({id:e,push_provider:t,voip_token:s},null!=i?{user_id:i}:{}),null!=n?{push_provider_name:n}:{})),this.addVoipDevice=async(e,t,n,i)=>await this.addDevice(e,t,n,i,!0),this.getDevices=async e=>await this.streamClient.get("/devices",e?{user_id:e}:{}),this.removeDevice=async(e,t)=>await this.streamClient.delete("/devices",(0,u.A)({id:e},t?{user_id:t}:{})),this.onRingingCall=async e=>{let t=this.state.calls.find((t=>t.cid===e&&t.ringing));if(!t){const[n,i]=e.split(":");t=new gu({streamClient:this.streamClient,type:n,id:i,clientStore:this.writeableStateStore,ringing:!0}),await t.get()}return t},this.connectAnonymousUser=async(e,t)=>Pa(this.connectionConcurrencyTag,(()=>this.streamClient.connectAnonymousUser(e,t)));const i="string"===typeof e?e:e.apiKey,s="string"===typeof e?t:e.options;null!==s&&void 0!==s&&s.enableTimerWorker&&(ol=!0);const r=(null===s||void 0===s?void 0:s.logger)||ba;var o,a;if(o=r,a=(null===s||void 0===s?void 0:s.logLevel)||"warn",ga=o,a&&ya(a),this.logger=Sa(["client"]),this.streamClient=Cu(i,s),this.writeableStateStore=new Ba,this.readOnlyStateStore=new Ha(this.writeableStateStore),"string"!==typeof e&&e.user){const t=e.user;"anonymous"===t.type&&(t.id="!anon"),t.id&&this.registerClientInstance(i,t);const n=(e=>{const{token:t,tokenProvider:n}=e;if(t&&n){let e=!1;return async function(){return e?n():(e=!0,t)}}return t||n})(e);this.connectUser(t,n).catch((e=>{this.logger("error","Failed to connect",e)}))}}static getOrCreateInstance(e){const{apiKey:t,user:n,token:i,tokenProvider:s}=e;if(!n.id&&"anonymous"!==n.type)throw new Error("user.id is required for a non-anonymous user");if(!i&&!s&&"anonymous"!==n.type&&"guest"!==n.type)throw new Error("tokenProvider or token is required for a authenticated users");return ku._instances.get(Tu(t,n))||new ku(e)}get state(){return this.readOnlyStateStore}}ku._instances=new Map},7542:(e,t,n)=>{var i=n(3992),s=/%[sdv%]/g,r=function(e){var t=1,n=arguments,i=n.length;return e.replace(s,(function(e){if(t>=i)return e;var s=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}}))},o=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var s=0;s<t.names.length;s+=1){var o=t.names[s];t.name?i.push(n[t.name][o]):i.push(n[t.names[s]])}else i.push(n[t.name]);return r.apply(null,i)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||a,s=t.innerOrder||c,r=[];return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(o(t,n,e))}))}))})),e.media.forEach((function(e){r.push(o("m",i.m[0],e)),s.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(o(t,n,e))}))}))}))})),r.join("\r\n")+"\r\n"}},7917:(e,t,n)=>{"use strict";n.d(t,{Ms:()=>v,vU:()=>p});var i=n(7827),s=n(9351),r=n(2047),o=n(18),a=n(3414);function c(){}var l=u("C",void 0,void 0);function u(e,t,n){return{kind:e,value:t,error:n}}var d=n(6950),h=n(6634),p=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,(0,r.Uv)(t)&&t.add(n)):n.destination=w,n}return(0,i.C6)(t,e),t.create=function(e,t,n){return new v(e,t,n)},t.prototype.next=function(e){this.isStopped?y(function(e){return u("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?y(u("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?y(l,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(r.yU),f=Function.prototype.bind;function m(e,t){return f.call(e,t)}var g=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){b(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){b(n)}else b(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){b(t)}},e}(),v=function(e){function t(t,n,i){var r,a,c=e.call(this)||this;(0,s.T)(t)||!t?r={next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==i&&void 0!==i?i:void 0}:c&&o.$.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return c.unsubscribe()},r={next:t.next&&m(t.next,a),error:t.error&&m(t.error,a),complete:t.complete&&m(t.complete,a)}):r=t;return c.destination=new g(r),c}return(0,i.C6)(t,e),t}(p);function b(e){o.$.useDeprecatedSynchronousErrorHandling?(0,h.l)(e):(0,a.m)(e)}function y(e,t){var n=o.$.onStoppedNotification;n&&d.f.setTimeout((function(){return n(e,t)}))}var w={closed:!0,next:c,error:function(e){throw e},complete:c}},7946:function(e,t,n){var i;!function(s,r){"use strict";var o="function",a="undefined",c="object",l="string",u="major",d="model",h="name",p="type",f="vendor",m="version",g="architecture",v="console",b="mobile",y="tablet",w="smarttv",S="wearable",T="embedded",C="Amazon",k="Apple",E="ASUS",_="BlackBerry",R="Browser",I="Chrome",A="Firefox",P="Google",x="Huawei",O="LG",N="Microsoft",D="Motorola",j="Opera",L="Samsung",U="Sharp",F="Sony",M="Xiaomi",V="Zebra",B="Facebook",H="Chromium OS",q="Mac OS",W=" Browser",$=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},J=function(e,t){return typeof e===l&&-1!==z(t).indexOf(z(e))},z=function(e){return e.toLowerCase()},G=function(e,t){if(typeof e===l)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},K=function(e,t){for(var n,i,s,a,l,u,d=0;d<t.length&&!l;){var h=t[d],p=t[d+1];for(n=i=0;n<h.length&&!l&&h[n];)if(l=h[n++].exec(e))for(s=0;s<p.length;s++)u=l[++i],typeof(a=p[s])===c&&a.length>0?2===a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,u):this[a[0]]=a[1]:3===a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=u?u.replace(a[1],a[2]):r:this[a[0]]=u?a[1].call(this,u,a[2]):r:4===a.length&&(this[a[0]]=u?a[3].call(this,u.replace(a[1],a[2])):r):this[a]=u||r;d+=2}},Y=function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(J(t[n][i],e))return"?"===n?r:n}else if(J(t[n],e))return"?"===n?r:n;return t.hasOwnProperty("*")?t["*"]:e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,m],[/opios[\/ ]+([\w\.]+)/i],[m,[h,j+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[m,[h,j+" GX"]],[/\bopr\/([\w\.]+)/i],[m,[h,j]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[h,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[m,[h,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,m],[/quark(?:pc)?\/([-\w\.]+)/i],[m,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[m,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[h,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[h,"Smart Lenovo "+R]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+R],m],[/\bfocus\/([\w\.]+)/i],[m,[h,A+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[h,j+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[h,j+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[h,"MIUI"+W]],[/fxios\/([\w\.-]+)/i],[m,[h,A]],[/\bqihoobrowser\/?([\w\.]*)/i],[m,[h,"360"]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],m],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+W],m],[/samsungbrowser\/([\w\.]+)/i],[m,[h,L+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[m,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[h,m],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[h],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[m,h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,B],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[h,I+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,I+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[h,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[m,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],m],[/(wolvic|librewolf)\/([\w\.]+)/i],[h,m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[h,A+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,[m,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,z]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,L],[p,y]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,L],[p,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,k],[p,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,k],[p,y]],[/(macintosh);/i],[d,[f,k]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,U],[p,b]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[f,"Honor"],[p,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,x],[p,y]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,x],[p,b]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[f,M],[p,b]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,M],[p,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[p,b]],[/\b(opd2\d{3}a?) bui/i],[d,[f,"OPPO"],[p,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[p,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[p,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,D],[p,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,D],[p,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,O],[p,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,O],[p,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[p,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[p,b]],[/(pixel c)\b/i],[d,[f,P],[p,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,P],[p,b]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,F],[p,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,F],[p,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[p,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,C],[p,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,C],[p,b]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[p,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,_],[p,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,E],[p,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,E],[p,b]],[/(nexus 9)/i],[d,[f,"HTC"],[p,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[p,b]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[f,"TCL"],[p,y]],[/(itel) ((\w+))/i],[[f,z],d,[p,Y,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[p,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[p,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[p,b]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[f,"Energizer"],[p,b]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[f,"Cat"],[p,b]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[f,"Smartfren"],[p,b]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[f,"Nothing"],[p,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[p,b]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[p,y]],[/(surface duo)/i],[d,[f,N],[p,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[p,b]],[/(u304aa)/i],[d,[f,"AT&T"],[p,b]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[p,b]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[p,y]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[p,y]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[p,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[p,y]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[p,y]],[/\b(k88) b/i],[d,[f,"ZTE"],[p,y]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[p,b]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[p,b]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[p,y]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[p,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[p,y]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[p,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[p,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[p,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[p,b]],[/\b(ph-1) /i],[d,[f,"Essential"],[p,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[p,y]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[p,y]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[p,y]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[p,y]],[/(sprint) (\w+)/i],[f,d,[p,b]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,N],[p,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,V],[p,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,V],[p,b]],[/smart-tv.+(samsung)/i],[f,[p,w]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,L],[p,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,O],[p,w]],[/(apple) ?tv/i],[f,[d,k+" TV"],[p,w]],[/crkey/i],[[d,I+"cast"],[f,P],[p,w]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,C],[p,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,U],[p,w]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,F],[p,w]],[/(mitv-\w{5}) bui/i],[d,[f,M],[p,w]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[p,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,G],[d,G],[p,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[p,v]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[p,v]],[/(playstation [345portablevi]+)/i],[d,[f,F],[p,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,N],[p,v]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[f,L],[p,S]],[/((pebble))app/i],[f,d,[p,S]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,k],[p,S]],[/droid.+; (glass) \d/i],[d,[f,P],[p,S]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,V],[p,S]],[/droid.+; (glass) \d/i],[d,[f,P],[p,S]],[/(pico) (4|neo3(?: link|pro)?)/i],[f,d,[p,S]],[/; (quest( \d| pro)?)/i],[d,[f,B],[p,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[p,T]],[/(aeobc)\b/i],[d,[f,C],[p,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[p,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[p,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[p,b]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[h,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[h,m],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[m,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,Y,X],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,q],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,m],[/\(bb(10);/i],[m,[h,_]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[h,A+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[h,I+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,H],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,m],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,m]]},Q=function(e,t){if(typeof e===c&&(t=e,e=r),!(this instanceof Q))return new Q(e,t).getResult();var n=typeof s!==a&&s.navigator?s.navigator:r,i=e||(n&&n.userAgent?n.userAgent:""),v=n&&n.userAgentData?n.userAgentData:r,w=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2===0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}(Z,t):Z,S=n&&n.userAgent==i;return this.getBrowser=function(){var e,t={};return t[h]=r,t[m]=r,K.call(t,i,w.browser),t[u]=typeof(e=t[m])===l?e.replace(/[^\d\.]/g,"").split(".")[0]:r,S&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[g]=r,K.call(e,i,w.cpu),e},this.getDevice=function(){var e={};return e[f]=r,e[d]=r,e[p]=r,K.call(e,i,w.device),S&&!e[p]&&v&&v.mobile&&(e[p]=b),S&&"Macintosh"==e[d]&&n&&typeof n.standalone!==a&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[p]=y),e},this.getEngine=function(){var e={};return e[h]=r,e[m]=r,K.call(e,i,w.engine),e},this.getOS=function(){var e={};return e[h]=r,e[m]=r,K.call(e,i,w.os),S&&!e[h]&&v&&v.platform&&"Unknown"!=v.platform&&(e[h]=v.platform.replace(/chrome os/i,H).replace(/macos/i,q)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===l&&e.length>500?G(e,500):e,this},this.setUA(i),this};Q.VERSION="1.0.40",Q.BROWSER=$([h,m,u]),Q.CPU=$([g]),Q.DEVICE=$([d,f,p,v,b,w,y,S,T]),Q.ENGINE=Q.OS=$([h,m]),typeof t!==a?(e.exports&&(t=e.exports=Q),t.UAParser=Q):n.amdO?(i=function(){return Q}.call(t,n,t,e))===r||(e.exports=i):typeof s!==a&&(s.UAParser=Q);var ee=typeof s!==a&&(s.jQuery||s.Zepto);if(ee&&!ee.ua){var te=new Q;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var n in t)ee.ua[n]=t[n]}}}("object"===typeof window?window:this)},8041:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var i="function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},8117:(e,t,n)=>{"use strict";function i(e){return e}n.d(t,{D:()=>i})},8165:(e,t,n)=>{"use strict";n.d(t,{H:()=>S});var i=n(1998),s=n(937),r=n(1190),o=n(8344);function a(e,t){return void 0===t&&(t=0),(0,r.N)((function(n,i){n.subscribe((0,o._)(i,(function(n){return(0,s.N)(i,e,(function(){return i.next(n)}),t)}),(function(){return(0,s.N)(i,e,(function(){return i.complete()}),t)}),(function(n){return(0,s.N)(i,e,(function(){return i.error(n)}),t)})))}))}function c(e,t){return void 0===t&&(t=0),(0,r.N)((function(n,i){i.add(e.schedule((function(){return n.subscribe(i)}),t))}))}var l=n(5868);var u=n(8041),d=n(9351);function h(e,t){if(!e)throw new Error("Iterable cannot be null");return new l.c((function(n){(0,s.N)(n,t,(function(){var i=e[Symbol.asyncIterator]();(0,s.N)(n,t,(function(){i.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}var p=n(3983),f=n(3554),m=n(5505),g=n(5637),v=n(1633),b=n(7391),y=n(9788);function w(e,t){if(null!=e){if((0,p.l)(e))return function(e,t){return(0,i.Tg)(e).pipe(c(t),a(t))}(e,t);if((0,m.X)(e))return function(e,t){return new l.c((function(n){var i=0;return t.schedule((function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())}))}))}(e,t);if((0,f.y)(e))return function(e,t){return(0,i.Tg)(e).pipe(c(t),a(t))}(e,t);if((0,v.T)(e))return h(e,t);if((0,g.x)(e))return function(e,t){return new l.c((function(n){var i;return(0,s.N)(n,t,(function(){i=e[u.l](),(0,s.N)(n,t,(function(){var e,t,s;try{t=(e=i.next()).value,s=e.done}catch(r){return void n.error(r)}s?n.complete():n.next(t)}),0,!0)})),function(){return(0,d.T)(null===i||void 0===i?void 0:i.return)&&i.return()}}))}(e,t);if((0,y.U)(e))return function(e,t){return h((0,y.C)(e),t)}(e,t)}throw(0,b.L)(e)}function S(e,t){return t?w(e,t):(0,i.Tg)(e)}},8344:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var i=n(7827);function s(e,t,n,i,s){return new r(e,t,n,i,s)}var r=function(e){function t(t,n,i,s,r,o){var a=e.call(this,t)||this;return a.onFinalize=r,a.shouldUnsubscribe=o,a._next=n?function(e){try{n(e)}catch(i){t.error(i)}}:e.prototype._next,a._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,i.C6)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(n(7917).vU)},8614:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(8587),s=n(8168),r=n(9950),o=n(2004),a=n(8465),c=n(3372),l=n(9254),u=n(8463),d=n(1763),h=n(423);function p(e){return(0,h.Ay)("MuiListItemAvatar",e)}(0,d.A)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var f=n(4414);const m=["className"],g=(0,l.Ay)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})((e=>{let{ownerState:t}=e;return(0,s.A)({minWidth:56,flexShrink:0},"flex-start"===t.alignItems&&{marginTop:8})})),v=r.forwardRef((function(e,t){const n=(0,u.b)({props:e,name:"MuiListItemAvatar"}),{className:l}=n,d=(0,i.A)(n,m),h=r.useContext(c.A),v=(0,s.A)({},n,{alignItems:h.alignItems}),b=(e=>{const{alignItems:t,classes:n}=e,i={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,a.A)(i,p,n)})(v);return(0,f.jsx)(g,(0,s.A)({className:(0,o.A)(b.root,l),ownerState:v,ref:t},d))}))},9317:(e,t,n)=>{"use strict";n.d(t,{fSl:()=>jn,ncL:()=>Xt,xwR:()=>Ln,Mf9:()=>Fn});var i=n(9379),s=n(45),r=n(7493),o=n(6932),a=n(4414),c=n(9950),l=n.t(c,2);function u(){return"undefined"!==typeof window}function d(e){return f(e)?(e.nodeName||"").toLowerCase():"#document"}function h(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function p(e){var t;return null==(t=(f(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function f(e){return!!u()&&(e instanceof Node||e instanceof h(e).Node)}function m(e){return!!u()&&(e instanceof Element||e instanceof h(e).Element)}function g(e){return!!u()&&(e instanceof HTMLElement||e instanceof h(e).HTMLElement)}function v(e){return!(!u()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof h(e).ShadowRoot)}function b(e){const{overflow:t,overflowX:n,overflowY:i,display:s}=k(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(s)}function y(e){return["table","td","th"].includes(d(e))}function w(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(n){return!1}}))}function S(e){const t=T(),n=m(e)?k(e):e;return["transform","translate","scale","rotate","perspective"].some((e=>!!n[e]&&"none"!==n[e]))||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","translate","scale","rotate","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function T(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function C(e){return["html","body","#document"].includes(d(e))}function k(e){return h(e).getComputedStyle(e)}function E(e){return m(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function _(e){if("html"===d(e))return e;const t=e.assignedSlot||e.parentNode||v(e)&&e.host||p(e);return v(t)?t.host:t}function R(e){const t=_(e);return C(t)?e.ownerDocument?e.ownerDocument.body:e.body:g(t)&&b(t)?t:R(t)}function I(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const s=R(e),r=s===(null==(i=e.ownerDocument)?void 0:i.body),o=h(s);if(r){const e=A(o);return t.concat(o,o.visualViewport||[],b(s)?s:[],e&&n?I(e):[])}return t.concat(s,I(s,[],n))}function A(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}var P=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],x=P.join(","),O="undefined"===typeof Element,N=O?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,D=!O&&Element.prototype.getRootNode?function(e){var t;return null===e||void 0===e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null===e||void 0===e?void 0:e.ownerDocument},j=function e(t,n){var i;void 0===n&&(n=!0);var s=null===t||void 0===t||null===(i=t.getAttribute)||void 0===i?void 0:i.call(t,"inert");return""===s||"true"===s||n&&t&&e(t.parentNode)},L=function(e,t,n){if(j(e))return[];var i=Array.prototype.slice.apply(e.querySelectorAll(x));return t&&N.call(e,x)&&i.unshift(e),i=i.filter(n)},U=function e(t,n,i){for(var s=[],r=Array.from(t);r.length;){var o=r.shift();if(!j(o,!1))if("SLOT"===o.tagName){var a=o.assignedElements(),c=e(a.length?a:o.children,!0,i);i.flatten?s.push.apply(s,c):s.push({scopeParent:o,candidates:c})}else{N.call(o,x)&&i.filter(o)&&(n||!t.includes(o))&&s.push(o);var l=o.shadowRoot||"function"===typeof i.getShadowRoot&&i.getShadowRoot(o),u=!j(l,!1)&&(!i.shadowRootFilter||i.shadowRootFilter(o));if(l&&u){var d=e(!0===l?o.children:l.children,!0,i);i.flatten?s.push.apply(s,d):s.push({scopeParent:o,candidates:d})}else r.unshift.apply(r,o.children)}}return s},F=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},M=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null===e||void 0===e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!F(e)?0:e.tabIndex},V=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},B=function(e){return"INPUT"===e.tagName},H=function(e){return function(e){return B(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||D(e),i=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!==typeof window&&"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)t=i(window.CSS.escape(e.name));else try{t=i(e.name)}catch(r){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",r.message),!1}var s=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!s||s===e}(e)},q=function(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return 0===n&&0===i},W=function(e,t){var n=t.displayCheck,i=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var s=N.call(e,"details>summary:first-of-type")?e.parentElement:e;if(N.call(s,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return q(e)}else{if("function"===typeof i){for(var r=e;e;){var o=e.parentElement,a=D(e);if(o&&!o.shadowRoot&&!0===i(o))return q(e);e=e.assignedSlot?e.assignedSlot:o||a===e.ownerDocument?o:a.host}e=r}if(function(e){var t,n,i,s,r=e&&D(e),o=null===(t=r)||void 0===t?void 0:t.host,a=!1;if(r&&r!==e)for(a=!!(null!==(n=o)&&void 0!==n&&null!==(i=n.ownerDocument)&&void 0!==i&&i.contains(o)||null!==e&&void 0!==e&&null!==(s=e.ownerDocument)&&void 0!==s&&s.contains(e));!a&&o;){var c,l,u;a=!(null===(l=o=null===(c=r=D(o))||void 0===c?void 0:c.host)||void 0===l||null===(u=l.ownerDocument)||void 0===u||!u.contains(o))}return a}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1},$=function(e,t){return!(t.disabled||j(t)||function(e){return B(e)&&"hidden"===e.type}(t)||W(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var i=t.children.item(n);if("LEGEND"===i.tagName)return!!N.call(t,"fieldset[disabled] *")||!i.contains(e)}return!0}t=t.parentElement}return!1}(t))},J=function(e,t){return!(H(t)||M(t)<0||!$(e,t))},z=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},G=function e(t){var n=[],i=[];return t.forEach((function(t,s){var r=!!t.scopeParent,o=r?t.scopeParent:t,a=function(e,t){var n=M(e);return n<0&&t&&!F(e)?0:n}(o,r),c=r?e(t.candidates):o;0===a?r?n.push.apply(n,c):n.push(o):i.push({documentOrder:s,tabIndex:a,item:t,isScope:r,content:c})})),i.sort(V).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},K=function(e,t){var n;return n=(t=t||{}).getShadowRoot?U([e],t.includeContainer,{filter:J.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:z}):L(e,t.includeContainer,J.bind(null,t)),G(n)};function Y(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function X(e){return(null==e?void 0:e.ownerDocument)||document}var Z="undefined"!==typeof document?c.useLayoutEffect:c.useEffect;const Q=(0,i.A)({},l).useInsertionEffect||(e=>e());const ee=()=>({getShadowRoot:!0,displayCheck:"function"===typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function te(e,t){const n=K(e,ee()),i=n.length;if(0===i)return;const s=function(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement);){var n;t=t.shadowRoot.activeElement}return t}(X(e)),r=n.indexOf(s);return n[-1===r?1===t?0:i-1:r+t]}function ne(e,t){const n=t||e.currentTarget,i=e.relatedTarget;return!i||!function(e,t){if(!e||!t)return!1;const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&v(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}(n,i)}function ie(e){K(e,ee()).forEach((e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}))}function se(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}var re=n(7119);const oe=Math.min,ae=Math.max,ce=Math.round,le=Math.floor,ue=e=>({x:e,y:e}),de={left:"right",right:"left",bottom:"top",top:"bottom"},he={start:"end",end:"start"};function pe(e,t,n){return ae(e,oe(t,n))}function fe(e,t){return"function"===typeof e?e(t):e}function me(e){return e.split("-")[0]}function ge(e){return e.split("-")[1]}function ve(e){return"x"===e?"y":"x"}function be(e){return"y"===e?"height":"width"}function ye(e){return["top","bottom"].includes(me(e))?"y":"x"}function we(e){return ve(ye(e))}function Se(e){return e.replace(/start|end/g,(e=>he[e]))}function Te(e){return e.replace(/left|right|bottom|top/g,(e=>de[e]))}function Ce(e){return"number"!==typeof e?function(e){return(0,i.A)({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function ke(e){const{x:t,y:n,width:i,height:s}=e;return{width:i,height:s,top:n,left:t,right:t+i,bottom:n+s,x:t,y:n}}const Ee=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],_e=["mainAxis","crossAxis","limiter"],Re=["apply"];function Ie(e,t,n){let{reference:i,floating:s}=e;const r=ye(t),o=we(t),a=be(o),c=me(t),l="y"===r,u=i.x+i.width/2-s.width/2,d=i.y+i.height/2-s.height/2,h=i[a]/2-s[a]/2;let p;switch(c){case"top":p={x:u,y:i.y-s.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:d};break;case"left":p={x:i.x-s.width,y:d};break;default:p={x:i.x,y:i.y}}switch(ge(t)){case"start":p[o]-=h*(n&&l?-1:1);break;case"end":p[o]+=h*(n&&l?-1:1)}return p}async function Ae(e,t){var n;void 0===t&&(t={});const{x:i,y:s,platform:r,rects:o,elements:a,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=fe(t,e),f=Ce(p),m=a[h?"floating"===d?"reference":"floating":d],g=ke(await r.getClippingRect({element:null==(n=await(null==r.isElement?void 0:r.isElement(m)))||n?m:m.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(a.floating)),boundary:l,rootBoundary:u,strategy:c})),v="floating"===d?{x:i,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(null==r.getOffsetParent?void 0:r.getOffsetParent(a.floating)),y=await(null==r.isElement?void 0:r.isElement(b))&&await(null==r.getScale?void 0:r.getScale(b))||{x:1,y:1},w=ke(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:b,strategy:c}):v);return{top:(g.top-w.top+f.top)/y.y,bottom:(w.bottom-g.bottom+f.bottom)/y.y,left:(g.left-w.left+f.left)/y.x,right:(w.right-g.right+f.right)/y.x}}function Pe(e){const t=k(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const s=g(e),r=s?e.offsetWidth:n,o=s?e.offsetHeight:i,a=ce(n)!==r||ce(i)!==o;return a&&(n=r,i=o),{width:n,height:i,$:a}}function xe(e){return m(e)?e:e.contextElement}function Oe(e){const t=xe(e);if(!g(t))return ue(1);const n=t.getBoundingClientRect(),{width:i,height:s,$:r}=Pe(t);let o=(r?ce(n.width):n.width)/i,a=(r?ce(n.height):n.height)/s;return o&&Number.isFinite(o)||(o=1),a&&Number.isFinite(a)||(a=1),{x:o,y:a}}const Ne=ue(0);function De(e){const t=h(e);return T()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Ne}function je(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const s=e.getBoundingClientRect(),r=xe(e);let o=ue(1);t&&(i?m(i)&&(o=Oe(i)):o=Oe(e));const a=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==h(e))&&t}(r,n,i)?De(r):ue(0);let c=(s.left+a.x)/o.x,l=(s.top+a.y)/o.y,u=s.width/o.x,d=s.height/o.y;if(r){const e=h(r),t=i&&m(i)?h(i):i;let n=e,s=A(n);for(;s&&i&&t!==n;){const e=Oe(s),t=s.getBoundingClientRect(),i=k(s),r=t.left+(s.clientLeft+parseFloat(i.paddingLeft))*e.x,o=t.top+(s.clientTop+parseFloat(i.paddingTop))*e.y;c*=e.x,l*=e.y,u*=e.x,d*=e.y,c+=r,l+=o,n=h(s),s=A(n)}}return ke({width:u,height:d,x:c,y:l})}function Le(e,t){const n=E(e).scrollLeft;return t?t.left+n:je(p(e)).left+n}function Ue(e,t,n){void 0===n&&(n=!1);const i=e.getBoundingClientRect();return{x:i.left+t.scrollLeft-(n?0:Le(e,i)),y:i.top+t.scrollTop}}function Fe(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=h(e),i=p(e),s=n.visualViewport;let r=i.clientWidth,o=i.clientHeight,a=0,c=0;if(s){r=s.width,o=s.height;const e=T();(!e||e&&"fixed"===t)&&(a=s.offsetLeft,c=s.offsetTop)}return{width:r,height:o,x:a,y:c}}(e,n);else if("document"===t)i=function(e){const t=p(e),n=E(e),i=e.ownerDocument.body,s=ae(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),r=ae(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-n.scrollLeft+Le(e);const a=-n.scrollTop;return"rtl"===k(i).direction&&(o+=ae(t.clientWidth,i.clientWidth)-s),{width:s,height:r,x:o,y:a}}(p(e));else if(m(t))i=function(e,t){const n=je(e,!0,"fixed"===t),i=n.top+e.clientTop,s=n.left+e.clientLeft,r=g(e)?Oe(e):ue(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:s*r.x,y:i*r.y}}(t,n);else{const n=De(e);i={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return ke(i)}function Me(e,t){const n=_(e);return!(n===t||!m(n)||C(n))&&("fixed"===k(n).position||Me(n,t))}function Ve(e,t,n){const i=g(t),s=p(t),r="fixed"===n,o=je(e,!0,r,t);let a={scrollLeft:0,scrollTop:0};const c=ue(0);function l(){c.x=Le(s)}if(i||!i&&!r)if(("body"!==d(t)||b(s))&&(a=E(t)),i){const e=je(t,!0,r,t);c.x=e.x+t.clientLeft,c.y=e.y+t.clientTop}else s&&l();r&&!i&&s&&l();const u=!s||i||r?ue(0):Ue(s,a);return{x:o.left+a.scrollLeft-c.x-u.x,y:o.top+a.scrollTop-c.y-u.y,width:o.width,height:o.height}}function Be(e){return"static"===k(e).position}function He(e,t){if(!g(e)||"fixed"===k(e).position)return null;if(t)return t(e);let n=e.offsetParent;return p(e)===n&&(n=n.ownerDocument.body),n}function qe(e,t){const n=h(e);if(w(e))return n;if(!g(e)){let t=_(e);for(;t&&!C(t);){if(m(t)&&!Be(t))return t;t=_(t)}return n}let i=He(e,t);for(;i&&y(i)&&Be(i);)i=He(i,t);return i&&C(i)&&Be(i)&&!S(i)?n:i||function(e){let t=_(e);for(;g(t)&&!C(t);){if(S(t))return t;if(w(t))return null;t=_(t)}return null}(e)||n}const We={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:s}=e;const r="fixed"===s,o=p(i),a=!!t&&w(t.floating);if(i===o||a&&r)return n;let c={scrollLeft:0,scrollTop:0},l=ue(1);const u=ue(0),h=g(i);if((h||!h&&!r)&&(("body"!==d(i)||b(o))&&(c=E(i)),g(i))){const e=je(i);l=Oe(i),u.x=e.x+i.clientLeft,u.y=e.y+i.clientTop}const f=!o||h||r?ue(0):Ue(o,c,!0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x+f.x,y:n.y*l.y-c.scrollTop*l.y+u.y+f.y}},getDocumentElement:p,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:s}=e;const r=[..."clippingAncestors"===n?w(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let i=I(e,[],!1).filter((e=>m(e)&&"body"!==d(e))),s=null;const r="fixed"===k(e).position;let o=r?_(e):e;for(;m(o)&&!C(o);){const t=k(o),n=S(o);n||"fixed"!==t.position||(s=null),(r?!n&&!s:!n&&"static"===t.position&&s&&["absolute","fixed"].includes(s.position)||b(o)&&!n&&Me(e,o))?i=i.filter((e=>e!==o)):s=t,o=_(o)}return t.set(e,i),i}(t,this._c):[].concat(n),i],o=r[0],a=r.reduce(((e,n)=>{const i=Fe(t,n,s);return e.top=ae(i.top,e.top),e.right=oe(i.right,e.right),e.bottom=oe(i.bottom,e.bottom),e.left=ae(i.left,e.left),e}),Fe(t,o,s));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:qe,getElementRects:async function(e){const t=this.getOffsetParent||qe,n=this.getDimensions,i=await n(e.floating);return{reference:Ve(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Pe(e);return{width:t,height:n}},getScale:Oe,isElement:m,isRTL:function(e){return"rtl"===k(e).direction}};function $e(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Je(e,t,n,s){void 0===s&&(s={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:a="function"===typeof ResizeObserver,layoutShift:c="function"===typeof IntersectionObserver,animationFrame:l=!1}=s,u=xe(e),d=r||o?[...u?I(u):[],...I(t)]:[];d.forEach((e=>{r&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)}));const h=u&&c?function(e,t){let n,s=null;const r=p(e);function o(){var e;clearTimeout(n),null==(e=s)||e.disconnect(),s=null}return function a(c,l){void 0===c&&(c=!1),void 0===l&&(l=1),o();const u=e.getBoundingClientRect(),{left:d,top:h,width:p,height:f}=u;if(c||t(),!p||!f)return;const m={rootMargin:-le(h)+"px "+-le(r.clientWidth-(d+p))+"px "+-le(r.clientHeight-(h+f))+"px "+-le(d)+"px",threshold:ae(0,oe(1,l))||1};let g=!0;function v(t){const i=t[0].intersectionRatio;if(i!==l){if(!g)return a();i?a(!1,i):n=setTimeout((()=>{a(!1,1e-7)}),1e3)}1!==i||$e(u,e.getBoundingClientRect())||a(),g=!1}try{s=new IntersectionObserver(v,(0,i.A)((0,i.A)({},m),{},{root:r.ownerDocument}))}catch(b){s=new IntersectionObserver(v,m)}s.observe(e)}(!0),o}(u,n):null;let f,m=-1,g=null;a&&(g=new ResizeObserver((e=>{let[i]=e;i&&i.target===u&&g&&(g.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame((()=>{var e;null==(e=g)||e.observe(t)}))),n()})),u&&!l&&g.observe(u),g.observe(t));let v=l?je(e):null;return l&&function t(){const i=je(e);v&&!$e(v,i)&&n();v=i,f=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach((e=>{r&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)})),null==h||h(),null==(e=g)||e.disconnect(),g=null,l&&cancelAnimationFrame(f)}}const ze=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,s;const{x:r,y:o,placement:a,middlewareData:c}=t,l=await async function(e,t){const{placement:n,platform:i,elements:s}=e,r=await(null==i.isRTL?void 0:i.isRTL(s.floating)),o=me(n),a=ge(n),c="y"===ye(n),l=["left","top"].includes(o)?-1:1,u=r&&c?-1:1,d=fe(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"===typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&"number"===typeof f&&(p="end"===a?-1*f:f),c?{x:p*u,y:h*l}:{x:h*l,y:p*u}}(t,e);return a===(null==(n=c.offset)?void 0:n.placement)&&null!=(s=c.arrow)&&s.alignmentOffset?{}:{x:r+l.x,y:o+l.y,data:(0,i.A)((0,i.A)({},l),{},{placement:a})}}}},Ge=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,a=fe(e,t),{mainAxis:c=!0,crossAxis:l=!1,limiter:u={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}}}=a,d=(0,s.A)(a,_e),h={x:n,y:r},p=await Ae(t,d),f=ye(me(o)),m=ve(f);let g=h[m],v=h[f];if(c){const e="y"===m?"bottom":"right";g=pe(g+p["y"===m?"top":"left"],g,g-p[e])}if(l){const e="y"===f?"bottom":"right";v=pe(v+p["y"===f?"top":"left"],v,v-p[e])}const b=u.fn((0,i.A)((0,i.A)({},t),{},{[m]:g,[f]:v}));return(0,i.A)((0,i.A)({},b),{},{data:{x:b.x-n,y:b.y-r,enabled:{[m]:c,[f]:l}}})}}},Ke=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:o,rects:a,initialPlacement:c,platform:l,elements:u}=t,d=fe(e,t),{mainAxis:h=!0,crossAxis:p=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0}=d,b=(0,s.A)(d,Ee);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const y=me(r),w=ye(c),S=me(c)===c,T=await(null==l.isRTL?void 0:l.isRTL(u.floating)),C=f||(S||!v?[Te(c)]:function(e){const t=Te(e);return[Se(e),t,Se(t)]}(c)),k="none"!==g;!f&&k&&C.push(...function(e,t,n,i){const s=ge(e);let r=function(e,t,n){const i=["left","right"],s=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:i:t?i:s;case"left":case"right":return t?r:o;default:return[]}}(me(e),"start"===n,i);return s&&(r=r.map((e=>e+"-"+s)),t&&(r=r.concat(r.map(Se)))),r}(c,v,g,T));const E=[c,...C],_=await Ae(t,b),R=[];let I=(null==(i=o.flip)?void 0:i.overflows)||[];if(h&&R.push(_[y]),p){const e=function(e,t,n){void 0===n&&(n=!1);const i=ge(e),s=we(e),r=be(s);let o="x"===s?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=Te(o)),[o,Te(o)]}(r,a,T);R.push(_[e[0]],_[e[1]])}if(I=[...I,{placement:r,overflows:R}],!R.every((e=>e<=0))){var A,P;const e=((null==(A=o.flip)?void 0:A.index)||0)+1,t=E[e];if(t){var x;const n="alignment"===p&&w!==ye(t),i=(null==(x=I[0])?void 0:x.overflows[0])>0;if(!n||i)return{data:{index:e,overflows:I},reset:{placement:t}}}let n=null==(P=I.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:P.placement;if(!n)switch(m){case"bestFit":{var O;const e=null==(O=I.filter((e=>{if(k){const t=ye(e.placement);return t===w||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:O[0];e&&(n=e);break}case"initialPlacement":n=c}if(r!==n)return{reset:{placement:n}}}return{}}}},Ye=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:a,platform:c,elements:l}=t,u=fe(e,t),{apply:d=()=>{}}=u,h=(0,s.A)(u,Re),p=await Ae(t,h),f=me(o),m=ge(o),g="y"===ye(o),{width:v,height:b}=a.floating;let y,w;"top"===f||"bottom"===f?(y=f,w=m===(await(null==c.isRTL?void 0:c.isRTL(l.floating))?"start":"end")?"left":"right"):(w=f,y="end"===m?"top":"bottom");const S=b-p.top-p.bottom,T=v-p.left-p.right,C=oe(b-p[y],S),k=oe(v-p[w],T),E=!t.middlewareData.shift;let _=C,R=k;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(R=T),null!=(r=t.middlewareData.shift)&&r.enabled.y&&(_=S),E&&!m){const e=ae(p.left,0),t=ae(p.right,0),n=ae(p.top,0),i=ae(p.bottom,0);g?R=v-2*(0!==e||0!==t?e+t:ae(p.left,p.right)):_=b-2*(0!==n||0!==i?n+i:ae(p.top,p.bottom))}await d((0,i.A)((0,i.A)({},t),{},{availableWidth:R,availableHeight:_}));const I=await c.getDimensions(l.floating);return v!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}},Xe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:s,placement:r,rects:o,platform:a,elements:c,middlewareData:l}=t,{element:u,padding:d=0}=fe(e,t)||{};if(null==u)return{};const h=Ce(d),p={x:n,y:s},f=we(r),m=be(f),g=await a.getDimensions(u),v="y"===f,b=v?"top":"left",y=v?"bottom":"right",w=v?"clientHeight":"clientWidth",S=o.reference[m]+o.reference[f]-p[f]-o.floating[m],T=p[f]-o.reference[f],C=await(null==a.getOffsetParent?void 0:a.getOffsetParent(u));let k=C?C[w]:0;k&&await(null==a.isElement?void 0:a.isElement(C))||(k=c.floating[w]||o.floating[m]);const E=S/2-T/2,_=k/2-g[m]/2-1,R=oe(h[b],_),I=oe(h[y],_),A=R,P=k-g[m]-I,x=k/2-g[m]/2+E,O=pe(A,x,P),N=!l.arrow&&null!=ge(r)&&x!==O&&o.reference[m]/2-(x<A?R:I)-g[m]/2<0,D=N?x<A?x-A:x-P:0;return{[f]:p[f]+D,data:(0,i.A)({[f]:O,centerOffset:x-O-D},N&&{alignmentOffset:D}),reset:N}}}),Ze=(e,t,n)=>{const s=new Map,r=(0,i.A)({platform:We},n),o=(0,i.A)((0,i.A)({},r.platform),{},{_c:s});return(async(e,t,n)=>{const{placement:s="bottom",strategy:r="absolute",middleware:o=[],platform:a}=n,c=o.filter(Boolean),l=await(null==a.isRTL?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:r}),{x:d,y:h}=Ie(u,s,l),p=s,f={},m=0;for(let g=0;g<c.length;g++){const{name:n,fn:o}=c[g],{x:v,y:b,data:y,reset:w}=await o({x:d,y:h,initialPlacement:s,placement:p,strategy:r,middlewareData:f,rects:u,platform:a,elements:{reference:e,floating:t}});d=null!=v?v:d,h=null!=b?b:h,f=(0,i.A)((0,i.A)({},f),{},{[n]:(0,i.A)((0,i.A)({},f[n]),y)}),w&&m<=50&&(m++,"object"===typeof w&&(w.placement&&(p=w.placement),w.rects&&(u=!0===w.rects?await a.getElementRects({reference:e,floating:t,strategy:r}):w.rects),({x:d,y:h}=Ie(u,p,l))),g=-1)}return{x:d,y:h,placement:p,strategy:r,middlewareData:f}})(e,t,(0,i.A)((0,i.A)({},r),{},{platform:o}))};var Qe="undefined"!==typeof document?c.useLayoutEffect:c.useEffect;function et(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,i,s;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;0!==i--;)if(!et(e[i],t[i]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;0!==i--;)if(!{}.hasOwnProperty.call(t,s[i]))return!1;for(i=n;0!==i--;){const n=s[i];if(("_owner"!==n||!e.$$typeof)&&!et(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function tt(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function nt(e,t){const n=tt(e);return Math.round(t*n)/n}function it(e){const t=c.useRef(e);return Qe((()=>{t.current=e})),t}const st=(e,t)=>(0,i.A)((0,i.A)({},Ge(e)),{},{options:[e,t]}),rt=(e,t)=>(0,i.A)((0,i.A)({},Ke(e)),{},{options:[e,t]}),ot=(e,t)=>(0,i.A)((0,i.A)({},Ye(e)),{},{options:[e,t]}),at=(e,t)=>(0,i.A)((0,i.A)({},(e=>({name:"arrow",options:e,fn(t){const{element:n,padding:i}="function"===typeof e?e(t):e;return n&&(s=n,{}.hasOwnProperty.call(s,"current"))?null!=n.current?Xe({element:n.current,padding:i}).fn(t):{}:n?Xe({element:n,padding:i}).fn(t):{};var s}}))(e)),{},{options:[e,t]}),ct=["transform"],lt=["context","width","height","tipRadius","strokeWidth","staticOffset","stroke","d","style"],ut=["lockScroll"];const dt="ArrowLeft",ht="ArrowRight",pt="ArrowUp",ft="ArrowDown";const mt=[dt,ht],gt=[pt,ft],vt=(0,i.A)({},l);let bt=!1,yt=0;const wt=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+yt++;const St=vt.useId||function(){const[e,t]=c.useState((()=>bt?wt():void 0));return Z((()=>{null==e&&t(wt())}),[]),c.useEffect((()=>{bt=!0}),[]),e};const Tt=c.forwardRef((function(e,t){const{context:{placement:n,elements:{floating:r},middlewareData:{arrow:o,shift:l}},width:u=14,height:d=7,tipRadius:h=0,strokeWidth:p=0,staticOffset:f,stroke:m,d:g,style:{transform:v}={}}=e,b=(0,s.A)(e.style,ct),y=(0,s.A)(e,lt);const w=St(),[S,T]=c.useState(!1);if(Z((()=>{if(!r)return;"rtl"===k(r).direction&&T(!0)}),[r]),!r)return null;const[C,E]=n.split("-"),_="top"===C||"bottom"===C;let R=f;(_&&null!=l&&l.x||!_&&null!=l&&l.y)&&(R=null);const I=2*p,A=I/2,P=u/2*(h/-8+1),x=d/2*h/4,O=!!g,N=R&&"end"===E?"bottom":"top";let D=R&&"end"===E?"right":"left";R&&S&&(D="end"===E?"left":"right");const j=null!=(null==o?void 0:o.x)?R||o.x:"",L=null!=(null==o?void 0:o.y)?R||o.y:"",U=g||"M0,0 H"+u+" L"+(u-P)+","+(d-x)+" Q"+u/2+","+d+" "+P+","+(d-x)+" Z",F={top:O?"rotate(180deg)":"",left:O?"rotate(90deg)":"rotate(-90deg)",bottom:O?"":"rotate(180deg)",right:O?"rotate(-90deg)":"rotate(90deg)"}[C];return(0,a.jsxs)("svg",(0,i.A)((0,i.A)({},y),{},{"aria-hidden":!0,ref:t,width:O?u:u+I,height:u,viewBox:"0 0 "+u+" "+(d>u?d:u),style:(0,i.A)({position:"absolute",pointerEvents:"none",[D]:j,[N]:L,[C]:_||O?"100%":"calc(100% - "+I/2+"px)",transform:[F,v].filter((e=>!!e)).join(" ")},b),children:[I>0&&(0,a.jsx)("path",{clipPath:"url(#"+w+")",fill:"none",stroke:m,strokeWidth:I+(g?0:1),d:U}),(0,a.jsx)("path",{stroke:I&&!g?y.fill:"none",d:U}),(0,a.jsx)("clipPath",{id:w,children:(0,a.jsx)("rect",{x:-A,y:A*(O?-1:1),width:u+I,height:u})})]}))}));function Ct(){const e=new Map;return{emit(t,n){var i;null==(i=e.get(t))||i.forEach((e=>e(n)))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var i;null==(i=e.get(t))||i.delete(n)}}}const kt=c.createContext(null),Et=c.createContext(null),_t=()=>{var e;return(null==(e=c.useContext(kt))?void 0:e.id)||null},Rt=()=>c.useContext(Et);function It(e){return"data-floating-ui-"+e}const At={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0},Pt=c.forwardRef((function(e,t){const[n,s]=c.useState();Z((()=>{/apple/i.test(navigator.vendor)&&s("button")}),[]);const r={ref:t,tabIndex:0,role:n,"aria-hidden":!n||void 0,[It("focus-guard")]:"",style:At};return(0,a.jsx)("span",(0,i.A)((0,i.A)({},e),r))})),xt=c.createContext(null),Ot=It("portal");function Nt(e){const{children:t,id:n,root:i,preserveTabOrder:s=!0}=e,r=function(e){void 0===e&&(e={});const{id:t,root:n}=e,i=St(),s=Dt(),[r,o]=c.useState(null),a=c.useRef(null);return Z((()=>()=>{null==r||r.remove(),queueMicrotask((()=>{a.current=null}))}),[r]),Z((()=>{if(!i)return;if(a.current)return;const e=t?document.getElementById(t):null;if(!e)return;const n=document.createElement("div");n.id=i,n.setAttribute(Ot,""),e.appendChild(n),a.current=n,o(n)}),[t,i]),Z((()=>{if(null===n)return;if(!i)return;if(a.current)return;let e=n||(null==s?void 0:s.portalNode);e&&!m(e)&&(e=e.current),e=e||document.body;let r=null;t&&(r=document.createElement("div"),r.id=t,e.appendChild(r));const c=document.createElement("div");c.id=i,c.setAttribute(Ot,""),e=r||e,e.appendChild(c),a.current=c,o(c)}),[t,n,i,s]),r}({id:n,root:i}),[o,l]=c.useState(null),u=c.useRef(null),d=c.useRef(null),h=c.useRef(null),p=c.useRef(null),f=null==o?void 0:o.modal,g=null==o?void 0:o.open,v=!!o&&!o.modal&&o.open&&s&&!(!i&&!r);return c.useEffect((()=>{if(r&&s&&!f)return r.addEventListener("focusin",e,!0),r.addEventListener("focusout",e,!0),()=>{r.removeEventListener("focusin",e,!0),r.removeEventListener("focusout",e,!0)};function e(e){if(r&&ne(e)){("focusin"===e.type?se:ie)(r)}}}),[r,s,f]),c.useEffect((()=>{r&&(g||se(r))}),[g,r]),(0,a.jsxs)(xt.Provider,{value:c.useMemo((()=>({preserveTabOrder:s,beforeOutsideRef:u,afterOutsideRef:d,beforeInsideRef:h,afterInsideRef:p,portalNode:r,setFocusManagerState:l})),[s,r]),children:[v&&r&&(0,a.jsx)(Pt,{"data-type":"outside",ref:u,onFocus:e=>{if(ne(e,r)){var t;null==(t=h.current)||t.focus()}else{const e=o?o.domReference:null,t=te(X(n=e).body,-1)||n;null==t||t.focus()}var n}}),v&&r&&(0,a.jsx)("span",{"aria-owns":r.id,style:At}),r&&re.createPortal(t,r),v&&r&&(0,a.jsx)(Pt,{"data-type":"outside",ref:d,onFocus:e=>{if(ne(e,r)){var t;null==(t=p.current)||t.focus()}else{const t=o?o.domReference:null,i=te(X(n=t).body,1)||n;null==i||i.focus(),(null==o?void 0:o.closeOnFocusOut)&&(null==o||o.onOpenChange(!1,e.nativeEvent,"focus-out"))}var n}})]})}const Dt=()=>c.useContext(xt);let jt=0;let Lt=()=>{};const Ut=c.forwardRef((function(e,t){const{lockScroll:n=!1}=e,r=(0,s.A)(e,ut);return Z((()=>{if(n)return jt++,1===jt&&(Lt=function(){const e=/iP(hone|ad|od)|iOS/.test(Y()),t=document.body.style,n=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",i=window.innerWidth-document.documentElement.clientWidth,s=t.left?parseFloat(t.left):window.scrollX,r=t.top?parseFloat(t.top):window.scrollY;if(t.overflow="hidden",i&&(t[n]=i+"px"),e){var o,a;const e=(null==(o=window.visualViewport)?void 0:o.offsetLeft)||0,n=(null==(a=window.visualViewport)?void 0:a.offsetTop)||0;Object.assign(t,{position:"fixed",top:-(r-Math.floor(n))+"px",left:-(s-Math.floor(e))+"px",right:"0"})}return()=>{Object.assign(t,{overflow:"",[n]:""}),e&&(Object.assign(t,{position:"",top:"",left:"",right:""}),window.scrollTo(s,r))}}()),()=>{jt--,0===jt&&Lt()}}),[n]),(0,a.jsx)("div",(0,i.A)((0,i.A)({ref:t},r),{},{style:(0,i.A)({position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0},r.style)}))}));function Ft(e){const{open:t=!1,onOpenChange:n,elements:i}=e,s=St(),r=c.useRef({}),[o]=c.useState((()=>Ct())),a=null!=_t();const[l,u]=c.useState(i.reference),d=function(e){const t=c.useRef((()=>{}));return Q((()=>{t.current=e})),c.useCallback((function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return null==t.current?void 0:t.current(...n)}),[])}(((e,t,i)=>{r.current.openEvent=e?t:void 0,o.emit("openchange",{open:e,event:t,reason:i,nested:a}),null==n||n(e,t,i)})),h=c.useMemo((()=>({setPositionReference:u})),[]),p=c.useMemo((()=>({reference:l||i.reference||null,floating:i.floating||null,domReference:i.reference})),[l,i.reference,i.floating]);return c.useMemo((()=>({dataRef:r,open:t,onOpenChange:d,elements:p,events:o,floatingId:s,refs:h})),[t,d,p,o,s,h])}function Mt(e){void 0===e&&(e={});const{nodeId:t}=e,n=Ft((0,i.A)((0,i.A)({},e),{},{elements:(0,i.A)({reference:null,floating:null},e.elements)})),s=e.rootContext||n,r=s.elements,[o,a]=c.useState(null),[l,u]=c.useState(null),d=(null==r?void 0:r.domReference)||o,h=c.useRef(null),p=Rt();Z((()=>{d&&(h.current=d)}),[d]);const f=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:s=[],platform:r,elements:{reference:o,floating:a}={},transform:l=!0,whileElementsMounted:u,open:d}=e,[h,p]=c.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=c.useState(s);et(f,s)||m(s);const[g,v]=c.useState(null),[b,y]=c.useState(null),w=c.useCallback((e=>{e!==k.current&&(k.current=e,v(e))}),[]),S=c.useCallback((e=>{e!==E.current&&(E.current=e,y(e))}),[]),T=o||g,C=a||b,k=c.useRef(null),E=c.useRef(null),_=c.useRef(h),R=null!=u,I=it(u),A=it(r),P=it(d),x=c.useCallback((()=>{if(!k.current||!E.current)return;const e={placement:t,strategy:n,middleware:f};A.current&&(e.platform=A.current),Ze(k.current,E.current,e).then((e=>{const t=(0,i.A)((0,i.A)({},e),{},{isPositioned:!1!==P.current});O.current&&!et(_.current,t)&&(_.current=t,re.flushSync((()=>{p(t)})))}))}),[f,t,n,A,P]);Qe((()=>{!1===d&&_.current.isPositioned&&(_.current.isPositioned=!1,p((e=>(0,i.A)((0,i.A)({},e),{},{isPositioned:!1}))))}),[d]);const O=c.useRef(!1);Qe((()=>(O.current=!0,()=>{O.current=!1})),[]),Qe((()=>{if(T&&(k.current=T),C&&(E.current=C),T&&C){if(I.current)return I.current(T,C,x);x()}}),[T,C,x,I,R]);const N=c.useMemo((()=>({reference:k,floating:E,setReference:w,setFloating:S})),[w,S]),D=c.useMemo((()=>({reference:T,floating:C})),[T,C]),j=c.useMemo((()=>{const e={position:n,left:0,top:0};if(!D.floating)return e;const t=nt(D.floating,h.x),s=nt(D.floating,h.y);return l?(0,i.A)((0,i.A)({},e),{},{transform:"translate("+t+"px, "+s+"px)"},tt(D.floating)>=1.5&&{willChange:"transform"}):{position:n,left:t,top:s}}),[n,l,D.floating,h.x,h.y]);return c.useMemo((()=>(0,i.A)((0,i.A)({},h),{},{update:x,refs:N,elements:D,floatingStyles:j})),[h,x,N,D,j])}((0,i.A)((0,i.A)({},e),{},{elements:(0,i.A)((0,i.A)({},r),l&&{reference:l})})),g=c.useCallback((e=>{const t=m(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;u(t),f.refs.setReference(t)}),[f.refs]),v=c.useCallback((e=>{(m(e)||null===e)&&(h.current=e,a(e)),(m(f.refs.reference.current)||null===f.refs.reference.current||null!==e&&!m(e))&&f.refs.setReference(e)}),[f.refs]),b=c.useMemo((()=>(0,i.A)((0,i.A)({},f.refs),{},{setReference:v,setPositionReference:g,domReference:h})),[f.refs,v,g]),y=c.useMemo((()=>(0,i.A)((0,i.A)({},f.elements),{},{domReference:d})),[f.elements,d]),w=c.useMemo((()=>(0,i.A)((0,i.A)((0,i.A)({},f),s),{},{refs:b,elements:y,nodeId:t})),[f,b,y,t,s]);return Z((()=>{s.dataRef.current.floatingContext=w;const e=null==p?void 0:p.nodesRef.current.find((e=>e.id===t));e&&(e.context=w)})),c.useMemo((()=>(0,i.A)((0,i.A)({},f),{},{context:w,refs:b,elements:y})),[f,b,y,w])}var Vt=n(2004);const Bt=["participant","trackType"],Ht=["children"],qt=["stream"],Wt=["enabled","mirror","trackType","participant","className","VideoPlaceholder","PictureInPicturePlaceholder","refs"],$t=["icon","enabled","variant","onClick","className"],Jt=["disabled","caption","children","className","active","Menu","menuPlacement","menuOffset","title","ToggleMenuButton","variant","onClick","onMenuToggle"],zt=["title","tooltipClassName","tooltipPlacement","tooltipDisabled"],Gt=["permissionRequests","handleUpdatePermission"],Kt=["className"],Yt=e=>{let{participant:t,trackType:n="audioTrack"}=e,r=(0,s.A)(e,Bt);const l=(0,o.Gc)(),[u,d]=(0,c.useState)(null),{userId:h,sessionId:p}=t;return(0,c.useEffect)((()=>{if(!l||!u)return;const e=l.bindAudioElement(u,p,n);return()=>{null===e||void 0===e||e()}}),[l,p,u,n]),(0,a.jsx)("audio",(0,i.A)((0,i.A)({autoPlay:!0},r),{},{ref:d,"data-user-id":h,"data-session-id":p,"data-track-type":n}))};Yt.displayName="Audio";const Xt=e=>{const{participants:t,audioProps:n}=e;return(0,a.jsx)(a.Fragment,{children:t.map((e=>{if(e.isLocalParticipant)return null;const{audioStream:t,screenShareAudioStream:s,sessionId:o}=e,l=(0,r.Fv)(e)&&t&&(0,a.jsx)(Yt,(0,i.A)((0,i.A)({},n),{},{trackType:"audioTrack",participant:e})),u=(0,r.sf)(e)&&s&&(0,a.jsx)(Yt,(0,i.A)((0,i.A)({},n),{},{trackType:"screenShareAudioTrack",participant:e}));return(0,a.jsxs)(c.Fragment,{children:[l,u]},o)}))})};Xt.displayName="ParticipantsAudio";const Zt=(0,c.createContext)(void 0),Qt=()=>(0,c.useContext)(Zt),en=e=>{let{middleware:t=[],placement:n,strategy:s,offset:r=10}=e;const{refs:o,x:a,y:l,update:u,elements:{domReference:d,floating:h},context:p}=Mt({placement:n,strategy:s,middleware:[(f=r,(0,i.A)((0,i.A)({},ze(f)),{},{options:[f,m]})),st(),rt(),ot({padding:10,apply:e=>{let{availableHeight:t,elements:n}=e;Object.assign(n.floating.style,{maxHeight:"".concat(t,"px")})}}),...t]});var f,m;return(0,c.useEffect)((()=>{if(!d||!h)return;const e=Je(d,h,u);return()=>e()}),[d,h,u]),{refs:o,x:a,y:l,domReference:d,floating:h,strategy:s,context:p}};var tn;!function(e){e.PORTAL="portal",e.MENU="menu"}(tn||(tn={}));const nn=(0,c.createContext)({}),sn=()=>(0,c.useContext)(nn),rn=e=>{let{children:t,refs:n}=e;const i=(0,c.useMemo)((()=>"str-video-portal-".concat(Math.random().toString(36).substring(2,9))),[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{id:i,className:"str-video__portal"}),(0,a.jsx)(Ut,{children:(0,a.jsx)(Nt,{id:i,children:(0,a.jsx)("div",{className:"str-video__portal-content",ref:n.setFloating,children:t})})})]})},on=e=>{let{ToggleButton:t,placement:n="top-start",strategy:i="absolute",offset:s,visualType:r=tn.MENU,children:o,onToggle:l}=e;const[u,d]=(0,c.useState)(!1),h=(0,c.useRef)(l);h.current=l;const{floating:p,domReference:f,refs:m,x:g,y:v}=en({placement:n,strategy:i,offset:s});return(0,c.useEffect)((()=>{const e=null===f||void 0===f?void 0:f.ownerDocument,t=e=>{var t;if(!p&&null!==f&&void 0!==f&&f.contains(e.target))d(!0),null===(t=h.current)||void 0===t||t.call(h,!0);else if(p&&(null===p||void 0===p||!p.contains(e.target))){var n;d(!1),null===(n=h.current)||void 0===n||n.call(h,!1)}},n=e=>{var t;!e.key||"escape"!==e.key.toLowerCase()||e.altKey||e.ctrlKey||(d(!1),null===(t=h.current)||void 0===t||t.call(h,!1))};return null===e||void 0===e||e.addEventListener("click",t,{capture:!0}),null===e||void 0===e||e.addEventListener("keydown",n),()=>{null===e||void 0===e||e.removeEventListener("click",t,{capture:!0}),null===e||void 0===e||e.removeEventListener("keydown",n)}}),[p,f]),(0,a.jsxs)(a.Fragment,{children:[u&&(0,a.jsx)(nn.Provider,{value:{close:()=>d(!1)},children:r===tn.PORTAL?(0,a.jsx)(rn,{refs:m,children:o}):r===tn.MENU?(0,a.jsx)("div",{className:"str-video__menu-container",ref:m.setFloating,style:{position:i,top:null!==v&&void 0!==v?v:0,left:null!==g&&void 0!==g?g:0,overflowY:"auto"},role:"menu",children:o}):null}),(0,a.jsx)(t,{menuShown:u,ref:m.setReference})]})},an=e=>{let{children:t,onItemClick:n}=e;const i=(0,c.useRef)(null);return(0,a.jsx)("ul",{className:"str-video__generic-menu",ref:i,onClick:e=>{var t;n&&e.target!==i.current&&null!==(t=i.current)&&void 0!==t&&t.contains(e.target)&&n(e)},children:t})},cn=e=>{let{children:t}=e,n=(0,s.A)(e,Ht);return(0,a.jsx)("li",{className:"str-video__generic-menu--item",children:(0,a.jsx)("button",(0,i.A)((0,i.A)({},n),{},{children:t}))})},ln=e=>{let{className:t,icon:n}=e;return(0,a.jsx)("span",{className:(0,Vt.A)("str-video__icon",n&&"str-video__icon--".concat(n),t)})};function un(e){const[t,n]=(0,c.useState)(document.pictureInPictureElement===e);return!e&&t&&n(!1),(0,c.useEffect)((()=>{if(!e)return;const t=()=>{n(document.pictureInPictureElement===e)};return e.addEventListener("enterpictureinpicture",t),e.addEventListener("leavepictureinpicture",t),()=>{e.removeEventListener("enterpictureinpicture",t),e.removeEventListener("leavepictureinpicture",t)}}),[e]),t}const dn=()=>{const{participant:e,participantViewElement:t,videoElement:n}=Qt(),[i,s]=(0,c.useState)(!!document.fullscreenElement),l=(0,o.Gc)(),u=un(null!==n&&void 0!==n?n:void 0),{t:d}=(0,o.s9)(),{pin:h,sessionId:p,userId:f}=e,m=(0,r.Fv)(e),g=(0,r.aV)(e),v=(0,r.Mc)(e),b=(0,r.sf)(e),y=e=>()=>{null===l||void 0===l||l.updateUserPermissions({user_id:f,grant_permissions:[e]})},w=e=>()=>{null===l||void 0===l||l.updateUserPermissions({user_id:f,revoke_permissions:[e]})};(0,c.useEffect)((()=>{const e=()=>{s(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}}),[]);const{close:S}=sn()||{};return(0,a.jsxs)(an,{onItemClick:S,children:[(0,a.jsxs)(cn,{onClick:()=>{h?null===l||void 0===l||l.unpin(p):null===l||void 0===l||l.pin(p)},disabled:h&&!h.isLocalPin,children:[(0,a.jsx)(ln,{icon:"pin"}),d(h?"Unpin":"Pin")]}),(0,a.jsxs)(o.c7,{requiredGrants:[r.pI.PIN_FOR_EVERYONE],children:[(0,a.jsxs)(cn,{onClick:()=>{null===l||void 0===l||l.pinForEveryone({user_id:f,session_id:p}).catch((e=>{console.error("Failed to pin participant ".concat(f),e)}))},disabled:h&&!h.isLocalPin,children:[(0,a.jsx)(ln,{icon:"pin"}),d("Pin for everyone")]}),(0,a.jsxs)(cn,{onClick:()=>{null===l||void 0===l||l.unpinForEveryone({user_id:f,session_id:p}).catch((e=>{console.error("Failed to unpin participant ".concat(f),e)}))},disabled:!h||h.isLocalPin,children:[(0,a.jsx)(ln,{icon:"pin"}),d("Unpin for everyone")]})]}),(0,a.jsx)(o.c7,{requiredGrants:[r.pI.BLOCK_USERS],children:(0,a.jsxs)(cn,{onClick:()=>null===l||void 0===l?void 0:l.blockUser(f),children:[(0,a.jsx)(ln,{icon:"not-allowed"}),d("Block")]})}),(0,a.jsxs)(o.c7,{requiredGrants:[r.pI.MUTE_USERS],children:[g&&(0,a.jsxs)(cn,{onClick:()=>null===l||void 0===l?void 0:l.muteUser(f,"video"),children:[(0,a.jsx)(ln,{icon:"camera-off-outline"}),d("Turn off video")]}),v&&(0,a.jsxs)(cn,{onClick:()=>null===l||void 0===l?void 0:l.muteUser(f,"screenshare"),children:[(0,a.jsx)(ln,{icon:"screen-share-off"}),d("Turn off screen share")]}),m&&(0,a.jsxs)(cn,{onClick:()=>null===l||void 0===l?void 0:l.muteUser(f,"audio"),children:[(0,a.jsx)(ln,{icon:"no-audio"}),d("Mute audio")]}),b&&(0,a.jsxs)(cn,{onClick:()=>null===l||void 0===l?void 0:l.muteUser(f,"screenshare_audio"),children:[(0,a.jsx)(ln,{icon:"no-audio"}),d("Mute screen share audio")]})]}),t&&"undefined"!==typeof t.requestFullscreen&&(0,a.jsx)(cn,{onClick:()=>i?document.exitFullscreen().catch(console.error):null===t||void 0===t?void 0:t.requestFullscreen().catch(console.error),children:d("{{ direction }} fullscreen",{direction:d(i?"Leave":"Enter")})}),n&&document.pictureInPictureEnabled&&(0,a.jsx)(cn,{onClick:()=>n&&!u?n.requestPictureInPicture().catch(console.error):document.exitPictureInPicture().catch(console.error),children:d("{{ direction }} picture-in-picture",{direction:d(u?"Leave":"Enter")})}),(0,a.jsxs)(o.c7,{requiredGrants:[r.pI.UPDATE_CALL_PERMISSIONS],children:[(0,a.jsx)(cn,{onClick:y(r.pI.SEND_AUDIO),children:d("Allow audio")}),(0,a.jsx)(cn,{onClick:y(r.pI.SEND_VIDEO),children:d("Allow video")}),(0,a.jsx)(cn,{onClick:y(r.pI.SCREENSHARE),children:d("Allow screen sharing")}),(0,a.jsx)(cn,{onClick:w(r.pI.SEND_AUDIO),children:d("Disable audio")}),(0,a.jsx)(cn,{onClick:w(r.pI.SEND_VIDEO),children:d("Disable video")}),(0,a.jsx)(cn,{onClick:w(r.pI.SCREENSHARE),children:d("Disable screen sharing")})]})]})},hn=e=>null!==e&&!(0,c.isValidElement)(e),pn=(e,t)=>{if(e)return"function"===typeof e?e(t):void(e.current=t)},fn=((0,c.forwardRef)((function(e,t){let{stream:n}=e,o=(0,s.A)(e,qt);const[l,u]=(0,c.useState)(null);return(0,c.useEffect)((()=>{if(l&&n&&n!==l.srcObject)return l.srcObject=n,(r.cV.isSafari()||r.cV.isFirefox())&&setTimeout((()=>{l.srcObject=n,l.play().catch((e=>{console.error("Failed to play stream",e)}))}),0),()=>{l.pause(),l.srcObject=null}}),[n,l]),(0,a.jsx)("video",(0,i.A)((0,i.A)({autoPlay:!0,playsInline:!0},o),{},{ref:e=>{pn(t,e),u(e)}}))})),(0,c.forwardRef)((function(e,t){let{participant:n,style:i,children:s}=e;const[r,o]=(0,c.useState)(!1),l=n.name||n.userId;return(0,a.jsxs)("div",{className:"str-video__video-placeholder",style:i,ref:t,children:[(!n.image||r)&&(l?(0,a.jsx)(mn,{name:l}):(0,a.jsx)("div",{className:"str-video__video-placeholder__no-video-label",children:s})),n.image&&!r&&(0,a.jsx)("img",{onError:()=>o(!0),alt:l,className:"str-video__video-placeholder__avatar",src:n.image})]})}))),mn=e=>{const{name:t}=e,n=t.split(" ").slice(0,2).map((e=>e[0])).join("");return(0,a.jsx)("div",{className:"str-video__video-placeholder__initials-fallback",children:n})},gn=(0,c.forwardRef)((function(e,t){const{t:n}=(0,o.s9)();return(0,a.jsx)(fn,(0,i.A)((0,i.A)({ref:t},e),{},{children:n("Video is disabled")}))})),vn=(0,c.forwardRef)((function(e,t){const{t:n}=(0,o.s9)();return(0,a.jsx)(fn,(0,i.A)((0,i.A)({ref:t},e),{},{children:n("Video is playing in a popup")}))})),bn=e=>{let{enabled:t=!0,mirror:n,trackType:l,participant:u,className:d,VideoPlaceholder:h=gn,PictureInPicturePlaceholder:p=vn,refs:f}=e,m=(0,s.A)(e,Wt);const{sessionId:g,videoStream:v,screenShareStream:b,viewportVisibilityState:y,isLocalParticipant:w,userId:S}=u,T=(0,o.Gc)(),[C,k]=(0,c.useState)(null),[E,_]=(0,c.useState)(!0),[R,I]=(0,c.useState)(!0),A=un(null!==C&&void 0!==C?C:void 0),P="videoTrack"===l?v:"screenShareTrack"===l?b:void 0;if((0,c.useLayoutEffect)((()=>{if(!T||!C||"none"===l)return;const e=T.bindVideoElement(C,g,l);return()=>{null===e||void 0===e||e()}}),[T,l,g,C]),(0,c.useEffect)((()=>{if(!P||!C)return;const[e]=P.getVideoTracks();if(!e)return;const t=()=>{_(C.paused);const{width:t=0,height:n=0}=e.getSettings();I(t>=n)};return _(C.paused),C.addEventListener("play",t),C.addEventListener("pause",t),e.addEventListener("unmute",t),()=>{C.removeEventListener("play",t),C.removeEventListener("pause",t),e.removeEventListener("unmute",t),_(!0)}}),[P,C]),!T)return null;const x="videoTrack"===l?(0,r.aV)(u):"screenShareTrack"===l&&(0,r.Mc)(u),O="none"===l||(null===y||void 0===y?void 0:y[l])===r.cy.INVISIBLE,N=!t||!x||O,D=void 0===n?w&&"videoTrack"===l:n,j="screenShareTrack"===l;return(0,a.jsxs)(a.Fragment,{children:[!N&&(0,a.jsx)("video",(0,i.A)((0,i.A)({},m),{},{className:(0,Vt.A)("str-video__video",d,{"str-video__video--not-playing":E,"str-video__video--tall":!R,"str-video__video--mirror":D,"str-video__video--screen-share":j}),"data-user-id":S,"data-session-id":g,ref:e=>{var t;k(e),null===f||void 0===f||null===(t=f.setVideoElement)||void 0===t||t.call(f,e)}})),A&&p&&(0,a.jsx)(p,{style:{position:"absolute"},participant:u}),(N||E)&&h&&(0,a.jsx)(h,{style:{position:"absolute"},participant:u,ref:null===f||void 0===f?void 0:f.setVideoPlaceholderElement})]})};bn.displayName="Video";(0,c.createContext)(void 0);const yn=(0,c.forwardRef)((function(e,t){const{icon:n,enabled:r,variant:o,onClick:c,className:l}=e,u=(0,s.A)(e,$t);return(0,a.jsx)("button",(0,i.A)((0,i.A)({className:(0,Vt.A)("str-video__call-controls__button",l,{["str-video__call-controls__button--variant-".concat(o)]:o,"str-video__call-controls__button--enabled":r}),onClick:e=>{e.preventDefault(),null===c||void 0===c||c(e)},ref:t},u),{},{children:(0,a.jsx)(ln,{icon:n})}))})),wn=(0,c.forwardRef)((function(e,t){let{disabled:n,caption:r,children:o,className:c,active:l,Menu:u,menuPlacement:d,menuOffset:h,title:p,ToggleMenuButton:f=Sn,variant:m,onClick:g,onMenuToggle:v}=e,b=(0,s.A)(e,Jt);return(0,a.jsxs)("div",{className:(0,Vt.A)("str-video__composite-button",c,{"str-video__composite-button--caption":r,"str-video__composite-button--menu":u}),title:p,ref:t,children:[(0,a.jsxs)("div",{className:(0,Vt.A)("str-video__composite-button__button-group",{"str-video__composite-button__button-group--active":l,"str-video__composite-button__button-group--active-primary":l&&"primary"===m,"str-video__composite-button__button-group--active-secondary":l&&"secondary"===m,"str-video__composite-button__button-group--disabled":n}),children:[(0,a.jsx)("button",(0,i.A)((0,i.A)({type:"button",className:"str-video__composite-button__button",onClick:e=>{e.preventDefault(),null===g||void 0===g||g(e)},disabled:n},b),{},{children:o})),u&&(0,a.jsx)(on,{offset:h,placement:d,ToggleButton:f,onToggle:v,children:hn(u)?(0,a.jsx)(u,{}):u})]}),r&&(0,a.jsx)("div",{className:"str-video__composite-button__caption",children:r})]})})),Sn=(0,c.forwardRef)((function(e,t){let{menuShown:n}=e;return(0,a.jsx)(yn,{className:(0,Vt.A)("str-video__menu-toggle-button",{"str-video__menu-toggle-button--active":n}),icon:n?"caret-down":"caret-up",ref:t})})),Tn=e=>{const{isVisible:t,message:n,children:i,visibilityTimeout:s,resetIsVisible:r,placement:o="top",iconClassName:l="str-video__notification__icon",close:u}=e,{refs:d,x:h,y:p,strategy:f}=en({placement:o,strategy:"absolute"});return(0,c.useEffect)((()=>{if(!t||!s||!r)return;const e=setTimeout((()=>{r()}),s);return()=>clearTimeout(e)}),[t,r,s]),(0,a.jsxs)("div",{ref:d.setReference,children:[t&&(0,a.jsxs)("div",{className:"str-video__notification",ref:d.setFloating,style:{position:f,top:null!==p&&void 0!==p?p:0,left:null!==h&&void 0!==h?h:0,overflowY:"auto"},children:[l&&(0,a.jsx)("i",{className:l}),(0,a.jsx)("span",{className:"str-video__notification__message",children:n}),u?(0,a.jsx)("i",{className:"str-video__icon str-video__icon--close str-video__notification__close",onClick:u}):null]}),i]})},Cn=e=>{let{children:t,referenceElement:n,tooltipClassName:i,tooltipPlacement:s="top",visible:r=!1}=e;const o=(0,c.useRef)(null),{refs:l,x:u,y:d,strategy:h,context:p}=en({placement:s,strategy:"absolute",middleware:[at({element:o})]});return(0,c.useEffect)((()=>{l.setReference(n)}),[n,l]),r?(0,a.jsxs)("div",{className:(0,Vt.A)("str-video__tooltip",i),ref:l.setFloating,style:{position:h,top:null!==d&&void 0!==d?d:0,left:null!==u&&void 0!==u?u:0},children:[(0,a.jsx)(Tt,{ref:o,context:p,fill:"var(--str-video__tooltip--background-color)"}),t]}):null},kn=e=>{let{title:t,tooltipClassName:n,tooltipPlacement:r,tooltipDisabled:o}=e,l=(0,s.A)(e,zt);const{handleMouseEnter:u,handleMouseLeave:d,tooltipVisible:h}=function(){let{onMouseEnter:e,onMouseLeave:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[n,i]=(0,c.useState)(!1);return{handleMouseEnter:(0,c.useCallback)((t=>{i(!0),null===e||void 0===e||e(t)}),[e]),handleMouseLeave:(0,c.useCallback)((e=>{i(!1),null===t||void 0===t||t(e)}),[t]),tooltipVisible:n}}(),[p,f]=(0,c.useState)(null),m=!o&&Boolean(t)&&h;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Cn,{referenceElement:p,visible:m,tooltipClassName:n,tooltipPlacement:r,children:t||""}),(0,a.jsx)("div",(0,i.A)({ref:f,onMouseEnter:u,onMouseLeave:d},l))]})},En=((0,c.forwardRef)((function(e,t){return(0,a.jsx)(wn,{ref:t,active:!0,variant:"secondary","data-testid":"recording-stop-button",children:(0,a.jsx)(ln,{icon:"recording-off"})})})),{":like:":"\ud83d\udc4d",":raise-hand:":"\u270b",":fireworks:":"\ud83c\udf89",":dislike:":"\ud83d\udc4e",":heart:":"\u2764\ufe0f",":smile:":"\ud83d\ude00"}),_n=e=>{let{participant:{reaction:t,sessionId:n},hideAfterTimeoutInMs:i=5500,emojiReactionMap:s=En}=e;const r=(0,o.Gc)();if((0,c.useEffect)((()=>{if(!r||!t)return;const e=setTimeout((()=>{r.resetReaction(n)}),i);return()=>{clearTimeout(e)}}),[r,i,t,n]),!t)return null;const{emoji_code:l}=t;return(0,a.jsx)("div",{className:"str-video__reaction",children:(0,a.jsx)("span",{className:"str-video__reaction__emoji",children:l&&s[l]})})};(0,c.forwardRef)((function(e,t){let{menuShown:n}=e;const{t:i}=(0,o.s9)();return(0,a.jsx)(kn,{title:i("Reactions"),tooltipDisabled:n,children:(0,a.jsx)(wn,{ref:t,active:n,variant:"primary",children:(0,a.jsx)(ln,{icon:"reactions"})})})}));(0,c.createContext)({}),(0,c.forwardRef)((function(e,t){let{menuShown:n}=e;const{t:i}=(0,o.s9)();return(0,a.jsx)(yn,{className:(0,Vt.A)("str-video__device-settings__button",{"str-video__device-settings__button--active":n}),title:i("Toggle device menu"),icon:"device-settings",ref:t})})),(0,c.forwardRef)((function(e,t){let{menuShown:n}=e;const{t:i}=(0,o.s9)();return(0,a.jsx)(kn,{title:i("Leave call"),tooltipDisabled:n,children:(0,a.jsx)(yn,{icon:n?"close":"call-end",variant:n?"active":"danger","data-testid":"leave-call-button",ref:t})})})),(0,c.lazy)((()=>n.e(748).then(n.bind(n,748))));var Rn;!function(e){e.GOOD="Good",e.OK="Ok",e.BAD="Bad"}(Rn||(Rn={}));(0,c.forwardRef)((function(e,t){const{t:n}=(0,o.s9)(),{caption:i,menuShown:s}=e;return(0,a.jsx)(wn,{ref:t,active:s,caption:i,title:i||n("Statistics"),"data-testid":"stats-button",children:(0,a.jsx)(ln,{icon:"stats"})})})),(0,c.forwardRef)((function(e,t){return(0,a.jsx)(yn,{enabled:e.menuShown,icon:"ellipsis",ref:t})}));(0,c.forwardRef)((function(e,t){return(0,a.jsx)(yn,{enabled:e.menuShown,icon:"filter",ref:t})})),(0,c.createContext)(null),r.Ko.JOINING,r.Ko.RINGING,r.Ko.MIGRATING,r.Ko.RECONNECTING,r.Ko.RECONNECTING_FAILED,r.Ko.OFFLINE,r.Ko.IDLE,r.Ko.UNKNOWN,r.Ko.JOINED,r.Ko.LEFT,(0,c.forwardRef)((function(e,t){const{permissionRequests:n,handleUpdatePermission:r}=e,l=(0,s.A)(e,Gt),{t:u}=(0,o.s9)();return(0,a.jsx)("div",(0,i.A)((0,i.A)({className:"str-video__permission-requests-list",ref:t},l),{},{children:n.map(((e,t)=>{const{user:n,permissions:i}=e;return(0,a.jsx)(c.Fragment,{children:i.map((t=>(0,a.jsxs)("div",{className:"str-video__permission-request",children:[(0,a.jsx)("div",{className:"str-video__permission-request__message",children:An(n.name||n.id,t,u)}),(0,a.jsx)(In,{className:"str-video__permission-request__button--allow",type:"button",onClick:r(e,"grant"),children:u("Allow")}),(0,a.jsx)(In,{className:"str-video__permission-request__button--reject",type:"button",onClick:r(e,"revoke"),children:u("Revoke")}),(0,a.jsx)(In,{className:"str-video__permission-request__button--reject",type:"button",onClick:r(e,"dismiss"),children:u("Dismiss")})]},t)))},"".concat(n.id,"/").concat(t))}))}))}));const In=e=>{const{className:t}=e,n=(0,s.A)(e,Kt);return(0,a.jsx)("button",(0,i.A)({className:(0,Vt.A)("str-video__permission-request__button",t)},n))},An=(e,t,n)=>{switch(t){case r.pI.SEND_AUDIO:return n("{{ userName }} is requesting to speak",{userName:e});case r.pI.SEND_VIDEO:return n("{{ userName }} is requesting to share their camera",{userName:e});case r.pI.SCREENSHARE:return n("{{ userName }} is requesting to present their screen",{userName:e});default:return n("{{ userName }} is requesting permission: {{ permission }}",{userName:e,permission:t})}},Pn=(0,c.forwardRef)((function(e,t){return(0,a.jsx)(yn,{enabled:e.menuShown,icon:"ellipsis",ref:t})})),xn=()=>{const e=(0,o.Gc)(),{t:t}=(0,o.s9)();return(0,a.jsxs)("div",{className:"str-video__screen-share-overlay",children:[(0,a.jsx)(ln,{icon:"screen-share-off"}),(0,a.jsx)("span",{className:"str-video__screen-share-overlay__title",children:t("You are presenting your screen")}),(0,a.jsxs)("button",{onClick:()=>{null===e||void 0===e||e.screenShare.disable()},className:"str-video__screen-share-overlay__button",children:[(0,a.jsx)(ln,{icon:"close"})," ",t("Stop Screen Sharing")]})]})},On=e=>{let{indicatorsVisible:t=!0,menuPlacement:n="bottom-start",showMenuButton:i=!0,ParticipantActionsContextMenu:s=dn}=e;const{participant:o,trackType:c}=Qt(),l=(0,r.Mc)(o);return o.isLocalParticipant&&l&&"screenShareTrack"===c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(xn,{}),(0,a.jsx)(Nn,{indicatorsVisible:t})]}):(0,a.jsxs)(a.Fragment,{children:[i&&(0,a.jsx)(on,{strategy:"fixed",placement:n,ToggleButton:Pn,children:(0,a.jsx)(s,{})}),(0,a.jsx)(_n,{participant:o}),(0,a.jsx)(Nn,{indicatorsVisible:t})]})},Nn=e=>{let{indicatorsVisible:t=!0}=e;const{participant:n}=Qt(),{isLocalParticipant:i,connectionQuality:s,pin:c,sessionId:l,name:u,userId:d}=n,h=(0,o.Gc)(),{t:p}=(0,o.s9)(),f=!!s&&r.hc.ConnectionQuality[s].toLowerCase(),m=(0,r.Fv)(n),g=(0,r.aV)(n),v=!!c&&c.isLocalPin;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"str-video__participant-details",children:(0,a.jsxs)("span",{className:"str-video__participant-details__name",children:[u||d,t&&!m&&(0,a.jsx)("span",{className:"str-video__participant-details__name--audio-muted"}),t&&!g&&(0,a.jsx)("span",{className:"str-video__participant-details__name--video-muted"}),t&&v&&(0,a.jsx)("span",{title:p("Unpin"),onClick:()=>null===h||void 0===h?void 0:h.unpin(l),className:"str-video__participant-details__name--pinned"}),t&&(0,a.jsx)(Dn,{})]})}),t&&(0,a.jsx)(Tn,{isVisible:i&&s===r.hc.ConnectionQuality.POOR,message:p("Poor connection quality"),children:f&&(0,a.jsx)("span",{className:(0,Vt.A)("str-video__participant-details__connection-quality","str-video__participant-details__connection-quality--".concat(f)),title:f})})]})},Dn=()=>{const{participant:e}=Qt(),{isSpeaking:t,isDominantSpeaker:n}=e;return(0,a.jsxs)("span",{className:(0,Vt.A)("str-video__speech-indicator",t&&"str-video__speech-indicator--speaking",n&&"str-video__speech-indicator--dominant"),children:[(0,a.jsx)("span",{className:"str-video__speech-indicator__bar"}),(0,a.jsx)("span",{className:"str-video__speech-indicator__bar"}),(0,a.jsx)("span",{className:"str-video__speech-indicator__bar"})]})},jn=(0,c.forwardRef)((function(e,t){let{participant:n,trackType:i="videoTrack",mirror:s,muteAudio:l,refs:{setVideoElement:u,setVideoPlaceholderElement:d}={},className:h,VideoPlaceholder:p,PictureInPicturePlaceholder:f,ParticipantViewUI:m=On}=e;const{isLocalParticipant:g,isSpeaking:v,isDominantSpeaker:b,sessionId:y}=n,w=(0,r.Fv)(n),S=(0,r.aV)(n),T=(0,r.sf)(n),[C,k]=(0,c.useState)(null),[E,_]=(0,c.useState)(null),[R,I]=(0,c.useState)(null);(e=>{let{trackedElement:t,dynascaleManager:n,sessionId:i,trackType:s}=e;const r=(0,o.Gc)(),a=null!==n&&void 0!==n?n:null===r||void 0===r?void 0:r.dynascaleManager;(0,c.useEffect)((()=>{if(!t||!a||!r||"none"===s)return;const e=a.trackElementVisibility(t,i,s);return()=>{e()}}),[t,a,r,i,s])})({sessionId:y,trackedElement:C,trackType:i});const{useIncomingVideoSettings:A}=(0,o.R3)(),{isParticipantVideoEnabled:P}=A(),x=(0,c.useMemo)((()=>({participant:n,participantViewElement:C,videoElement:E,videoPlaceholderElement:R,trackType:i})),[E,R,n,C,i]),O=(0,c.useMemo)((()=>({setVideoElement:e=>{null===u||void 0===u||u(e),_(e)},setVideoPlaceholderElement:e=>{null===d||void 0===d||d(e),I(e)}})),[u,d]);return(0,a.jsx)("div",{"data-testid":"participant-view",ref:e=>{pn(t,e),k(e)},className:(0,Vt.A)("str-video__participant-view",b&&"str-video__participant-view--dominant-speaker",v&&"str-video__participant-view--speaking",!S&&"str-video__participant-view--no-video",!w&&"str-video__participant-view--no-audio",h),children:(0,a.jsxs)(Zt.Provider,{value:x,children:[!g&&!l&&(0,a.jsxs)(a.Fragment,{children:[w&&(0,a.jsx)(Yt,{participant:n,trackType:"audioTrack"}),T&&(0,a.jsx)(Yt,{participant:n,trackType:"screenShareAudioTrack"})]}),(0,a.jsx)(bn,{VideoPlaceholder:p,PictureInPicturePlaceholder:f,participant:n,trackType:i,refs:O,enabled:g||"videoTrack"!==i||P(n.sessionId),mirror:s,autoPlay:!0}),hn(m)?(0,a.jsx)(m,{}):m]})})}));jn.displayName="ParticipantView";const Ln=o.kb;Ln.displayName="StreamCall";const Un={en:{Joining:"Joining",Mic:"Mic","No internet connection":"No internet connection","Re-connecting":"Re-connecting",Ringing:"Ringing","Screen Share":"Screen Share","Select a Camera":"Select a Camera","Select a Mic":"Select a Mic","Select Speakers":"Select Speakers",Speakers:"Speakers",Video:"Video","You are muted. Unmute to speak.":"You are muted. Unmute to speak.",Live:"Live","You can now speak.":"You can now speak.","Awaiting for an approval to speak.":"Awaiting for an approval to speak.","You can no longer speak.":"You can no longer speak.","You can now share your video.":"You can now share your video.","Awaiting for an approval to share your video.":"Awaiting for an approval to share your video.","You can no longer share your video.":"You can no longer share your video.","Waiting for recording to stop...":"Waiting for recording to stop...","Waiting for recording to start...":"Waiting for recording to start...","Record call":"Record call",Reactions:"Reactions",Statistics:"Statistics","You can now share your screen.":"You can now share your screen.","Awaiting for an approval to share screen.":"Awaiting for an approval to share screen.","You can no longer share your screen.":"You can no longer share your screen.","Share screen":"Share screen","Incoming Call...":"Incoming Call...","Calling...":"Calling...","Mute All":"Mute All",Invite:"Invite",Join:"Join",You:"You",Me:"Me",Unknown:"Unknown","Toggle device menu":"Toggle device menu",Default:"Default","Call Recordings":"Call Recordings",Refresh:"Refresh","Check your browser video permissions":"Check your browser video permissions","Video publishing is disabled by the system":"Video publishing is disabled by the system","You have no permission to share your video":"You have no permission to share your video","You have no permission to share your audio":"You have no permission to share your audio","You are presenting your screen":"You are presenting your screen","Stop Screen Sharing":"Stop Screen Sharing",Allow:"Allow",Revoke:"Revoke",Dismiss:"Dismiss","Microphone on":"Microphone on","Microphone off":"Microphone off","Camera on":"Camera on","Camera off":"Camera off","No camera found":"No camera found","Video is disabled":"Video is disabled",Pinned:"Pinned",Unpin:"Unpin",Pin:"Pin","Pin for everyone":"Pin for everyone","Unpin for everyone":"Unpin for everyone",Block:"Block","Turn off video":"Turn off video","Turn off screen share":"Turn off screen share","Mute audio":"Mute audio","Mute screen share audio":"Mute screen share audio","Allow audio":"Allow audio","Allow video":"Allow video","Allow screen sharing":"Allow screen sharing","Disable audio":"Disable audio","Disable video":"Disable video","Disable screen sharing":"Disable screen sharing",Enter:"Enter",Leave:"Leave","Leave call":"Leave call","End call for all":"End call for all","{{ direction }} fullscreen":"{{ direction }} fullscreen","{{ direction }} picture-in-picture":"{{ direction }} picture-in-picture","Dominant Speaker":"Dominant Speaker","Poor connection quality":"Poor connection quality. Please check your internet connection.",Participants:"Participants",Anonymous:", and ({{ count }}) anonymous","No participants found":"No participants found","Participants ({{ numberOfParticipants }})":"Participants ({{ numberOfParticipants }})","{{ userName }} is sharing their screen":"{{ userName }} is sharing their screen","{{ userName }} is requesting to speak":"{{ userName }} is requesting to speak","{{ userName }} is requesting to share their camera":"{{ userName }} is requesting to share their camera","{{ userName }} is requesting to present their screen":"{{ userName }} is requesting to present their screen","{{ userName }} is requesting permission: {{ permission }}":"{{ userName }} is requesting permission: {{ permission }}"}},Fn=e=>(0,a.jsx)(o.Dv,(0,i.A)({translationsOverrides:Un},e));function Mn(e,t){return"$and"in t?t.$and.every((t=>Mn(e,t))):"$or"in t?t.$or.some((t=>Mn(e,t))):"$not"in t?!Mn(e,t.$not):function(e,t){let n=!0;for(const i of Object.keys(t)){const s=t[i],r=s&&"object"===typeof s,o=e[i];if(r&&"$eq"in s){n&&(n=s.$eq===o)}else if(r&&"$neq"in s){n&&(n=s.$neq!==o)}else if(r&&"$in"in s){n&&(n=s.$in.includes(o))}else if(r&&"$contains"in s)if(Array.isArray(o)){const e=s;n&&(n=o.includes(e.$contains))}else n=!1;else{n&&(n=s===o)}if(!n)return!1}return!0}(e,t)}Fn.displayName="StreamVideo";const Vn=e=>{let{excludeLocalParticipant:t=!1,filterParticipants:n}=e;const{useParticipants:i,useRemoteParticipants:s}=(0,o.R3)(),r=i(),a=s();return(0,c.useMemo)((()=>{const e=t?a:r;return n?Bn(e,n):e}),[r,a,t,n])},Bn=(e,t)=>{const n="function"===typeof t?t:e=>Mn({userId:e.userId,isSpeaking:e.isSpeaking,isDominantSpeaker:e.isDominantSpeaker,name:e.name,roles:e.roles,isPinned:(0,r.T4)(e),hasVideo:(0,r.aV)(e),hasAudio:(0,r.Fv)(e)},t);return e.filter(n)},Hn=e=>{(0,c.useEffect)((()=>{if(e)return e.setSortParticipantsBy(r.bT),()=>{qn(e)}}),[e])},qn=e=>{const t=r.iV.get(e.type);e.setSortParticipantsBy(t.options.sortParticipantsBy||r.B6)},Wn=(e,t)=>e.isLocalParticipant?1:t.isLocalParticipant?-1:0,$n=e=>{var t,n,i,s,c;const{useParticipants:l,useRemoteParticipants:u,useHasOngoingScreenShare:d}=(0,o.R3)(),h=(0,o.Gc)(),p=l(),[f]=p,m=u(),g=d(),v=g?p.find(r.Mc):void 0;Hn(h);const b=(0,a.jsx)(Jn,{showParticipantCount:e.showParticipantCount,showDuration:e.showDuration,showLiveBadge:e.showLiveBadge,showSpeakerName:e.showSpeakerName}),{floatingParticipantProps:y,muted:w}=e,S=g&&(0,a.jsx)(Jn,{showParticipantCount:null!==(t=null===y||void 0===y?void 0:y.showParticipantCount)&&void 0!==t&&t,showDuration:null!==(n=null===y||void 0===y?void 0:y.showDuration)&&void 0!==n&&n,showLiveBadge:null!==(i=null===y||void 0===y?void 0:y.showLiveBadge)&&void 0!==i&&i,showSpeakerName:null===(s=null===y||void 0===y?void 0:y.showSpeakerName)||void 0===s||s});return(0,a.jsxs)("div",{className:"str-video__livestream-layout__wrapper",children:[!w&&(0,a.jsx)(Xt,{participants:m}),g&&v&&(0,a.jsx)(jn,{className:"str-video__livestream-layout__screen-share",participant:v,ParticipantViewUI:b,trackType:"screenShareTrack",muteAudio:!0}),f&&(0,a.jsx)(jn,{className:(0,Vt.A)(g&&(0,Vt.A)("str-video__livestream-layout__floating-participant","str-video__livestream-layout__floating-participant--".concat(null!==(c=null===y||void 0===y?void 0:y.position)&&void 0!==c?c:"top-right"))),participant:f,ParticipantViewUI:S||b,mirror:!1!==e.mirrorLocalParticipantVideo&&void 0,muteAudio:!0})]})},Jn=e=>{const{enableFullScreen:t=!0,showParticipantCount:n=!0,showDuration:i=!0,showLiveBadge:s=!0,showSpeakerName:r=!1}=e,{participant:c}=Qt(),{useParticipantCount:l}=(0,o.R3)(),u=l(),d=zn(),h=Gn(),{t:p}=(0,o.s9)();return(0,a.jsx)("div",{className:"str-video__livestream-layout__overlay",children:(0,a.jsxs)("div",{className:"str-video__livestream-layout__overlay__bar",children:[s&&(0,a.jsx)("span",{className:"str-video__livestream-layout__live-badge",children:p("Live")}),n&&(0,a.jsx)("span",{className:"str-video__livestream-layout__viewers-count",children:u}),r&&(0,a.jsx)("span",{className:"str-video__livestream-layout__speaker-name",title:c.name||c.userId||"",children:c.name||c.userId||""}),i&&(0,a.jsx)("span",{className:"str-video__livestream-layout__duration",children:Kn(d)}),t&&(0,a.jsx)("span",{className:"str-video__livestream-layout__go-fullscreen",onClick:h})]})})};$n.displayName="LivestreamLayout";const zn=()=>{const{useIsCallLive:e,useCallSession:t}=(0,o.R3)(),n=e(),i=t(),[s,r]=(0,c.useState)((()=>{if(!i||!i.live_started_at)return 0;const e=new Date(i.live_started_at),t=new Date;return Math.floor((t.getTime()-e.getTime())/1e3)}));return(0,c.useEffect)((()=>{if(!n)return;const e=setInterval((()=>{r((e=>e+1))}),1e3);return()=>{clearInterval(e)}}),[n]),s},Gn=()=>{const{participantViewElement:e}=Qt(),[t,n]=(0,c.useState)(!1);return(0,c.useCallback)((()=>{t?document.exitFullscreen().then((()=>{n(!1)})):null===e||void 0===e||e.requestFullscreen().then((()=>{n(!0)}))}),[t,e])},Kn=e=>{const t=Math.floor(e/86400),n=Math.floor(e/3600),i=Math.floor(e%3600/60),s=e%60;return"".concat(t?t+" ":"").concat(n?n+":":"").concat(i<10?"0":"").concat(i,":").concat(s<10?"0":"").concat(s)},Yn=16,Xn=e=>{let{group:t,mirror:n,VideoPlaceholder:i,PictureInPicturePlaceholder:s,ParticipantViewUI:r}=e;return(0,a.jsx)("div",{className:(0,Vt.A)("str-video__paginated-grid-layout__group",{"str-video__paginated-grid-layout--one":1===t.length,"str-video__paginated-grid-layout--two-four":t.length>=2&&t.length<=4,"str-video__paginated-grid-layout--five-nine":t.length>=5&&t.length<=9}),children:t.map((e=>(0,a.jsx)(jn,{participant:e,muteAudio:!0,mirror:n,VideoPlaceholder:i,PictureInPicturePlaceholder:s,ParticipantViewUI:r},e.sessionId)))})};(e=>{const{groupSize:t=(e.groupSize||0)>0&&e.groupSize||Yn,excludeLocalParticipant:n=!1,filterParticipants:i,mirrorLocalParticipantVideo:s=!0,pageArrowsVisible:r=!0,VideoPlaceholder:l,ParticipantViewUI:u=On,PictureInPicturePlaceholder:d,muted:h}=e,[p,f]=(0,c.useState)(0),[m,g]=(0,c.useState)(null),v=(0,o.Gc)(),{useRemoteParticipants:b}=(0,o.R3)(),y=b(),w=Vn({excludeLocalParticipant:n,filterParticipants:i});Hn(v),(0,c.useEffect)((()=>{if(!m||!v)return;const e=v.setViewport(m);return()=>e()}),[m,v]);const S=(0,c.useMemo)((()=>((e,t)=>{const n=Math.ceil(e.length/t);return Array.from({length:n},((n,i)=>e.slice(t*i,t*i+t)))})(w,t)),[w,t]),T=S.length;(0,c.useEffect)((()=>{p>T-1&&f(Math.max(0,T-1))}),[p,T]);const C=S[p],k=!!s&&void 0;return v?(0,a.jsxs)("div",{className:"str-video__paginated-grid-layout__wrapper",ref:g,children:[!h&&(0,a.jsx)(Xt,{participants:y}),(0,a.jsxs)("div",{className:"str-video__paginated-grid-layout",children:[r&&T>1&&(0,a.jsx)(yn,{icon:"caret-left",disabled:0===p,onClick:()=>f((e=>Math.max(0,e-1)))}),C&&(0,a.jsx)(Xn,{group:C,mirror:k,VideoPlaceholder:l,ParticipantViewUI:u,PictureInPicturePlaceholder:d}),r&&T>1&&(0,a.jsx)(yn,{disabled:p===T-1,icon:"caret-right",onClick:()=>f((e=>Math.min(T-1,e+1)))})]})]}):null}).displayName="PaginatedGridLayout";const Zn=()=>(0,a.jsx)(On,{menuPlacement:"top-end"});(e=>{let{ParticipantViewUIBar:t=Zn,ParticipantViewUISpotlight:n=On,VideoPlaceholder:i,PictureInPicturePlaceholder:s,participantsBarPosition:l="bottom",participantsBarLimit:u,mirrorLocalParticipantVideo:d=!0,excludeLocalParticipant:h=!1,filterParticipants:p,pageArrowsVisible:f=!0,muted:m}=e;const g=(0,o.Gc)(),{useParticipants:v,useRemoteParticipants:b}=(0,o.R3)(),y=v(),w=b(),[S,...T]=Vn({excludeLocalParticipant:h,filterParticipants:p}),[C,k]=(0,c.useState)(null),[E,_]=(0,c.useState)(null),[R,I]=(0,c.useState)(null),A=S&&(0,r.Mc)(S),P=((e,t,n)=>{const[i,s]=(0,c.useState)({vertical:"number"===typeof n?n:null,horizontal:"number"===typeof n?n:null});return(0,c.useEffect)((()=>{if(!t||!e||"number"===typeof n||"undefined"===typeof n)return;let i=null,r=null;const o=new ResizeObserver(((n,o)=>{if(n.length>1){const e=t.firstChild;e&&(r=e.clientHeight,i=e.clientWidth,o.unobserve(t))}if(null===r||null===i)return;const a=Math.floor(e.clientHeight/r),c=Math.floor(e.clientWidth/i);s((e=>e.vertical!==a||e.horizontal!==c?{vertical:a,horizontal:c}:e))}));return o.observe(e),o.observe(t),()=>{o.disconnect()}}),[t,n,e]),i})(R,E,u),x="left"===l||"right"===l,O="top"===l||"bottom"===l;(0,c.useEffect)((()=>{if(!C||!g)return;const e=g.setViewport(C);return()=>e()}),[C,g]);const N=2===y.length;((e,t)=>{(0,c.useEffect)((()=>{if(e)return t?e.setSortParticipantsBy((0,r.SJ)(r.Vz,Wn)):e.setSortParticipantsBy(r.ND),()=>{qn(e)}}),[e,t])})(g,N);let D=T;const j=x?P.vertical:P.horizontal;"undefined"!==typeof u&&null!==j&&(D=T.slice(0,j-(A?1:0)));const L=!!d&&void 0;if(!g)return null;const U=l&&(D.length>0||A);return(0,a.jsxs)("div",{className:"str-video__speaker-layout__wrapper",children:[!m&&(0,a.jsx)(Xt,{participants:w}),(0,a.jsxs)("div",{className:(0,Vt.A)("str-video__speaker-layout",l&&"str-video__speaker-layout--variant-".concat(l)),children:[(0,a.jsx)("div",{className:"str-video__speaker-layout__spotlight",children:S&&(0,a.jsx)(jn,{participant:S,muteAudio:!0,mirror:L,trackType:A?"screenShareTrack":"videoTrack",ParticipantViewUI:n,VideoPlaceholder:i,PictureInPicturePlaceholder:s})}),U&&(0,a.jsxs)("div",{ref:I,className:"str-video__speaker-layout__participants-bar-buttons-wrapper",children:[(0,a.jsx)("div",{className:"str-video__speaker-layout__participants-bar-wrapper",ref:k,children:(0,a.jsxs)("div",{ref:_,className:"str-video__speaker-layout__participants-bar",children:[A&&(0,a.jsx)("div",{className:"str-video__speaker-layout__participant-tile",children:(0,a.jsx)(jn,{participant:S,ParticipantViewUI:t,VideoPlaceholder:i,PictureInPicturePlaceholder:s,mirror:L,muteAudio:!0})},S.sessionId),D.map((e=>(0,a.jsx)("div",{className:"str-video__speaker-layout__participant-tile",children:(0,a.jsx)(jn,{participant:e,ParticipantViewUI:t,VideoPlaceholder:i,PictureInPicturePlaceholder:s,mirror:L,muteAudio:!0})},e.sessionId)))]})}),f&&x&&(0,a.jsx)(ei,{scrollWrapper:C}),f&&O&&(0,a.jsx)(Qn,{scrollWrapper:C})]})]})]})}).displayName="SpeakerLayout";const Qn=e=>{let{scrollWrapper:t}=e;const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const[n,i]=(0,c.useState)(null);return(0,c.useEffect)((()=>{if(!e)return;const n=()=>{const n=e;return n.scrollWidth>n.clientWidth?n.scrollLeft<=t?i("start"):Math.abs(n.scrollWidth-n.scrollLeft-n.clientWidth)<=t?i("end"):void i("between"):i(null)},s=new ResizeObserver(n);return s.observe(e),e.addEventListener("scroll",n),()=>{e.removeEventListener("scroll",n),s.disconnect()}}),[e,t]),n}(t);return(0,a.jsxs)(a.Fragment,{children:[n&&"start"!==n&&(0,a.jsx)(yn,{onClick:()=>{null===t||void 0===t||t.scrollBy({left:-150,behavior:"smooth"})},icon:"caret-left",className:"str-video__speaker-layout__participants-bar--button-left"}),n&&"end"!==n&&(0,a.jsx)(yn,{onClick:()=>{null===t||void 0===t||t.scrollBy({left:150,behavior:"smooth"})},icon:"caret-right",className:"str-video__speaker-layout__participants-bar--button-right"})]})},ei=e=>{let{scrollWrapper:t}=e;const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const[n,i]=(0,c.useState)(null);return(0,c.useEffect)((()=>{if(!e)return;const n=()=>{const n=e;return n.scrollHeight>n.clientHeight?n.scrollTop<=t?i("top"):Math.abs(n.scrollHeight-n.scrollTop-n.clientHeight)<=t?i("bottom"):void i("between"):i(null)},s=new ResizeObserver(n);return s.observe(e),e.addEventListener("scroll",n),()=>{e.removeEventListener("scroll",n),s.disconnect()}}),[e,t]),n}(t);return(0,a.jsxs)(a.Fragment,{children:[n&&"top"!==n&&(0,a.jsx)(yn,{onClick:()=>{null===t||void 0===t||t.scrollBy({top:-150,behavior:"smooth"})},icon:"caret-up",className:"str-video__speaker-layout__participants-bar--button-top"}),n&&"bottom"!==n&&(0,a.jsx)(yn,{onClick:()=>{null===t||void 0===t||t.scrollBy({top:150,behavior:"smooth"})},icon:"caret-down",className:"str-video__speaker-layout__participants-bar--button-bottom"})]})},ti=e=>{const{t:t}=(0,o.s9)(),{excludeLocalParticipant:n=!1,filterParticipants:i,mirrorLocalParticipantVideo:s=!0,VideoPlaceholder:l,ParticipantViewUI:u=On}=e,[d,h]=(0,c.useState)(null),p=(0,o.Gc)(),f=Vn({excludeLocalParticipant:n,filterParticipants:i}),m=f.find((e=>(0,r.Mc)(e)));Hn(p),(0,c.useEffect)((()=>{if(d&&p)return p.setViewport(d)}),[d,p]);const g=!!s&&void 0;return p?(0,a.jsxs)("div",{className:"str-video__pip-layout",ref:h,children:[m&&(m.isLocalParticipant?(0,a.jsxs)("div",{className:"str-video__pip-screen-share-local",children:[(0,a.jsx)(ln,{icon:"screen-share-off"}),(0,a.jsx)("span",{className:"str-video__pip-screen-share-local__title",children:t("You are presenting your screen")})]}):(0,a.jsx)(jn,{participant:m,trackType:"screenShareTrack",muteAudio:!0,mirror:!1,VideoPlaceholder:l,ParticipantViewUI:u})),f.map((e=>(0,a.jsx)(jn,{participant:e,muteAudio:!0,mirror:g,VideoPlaceholder:l,ParticipantViewUI:u},e.sessionId)))]}):null};ti.displayName="PipLayout.Pip";const ni=()=>{const{useRemoteParticipants:e}=(0,o.R3)(),t=e();return(0,a.jsx)(Xt,{participants:t})};ni.displayName="PipLayout.Host";const[ii,si,ri]="1.16.2".split(".");(0,r.x8)({type:r.hc.SdkType.REACT,major:ii,minor:si,patch:ri})},9351:(e,t,n)=>{"use strict";function i(e){return"function"===typeof e}n.d(t,{T:()=>i})},9569:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let s=0;s<i.length;s++)n=i[s].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],s=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let r=3;r<i.length;r++){const s=i[r],o=t.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(o){const i=t.parseRtpMap(o),r=t.matchPrefix(e,"a=fmtp:"+s+" ");switch(i.parameters=r.length?t.parseFmtp(r[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const s=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{s.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let s=0;return n.codecs.forEach((e=>{e.maxptime>s&&(s=e.maxptime)})),s>0&&(i+="a=maxptime:"+s+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),s=-1!==i.fecMechanisms.indexOf("RED"),r=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=o.length>0&&o[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));l.length>0&&l[0].length>1&&l[0][0]===a&&(c=l[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),n.push(t),s&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:r?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&a&&n.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const s=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=s.length>0,n.compound=0===s.length;const r=t.matchPrefix(e,"a=rtcp-mux");return n.mux=r.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return s.length>0?(n=s[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const r=t.matchPrefix(e,"a=sctp-port:");if(r.length>0)return{port:parseInt(r[0].substring(12),10),protocol:n.fmt,maxMessageSize:s};const o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){const e=o[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:s}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let s;const r=void 0!==n?n:2;s=e||t.generateSessionId();return"v=0\r\no="+(i||"thisisadapterortc")+" "+s+" "+r+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t},9788:(e,t,n)=>{"use strict";n.d(t,{C:()=>r,U:()=>o});var i=n(7827),s=n(9351);function r(e){return(0,i.AQ)(this,arguments,(function(){var t,n,s;return(0,i.YH)(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,(0,i.N3)(t.read())];case 3:return n=r.sent(),s=n.value,n.done?[4,(0,i.N3)(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,(0,i.N3)(s)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function o(e){return(0,s.T)(null===e||void 0===e?void 0:e.getReader)}}}]);