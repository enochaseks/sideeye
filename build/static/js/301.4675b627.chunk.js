"use strict";(self.webpackChunkside_eye=self.webpackChunkside_eye||[]).push([[301],{227:(e,r,s)=>{s.d(r,{A:()=>i});var o=s(3235),t=s(4414);const i=(0,o.A)((0,t.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"PersonAdd")},3301:(e,r,s)=>{s.r(r),s.d(r,{default:()=>C});var o=s(9379),t=s(9950),i=s(8429),l=s(2074),n=s(1367),a=s(301),c=s(6220),d=s(6491),u=s(6639),f=s(2053),A=s(8060),x=s(3239),w=s(5333),h=s(249),m=s(6050),p=s(8614),g=s(1413),v=s(3563),j=s(1378),y=s(226),F=s(4745),I=s(4801),H=s(7286),b=s(227),k=s(5887),S=s(4414);const C=()=>{const{userId:e}=(0,i.g)(),{db:r}=(0,a.j)(),[s,C]=(0,t.useState)([]),[R,z]=(0,t.useState)(!0),[M,N]=(0,t.useState)(!1),[E,L]=(0,t.useState)(null),{currentUser:B}=(0,n.As)(),P=(0,i.Zp)();(0,t.useEffect)((()=>{if(!r||!e)return void console.error("Firestore database or userId is not initialized");let s=null;return(async()=>{if(!await(async()=>{try{const s=await(0,c.x7)((0,c.H9)(r,"users",e));if(!s.exists())return L("User not found"),z(!1),!1;if(!s.data().isPrivate||B&&B.uid===e)return!0;if(B){const s=(0,c.H9)(r,"users",e,"followers",B.uid);if((await(0,c.x7)(s)).exists())return!0}return L("This account is private. Follow to see their followers."),z(!1),!1}catch(s){return console.error("Error fetching user data:",s),L("Failed to fetch user data"),z(!1),!1}})())return null;const s=(0,c.rJ)(r,"users",e,"followers");return(0,c.aQ)(s,(async e=>{console.log("Real-time update - Followers snapshot size:",e.size),R||N(!0);try{let s=[];if(B){const e=await(0,c.GG)((0,c.rJ)(r,"users",B.uid,"following"));s=e.docs.map((e=>e.id))}const t=e.docs.map((async e=>{const t=e.id,i=await(0,c.x7)((0,c.H9)(r,"users",t));if(i.exists()){const e=i.data();return(0,o.A)((0,o.A)({},e),{},{id:t,isFollowing:s.includes(t)})}return null})),i=await Promise.all(t);C(i.filter(Boolean)),z(!1),N(!1)}catch(s){L("Failed to fetch followers"),console.error("Error fetching followers:",s),z(!1),N(!1)}}),(e=>{console.error("Error in followers snapshot listener:",e),L("Failed to listen for followers updates"),z(!1),N(!1)}))})().then((e=>{s=e})).catch((e=>{console.error("Error setting up followers updates:",e)})),()=>{s&&s()}}),[r,e,B]);return R?(0,S.jsx)(d.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:(0,S.jsx)(u.A,{})}):E?(0,S.jsx)(d.A,{p:3,children:(0,S.jsx)(f.A,{color:"error",children:E})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(A.A,{position:"static",color:"default",elevation:0,sx:{borderBottom:1,borderColor:"divider"},children:(0,S.jsxs)(x.A,{children:[(0,S.jsx)(w.A,{edge:"start",onClick:()=>P(-1),sx:{mr:2},children:(0,S.jsx)(I.A,{})}),(0,S.jsx)(f.A,{variant:"h6",sx:{flexGrow:1},children:"Followers"}),M&&(0,S.jsx)(u.A,{size:24,sx:{mr:2}})]})}),(0,S.jsx)(d.A,{p:3,children:(0,S.jsxs)(h.A,{children:[s.map((e=>(0,S.jsxs)(t.Fragment,{children:[(0,S.jsxs)(m.Ay,{sx:{py:1.5,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[(0,S.jsx)(p.A,{children:(0,S.jsx)(g.A,{src:e.profilePic,alt:e.username,component:l.N_,to:"/profile/".concat(e.id),sx:{cursor:"pointer"}})}),(0,S.jsx)(v.A,{primary:(0,S.jsx)(f.A,{component:l.N_,to:"/profile/".concat(e.id),sx:{textDecoration:"none",color:"inherit",fontWeight:"medium"},children:e.username}),secondary:e.name}),B&&e.id!==B.uid&&(0,S.jsx)(j.A,{children:e.isFollowing?(0,S.jsx)(y.A,{variant:"outlined",size:"small",startIcon:(0,S.jsx)(H.A,{}),onClick:()=>(async e=>{if(B&&r)try{C((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{isFollowing:!1}):r)))),N(!0),await(0,c.kd)((0,c.H9)(r,"users",B.uid,"following",e)),await(0,c.kd)((0,c.H9)(r,"users",e,"followers",B.uid)),await(0,c.mZ)((0,c.H9)(r,"users",B.uid),{following:(0,c.C3)(e)}),await(0,c.mZ)((0,c.H9)(r,"users",e),{followers:(0,c.C3)(B.uid)}),k.oR.success("Unfollowed successfully"),N(!1)}catch(E){console.error("Error unfollowing user:",E),k.oR.error("Failed to unfollow user"),C((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{isFollowing:!0}):r)))),N(!1)}})(e.id),sx:{borderRadius:8},children:"Unfollow"}):(0,S.jsx)(y.A,{variant:"contained",size:"small",startIcon:(0,S.jsx)(b.A,{}),onClick:()=>(async e=>{if(B&&r)try{C((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{isFollowing:!0}):r)))),N(!0),await(0,c.BN)((0,c.H9)(r,"users",B.uid,"following",e),{createdAt:new Date}),await(0,c.BN)((0,c.H9)(r,"users",e,"followers",B.uid),{createdAt:new Date}),await(0,c.mZ)((0,c.H9)(r,"users",B.uid),{following:(0,c.hq)(e)}),await(0,c.mZ)((0,c.H9)(r,"users",e),{followers:(0,c.hq)(B.uid)}),k.oR.success("Followed successfully"),N(!1)}catch(E){console.error("Error following user:",E),k.oR.error("Failed to follow user"),C((r=>r.map((r=>r.id===e?(0,o.A)((0,o.A)({},r),{},{isFollowing:!1}):r)))),N(!1)}})(e.id),sx:{borderRadius:8},children:"Follow"})})]}),(0,S.jsx)(F.A,{component:"li"})]},e.id))),0===s.length&&(0,S.jsx)(f.A,{variant:"body1",color:"text.secondary",sx:{p:2,textAlign:"center"},children:"No followers yet"})]})})]})}},4801:(e,r,s)=>{s.d(r,{A:()=>i});var o=s(3235),t=s(4414);const i=(0,o.A)((0,t.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")},7286:(e,r,s)=>{s.d(r,{A:()=>i});var o=s(3235),t=s(4414);const i=(0,o.A)((0,t.jsx)("path",{d:"M14 8c0-2.21-1.79-4-4-4S6 5.79 6 8s1.79 4 4 4 4-1.79 4-4m3 2v2h6v-2zM2 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4"}),"PersonRemove")},8614:(e,r,s)=>{s.d(r,{A:()=>m});var o=s(8587),t=s(8168),i=s(9950),l=s(2004),n=s(8465),a=s(3372),c=s(9254),d=s(8463),u=s(1763),f=s(423);function A(e){return(0,f.Ay)("MuiListItemAvatar",e)}(0,u.A)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var x=s(4414);const w=["className"],h=(0,c.Ay)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,"flex-start"===s.alignItems&&r.alignItemsFlexStart]}})((e=>{let{ownerState:r}=e;return(0,t.A)({minWidth:56,flexShrink:0},"flex-start"===r.alignItems&&{marginTop:8})})),m=i.forwardRef((function(e,r){const s=(0,d.b)({props:e,name:"MuiListItemAvatar"}),{className:c}=s,u=(0,o.A)(s,w),f=i.useContext(a.A),m=(0,t.A)({},s,{alignItems:f.alignItems}),p=(e=>{const{alignItems:r,classes:s}=e,o={root:["root","flex-start"===r&&"alignItemsFlexStart"]};return(0,n.A)(o,A,s)})(m);return(0,x.jsx)(h,(0,t.A)({className:(0,l.A)(p.root,c),ownerState:m,ref:r},u))}))}}]);